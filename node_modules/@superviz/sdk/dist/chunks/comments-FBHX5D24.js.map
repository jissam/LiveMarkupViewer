{
  "version": 3,
  "sources": ["../../src/web-components/comments/index.ts", "../../src/web-components/comments/utils/watermark.ts"],
  "sourcesContent": ["import { CSSResultGroup, LitElement, PropertyValueMap, html } from 'lit';\n\nimport { classMap } from 'lit/directives/class-map.js';\n\nimport { ParticipantByGroupApi } from '../../common/types/participant.types';\nimport { Annotation, CommentsSide, Offset } from '../../components/comments/types';\nimport { WebComponentsBase } from '../base';\nimport importStyle from '../base/utils/importStyle';\n\nimport { AnnotationFilter } from './components/types';\nimport { commentsStyle, poweredByStyle } from './css/index';\nimport { waterMarkElementObserver } from './utils/watermark';\nimport { CreateElement } from '../global/decorators/create-element.decorator';\n\nconst WebComponentsBaseElement = WebComponentsBase(LitElement);\nconst styles: CSSResultGroup[] = [WebComponentsBaseElement.styles, commentsStyle, poweredByStyle];\n\n@CreateElement('superviz-comments')\nexport class Comments extends WebComponentsBaseElement {\n  static styles = styles;\n\n  declare open: boolean;\n  declare annotations: Annotation[];\n  declare annotationFilter: AnnotationFilter;\n  declare waterMarkState: boolean;\n  declare side: CommentsSide;\n  declare participantsList: ParticipantByGroupApi[];\n  declare offset: Offset;\n\n  static properties = {\n    open: { type: Boolean },\n    annotations: { type: Object },\n    annotationFilter: { type: String },\n    waterMarkState: { type: Boolean },\n    side: { type: String },\n    participantsList: { type: Object },\n    offset: { type: Object },\n  };\n\n  constructor() {\n    super();\n    this.annotations = [];\n    this.annotationFilter = AnnotationFilter.ALL;\n    this.waterMarkState = false;\n    this.participantsList = [];\n    this.side = CommentsSide.LEFT;\n  }\n\n  protected firstUpdated(\n    _changedProperties: PropertyValueMap<any> | Map<PropertyKey, unknown>,\n  ): void {\n    super.firstUpdated(_changedProperties);\n    this.updateComplete.then(() => {\n      importStyle.call(this, ['comments']);\n    });\n  }\n\n  protected updated(changedProperties: Map<string, any>) {\n    super.updated(changedProperties);\n    this.updateComplete.then(() => {\n      if (this.waterMarkState) {\n        waterMarkElementObserver(this.shadowRoot);\n      }\n\n      if (changedProperties.has('offset')) {\n        this.applyOffset();\n      }\n    });\n  }\n\n  public participantsListed(participants: ParticipantByGroupApi[]) {\n    this.participantsList = participants;\n  }\n\n  public updateAnnotations(data: Annotation[]) {\n    this.annotations = data;\n  }\n\n  private close() {\n    this.emitEvent('close-threads', {});\n  }\n\n  waterMarkStatus(waterMark: boolean) {\n    this.waterMarkState = waterMark;\n  }\n\n  private setFilter({ detail }) {\n    const {\n      filter: { label },\n    } = detail;\n    this.annotationFilter = label;\n  }\n\n  private getOffset(offset: number) {\n    if (offset === null || offset === undefined || offset < 0) {\n      return '10px';\n    }\n\n    return `${offset}px`;\n  }\n\n  private applyOffset() {\n    const supervizCommentsDiv: HTMLDivElement = this.shadowRoot.querySelector('.superviz-comments');\n    if (!supervizCommentsDiv) return;\n\n    const { left, right, top, bottom } = this.offset;\n\n    supervizCommentsDiv.style.setProperty('--offset-top', this.getOffset(top));\n    supervizCommentsDiv.style.setProperty('--offset-bottom', this.getOffset(bottom));\n    supervizCommentsDiv.style.setProperty('--offset-right', this.getOffset(right));\n    supervizCommentsDiv.style.setProperty('--offset-left', this.getOffset(left));\n  }\n\n  private get poweredBy() {\n    if (!this.waterMarkState) return html``;\n\n    return html` <div id=\"poweredby-footer\" class=\"footer\">\n      <div class=\"powered-by powered-by--horizontal\">\n        <a href=\"https://superviz.com/\" target=\"_blank\" class=\"link\">\n          <div class=\"\">\n            Powered by\n            <img\n              width=\"48px\"\n              height=\"8.86px\"\n              src=\"https://production.cdn.superviz.com/static/superviz-gray-logo.svg\"\n            />\n          </div>\n        </a>\n      </div>\n    </div>`;\n  }\n\n  protected render() {\n    const classes = {\n      'superviz-comments': true,\n      'threads-on-left-side': this.side === CommentsSide.LEFT,\n      'threads-on-right-side': this.side === CommentsSide.RIGHT,\n      'hide-at-right': this.side === CommentsSide.RIGHT && !this.open,\n      'hide-at-left': this.side === CommentsSide.LEFT && !this.open,\n    };\n\n    return html`\n      <div id=\"superviz-comments\" class=${classMap(classes)}>\n        <div class=\"header\">\n          <superviz-comments-topbar\n            @close-threads=${this.close}\n            side=${this.side.split(':')[0]}\n          ></superviz-comments-topbar>\n        </div>\n        <superviz-comments-annotation-filter\n          filter=${this.annotationFilter}\n          @select=${this.setFilter}\n        >\n        </superviz-comments-annotation-filter>\n        <superviz-comments-content\n          annotations=${JSON.stringify(this.annotations)}\n          annotationFilter=${this.annotationFilter}\n          participantsList=${JSON.stringify(this.participantsList)}\n          class=\"content\"\n        ></superviz-comments-content>\n        ${this.poweredBy}\n      </div>\n    `;\n  }\n}\n", "let observer: MutationObserver;\n\nexport function waterMarkElementObserver(shadowRoot: ShadowRoot) {\n  const superVizCommentsId = shadowRoot.querySelector('#superviz-comments');\n\n  if (superVizCommentsId && !observer) {\n    const options = {\n      childList: true,\n      attributes: true,\n      characterData: true,\n      subtree: true,\n    };\n\n    observer = new MutationObserver((mutationsList) => {\n      mutationsList.forEach((mutation) => {\n        if (!mutation.removedNodes.length) return;\n\n        mutation.removedNodes.forEach((node: HTMLElement) => {\n          if (node.id === 'poweredby-footer') {\n            reloadWaterMarkContent(shadowRoot);\n          }\n        });\n      });\n    });\n\n    observer.observe(superVizCommentsId, options);\n  }\n}\n\nexport function reloadWaterMarkContent(shadowRoot: ShadowRoot) {\n  const divPoweredByFooter = document.createElement('div');\n  divPoweredByFooter.id = 'poweredby-footer';\n  divPoweredByFooter.className = 'footer';\n\n  const divPoweredBy = document.createElement('div');\n  divPoweredBy.className = 'powered-by powered-by--horizontal';\n\n  const link = document.createElement('a');\n  link.href = 'https://superviz.com/';\n  link.target = '_blank';\n  link.className = 'link';\n\n  const divText = document.createElement('div');\n  divText.textContent = 'Powered by';\n\n  const img = document.createElement('img');\n  img.width = 48;\n  img.height = 8.86;\n  img.src = 'https://production.cdn.superviz.com/static/superviz-gray-logo.svg';\n\n  divPoweredBy.appendChild(link);\n  link.appendChild(divText);\n\n  divText.appendChild(img);\n\n  divPoweredByFooter.appendChild(divPoweredBy);\n\n  const supervizCommentsDiv = shadowRoot.getElementById('superviz-comments');\n\n  if (supervizCommentsDiv) {\n    supervizCommentsDiv.appendChild(divPoweredByFooter);\n  }\n\n  waterMarkElementObserver(shadowRoot);\n}\n"],
  "mappings": "4XAAAA,ICAAC,IAAA,IAAIC,EAEG,SAASC,EAAyBC,EAAwB,CAC/D,IAAMC,EAAqBD,EAAW,cAAc,oBAAoB,EAExE,GAAIC,GAAsB,CAACH,EAAU,CACnC,IAAMI,EAAU,CACd,UAAW,GACX,WAAY,GACZ,cAAe,GACf,QAAS,EACX,EAEAJ,EAAW,IAAI,iBAAkBK,GAAkB,CACjDA,EAAc,QAASC,GAAa,CAC7BA,EAAS,aAAa,QAE3BA,EAAS,aAAa,QAASC,GAAsB,CAC/CA,EAAK,KAAO,oBACdC,EAAuBN,CAAU,CAErC,CAAC,CACH,CAAC,CACH,CAAC,EAEDF,EAAS,QAAQG,EAAoBC,CAAO,CAC9C,CACF,CAEO,SAASI,EAAuBN,EAAwB,CAC7D,IAAMO,EAAqB,SAAS,cAAc,KAAK,EACvDA,EAAmB,GAAK,mBACxBA,EAAmB,UAAY,SAE/B,IAAMC,EAAe,SAAS,cAAc,KAAK,EACjDA,EAAa,UAAY,oCAEzB,IAAMC,EAAO,SAAS,cAAc,GAAG,EACvCA,EAAK,KAAO,wBACZA,EAAK,OAAS,SACdA,EAAK,UAAY,OAEjB,IAAMC,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,YAAc,aAEtB,IAAMC,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,MAAQ,GACZA,EAAI,OAAS,KACbA,EAAI,IAAM,oEAEVH,EAAa,YAAYC,CAAI,EAC7BA,EAAK,YAAYC,CAAO,EAExBA,EAAQ,YAAYC,CAAG,EAEvBJ,EAAmB,YAAYC,CAAY,EAE3C,IAAMI,EAAsBZ,EAAW,eAAe,mBAAmB,EAErEY,GACFA,EAAoB,YAAYL,CAAkB,EAGpDR,EAAyBC,CAAU,CACrC,CDlDA,IAAMa,EAA2BC,EAAkBC,CAAU,EACvDC,EAA2B,CAACH,EAAyB,OAAQI,EAAeC,CAAc,EAGnFC,EAAN,cAAuBN,CAAyB,CAqBrD,aAAc,CACZ,MAAM,EACN,KAAK,YAAc,CAAC,EACpB,KAAK,iBAAmB,eACxB,KAAK,eAAiB,GACtB,KAAK,iBAAmB,CAAC,EACzB,KAAK,KAAO,MACd,CAEU,aACRO,EACM,CACN,MAAM,aAAaA,CAAkB,EACrC,KAAK,eAAe,KAAK,IAAM,CAC7BC,EAAY,KAAK,KAAM,CAAC,UAAU,CAAC,CACrC,CAAC,CACH,CAEU,QAAQC,EAAqC,CACrD,MAAM,QAAQA,CAAiB,EAC/B,KAAK,eAAe,KAAK,IAAM,CACzB,KAAK,gBACPC,EAAyB,KAAK,UAAU,EAGtCD,EAAkB,IAAI,QAAQ,GAChC,KAAK,YAAY,CAErB,CAAC,CACH,CAEO,mBAAmBE,EAAuC,CAC/D,KAAK,iBAAmBA,CAC1B,CAEO,kBAAkBC,EAAoB,CAC3C,KAAK,YAAcA,CACrB,CAEQ,OAAQ,CACd,KAAK,UAAU,gBAAiB,CAAC,CAAC,CACpC,CAEA,gBAAgBC,EAAoB,CAClC,KAAK,eAAiBA,CACxB,CAEQ,UAAU,CAAE,OAAAC,CAAO,EAAG,CAC5B,GAAM,CACJ,OAAQ,CAAE,MAAAC,CAAM,CAClB,EAAID,EACJ,KAAK,iBAAmBC,CAC1B,CAEQ,UAAUC,EAAgB,CAChC,OAAIA,GAAW,MAAgCA,EAAS,EAC/C,OAGF,GAAGA,CAAM,IAClB,CAEQ,aAAc,CACpB,IAAMC,EAAsC,KAAK,WAAW,cAAc,oBAAoB,EAC9F,GAAI,CAACA,EAAqB,OAE1B,GAAM,CAAE,KAAAC,EAAM,MAAAC,EAAO,IAAAC,EAAK,OAAAC,CAAO,EAAI,KAAK,OAE1CJ,EAAoB,MAAM,YAAY,eAAgB,KAAK,UAAUG,CAAG,CAAC,EACzEH,EAAoB,MAAM,YAAY,kBAAmB,KAAK,UAAUI,CAAM,CAAC,EAC/EJ,EAAoB,MAAM,YAAY,iBAAkB,KAAK,UAAUE,CAAK,CAAC,EAC7EF,EAAoB,MAAM,YAAY,gBAAiB,KAAK,UAAUC,CAAI,CAAC,CAC7E,CAEA,IAAY,WAAY,CACtB,OAAK,KAAK,eAEHI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAF0BA,GAgBnC,CAEU,QAAS,CACjB,IAAMC,EAAU,CACd,oBAAqB,GACrB,uBAAwB,KAAK,OAAS,OACtC,wBAAyB,KAAK,OAAS,QACvC,gBAAiB,KAAK,OAAS,SAAsB,CAAC,KAAK,KAC3D,eAAgB,KAAK,OAAS,QAAqB,CAAC,KAAK,IAC3D,EAEA,OAAOD;AAAA,0CAC+BE,EAASD,CAAO,CAAC;AAAA;AAAA;AAAA,6BAG9B,KAAK,KAAK;AAAA,mBACpB,KAAK,KAAK,MAAM,GAAG,EAAE,CAAC,CAAC;AAAA;AAAA;AAAA;AAAA,mBAIvB,KAAK,gBAAgB;AAAA,oBACpB,KAAK,SAAS;AAAA;AAAA;AAAA;AAAA,wBAIV,KAAK,UAAU,KAAK,WAAW,CAAC;AAAA,6BAC3B,KAAK,gBAAgB;AAAA,6BACrB,KAAK,UAAU,KAAK,gBAAgB,CAAC;AAAA;AAAA;AAAA,UAGxD,KAAK,SAAS;AAAA;AAAA,KAGtB,CACF,EAlJajB,EACJ,OAASH,EADLG,EAWJ,WAAa,CAClB,KAAM,CAAE,KAAM,OAAQ,EACtB,YAAa,CAAE,KAAM,MAAO,EAC5B,iBAAkB,CAAE,KAAM,MAAO,EACjC,eAAgB,CAAE,KAAM,OAAQ,EAChC,KAAM,CAAE,KAAM,MAAO,EACrB,iBAAkB,CAAE,KAAM,MAAO,EACjC,OAAQ,CAAE,KAAM,MAAO,CACzB,EAnBWA,EAANmB,EAAA,CADNC,EAAc,mBAAmB,GACrBpB",
  "names": ["init_define_process_env", "init_define_process_env", "observer", "waterMarkElementObserver", "shadowRoot", "superVizCommentsId", "options", "mutationsList", "mutation", "node", "reloadWaterMarkContent", "divPoweredByFooter", "divPoweredBy", "link", "divText", "img", "supervizCommentsDiv", "WebComponentsBaseElement", "WebComponentsBase", "s", "styles", "commentsStyle", "poweredByStyle", "Comments", "_changedProperties", "importStyle", "changedProperties", "waterMarkElementObserver", "participants", "data", "waterMark", "detail", "label", "offset", "supervizCommentsDiv", "left", "right", "top", "bottom", "x", "classes", "e", "__decorateClass", "CreateElement"]
}
