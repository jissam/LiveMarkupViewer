{
  "version": 3,
  "sources": ["../src/index.ts", "../src/components/Avatar.ts", "../node_modules/three/src/constants.js", "../node_modules/three/src/core/EventDispatcher.js", "../node_modules/three/src/math/MathUtils.js", "../node_modules/three/src/math/Vector2.js", "../node_modules/three/src/math/Matrix3.js", "../node_modules/three/src/utils.js", "../node_modules/three/src/math/ColorManagement.js", "../node_modules/three/src/math/Color.js", "../node_modules/three/src/extras/ImageUtils.js", "../node_modules/three/src/textures/Source.js", "../node_modules/three/src/textures/Texture.js", "../node_modules/three/src/math/Vector4.js", "../node_modules/three/src/math/Quaternion.js", "../node_modules/three/src/math/Vector3.js", "../node_modules/three/src/math/Box3.js", "../node_modules/three/src/math/Sphere.js", "../node_modules/three/src/math/Ray.js", "../node_modules/three/src/math/Matrix4.js", "../node_modules/three/src/math/Euler.js", "../node_modules/three/src/core/Layers.js", "../node_modules/three/src/core/Object3D.js", "../node_modules/three/src/math/Triangle.js", "../node_modules/three/src/materials/Material.js", "../node_modules/three/src/materials/MeshBasicMaterial.js", "../node_modules/three/src/core/BufferAttribute.js", "../node_modules/three/src/core/BufferGeometry.js", "../node_modules/three/src/objects/Mesh.js", "../node_modules/three/src/renderers/shaders/UniformsUtils.js", "../node_modules/three/src/renderers/shaders/ShaderChunk/default_vertex.glsl.js", "../node_modules/three/src/renderers/shaders/ShaderChunk/default_fragment.glsl.js", "../node_modules/three/src/materials/ShaderMaterial.js", "../node_modules/three/src/cameras/Camera.js", "../node_modules/three/src/cameras/PerspectiveCamera.js", "../node_modules/three/src/math/Plane.js", "../node_modules/three/src/math/Frustum.js", "../node_modules/three/src/cameras/OrthographicCamera.js", "../node_modules/three/src/materials/MeshDepthMaterial.js", "../node_modules/three/src/materials/MeshDistanceMaterial.js", "../node_modules/three/src/objects/Group.js", "../node_modules/three/src/core/InterleavedBuffer.js", "../node_modules/three/src/core/InterleavedBufferAttribute.js", "../node_modules/three/src/materials/SpriteMaterial.js", "../node_modules/three/src/objects/SkinnedMesh.js", "../node_modules/three/src/objects/Bone.js", "../node_modules/three/src/textures/DataTexture.js", "../node_modules/three/src/objects/Skeleton.js", "../node_modules/three/src/core/InstancedBufferAttribute.js", "../node_modules/three/src/objects/InstancedMesh.js", "../node_modules/three/src/materials/LineBasicMaterial.js", "../node_modules/three/src/objects/Line.js", "../node_modules/three/src/objects/LineSegments.js", "../node_modules/three/src/objects/LineLoop.js", "../node_modules/three/src/materials/PointsMaterial.js", "../node_modules/three/src/objects/Points.js", "../node_modules/three/src/materials/ShadowMaterial.js", "../node_modules/three/src/materials/RawShaderMaterial.js", "../node_modules/three/src/materials/MeshStandardMaterial.js", "../node_modules/three/src/materials/MeshPhysicalMaterial.js", "../node_modules/three/src/materials/MeshPhongMaterial.js", "../node_modules/three/src/materials/MeshToonMaterial.js", "../node_modules/three/src/materials/MeshNormalMaterial.js", "../node_modules/three/src/materials/MeshLambertMaterial.js", "../node_modules/three/src/materials/MeshMatcapMaterial.js", "../node_modules/three/src/materials/LineDashedMaterial.js", "../node_modules/three/src/materials/Materials.js", "../node_modules/three/src/animation/AnimationUtils.js", "../node_modules/three/src/math/Interpolant.js", "../node_modules/three/src/math/interpolants/CubicInterpolant.js", "../node_modules/three/src/math/interpolants/LinearInterpolant.js", "../node_modules/three/src/math/interpolants/DiscreteInterpolant.js", "../node_modules/three/src/animation/KeyframeTrack.js", "../node_modules/three/src/animation/tracks/BooleanKeyframeTrack.js", "../node_modules/three/src/animation/tracks/ColorKeyframeTrack.js", "../node_modules/three/src/animation/tracks/NumberKeyframeTrack.js", "../node_modules/three/src/math/interpolants/QuaternionLinearInterpolant.js", "../node_modules/three/src/animation/tracks/QuaternionKeyframeTrack.js", "../node_modules/three/src/animation/tracks/StringKeyframeTrack.js", "../node_modules/three/src/animation/tracks/VectorKeyframeTrack.js", "../node_modules/three/src/animation/AnimationClip.js", "../node_modules/three/src/loaders/Cache.js", "../node_modules/three/src/loaders/LoadingManager.js", "../node_modules/three/src/loaders/Loader.js", "../node_modules/three/src/loaders/FileLoader.js", "../node_modules/three/src/loaders/ImageLoader.js", "../node_modules/three/src/loaders/TextureLoader.js", "../node_modules/three/src/lights/Light.js", "../node_modules/three/src/lights/LightShadow.js", "../node_modules/three/src/lights/SpotLightShadow.js", "../node_modules/three/src/lights/SpotLight.js", "../node_modules/three/src/lights/PointLightShadow.js", "../node_modules/three/src/lights/PointLight.js", "../node_modules/three/src/lights/DirectionalLightShadow.js", "../node_modules/three/src/lights/DirectionalLight.js", "../node_modules/three/src/loaders/LoaderUtils.js", "../node_modules/three/src/loaders/ImageBitmapLoader.js", "../node_modules/three/src/animation/PropertyBinding.js", "../node_modules/three/src/Three.js", "../src/utils/BufferGeometryUtils.js", "../src/utils/GLTFLoader.js", "../src/utils/ColladaExporter.js", "../src/utils/ColladaLoader.js", "../src/utils/TranslateModel.js", "../src/components/AvatarName3D.ts", "../src/components/Laser.ts", "../src/components/Mouse.ts", "../src/services/comments-adapter.ts", "../src/common/utils/logger.ts", "../src/common/utils/observer.ts", "../src/utils/logger.ts"],
  "sourcesContent": ["import type { Participant, Presence3DManager, StoreType } from '@superviz/sdk';\nimport type { useStore } from '@superviz/sdk/lib/common/utils/use-store';\nimport type { DefaultAttachComponentOptions } from '@superviz/sdk/lib/components/base/types';\nimport type { EventBus } from '@superviz/sdk/lib/services/event-bus';\nimport type {\n  PresenceEvent,\n  PresenceEvents,\n  Room,\n  SocketEvent,\n} from '@superviz/sdk/lib/lib/socket';\nimport { isEqual } from 'lodash';\nimport { Mesh, Object3D, Vector3 } from 'three';\n\nimport { Avatar } from './components/Avatar';\nimport { AvatarName } from './components/AvatarName3D';\nimport { Laser } from './components/Laser';\nimport { Mouse } from './components/Mouse';\nimport { AutodeskPin } from './services/comments-adapter';\nimport {\n  AutodeskViewerComponentOptions,\n  ParticipantOn3D,\n  PositionInfo,\n  Avatar as AvatarType,\n  Presence3dEvents,\n} from './types';\nimport { Logger } from './utils/logger';\nimport type { ParticipantDataInput } from '@superviz/sdk/lib/services/presence-3d-manager/types';\n\nconst MY_PROPERTIES_MOUSE_THROTTLE = 100;\nconst DEFAULT_AVATAR: AvatarType = {\n  model3DUrl: 'https://production.storage.superviz.com/readyplayerme/1.glb',\n  imageUrl: 'https://production.cdn.superviz.com/static/default-avatars/1.png',\n};\n\nconst storeType = {\n  GLOBAL: 'global-store' as StoreType.GLOBAL,\n  PRESENCE_3D: 'presence-3d-store' as StoreType.PRESENCE_3D,\n};\n\nclass Presence3D {\n  public name: string;\n\n  private localParticipant: Participant;\n  private eventBus: EventBus;\n  private logger: Logger;\n  private config: AutodeskViewerComponentOptions;\n  private participants: ParticipantOn3D[] = [];\n\n  private isAttached = false;\n  private followParticipantId?: string;\n  private localFollowParticipantId?: string;\n\n  private avatars: Record<string, Avatar> = {};\n  private lasers: Record<string, Laser> = {};\n  private names: Record<string, AvatarName> = {};\n  private mouses: Record<string, Mouse> = {};\n  private positionInfos: Record<string, PositionInfo> = {};\n\n  private renderSilentInterval: ReturnType<typeof setInterval> = null;\n  private lastSyncedData: Object3D = {};\n\n  private viewer: Autodesk.Viewing.GuiViewer3D;\n  private unsubscribeFrom: Array<(id: unknown) => void> = [];\n  private useStore: typeof useStore;\n  private room: Room;\n  private presence3DManager: Presence3DManager;\n  private isPrivate: boolean;\n  private roomParticipants: Record<string, ParticipantDataInput> = {};\n  private hasJoinedRoom: boolean = false;\n  private hasJoined3D: boolean = false;\n\n  constructor(viewer: Autodesk.Viewing.GuiViewer3D, options?: AutodeskViewerComponentOptions) {\n    if (typeof window === 'undefined') {\n      throw new Error(\n        '[SuperViz] Presence3D cannot be initialized in a non-browser environment. Window is not defined',\n      );\n    }\n\n    if (!viewer) {\n      throw new Error('autodesk viewer instance is required');\n    }\n\n    this.name = 'presence3dAutodesk';\n    this.logger = new Logger('@superviz/sdk/autodesk-viewer-component');\n\n    this.logger.log('autodesk-viewer component @ constructor', { viewer, options });\n\n    this.config = {\n      isAvatarsEnabled: options?.isAvatarsEnabled ?? true,\n      isLaserEnabled: options?.isLaserEnabled ?? true,\n      isNameEnabled: options?.isNameEnabled ?? true,\n      isMouseEnabled: options?.isMouseEnabled ?? true,\n      avatarConfig: options?.avatarConfig,\n    };\n\n    this.logger.log('autodesk-viewer component @ constructor - config', this.config);\n\n    this.viewer = viewer;\n    this.viewer.canvas.addEventListener('mousemove', this.onMouseMove);\n\n    this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraChanged);\n  }\n\n  private get localParticipantId(): string {\n    return this.localParticipant?.id;\n  }\n\n  public attach = (params: DefaultAttachComponentOptions): void => {\n    if (Object.values(params).includes(null) || Object.values(params).includes(undefined)) {\n      const message = 'autodesk-viewer component @ attach - params are required';\n\n      this.logger.log(message);\n      throw new Error(message);\n    }\n\n    this.logger.log('attached');\n\n    const { eventBus, useStore, ioc, Presence3DManagerService } = params;\n    this.useStore = useStore.bind(this);\n    this.room = ioc.createRoom(this.name);\n    this.presence3DManager = new Presence3DManagerService(this.room, this.useStore);\n\n    const { localParticipant, hasJoinedRoom } = this.useStore(storeType.GLOBAL);\n    localParticipant.subscribe();\n    hasJoinedRoom.subscribe();\n\n    const { hasJoined3D, participants } = this.useStore(storeType.PRESENCE_3D);\n    hasJoined3D.subscribe();\n    participants.subscribe(this.onParticipantsUpdated);\n\n    this.isAttached = true;\n    this.eventBus = eventBus;\n\n    this.start();\n  };\n\n  public detach = (): void => {\n    if (!this.isAttached) {\n      this.logger.log('autodesk-viewer component @ detach - component is not attached}');\n      return;\n    }\n\n    this.logger.log('detached');\n    this.destroy();\n    this.unsubscribeFrom.forEach((unsubscribe) => unsubscribe(this));\n\n    this.localParticipant = undefined;\n    this.isAttached = false;\n  };\n\n  private destroy = (): void => {\n    this.unsubscribeToRealtimeEvents();\n    this.unsubscribeToEventBusEvents();\n    this.room.disconnect();\n    this.room = undefined;\n    this.participants.forEach((participant) => {\n      this.presence3DManager.unsubscribeFromUpdates(participant.id, this.onParticipantUpdated);\n    });\n\n    this.presence3DManager = undefined;\n    this.useStore(storeType.PRESENCE_3D).destroy();\n    this.useStore = undefined;\n\n    this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraChanged);\n    this.viewer.canvas.removeEventListener('mousemove', this.onMouseMove);\n\n    clearInterval(this.renderSilentInterval);\n\n    this.participants.forEach((participant) => {\n      this.removeParticipant(participant, true);\n    });\n\n    this.avatars = {};\n    this.lasers = {};\n    this.mouses = {};\n    this.positionInfos = {};\n\n    this.viewer.overlays.clearScene('avatars-scene');\n    this.viewer.overlays.removeScene('avatars-scene');\n  };\n\n  private start = (): void => {\n    if (!this.hasJoinedRoom || !this.hasJoined3D) {\n      this.logger.log('matterport component @ start - not joined yet');\n\n      setTimeout(() => {\n        this.logger.log('matterport component @ start - retrying');\n        this.start();\n      }, 1000);\n\n      return;\n    }\n\n    this.subscribeToRealtimeEvents();\n    this.subscribeToEventBusEvents();\n    this.createParticipantList();\n\n    this.renderSilentInterval = setInterval(this.renderSilent, 1);\n    this.sync();\n  };\n\n  private subscribeToRealtimeEvents = (): void => {\n    this.logger.log('autodesk-viewer component @ subscribeToRealtimeEvents');\n    this.room.on<Participant>(Presence3dEvents.PARTICIPANT_JOINED, this.onParticipantJoined);\n    this.room.presence.on('presence.leave' as PresenceEvents, this.onParticipantLeave);\n    this.room.on<{ id?: string }>(Presence3dEvents.GATHER, this.onGatherUpdate);\n    this.room.on<{ id?: string }>(Presence3dEvents.FOLLOW_ME, this.onFollowParticipantUpdate);\n  };\n\n  private unsubscribeToRealtimeEvents = (): void => {\n    this.logger.log('autodesk-viewer component @ unsubscribeToRealtimeEvents');\n    this.room.presence.off('presence.leave' as PresenceEvents);\n    this.room.off(Presence3dEvents.PARTICIPANT_JOINED, this.onParticipantJoined);\n    this.room.off(Presence3dEvents.GATHER, this.onGatherUpdate);\n    this.room.off(Presence3dEvents.FOLLOW_ME, this.onFollowParticipantUpdate);\n  };\n\n  private subscribeToEventBusEvents = (): void => {\n    this.logger.log('autodesk-viewer component @ subscribeToEventBusEvents');\n    this.eventBus.subscribe('realtime.go-to-participant', this.goTo);\n    this.eventBus.subscribe('realtime.local-follow-participant', this.localFollow);\n    this.eventBus.subscribe('realtime.follow-participant', this.follow);\n    this.eventBus.subscribe('realtime.private-mode', this.setPrivate);\n  };\n\n  private unsubscribeToEventBusEvents = (): void => {\n    this.logger.log('autodesk-viewer component @ unsubscribeToEventBusEvents');\n    this.eventBus.unsubscribe('realtime.go-to-participant', this.goTo);\n    this.eventBus.unsubscribe('realtime.local-follow-participant', this.localFollow);\n    this.eventBus.unsubscribe('realtime.follow-participant', this.follow);\n    this.eventBus.unsubscribe('realtime.private-mode', this.setPrivate);\n  };\n\n  /** Realtime Callbacks */\n\n  private onParticipantJoined = (participant): void => {\n    if (!participant.data) return;\n\n    this.logger.log('autodesk-viewer component @ onParticipantJoined', participant);\n\n    const { id, name, avatar, avatarConfig, type, slot } = participant.data;\n\n    if (id === this.localFollowParticipantId) {\n      this.onLocalParticipantJoined(participant.data);\n      return;\n    }\n\n    this.addParticipant({\n      id,\n      name,\n      avatar,\n      avatarConfig,\n      type,\n      slot,\n      isPrivate: false,\n    });\n  };\n\n  private onLocalParticipantJoined = (participant): void => {\n    if (this.config.avatarConfig) {\n      this.presence3DManager.setParticipantData({\n        avatarConfig: this.config.avatarConfig,\n      } as ParticipantDataInput);\n    }\n\n    if (participant.avatar?.model3DUrl) {\n      this.presence3DManager.setParticipantData({\n        avatar: {\n          model3DUrl: participant?.avatar.model3DUrl,\n          imageUrl: participant?.avatar?.imageUrl,\n        },\n      } as ParticipantDataInput);\n    }\n\n    if (!participant.avatar?.model3DUrl) {\n      this.presence3DManager.setParticipantData({\n        avatar: {\n          model3DUrl: DEFAULT_AVATAR.model3DUrl,\n          imageUrl: participant?.avatar?.imageUrl,\n        },\n      } as ParticipantDataInput);\n    }\n  };\n\n  private onParticipantLeave = (event: PresenceEvent<Participant>): void => {\n    this.logger.log('autodesk-viewer component @ onParticipantLeave', event);\n\n    const participantToRemove = this.participants.find(\n      (participantOnlist) => participantOnlist.id === event.id,\n    );\n\n    delete this.roomParticipants[event.id];\n\n    if (!participantToRemove) return;\n\n    this.removeParticipant(participantToRemove, true);\n  };\n\n  private onParticipantUpdated = (participant): void => {\n    this.logger.log('autodesk-viewer component @ onParticipantUpdated', participant);\n    const { id, name, avatar, avatarConfig, position, rotation, type, slot } = participant;\n\n    this.updateParticipant({\n      position,\n      rotation,\n      id,\n      name,\n      avatar,\n      avatarConfig,\n      type,\n      slot,\n    });\n\n    if (this.localFollowParticipantId || this.followParticipantId) {\n      this.moveToAnotherParticipant(this.localFollowParticipantId ?? this.followParticipantId);\n    }\n  };\n\n  private updateParticipant = (participant): Promise<void> => {\n    if (!this.participants || this.participants.length === 0 || !participant || !participant.id) {\n      return;\n    }\n\n    const participantToBeUpdated = this.participants.find(\n      (oldParticipant) => oldParticipant.id === participant.id,\n    );\n\n    if (!participantToBeUpdated) {\n      this.addParticipant(participant);\n      return;\n    }\n\n    // create new avatar if avatar model, remove participant and add it again\n    if (\n      participantToBeUpdated.avatar?.model3DUrl !== participant.avatar?.model3DUrl ||\n      !isEqual(participantToBeUpdated.avatarConfig, participant.avatarConfig) ||\n      participantToBeUpdated.name !== participant.name\n    ) {\n      this.removeParticipant(participant, true);\n      this.addParticipant(participant);\n    } else {\n      const index = this.participants.findIndex((u) => u.id === participant.id);\n\n      if (index !== -1) {\n        this.participants[index] = participant;\n      }\n    }\n\n    this.logger.log('autodesk-viewer component @ updateParticipant', {\n      participant,\n      participants: this.participants,\n    });\n  };\n\n  private onFollowParticipantUpdate = (event: SocketEvent<{ id: string | undefined }>): void => {\n    if (event.data.id === this.localParticipantId) return;\n    this.logger.log('three js component @ onFollowParticipantUpdate', event.data.id);\n    this.followParticipantId = event.data.id;\n    this.moveToAnotherParticipant(event.data.id);\n  };\n\n  private onGatherUpdate = (event: SocketEvent<{ id: string | undefined }>): void => {\n    this.logger.log('three js component @ onGatherUpdate', event.data.id);\n\n    if (event.data.id === this.localParticipantId) return;\n\n    this.eventBus.publish('realtime.go-to-participant', event.data.id);\n  };\n\n  private async create3dPresence(participantOn3D: ParticipantOn3D) {\n    if (participantOn3D.id === this.localParticipantId) return;\n\n    if (this.config.isAvatarsEnabled) {\n      const model = await this.createAvatar(participantOn3D);\n\n      // name is a child of avatar\n      this.config.isNameEnabled && this.createName(participantOn3D, model);\n    }\n\n    this.config.isMouseEnabled && this.createMouse(participantOn3D);\n    this.config.isLaserEnabled && this.createLaser(participantOn3D);\n  }\n\n  /** Participants */\n\n  private createParticipantList = () => {\n    const list = this.useStore(storeType.PRESENCE_3D).participants.value;\n\n    Object.values(list).forEach((participant: ParticipantDataInput) => {\n      if (participant.isPrivate) return;\n      this.addParticipant(participant);\n    });\n\n    this.logger.log('autodesk-viewer component @ createParticipantList', this.participants);\n  };\n\n  private createParticipantOn3D = ({\n    id,\n    name,\n    avatar,\n    avatarConfig,\n    type,\n    isPrivate,\n    slot,\n  }): ParticipantOn3D => {\n    const participant = {\n      id,\n      name,\n      avatar,\n      isPrivate,\n      isAudience: type === 'audience',\n      avatarConfig: id === this.localParticipantId ? this.config.avatarConfig : avatarConfig,\n      position: {\n        x: 0,\n        y: 0,\n        z: 0,\n      },\n      rotation: {\n        x: 0,\n        y: 0,\n      },\n      slot,\n    };\n\n    this.logger.log('autodesk-viewer component @ createParticipantOn3D', participant);\n\n    return participant;\n  };\n\n  private removeParticipant = (participant: ParticipantOn3D, unsubscribe: boolean): void => {\n    this.logger.log('autodesk-viewer component @ removeParticipant', { participant, unsubscribe });\n\n    this.participants = this.participants.filter(\n      (participantOnlist) => participantOnlist.id !== participant.id,\n    );\n\n    this.destroyAvatar(participant);\n    this.destroyLaser(participant);\n    this.destroyMouse(participant);\n\n    if (unsubscribe) {\n      this.presence3DManager?.unsubscribeFromUpdates(participant.id, this.onParticipantUpdated);\n    }\n  };\n\n  private addParticipant = async (participant): Promise<void> => {\n    if (!participant || !participant.id || participant.type === 'audience') return;\n    const participantOn3D = this.createParticipantOn3D(participant);\n\n    if (this.participants.find((p) => p.id === participantOn3D.id)) {\n      this.logger.log('autodesk-viewer component @ addParticipant - participant already exists');\n\n      this.onParticipantUpdated(participant);\n      return;\n    }\n\n    this.roomParticipants[participant.id] = participant;\n\n    this.participants.push(participantOn3D);\n\n    this.logger.log('autodesk-viewer component @ addParticipant', {\n      participant,\n      participantOn3D,\n      participants: this.participants,\n    });\n\n    // audience listens to the hosts broadcast channel\n\n    this.presence3DManager.subscribeToUpdates(participantOn3D.id, this.onParticipantUpdated);\n\n    this.create3dPresence(participantOn3D);\n  };\n\n  /** EventBus callbacks */\n\n  /**\n   * @function goTo\n   * @description go to a participant\n   * @param participantId - participant id to go to\n   * @returns {void}\n   */\n  public goTo = (participantId: string): void => {\n    this.logger.log('autodesk-viewer component @ goTo', participantId);\n\n    this.moveToAnotherParticipant(participantId);\n  };\n\n  /**\n   * @function gather\n   * @description gather all participants\n   * @returns {void}\n   */\n  public gather = (): void => {\n    this.logger.log('autodesk-viewer component @ gather');\n    this.room.emit(Presence3dEvents.GATHER, { id: this.localParticipant.id });\n  };\n\n  /**\n   * @function setPrivate\n   * @param {boolean} isPrivate\n   * @description updates participant private status\n   * @returns {void}\n   */\n  private setPrivate = (isPrivate: boolean): void => {\n    this.logger.log('autodesk-viewer component @ private mode');\n    this.presence3DManager.updatePresence3D({\n      id: this.localParticipantId,\n      isPrivate: !!isPrivate,\n    } as ParticipantDataInput);\n\n    this.isPrivate = !!isPrivate;\n  };\n\n  /**\n   * @function follow\n   * @description follow a participant\n   * @param participantId - participant id to follow, if not provided, follow is disabled\n   * @returns {void}\n   */\n  public follow = (participantId?: string): void => {\n    this.logger.log('autodesk-viewer component @ follow');\n    this.room.emit(Presence3dEvents.FOLLOW_ME, { id: participantId });\n  };\n\n  /**\n   * @function localFollow\n   * @description follow a participant\n   * @param participantId - participant id to follow, if not provided, follow is disabled\n   * @returns {void}\n   */\n  private localFollow = (participantId?: string): void => {\n    this.localFollowParticipantId = participantId;\n  };\n\n  public async createAvatar(participant: ParticipantOn3D) {\n    this.logger.log('autodesk-viewer component @ createAvatar', participant);\n\n    if (!this.isAttached) return;\n\n    if (participant.id === this.localParticipantId) return;\n\n    if (this.avatars[participant.id]) {\n      this.avatars[participant.id].destroy();\n    }\n\n    const scale = participant.avatarConfig?.scale || 1;\n    const height = participant.avatarConfig?.height || 0;\n\n    const url = participant.avatar?.model3DUrl ?? DEFAULT_AVATAR.model3DUrl;\n    const avatar = new Avatar(url, scale, height);\n    const model: Object3D = await avatar.load();\n\n    if (!this.viewer.overlays.hasScene('avatars-scene')) {\n      this.viewer.overlays.addScene('avatars-scene');\n    }\n\n    this.viewer.overlays.addMesh(model, 'avatars-scene');\n    this.avatars[participant.id] = avatar;\n\n    return model;\n  }\n\n  public async destroyAvatar(participant: ParticipantOn3D) {\n    if (this.avatars[participant.id]) {\n      if (this.names[participant.id]) {\n        this.names[participant.id].destroy();\n        this.names[participant.id] = null;\n      }\n\n      this.avatars[participant.id].destroy();\n      delete this.avatars[participant.id];\n      this.avatars[participant.id] = null;\n    }\n  }\n\n  private createLaser(participant: ParticipantOn3D) {\n    if (!this.isAttached) return;\n\n    let laserOrigin: Vector3 = new Vector3(0, 0, 0);\n    if (participant.avatarConfig?.laserOrigin) {\n      laserOrigin = new Vector3(\n        participant.avatarConfig.laserOrigin.x,\n        participant.avatarConfig.laserOrigin.y,\n        participant.avatarConfig.laserOrigin.z,\n      );\n    }\n\n    // laser\n    const slot = this.roomParticipants[participant.id].slot;\n    this.lasers[participant.id] = new Laser(this.viewer, slot, laserOrigin);\n  }\n\n  public async destroyLaser(participant: ParticipantOn3D) {\n    if (this.lasers[participant.id]) {\n      this.lasers[participant.id].destroy();\n      delete this.lasers[participant.id];\n      this.lasers[participant.id] = null;\n    }\n  }\n\n  private async createName(participant: ParticipantOn3D, avatarModel: THREE.Object3D) {\n    this.logger.log('autodesk-viewer component @ createName', participant);\n\n    if (!participant.name.trim().length) return;\n\n    const boundingBox = new THREE.Box3().setFromObject(avatarModel);\n    const size = new Vector3(0, 0, 0);\n    boundingBox.getSize(size);\n    const slot = participant.slot ?? this.roomParticipants[participant.id].slot;\n    const nameHeight = boundingBox.min.y + size.y * 1.25;\n    const name = new AvatarName(participant.name, slot, nameHeight, this.viewer);\n    const nameModel: Mesh = await name.load();\n    avatarModel.add(nameModel);\n    this.names[participant.id] = name;\n  }\n\n  private async createMouse(participant: ParticipantOn3D) {\n    if (!this.isAttached) return;\n\n    // mouse\n    const slot = this.roomParticipants[participant.id].slot;\n\n    const mouse = new Mouse(this.viewer, participant.id);\n    this.mouses[participant.id] = mouse;\n    mouse.load(participant.name, slot);\n  }\n\n  public async destroyMouse(participant: ParticipantOn3D) {\n    if (this.mouses[participant.id]) {\n      this.mouses[participant.id].destroy();\n      delete this.mouses[participant.id];\n    }\n  }\n\n  public moveToAnotherParticipant(participantId: string) {\n    if (!this.positionInfos[participantId] || !this.isAttached) return;\n\n    const { position, target } = this.positionInfos[participantId];\n\n    if (!target || !position) return;\n\n    const destPosition = new Vector3(position.x, position.y, position.z);\n    const destTarget = new Vector3(target.x, target.y, target.z);\n    const camera = this.viewer.navigation.getCamera();\n\n    // @ts-ignore\n    this.viewer.navigation.setRequestTransition(\n      true,\n      destPosition,\n      destTarget,\n      camera.fov,\n      true,\n      camera.pivot,\n    );\n  }\n\n  private onCameraChanged = () => {\n    if (!this.isAttached) {\n      return;\n    }\n    if (this.viewer.impl.overlayScenes['avatars-scene']) {\n      // @ts-ignore\n      this.viewer.impl.requestSilentRender();\n    }\n    this.sync();\n  };\n\n  private renderSilent = () => {\n    if (this.viewer.impl.overlayScenes['avatars-scene']) {\n      // @ts-ignore\n      this.viewer.impl.requestSilentRender();\n\n      // check if avatars close to local\n      let isTooClose = false;\n\n      const closeAvatars = [];\n\n      Object.values(this.avatars).forEach((avatar) => {\n        if (!avatar?.model) {\n          return;\n        }\n        if (this.lastSyncedData.position.distanceTo(avatar.model.position) < 1) {\n          isTooClose = true;\n          closeAvatars.push(avatar);\n        }\n      });\n\n      if (isTooClose) {\n        closeAvatars.forEach((avatar) => {\n          if (!avatar?.model) {\n            return;\n          }\n          avatar.model.visible = false;\n        });\n      } else {\n        Object.values(this.avatars).forEach((avatar) => {\n          if (!avatar?.model) {\n            return;\n          }\n          avatar.model.visible = true;\n        });\n      }\n    }\n  };\n\n  private onParticipantsUpdated = (participants) => {\n    Object.values(participants).forEach((participant: ParticipantOn3D) => {\n      if (!this.isAttached || participant.id === this.localParticipantId) return;\n\n      this.roomParticipants = {};\n\n      participants.forEach((participant) => {\n        this.roomParticipants[participant.id] = participant;\n      });\n\n      const participantId = participant.id;\n      const remoteAvatar: Avatar = this.avatars[participantId];\n      const remoteLaser: Laser = this.lasers[participantId];\n      const remoteMouse: Mouse = this.mouses[participantId];\n      const slot = participant.slot;\n\n      const { position, quaternion, target, mouse, isPrivate } = participant;\n\n      this.positionInfos[participant.id] = {\n        position,\n        quaternion,\n        target,\n      };\n\n      if (isPrivate && this.avatars[participantId]) {\n        this.removeParticipant(participant, true);\n      }\n\n      if (!isPrivate && !this.avatars[participantId]) {\n        this.addParticipant(participant);\n      }\n\n      if (remoteAvatar) {\n        remoteAvatar.setPosition(position);\n        remoteAvatar.setQuaternion(quaternion);\n        remoteAvatar.target = target;\n      }\n\n      if (remoteLaser) {\n        remoteLaser.setAvatar(remoteAvatar);\n        remoteLaser.setMousePosition(mouse);\n        remoteLaser.setColorIndex(slot);\n      }\n\n      if (remoteMouse) {\n        this.mouses[participantId].update(mouse, slot);\n      }\n    });\n  };\n\n  private sync(): void {\n    if (!this.viewer || !this.isAttached) return;\n\n    const position = this.viewer?.navigation?.getPosition();\n    const target = this.viewer?.navigation?.getTarget();\n    const camera = this.viewer?.navigation?.getCamera();\n    const { quaternion } = camera;\n\n    this.lastSyncedData.position = position;\n    this.lastSyncedData.target = target;\n    this.lastSyncedData.quaternion = quaternion;\n\n    if (this.isPrivate) return;\n\n    const participantData = this.participants.find(\n      (participant) => participant.id === this.localParticipantId,\n    );\n\n    if (participantData?.position) {\n      const similarX = Math.abs(participantData.position.x - position.x) < 0.1;\n      const similarY = Math.abs(participantData.position.y - position.y) < 0.1;\n      const similarZ = Math.abs(participantData.position.z - position.z) < 0.1;\n\n      if (similarX && similarY && similarZ) return;\n    }\n\n    this.presence3DManager.updatePresence3D({\n      id: this.localParticipantId,\n      ...this.lastSyncedData,\n    }); // this is throttled\n  }\n\n  public onMouseMove = (event: MouseEvent): void => {\n    if (!this.viewer || !THREE) return;\n\n    const mouse = this.viewer.clientToWorld(event.offsetX, event.offsetY, false);\n\n    if (mouse !== null) {\n      this.lastSyncedData.mouse = mouse.point;\n      this.presence3DManager?.updatePresence3D({\n        id: this.localParticipantId,\n        ...this.lastSyncedData,\n      }); // this is throttled\n    }\n  };\n}\n\nif (typeof window !== 'undefined') {\n  window.Presence3D = Presence3D;\n  window.AutodeskPin = AutodeskPin;\n}\n\nexport { Presence3D, AutodeskPin };\n", "import { Clock, Object3D, Quaternion, Vector3 } from 'three'; // new THREE (r139)\n\n// eslint-disable-next-line import/extensions\nimport { GLTFLoader } from '../utils/GLTFLoader.js';\n// eslint-disable-next-line import/extensions\nimport { TranslateModel } from '../utils/TranslateModel.js';\n\nexport class Avatar {\n  constructor(url: string, scale: number, height: number) {\n    this.url = url;\n    this.scale = scale;\n    this.height = height;\n    this.clock = new Clock();\n    this.clock.start();\n    this.lerpAnimationFrame = requestAnimationFrame(this.animate.bind(this));\n  }\n\n  private clock: Clock;\n  public target: Vector3 = new Vector3(0, 0, 0);\n  public url: string;\n  public scale: number;\n  public height: number;\n  private lerpAnimationFrame: number;\n  public position: Vector3 = new Vector3(0, 0, 0);\n  private curPosition: Vector3 = new Vector3(0, 0, 0);\n  public quaternion: Quaternion = new Quaternion(0, 0, 0, 0);\n  public model: Object3D;\n\n  load = async function (): Promise<Object3D> {\n    const loader = new GLTFLoader();\n    return new Promise((resolve, reject) => {\n      loader.load(\n        this.url,\n        async (gltf) => {\n          this.model = await TranslateModel(THREE, gltf.scene, this.scale, this.height);\n          if (!this.model) {\n            throw new Error('error creating avatar in forge');\n          }\n          resolve(this.model);\n        },\n        undefined,\n        (error) => {\n          console.error('An error happened loading the avatar', error);\n          reject(error);\n        },\n      );\n    });\n  };\n\n  public setPosition(position: Vector3) {\n    if (!position || (position.x === 0 && position.y === 0 && position.z === 0)) return;\n\n    this.position.set(position.x, position.y, position.z);\n  }\n\n  public setQuaternion(quaternion: Quaternion) {\n    if (!quaternion) return;\n\n    this.quaternion.set(quaternion._x, quaternion._y, quaternion._z, quaternion._w);\n  }\n\n  public destroy() {\n    cancelAnimationFrame(this.lerpAnimationFrame);\n    this.model.parent.remove(this.model);\n  }\n\n  private animate() {\n    this.lerpAnimationFrame = requestAnimationFrame(this.animate.bind(this));\n    if (!this.model || !this.position || !this.quaternion) {\n      return;\n    }\n    const delta = this.clock.getDelta();\n    const speed = 2;\n    const lerpSpeed = speed * delta;\n    this.curPosition.lerp(this.position, lerpSpeed);\n\n    this.model.position.set(this.curPosition.x, this.curPosition.y, this.curPosition.z);\n\n    const curQuaternion: Quaternion = this.model.quaternion.clone();\n    curQuaternion.slerp(this.quaternion, lerpSpeed);\n    this.model.quaternion.set(curQuaternion.x, curQuaternion.y, curQuaternion.z, curQuaternion.w);\n  }\n}\n", "export const REVISION = '139';\nexport const MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2, ROTATE: 0, DOLLY: 1, PAN: 2 };\nexport const TOUCH = { ROTATE: 0, PAN: 1, DOLLY_PAN: 2, DOLLY_ROTATE: 3 };\nexport const CullFaceNone = 0;\nexport const CullFaceBack = 1;\nexport const CullFaceFront = 2;\nexport const CullFaceFrontBack = 3;\nexport const BasicShadowMap = 0;\nexport const PCFShadowMap = 1;\nexport const PCFSoftShadowMap = 2;\nexport const VSMShadowMap = 3;\nexport const FrontSide = 0;\nexport const BackSide = 1;\nexport const DoubleSide = 2;\nexport const FlatShading = 1;\nexport const SmoothShading = 2;\nexport const NoBlending = 0;\nexport const NormalBlending = 1;\nexport const AdditiveBlending = 2;\nexport const SubtractiveBlending = 3;\nexport const MultiplyBlending = 4;\nexport const CustomBlending = 5;\nexport const AddEquation = 100;\nexport const SubtractEquation = 101;\nexport const ReverseSubtractEquation = 102;\nexport const MinEquation = 103;\nexport const MaxEquation = 104;\nexport const ZeroFactor = 200;\nexport const OneFactor = 201;\nexport const SrcColorFactor = 202;\nexport const OneMinusSrcColorFactor = 203;\nexport const SrcAlphaFactor = 204;\nexport const OneMinusSrcAlphaFactor = 205;\nexport const DstAlphaFactor = 206;\nexport const OneMinusDstAlphaFactor = 207;\nexport const DstColorFactor = 208;\nexport const OneMinusDstColorFactor = 209;\nexport const SrcAlphaSaturateFactor = 210;\nexport const NeverDepth = 0;\nexport const AlwaysDepth = 1;\nexport const LessDepth = 2;\nexport const LessEqualDepth = 3;\nexport const EqualDepth = 4;\nexport const GreaterEqualDepth = 5;\nexport const GreaterDepth = 6;\nexport const NotEqualDepth = 7;\nexport const MultiplyOperation = 0;\nexport const MixOperation = 1;\nexport const AddOperation = 2;\nexport const NoToneMapping = 0;\nexport const LinearToneMapping = 1;\nexport const ReinhardToneMapping = 2;\nexport const CineonToneMapping = 3;\nexport const ACESFilmicToneMapping = 4;\nexport const CustomToneMapping = 5;\n\nexport const UVMapping = 300;\nexport const CubeReflectionMapping = 301;\nexport const CubeRefractionMapping = 302;\nexport const EquirectangularReflectionMapping = 303;\nexport const EquirectangularRefractionMapping = 304;\nexport const CubeUVReflectionMapping = 306;\nexport const RepeatWrapping = 1000;\nexport const ClampToEdgeWrapping = 1001;\nexport const MirroredRepeatWrapping = 1002;\nexport const NearestFilter = 1003;\nexport const NearestMipmapNearestFilter = 1004;\nexport const NearestMipMapNearestFilter = 1004;\nexport const NearestMipmapLinearFilter = 1005;\nexport const NearestMipMapLinearFilter = 1005;\nexport const LinearFilter = 1006;\nexport const LinearMipmapNearestFilter = 1007;\nexport const LinearMipMapNearestFilter = 1007;\nexport const LinearMipmapLinearFilter = 1008;\nexport const LinearMipMapLinearFilter = 1008;\nexport const UnsignedByteType = 1009;\nexport const ByteType = 1010;\nexport const ShortType = 1011;\nexport const UnsignedShortType = 1012;\nexport const IntType = 1013;\nexport const UnsignedIntType = 1014;\nexport const FloatType = 1015;\nexport const HalfFloatType = 1016;\nexport const UnsignedShort4444Type = 1017;\nexport const UnsignedShort5551Type = 1018;\nexport const UnsignedInt248Type = 1020;\nexport const AlphaFormat = 1021;\nexport const RGBFormat = 1022;\nexport const RGBAFormat = 1023;\nexport const LuminanceFormat = 1024;\nexport const LuminanceAlphaFormat = 1025;\nexport const DepthFormat = 1026;\nexport const DepthStencilFormat = 1027;\nexport const RedFormat = 1028;\nexport const RedIntegerFormat = 1029;\nexport const RGFormat = 1030;\nexport const RGIntegerFormat = 1031;\nexport const RGBAIntegerFormat = 1033;\n\nexport const RGB_S3TC_DXT1_Format = 33776;\nexport const RGBA_S3TC_DXT1_Format = 33777;\nexport const RGBA_S3TC_DXT3_Format = 33778;\nexport const RGBA_S3TC_DXT5_Format = 33779;\nexport const RGB_PVRTC_4BPPV1_Format = 35840;\nexport const RGB_PVRTC_2BPPV1_Format = 35841;\nexport const RGBA_PVRTC_4BPPV1_Format = 35842;\nexport const RGBA_PVRTC_2BPPV1_Format = 35843;\nexport const RGB_ETC1_Format = 36196;\nexport const RGB_ETC2_Format = 37492;\nexport const RGBA_ETC2_EAC_Format = 37496;\nexport const RGBA_ASTC_4x4_Format = 37808;\nexport const RGBA_ASTC_5x4_Format = 37809;\nexport const RGBA_ASTC_5x5_Format = 37810;\nexport const RGBA_ASTC_6x5_Format = 37811;\nexport const RGBA_ASTC_6x6_Format = 37812;\nexport const RGBA_ASTC_8x5_Format = 37813;\nexport const RGBA_ASTC_8x6_Format = 37814;\nexport const RGBA_ASTC_8x8_Format = 37815;\nexport const RGBA_ASTC_10x5_Format = 37816;\nexport const RGBA_ASTC_10x6_Format = 37817;\nexport const RGBA_ASTC_10x8_Format = 37818;\nexport const RGBA_ASTC_10x10_Format = 37819;\nexport const RGBA_ASTC_12x10_Format = 37820;\nexport const RGBA_ASTC_12x12_Format = 37821;\nexport const RGBA_BPTC_Format = 36492;\nexport const LoopOnce = 2200;\nexport const LoopRepeat = 2201;\nexport const LoopPingPong = 2202;\nexport const InterpolateDiscrete = 2300;\nexport const InterpolateLinear = 2301;\nexport const InterpolateSmooth = 2302;\nexport const ZeroCurvatureEnding = 2400;\nexport const ZeroSlopeEnding = 2401;\nexport const WrapAroundEnding = 2402;\nexport const NormalAnimationBlendMode = 2500;\nexport const AdditiveAnimationBlendMode = 2501;\nexport const TrianglesDrawMode = 0;\nexport const TriangleStripDrawMode = 1;\nexport const TriangleFanDrawMode = 2;\nexport const LinearEncoding = 3000;\nexport const sRGBEncoding = 3001;\nexport const BasicDepthPacking = 3200;\nexport const RGBADepthPacking = 3201;\nexport const TangentSpaceNormalMap = 0;\nexport const ObjectSpaceNormalMap = 1;\n\n// Color space string identifiers, matching CSS Color Module Level 4 and WebGPU names where available.\nexport const NoColorSpace = '';\nexport const SRGBColorSpace = 'srgb';\nexport const LinearSRGBColorSpace = 'srgb-linear';\n\nexport const ZeroStencilOp = 0;\nexport const KeepStencilOp = 7680;\nexport const ReplaceStencilOp = 7681;\nexport const IncrementStencilOp = 7682;\nexport const DecrementStencilOp = 7683;\nexport const IncrementWrapStencilOp = 34055;\nexport const DecrementWrapStencilOp = 34056;\nexport const InvertStencilOp = 5386;\n\nexport const NeverStencilFunc = 512;\nexport const LessStencilFunc = 513;\nexport const EqualStencilFunc = 514;\nexport const LessEqualStencilFunc = 515;\nexport const GreaterStencilFunc = 516;\nexport const NotEqualStencilFunc = 517;\nexport const GreaterEqualStencilFunc = 518;\nexport const AlwaysStencilFunc = 519;\n\nexport const StaticDrawUsage = 35044;\nexport const DynamicDrawUsage = 35048;\nexport const StreamDrawUsage = 35040;\nexport const StaticReadUsage = 35045;\nexport const DynamicReadUsage = 35049;\nexport const StreamReadUsage = 35041;\nexport const StaticCopyUsage = 35046;\nexport const DynamicCopyUsage = 35050;\nexport const StreamCopyUsage = 35042;\n\nexport const GLSL1 = '100';\nexport const GLSL3 = '300 es';\n\nexport const _SRGBAFormat = 1035; // fallback for WebGL 1\n", "/**\n * https://github.com/mrdoob/eventdispatcher.js/\n */\n\nclass EventDispatcher {\n\n\taddEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) this._listeners = {};\n\n\t\tconst listeners = this._listeners;\n\n\t\tif ( listeners[ type ] === undefined ) {\n\n\t\t\tlisteners[ type ] = [];\n\n\t\t}\n\n\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\n\n\t\t\tlisteners[ type ].push( listener );\n\n\t\t}\n\n\t}\n\n\thasEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return false;\n\n\t\tconst listeners = this._listeners;\n\n\t\treturn listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1;\n\n\t}\n\n\tremoveEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tconst listeners = this._listeners;\n\t\tconst listenerArray = listeners[ type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tconst index = listenerArray.indexOf( listener );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\tlistenerArray.splice( index, 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tdispatchEvent( event ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tconst listeners = this._listeners;\n\t\tconst listenerArray = listeners[ event.type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tevent.target = this;\n\n\t\t\t// Make a copy, in case listeners are removed while iterating.\n\t\t\tconst array = listenerArray.slice( 0 );\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i ++ ) {\n\n\t\t\t\tarray[ i ].call( this, event );\n\n\t\t\t}\n\n\t\t\tevent.target = null;\n\n\t\t}\n\n\t}\n\n}\n\n\nexport { EventDispatcher };\n", "const _lut = [];\n\nfor ( let i = 0; i < 256; i ++ ) {\n\n\t_lut[ i ] = ( i < 16 ? '0' : '' ) + ( i ).toString( 16 );\n\n}\n\nlet _seed = 1234567;\n\n\nconst DEG2RAD = Math.PI / 180;\nconst RAD2DEG = 180 / Math.PI;\n\n// http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\nfunction generateUUID() {\n\n\tconst d0 = Math.random() * 0xffffffff | 0;\n\tconst d1 = Math.random() * 0xffffffff | 0;\n\tconst d2 = Math.random() * 0xffffffff | 0;\n\tconst d3 = Math.random() * 0xffffffff | 0;\n\tconst uuid = _lut[ d0 & 0xff ] + _lut[ d0 >> 8 & 0xff ] + _lut[ d0 >> 16 & 0xff ] + _lut[ d0 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d1 & 0xff ] + _lut[ d1 >> 8 & 0xff ] + '-' + _lut[ d1 >> 16 & 0x0f | 0x40 ] + _lut[ d1 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d2 & 0x3f | 0x80 ] + _lut[ d2 >> 8 & 0xff ] + '-' + _lut[ d2 >> 16 & 0xff ] + _lut[ d2 >> 24 & 0xff ] +\n\t\t\t_lut[ d3 & 0xff ] + _lut[ d3 >> 8 & 0xff ] + _lut[ d3 >> 16 & 0xff ] + _lut[ d3 >> 24 & 0xff ];\n\n\t// .toLowerCase() here flattens concatenated strings to save heap memory space.\n\treturn uuid.toLowerCase();\n\n}\n\nfunction clamp( value, min, max ) {\n\n\treturn Math.max( min, Math.min( max, value ) );\n\n}\n\n// compute euclidean modulo of m % n\n// https://en.wikipedia.org/wiki/Modulo_operation\nfunction euclideanModulo( n, m ) {\n\n\treturn ( ( n % m ) + m ) % m;\n\n}\n\n// Linear mapping from range <a1, a2> to range <b1, b2>\nfunction mapLinear( x, a1, a2, b1, b2 ) {\n\n\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\n\n}\n\n// https://www.gamedev.net/tutorials/programming/general-and-gameplay-programming/inverse-lerp-a-super-useful-yet-often-overlooked-function-r5230/\nfunction inverseLerp( x, y, value ) {\n\n\tif ( x !== y ) {\n\n\t\treturn ( value - x ) / ( y - x );\n\n\t} else {\n\n\t\treturn 0;\n\n\t}\n\n}\n\n// https://en.wikipedia.org/wiki/Linear_interpolation\nfunction lerp( x, y, t ) {\n\n\treturn ( 1 - t ) * x + t * y;\n\n}\n\n// http://www.rorydriscoll.com/2016/03/07/frame-rate-independent-damping-using-lerp/\nfunction damp( x, y, lambda, dt ) {\n\n\treturn lerp( x, y, 1 - Math.exp( - lambda * dt ) );\n\n}\n\n// https://www.desmos.com/calculator/vcsjnyz7x4\nfunction pingpong( x, length = 1 ) {\n\n\treturn length - Math.abs( euclideanModulo( x, length * 2 ) - length );\n\n}\n\n// http://en.wikipedia.org/wiki/Smoothstep\nfunction smoothstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * ( 3 - 2 * x );\n\n}\n\nfunction smootherstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\n\n}\n\n// Random integer from <low, high> interval\nfunction randInt( low, high ) {\n\n\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\n\n}\n\n// Random float from <low, high> interval\nfunction randFloat( low, high ) {\n\n\treturn low + Math.random() * ( high - low );\n\n}\n\n// Random float from <-range/2, range/2> interval\nfunction randFloatSpread( range ) {\n\n\treturn range * ( 0.5 - Math.random() );\n\n}\n\n// Deterministic pseudo-random float in the interval [ 0, 1 ]\nfunction seededRandom( s ) {\n\n\tif ( s !== undefined ) _seed = s;\n\n\t// Mulberry32 generator\n\n\tlet t = _seed += 0x6D2B79F5;\n\n\tt = Math.imul( t ^ t >>> 15, t | 1 );\n\n\tt ^= t + Math.imul( t ^ t >>> 7, t | 61 );\n\n\treturn ( ( t ^ t >>> 14 ) >>> 0 ) / 4294967296;\n\n}\n\nfunction degToRad( degrees ) {\n\n\treturn degrees * DEG2RAD;\n\n}\n\nfunction radToDeg( radians ) {\n\n\treturn radians * RAD2DEG;\n\n}\n\nfunction isPowerOfTwo( value ) {\n\n\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\n\n}\n\nfunction ceilPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.ceil( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction floorPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.floor( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction setQuaternionFromProperEuler( q, a, b, c, order ) {\n\n\t// Intrinsic Proper Euler Angles - see https://en.wikipedia.org/wiki/Euler_angles\n\n\t// rotations are applied to the axes in the order specified by 'order'\n\t// rotation by angle 'a' is applied first, then by angle 'b', then by angle 'c'\n\t// angles are in radians\n\n\tconst cos = Math.cos;\n\tconst sin = Math.sin;\n\n\tconst c2 = cos( b / 2 );\n\tconst s2 = sin( b / 2 );\n\n\tconst c13 = cos( ( a + c ) / 2 );\n\tconst s13 = sin( ( a + c ) / 2 );\n\n\tconst c1_3 = cos( ( a - c ) / 2 );\n\tconst s1_3 = sin( ( a - c ) / 2 );\n\n\tconst c3_1 = cos( ( c - a ) / 2 );\n\tconst s3_1 = sin( ( c - a ) / 2 );\n\n\tswitch ( order ) {\n\n\t\tcase 'XYX':\n\t\t\tq.set( c2 * s13, s2 * c1_3, s2 * s1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YZY':\n\t\t\tq.set( s2 * s1_3, c2 * s13, s2 * c1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZXZ':\n\t\t\tq.set( s2 * c1_3, s2 * s1_3, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'XZX':\n\t\t\tq.set( c2 * s13, s2 * s3_1, s2 * c3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YXY':\n\t\t\tq.set( s2 * c3_1, c2 * s13, s2 * s3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZYZ':\n\t\t\tq.set( s2 * s3_1, s2 * c3_1, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: ' + order );\n\n\t}\n\n}\n\nfunction denormalize( value, array ) {\n\n\tswitch ( array.constructor ) {\n\n\t\tcase Float32Array:\n\n\t\t\treturn value;\n\n\t\tcase Uint16Array:\n\n\t\t\treturn value / 65535.0;\n\n\t\tcase Uint8Array:\n\n\t\t\treturn value / 255.0;\n\n\t\tcase Int16Array:\n\n\t\t\treturn Math.max( value / 32767.0, - 1.0 );\n\n\t\tcase Int8Array:\n\n\t\t\treturn Math.max( value / 127.0, - 1.0 );\n\n\t\tdefault:\n\n\t\t\tthrow new Error( 'Invalid component type.' );\n\n\t}\n\n}\n\nfunction normalize( value, array ) {\n\n\tswitch ( array.constructor ) {\n\n\t\tcase Float32Array:\n\n\t\t\treturn value;\n\n\t\tcase Uint16Array:\n\n\t\t\treturn Math.round( value * 65535.0 );\n\n\t\tcase Uint8Array:\n\n\t\t\treturn Math.round( value * 255.0 );\n\n\t\tcase Int16Array:\n\n\t\t\treturn Math.round( value * 32767.0 );\n\n\t\tcase Int8Array:\n\n\t\t\treturn Math.round( value * 127.0 );\n\n\t\tdefault:\n\n\t\t\tthrow new Error( 'Invalid component type.' );\n\n\t}\n\n}\n\n\n\nexport {\n\tDEG2RAD,\n\tRAD2DEG,\n\tgenerateUUID,\n\tclamp,\n\teuclideanModulo,\n\tmapLinear,\n\tinverseLerp,\n\tlerp,\n\tdamp,\n\tpingpong,\n\tsmoothstep,\n\tsmootherstep,\n\trandInt,\n\trandFloat,\n\trandFloatSpread,\n\tseededRandom,\n\tdegToRad,\n\tradToDeg,\n\tisPowerOfTwo,\n\tceilPowerOfTwo,\n\tfloorPowerOfTwo,\n\tsetQuaternionFromProperEuler,\n\tnormalize,\n\tdenormalize,\n};\n", "class Vector2 {\n\n\tconstructor( x = 0, y = 0 ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t}\n\n\tget width() {\n\n\t\treturn this.x;\n\n\t}\n\n\tset width( value ) {\n\n\t\tthis.x = value;\n\n\t}\n\n\tget height() {\n\n\t\treturn this.y;\n\n\t}\n\n\tset height( value ) {\n\n\t\tthis.y = value;\n\n\t}\n\n\tset( x, y ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\treturn this.addVectors( v, w );\n\n\t\t}\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\treturn this.subVectors( v, w );\n\n\t\t}\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst x = this.x, y = this.y;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ];\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ];\n\n\t\treturn this;\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y;\n\n\t}\n\n\tcross( v ) {\n\n\t\treturn this.x * v.y - this.y * v.x;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tangle() {\n\n\t\t// computes the angle in radians with respect to the positive x-axis\n\n\t\tconst angle = Math.atan2( - this.y, - this.x ) + Math.PI;\n\n\t\treturn angle;\n\n\t}\n\n\tdistanceTo( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t}\n\n\tdistanceToSquared( v ) {\n\n\t\tconst dx = this.x - v.x, dy = this.y - v.y;\n\t\treturn dx * dx + dy * dy;\n\n\t}\n\n\tmanhattanDistanceTo( v ) {\n\n\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index, offset ) {\n\n\t\tif ( offset !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector2: offset has been removed from .fromBufferAttribute().' );\n\n\t\t}\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\n\t\treturn this;\n\n\t}\n\n\trotateAround( center, angle ) {\n\n\t\tconst c = Math.cos( angle ), s = Math.sin( angle );\n\n\t\tconst x = this.x - center.x;\n\t\tconst y = this.y - center.y;\n\n\t\tthis.x = x * c - y * s + center.x;\n\t\tthis.y = x * s + y * c + center.y;\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\n\t}\n\n}\n\nVector2.prototype.isVector2 = true;\n\nexport { Vector2 };\n", "class Matrix3 {\n\n\tconstructor() {\n\n\t\tthis.elements = [\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t];\n\n\t\tif ( arguments.length > 0 ) {\n\n\t\t\tconsole.error( 'THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.' );\n\n\t\t}\n\n\t}\n\n\tset( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 1 ] = n21; te[ 2 ] = n31;\n\t\tte[ 3 ] = n12; te[ 4 ] = n22; te[ 5 ] = n32;\n\t\tte[ 6 ] = n13; te[ 7 ] = n23; te[ 8 ] = n33;\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tcopy( m ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ];\n\t\tte[ 3 ] = me[ 3 ]; te[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ];\n\t\tte[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ]; te[ 8 ] = me[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\textractBasis( xAxis, yAxis, zAxis ) {\n\n\t\txAxis.setFromMatrix3Column( this, 0 );\n\t\tyAxis.setFromMatrix3Column( this, 1 );\n\t\tzAxis.setFromMatrix3Column( this, 2 );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrix4( m ) {\n\n\t\tconst me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 4 ], me[ 8 ],\n\t\t\tme[ 1 ], me[ 5 ], me[ 9 ],\n\t\t\tme[ 2 ], me[ 6 ], me[ 10 ]\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( m ) {\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t}\n\n\tpremultiply( m ) {\n\n\t\treturn this.multiplyMatrices( m, this );\n\n\t}\n\n\tmultiplyMatrices( a, b ) {\n\n\t\tconst ae = a.elements;\n\t\tconst be = b.elements;\n\t\tconst te = this.elements;\n\n\t\tconst a11 = ae[ 0 ], a12 = ae[ 3 ], a13 = ae[ 6 ];\n\t\tconst a21 = ae[ 1 ], a22 = ae[ 4 ], a23 = ae[ 7 ];\n\t\tconst a31 = ae[ 2 ], a32 = ae[ 5 ], a33 = ae[ 8 ];\n\n\t\tconst b11 = be[ 0 ], b12 = be[ 3 ], b13 = be[ 6 ];\n\t\tconst b21 = be[ 1 ], b22 = be[ 4 ], b23 = be[ 7 ];\n\t\tconst b31 = be[ 2 ], b32 = be[ 5 ], b33 = be[ 8 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31;\n\t\tte[ 3 ] = a11 * b12 + a12 * b22 + a13 * b32;\n\t\tte[ 6 ] = a11 * b13 + a12 * b23 + a13 * b33;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31;\n\t\tte[ 4 ] = a21 * b12 + a22 * b22 + a23 * b32;\n\t\tte[ 7 ] = a21 * b13 + a22 * b23 + a23 * b33;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31;\n\t\tte[ 5 ] = a31 * b12 + a32 * b22 + a33 * b32;\n\t\tte[ 8 ] = a31 * b13 + a32 * b23 + a33 * b33;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\n\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\n\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\n\n\t\treturn this;\n\n\t}\n\n\tdeterminant() {\n\n\t\tconst te = this.elements;\n\n\t\tconst a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\n\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\n\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\n\n\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\n\n\t}\n\n\tinvert() {\n\n\t\tconst te = this.elements,\n\n\t\t\tn11 = te[ 0 ], n21 = te[ 1 ], n31 = te[ 2 ],\n\t\t\tn12 = te[ 3 ], n22 = te[ 4 ], n32 = te[ 5 ],\n\t\t\tn13 = te[ 6 ], n23 = te[ 7 ], n33 = te[ 8 ],\n\n\t\t\tt11 = n33 * n22 - n32 * n23,\n\t\t\tt12 = n32 * n13 - n33 * n12,\n\t\t\tt13 = n23 * n12 - n22 * n13,\n\n\t\t\tdet = n11 * t11 + n21 * t12 + n31 * t13;\n\n\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0 );\n\n\t\tconst detInv = 1 / det;\n\n\t\tte[ 0 ] = t11 * detInv;\n\t\tte[ 1 ] = ( n31 * n23 - n33 * n21 ) * detInv;\n\t\tte[ 2 ] = ( n32 * n21 - n31 * n22 ) * detInv;\n\n\t\tte[ 3 ] = t12 * detInv;\n\t\tte[ 4 ] = ( n33 * n11 - n31 * n13 ) * detInv;\n\t\tte[ 5 ] = ( n31 * n12 - n32 * n11 ) * detInv;\n\n\t\tte[ 6 ] = t13 * detInv;\n\t\tte[ 7 ] = ( n21 * n13 - n23 * n11 ) * detInv;\n\t\tte[ 8 ] = ( n22 * n11 - n21 * n12 ) * detInv;\n\n\t\treturn this;\n\n\t}\n\n\ttranspose() {\n\n\t\tlet tmp;\n\t\tconst m = this.elements;\n\n\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\n\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\n\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\n\n\t\treturn this;\n\n\t}\n\n\tgetNormalMatrix( matrix4 ) {\n\n\t\treturn this.setFromMatrix4( matrix4 ).invert().transpose();\n\n\t}\n\n\ttransposeIntoArray( r ) {\n\n\t\tconst m = this.elements;\n\n\t\tr[ 0 ] = m[ 0 ];\n\t\tr[ 1 ] = m[ 3 ];\n\t\tr[ 2 ] = m[ 6 ];\n\t\tr[ 3 ] = m[ 1 ];\n\t\tr[ 4 ] = m[ 4 ];\n\t\tr[ 5 ] = m[ 7 ];\n\t\tr[ 6 ] = m[ 2 ];\n\t\tr[ 7 ] = m[ 5 ];\n\t\tr[ 8 ] = m[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetUvTransform( tx, ty, sx, sy, rotation, cx, cy ) {\n\n\t\tconst c = Math.cos( rotation );\n\t\tconst s = Math.sin( rotation );\n\n\t\tthis.set(\n\t\t\tsx * c, sx * s, - sx * ( c * cx + s * cy ) + cx + tx,\n\t\t\t- sy * s, sy * c, - sy * ( - s * cx + c * cy ) + cy + ty,\n\t\t\t0, 0, 1\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tscale( sx, sy ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= sx; te[ 3 ] *= sx; te[ 6 ] *= sx;\n\t\tte[ 1 ] *= sy; te[ 4 ] *= sy; te[ 7 ] *= sy;\n\n\t\treturn this;\n\n\t}\n\n\trotate( theta ) {\n\n\t\tconst c = Math.cos( theta );\n\t\tconst s = Math.sin( theta );\n\n\t\tconst te = this.elements;\n\n\t\tconst a11 = te[ 0 ], a12 = te[ 3 ], a13 = te[ 6 ];\n\t\tconst a21 = te[ 1 ], a22 = te[ 4 ], a23 = te[ 7 ];\n\n\t\tte[ 0 ] = c * a11 + s * a21;\n\t\tte[ 3 ] = c * a12 + s * a22;\n\t\tte[ 6 ] = c * a13 + s * a23;\n\n\t\tte[ 1 ] = - s * a11 + c * a21;\n\t\tte[ 4 ] = - s * a12 + c * a22;\n\t\tte[ 7 ] = - s * a13 + c * a23;\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( tx, ty ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] += tx * te[ 2 ]; te[ 3 ] += tx * te[ 5 ]; te[ 6 ] += tx * te[ 8 ];\n\t\tte[ 1 ] += ty * te[ 2 ]; te[ 4 ] += ty * te[ 5 ]; te[ 7 ] += ty * te[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\tequals( matrix ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = matrix.elements;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\t\tarray[ offset + 8 ] = te[ 8 ];\n\n\t\treturn array;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().fromArray( this.elements );\n\n\t}\n\n}\n\nMatrix3.prototype.isMatrix3 = true;\n\nexport { Matrix3 };\n", "function arrayMin( array ) {\n\n\tif ( array.length === 0 ) return Infinity;\n\n\tlet min = array[ 0 ];\n\n\tfor ( let i = 1, l = array.length; i < l; ++ i ) {\n\n\t\tif ( array[ i ] < min ) min = array[ i ];\n\n\t}\n\n\treturn min;\n\n}\n\nfunction arrayMax( array ) {\n\n\tif ( array.length === 0 ) return - Infinity;\n\n\tlet max = array[ 0 ];\n\n\tfor ( let i = 1, l = array.length; i < l; ++ i ) {\n\n\t\tif ( array[ i ] > max ) max = array[ i ];\n\n\t}\n\n\treturn max;\n\n}\n\nfunction arrayNeedsUint32( array ) {\n\n\t// assumes larger values usually on last\n\n\tfor ( let i = array.length - 1; i >= 0; -- i ) {\n\n\t\tif ( array[ i ] > 65535 ) return true;\n\n\t}\n\n\treturn false;\n\n}\n\nconst TYPED_ARRAYS = {\n\tInt8Array: Int8Array,\n\tUint8Array: Uint8Array,\n\tUint8ClampedArray: Uint8ClampedArray,\n\tInt16Array: Int16Array,\n\tUint16Array: Uint16Array,\n\tInt32Array: Int32Array,\n\tUint32Array: Uint32Array,\n\tFloat32Array: Float32Array,\n\tFloat64Array: Float64Array\n};\n\nfunction getTypedArray( type, buffer ) {\n\n\treturn new TYPED_ARRAYS[ type ]( buffer );\n\n}\n\nfunction createElementNS( name ) {\n\n\treturn document.createElementNS( 'http://www.w3.org/1999/xhtml', name );\n\n}\n\nexport { arrayMin, arrayMax, arrayNeedsUint32, getTypedArray, createElementNS };\n", "import { SRGBColorSpace, LinearSRGBColorSpace } from '../constants.js';\n\nexport function SRGBToLinear( c ) {\n\n\treturn ( c < 0.04045 ) ? c * 0.0773993808 : Math.pow( c * 0.9478672986 + 0.0521327014, 2.4 );\n\n}\n\nexport function LinearToSRGB( c ) {\n\n\treturn ( c < 0.0031308 ) ? c * 12.92 : 1.055 * ( Math.pow( c, 0.41666 ) ) - 0.055;\n\n}\n\n// JavaScript RGB-to-RGB transforms, defined as\n// FN[InputColorSpace][OutputColorSpace] callback functions.\nconst FN = {\n\t[ SRGBColorSpace ]: { [ LinearSRGBColorSpace ]: SRGBToLinear },\n\t[ LinearSRGBColorSpace ]: { [ SRGBColorSpace ]: LinearToSRGB },\n};\n\nexport const ColorManagement = {\n\n\tlegacyMode: true,\n\n\tget workingColorSpace() {\n\n\t\treturn LinearSRGBColorSpace;\n\n\t},\n\n\tset workingColorSpace( colorSpace ) {\n\n\t\tconsole.warn( 'THREE.ColorManagement: .workingColorSpace is readonly.' );\n\n\t},\n\n\tconvert: function ( color, sourceColorSpace, targetColorSpace ) {\n\n\t\tif ( this.legacyMode || sourceColorSpace === targetColorSpace || ! sourceColorSpace || ! targetColorSpace ) {\n\n\t\t\treturn color;\n\n\t\t}\n\n\t\tif ( FN[ sourceColorSpace ] && FN[ sourceColorSpace ][ targetColorSpace ] !== undefined ) {\n\n\t\t\tconst fn = FN[ sourceColorSpace ][ targetColorSpace ];\n\n\t\t\tcolor.r = fn( color.r );\n\t\t\tcolor.g = fn( color.g );\n\t\t\tcolor.b = fn( color.b );\n\n\t\t\treturn color;\n\n\t\t}\n\n\t\tthrow new Error( 'Unsupported color space conversion.' );\n\n\t},\n\n\tfromWorkingColorSpace: function ( color, targetColorSpace ) {\n\n\t\treturn this.convert( color, this.workingColorSpace, targetColorSpace );\n\n\t},\n\n\ttoWorkingColorSpace: function ( color, sourceColorSpace ) {\n\n\t\treturn this.convert( color, sourceColorSpace, this.workingColorSpace );\n\n\t},\n\n};\n", "import { clamp, euclideanModulo, lerp } from './MathUtils.js';\nimport { ColorManagement, SRGBToLinear, LinearToSRGB } from './ColorManagement.js';\nimport { SRGBColorSpace, LinearSRGBColorSpace } from '../constants.js';\n\nconst _colorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\n\t'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\n\t'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\n\t'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\n\t'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\n\t'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\n\t'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\n\t'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\n\t'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\n\t'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\n\t'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\n\t'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\n\t'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\n\t'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\n\t'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\n\t'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\n\t'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\n\t'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\n\t'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\n\t'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'rebeccapurple': 0x663399, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\n\t'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\n\t'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\n\t'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\n\t'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\n\nconst _rgb = { r: 0, g: 0, b: 0 };\nconst _hslA = { h: 0, s: 0, l: 0 };\nconst _hslB = { h: 0, s: 0, l: 0 };\n\nfunction hue2rgb( p, q, t ) {\n\n\tif ( t < 0 ) t += 1;\n\tif ( t > 1 ) t -= 1;\n\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\n\tif ( t < 1 / 2 ) return q;\n\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\n\treturn p;\n\n}\n\nfunction toComponents( source, target ) {\n\n\ttarget.r = source.r;\n\ttarget.g = source.g;\n\ttarget.b = source.b;\n\n\treturn target;\n\n}\n\nclass Color {\n\n\tconstructor( r, g, b ) {\n\n\t\tif ( g === undefined && b === undefined ) {\n\n\t\t\t// r is THREE.Color, hex or string\n\t\t\treturn this.set( r );\n\n\t\t}\n\n\t\treturn this.setRGB( r, g, b );\n\n\t}\n\n\tset( value ) {\n\n\t\tif ( value && value.isColor ) {\n\n\t\t\tthis.copy( value );\n\n\t\t} else if ( typeof value === 'number' ) {\n\n\t\t\tthis.setHex( value );\n\n\t\t} else if ( typeof value === 'string' ) {\n\n\t\t\tthis.setStyle( value );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.r = scalar;\n\t\tthis.g = scalar;\n\t\tthis.b = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetHex( hex, colorSpace = SRGBColorSpace ) {\n\n\t\thex = Math.floor( hex );\n\n\t\tthis.r = ( hex >> 16 & 255 ) / 255;\n\t\tthis.g = ( hex >> 8 & 255 ) / 255;\n\t\tthis.b = ( hex & 255 ) / 255;\n\n\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\treturn this;\n\n\t}\n\n\tsetRGB( r, g, b, colorSpace = LinearSRGBColorSpace ) {\n\n\t\tthis.r = r;\n\t\tthis.g = g;\n\t\tthis.b = b;\n\n\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\treturn this;\n\n\t}\n\n\tsetHSL( h, s, l, colorSpace = LinearSRGBColorSpace ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\t\th = euclideanModulo( h, 1 );\n\t\ts = clamp( s, 0, 1 );\n\t\tl = clamp( l, 0, 1 );\n\n\t\tif ( s === 0 ) {\n\n\t\t\tthis.r = this.g = this.b = l;\n\n\t\t} else {\n\n\t\t\tconst p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\n\t\t\tconst q = ( 2 * l ) - p;\n\n\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\n\t\t\tthis.g = hue2rgb( q, p, h );\n\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\n\n\t\t}\n\n\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\treturn this;\n\n\t}\n\n\tsetStyle( style, colorSpace = SRGBColorSpace ) {\n\n\t\tfunction handleAlpha( string ) {\n\n\t\t\tif ( string === undefined ) return;\n\n\t\t\tif ( parseFloat( string ) < 1 ) {\n\n\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\n\n\t\t\t}\n\n\t\t}\n\n\n\t\tlet m;\n\n\t\tif ( m = /^((?:rgb|hsl)a?)\\(([^\\)]*)\\)/.exec( style ) ) {\n\n\t\t\t// rgb / hsl\n\n\t\t\tlet color;\n\t\t\tconst name = m[ 1 ];\n\t\t\tconst components = m[ 2 ];\n\n\t\t\tswitch ( name ) {\n\n\t\t\t\tcase 'rgb':\n\t\t\t\tcase 'rgba':\n\n\t\t\t\t\tif ( color = /^\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\n\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\n\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\n\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\n\n\t\t\t\t\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( color = /^\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\n\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\n\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\n\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\n\n\t\t\t\t\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'hsl':\n\t\t\t\tcase 'hsla':\n\n\t\t\t\t\tif ( color = /^\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\n\t\t\t\t\t\tconst h = parseFloat( color[ 1 ] ) / 360;\n\t\t\t\t\t\tconst s = parseInt( color[ 2 ], 10 ) / 100;\n\t\t\t\t\t\tconst l = parseInt( color[ 3 ], 10 ) / 100;\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this.setHSL( h, s, l, colorSpace );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t} else if ( m = /^\\#([A-Fa-f\\d]+)$/.exec( style ) ) {\n\n\t\t\t// hex color\n\n\t\t\tconst hex = m[ 1 ];\n\t\t\tconst size = hex.length;\n\n\t\t\tif ( size === 3 ) {\n\n\t\t\t\t// #ff0\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 0 ), 16 ) / 255;\n\t\t\t\tthis.g = parseInt( hex.charAt( 1 ) + hex.charAt( 1 ), 16 ) / 255;\n\t\t\t\tthis.b = parseInt( hex.charAt( 2 ) + hex.charAt( 2 ), 16 ) / 255;\n\n\t\t\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\t\t\treturn this;\n\n\t\t\t} else if ( size === 6 ) {\n\n\t\t\t\t// #ff0000\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 1 ), 16 ) / 255;\n\t\t\t\tthis.g = parseInt( hex.charAt( 2 ) + hex.charAt( 3 ), 16 ) / 255;\n\t\t\t\tthis.b = parseInt( hex.charAt( 4 ) + hex.charAt( 5 ), 16 ) / 255;\n\n\t\t\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\t\t\treturn this;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( style && style.length > 0 ) {\n\n\t\t\treturn this.setColorName( style, colorSpace );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetColorName( style, colorSpace = SRGBColorSpace ) {\n\n\t\t// color keywords\n\t\tconst hex = _colorKeywords[ style.toLowerCase() ];\n\n\t\tif ( hex !== undefined ) {\n\n\t\t\t// red\n\t\t\tthis.setHex( hex, colorSpace );\n\n\t\t} else {\n\n\t\t\t// unknown color\n\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.r, this.g, this.b );\n\n\t}\n\n\tcopy( color ) {\n\n\t\tthis.r = color.r;\n\t\tthis.g = color.g;\n\t\tthis.b = color.b;\n\n\t\treturn this;\n\n\t}\n\n\tcopySRGBToLinear( color ) {\n\n\t\tthis.r = SRGBToLinear( color.r );\n\t\tthis.g = SRGBToLinear( color.g );\n\t\tthis.b = SRGBToLinear( color.b );\n\n\t\treturn this;\n\n\t}\n\n\tcopyLinearToSRGB( color ) {\n\n\t\tthis.r = LinearToSRGB( color.r );\n\t\tthis.g = LinearToSRGB( color.g );\n\t\tthis.b = LinearToSRGB( color.b );\n\n\t\treturn this;\n\n\t}\n\n\tconvertSRGBToLinear() {\n\n\t\tthis.copySRGBToLinear( this );\n\n\t\treturn this;\n\n\t}\n\n\tconvertLinearToSRGB() {\n\n\t\tthis.copyLinearToSRGB( this );\n\n\t\treturn this;\n\n\t}\n\n\tgetHex( colorSpace = SRGBColorSpace ) {\n\n\t\tColorManagement.fromWorkingColorSpace( toComponents( this, _rgb ), colorSpace );\n\n\t\treturn clamp( _rgb.r * 255, 0, 255 ) << 16 ^ clamp( _rgb.g * 255, 0, 255 ) << 8 ^ clamp( _rgb.b * 255, 0, 255 ) << 0;\n\n\t}\n\n\tgetHexString( colorSpace = SRGBColorSpace ) {\n\n\t\treturn ( '000000' + this.getHex( colorSpace ).toString( 16 ) ).slice( - 6 );\n\n\t}\n\n\tgetHSL( target, colorSpace = LinearSRGBColorSpace ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\n\t\tColorManagement.fromWorkingColorSpace( toComponents( this, _rgb ), colorSpace );\n\n\t\tconst r = _rgb.r, g = _rgb.g, b = _rgb.b;\n\n\t\tconst max = Math.max( r, g, b );\n\t\tconst min = Math.min( r, g, b );\n\n\t\tlet hue, saturation;\n\t\tconst lightness = ( min + max ) / 2.0;\n\n\t\tif ( min === max ) {\n\n\t\t\thue = 0;\n\t\t\tsaturation = 0;\n\n\t\t} else {\n\n\t\t\tconst delta = max - min;\n\n\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\n\n\t\t\tswitch ( max ) {\n\n\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\n\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\n\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\n\n\t\t\t}\n\n\t\t\thue /= 6;\n\n\t\t}\n\n\t\ttarget.h = hue;\n\t\ttarget.s = saturation;\n\t\ttarget.l = lightness;\n\n\t\treturn target;\n\n\t}\n\n\tgetRGB( target, colorSpace = LinearSRGBColorSpace ) {\n\n\t\tColorManagement.fromWorkingColorSpace( toComponents( this, _rgb ), colorSpace );\n\n\t\ttarget.r = _rgb.r;\n\t\ttarget.g = _rgb.g;\n\t\ttarget.b = _rgb.b;\n\n\t\treturn target;\n\n\t}\n\n\tgetStyle( colorSpace = SRGBColorSpace ) {\n\n\t\tColorManagement.fromWorkingColorSpace( toComponents( this, _rgb ), colorSpace );\n\n\t\tif ( colorSpace !== SRGBColorSpace ) {\n\n\t\t\t// Requires CSS Color Module Level 4 (https://www.w3.org/TR/css-color-4/).\n\t\t\treturn `color(${ colorSpace } ${ _rgb.r } ${ _rgb.g } ${ _rgb.b })`;\n\n\t\t}\n\n\t\treturn `rgb(${( _rgb.r * 255 ) | 0},${( _rgb.g * 255 ) | 0},${( _rgb.b * 255 ) | 0})`;\n\n\t}\n\n\toffsetHSL( h, s, l ) {\n\n\t\tthis.getHSL( _hslA );\n\n\t\t_hslA.h += h; _hslA.s += s; _hslA.l += l;\n\n\t\tthis.setHSL( _hslA.h, _hslA.s, _hslA.l );\n\n\t\treturn this;\n\n\t}\n\n\tadd( color ) {\n\n\t\tthis.r += color.r;\n\t\tthis.g += color.g;\n\t\tthis.b += color.b;\n\n\t\treturn this;\n\n\t}\n\n\taddColors( color1, color2 ) {\n\n\t\tthis.r = color1.r + color2.r;\n\t\tthis.g = color1.g + color2.g;\n\t\tthis.b = color1.b + color2.b;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.r += s;\n\t\tthis.g += s;\n\t\tthis.b += s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( color ) {\n\n\t\tthis.r = Math.max( 0, this.r - color.r );\n\t\tthis.g = Math.max( 0, this.g - color.g );\n\t\tthis.b = Math.max( 0, this.b - color.b );\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( color ) {\n\n\t\tthis.r *= color.r;\n\t\tthis.g *= color.g;\n\t\tthis.b *= color.b;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tthis.r *= s;\n\t\tthis.g *= s;\n\t\tthis.b *= s;\n\n\t\treturn this;\n\n\t}\n\n\tlerp( color, alpha ) {\n\n\t\tthis.r += ( color.r - this.r ) * alpha;\n\t\tthis.g += ( color.g - this.g ) * alpha;\n\t\tthis.b += ( color.b - this.b ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpColors( color1, color2, alpha ) {\n\n\t\tthis.r = color1.r + ( color2.r - color1.r ) * alpha;\n\t\tthis.g = color1.g + ( color2.g - color1.g ) * alpha;\n\t\tthis.b = color1.b + ( color2.b - color1.b ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpHSL( color, alpha ) {\n\n\t\tthis.getHSL( _hslA );\n\t\tcolor.getHSL( _hslB );\n\n\t\tconst h = lerp( _hslA.h, _hslB.h, alpha );\n\t\tconst s = lerp( _hslA.s, _hslB.s, alpha );\n\t\tconst l = lerp( _hslA.l, _hslB.l, alpha );\n\n\t\tthis.setHSL( h, s, l );\n\n\t\treturn this;\n\n\t}\n\n\tequals( c ) {\n\n\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.r = array[ offset ];\n\t\tthis.g = array[ offset + 1 ];\n\t\tthis.b = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.r;\n\t\tarray[ offset + 1 ] = this.g;\n\t\tarray[ offset + 2 ] = this.b;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.r = attribute.getX( index );\n\t\tthis.g = attribute.getY( index );\n\t\tthis.b = attribute.getZ( index );\n\n\t\tif ( attribute.normalized === true ) {\n\n\t\t\t// assuming Uint8Array\n\n\t\t\tthis.r /= 255;\n\t\t\tthis.g /= 255;\n\t\t\tthis.b /= 255;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.getHex();\n\n\t}\n\n}\n\nColor.NAMES = _colorKeywords;\n\nColor.prototype.isColor = true;\nColor.prototype.r = 1;\nColor.prototype.g = 1;\nColor.prototype.b = 1;\n\nexport { Color, SRGBToLinear };\n", "import { createElementNS } from '../utils.js';\nimport { SRGBToLinear } from '../math/Color.js';\n\nlet _canvas;\n\nclass ImageUtils {\n\n\tstatic getDataURL( image ) {\n\n\t\tif ( /^data:/i.test( image.src ) ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tif ( typeof HTMLCanvasElement == 'undefined' ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tlet canvas;\n\n\t\tif ( image instanceof HTMLCanvasElement ) {\n\n\t\t\tcanvas = image;\n\n\t\t} else {\n\n\t\t\tif ( _canvas === undefined ) _canvas = createElementNS( 'canvas' );\n\n\t\t\t_canvas.width = image.width;\n\t\t\t_canvas.height = image.height;\n\n\t\t\tconst context = _canvas.getContext( '2d' );\n\n\t\t\tif ( image instanceof ImageData ) {\n\n\t\t\t\tcontext.putImageData( image, 0, 0 );\n\n\t\t\t} else {\n\n\t\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\t}\n\n\t\t\tcanvas = _canvas;\n\n\t\t}\n\n\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons', image );\n\n\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\n\n\t\t} else {\n\n\t\t\treturn canvas.toDataURL( 'image/png' );\n\n\t\t}\n\n\t}\n\n\tstatic sRGBToLinear( image ) {\n\n\t\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t\tconst canvas = createElementNS( 'canvas' );\n\n\t\t\tcanvas.width = image.width;\n\t\t\tcanvas.height = image.height;\n\n\t\t\tconst context = canvas.getContext( '2d' );\n\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\tconst imageData = context.getImageData( 0, 0, image.width, image.height );\n\t\t\tconst data = imageData.data;\n\n\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tdata[ i ] = SRGBToLinear( data[ i ] / 255 ) * 255;\n\n\t\t\t}\n\n\t\t\tcontext.putImageData( imageData, 0, 0 );\n\n\t\t\treturn canvas;\n\n\t\t} else if ( image.data ) {\n\n\t\t\tconst data = image.data.slice( 0 );\n\n\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tif ( data instanceof Uint8Array || data instanceof Uint8ClampedArray ) {\n\n\t\t\t\t\tdata[ i ] = Math.floor( SRGBToLinear( data[ i ] / 255 ) * 255 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// assuming float\n\n\t\t\t\t\tdata[ i ] = SRGBToLinear( data[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdata: data,\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.' );\n\t\t\treturn image;\n\n\t\t}\n\n\t}\n\n}\n\nexport { ImageUtils };\n", "import { ImageUtils } from '../extras/ImageUtils.js';\nimport * as MathUtils from '../math/MathUtils.js';\n\nclass Source {\n\n\tconstructor( data = null ) {\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.data = data;\n\n\t\tthis.version = 0;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( ! isRootObject && meta.images[ this.uuid ] !== undefined ) {\n\n\t\t\treturn meta.images[ this.uuid ];\n\n\t\t}\n\n\t\tconst output = {\n\t\t\tuuid: this.uuid,\n\t\t\turl: ''\n\t\t};\n\n\t\tconst data = this.data;\n\n\t\tif ( data !== null ) {\n\n\t\t\tlet url;\n\n\t\t\tif ( Array.isArray( data ) ) {\n\n\t\t\t\t// cube texture\n\n\t\t\t\turl = [];\n\n\t\t\t\tfor ( let i = 0, l = data.length; i < l; i ++ ) {\n\n\t\t\t\t\tif ( data[ i ].isDataTexture ) {\n\n\t\t\t\t\t\turl.push( serializeImage( data[ i ].image ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\turl.push( serializeImage( data[ i ] ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// texture\n\n\t\t\t\turl = serializeImage( data );\n\n\t\t\t}\n\n\t\t\toutput.url = url;\n\n\t\t}\n\n\t\tif ( ! isRootObject ) {\n\n\t\t\tmeta.images[ this.uuid ] = output;\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nfunction serializeImage( image ) {\n\n\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t// default images\n\n\t\treturn ImageUtils.getDataURL( image );\n\n\t} else {\n\n\t\tif ( image.data ) {\n\n\t\t\t// images of DataTexture\n\n\t\t\treturn {\n\t\t\t\tdata: Array.prototype.slice.call( image.data ),\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height,\n\t\t\t\ttype: image.data.constructor.name\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.Texture: Unable to serialize Texture.' );\n\t\t\treturn {};\n\n\t\t}\n\n\t}\n\n}\n\nSource.prototype.isSource = true;\n\nexport { Source };\n", "import { EventDispatcher } from '../core/EventDispatcher.js';\nimport {\n\tMirroredRepeatWrapping,\n\tClampToEdgeWrapping,\n\tRepeatWrapping,\n\tLinearEncoding,\n\tUnsignedByteType,\n\tRGBAFormat,\n\tLinearMipmapLinearFilter,\n\tLinearFilter,\n\tUVMapping\n} from '../constants.js';\nimport * as MathUtils from '../math/MathUtils.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Matrix3 } from '../math/Matrix3.js';\nimport { Source } from './Source.js';\n\nlet textureId = 0;\n\nclass Texture extends EventDispatcher {\n\n\tconstructor( image = Texture.DEFAULT_IMAGE, mapping = Texture.DEFAULT_MAPPING, wrapS = ClampToEdgeWrapping, wrapT = ClampToEdgeWrapping, magFilter = LinearFilter, minFilter = LinearMipmapLinearFilter, format = RGBAFormat, type = UnsignedByteType, anisotropy = 1, encoding = LinearEncoding ) {\n\n\t\tsuper();\n\n\t\tObject.defineProperty( this, 'id', { value: textureId ++ } );\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.name = '';\n\n\t\tthis.source = new Source( image );\n\t\tthis.mipmaps = [];\n\n\t\tthis.mapping = mapping;\n\n\t\tthis.wrapS = wrapS;\n\t\tthis.wrapT = wrapT;\n\n\t\tthis.magFilter = magFilter;\n\t\tthis.minFilter = minFilter;\n\n\t\tthis.anisotropy = anisotropy;\n\n\t\tthis.format = format;\n\t\tthis.internalFormat = null;\n\t\tthis.type = type;\n\n\t\tthis.offset = new Vector2( 0, 0 );\n\t\tthis.repeat = new Vector2( 1, 1 );\n\t\tthis.center = new Vector2( 0, 0 );\n\t\tthis.rotation = 0;\n\n\t\tthis.matrixAutoUpdate = true;\n\t\tthis.matrix = new Matrix3();\n\n\t\tthis.generateMipmaps = true;\n\t\tthis.premultiplyAlpha = false;\n\t\tthis.flipY = true;\n\t\tthis.unpackAlignment = 4;\t// valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\n\n\t\t// Values of encoding !== THREE.LinearEncoding only supported on map, envMap and emissiveMap.\n\t\t//\n\t\t// Also changing the encoding after already used by a Material will not automatically make the Material\n\t\t// update. You need to explicitly call Material.needsUpdate to trigger it to recompile.\n\t\tthis.encoding = encoding;\n\n\t\tthis.userData = {};\n\n\t\tthis.version = 0;\n\t\tthis.onUpdate = null;\n\n\t\tthis.isRenderTargetTexture = false; // indicates whether a texture belongs to a render target or not\n\t\tthis.needsPMREMUpdate = false; // indicates whether this texture should be processed by PMREMGenerator or not (only relevant for render target textures)\n\n\t}\n\n\tget image() {\n\n\t\treturn this.source.data;\n\n\t}\n\n\tset image( value ) {\n\n\t\tthis.source.data = value;\n\n\t}\n\n\tupdateMatrix() {\n\n\t\tthis.matrix.setUvTransform( this.offset.x, this.offset.y, this.repeat.x, this.repeat.y, this.rotation, this.center.x, this.center.y );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.source = source.source;\n\t\tthis.mipmaps = source.mipmaps.slice( 0 );\n\n\t\tthis.mapping = source.mapping;\n\n\t\tthis.wrapS = source.wrapS;\n\t\tthis.wrapT = source.wrapT;\n\n\t\tthis.magFilter = source.magFilter;\n\t\tthis.minFilter = source.minFilter;\n\n\t\tthis.anisotropy = source.anisotropy;\n\n\t\tthis.format = source.format;\n\t\tthis.internalFormat = source.internalFormat;\n\t\tthis.type = source.type;\n\n\t\tthis.offset.copy( source.offset );\n\t\tthis.repeat.copy( source.repeat );\n\t\tthis.center.copy( source.center );\n\t\tthis.rotation = source.rotation;\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\t\tthis.matrix.copy( source.matrix );\n\n\t\tthis.generateMipmaps = source.generateMipmaps;\n\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\n\t\tthis.flipY = source.flipY;\n\t\tthis.unpackAlignment = source.unpackAlignment;\n\t\tthis.encoding = source.encoding;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\tthis.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( ! isRootObject && meta.textures[ this.uuid ] !== undefined ) {\n\n\t\t\treturn meta.textures[ this.uuid ];\n\n\t\t}\n\n\t\tconst output = {\n\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Texture',\n\t\t\t\tgenerator: 'Texture.toJSON'\n\t\t\t},\n\n\t\t\tuuid: this.uuid,\n\t\t\tname: this.name,\n\n\t\t\timage: this.source.toJSON( meta ).uuid,\n\n\t\t\tmapping: this.mapping,\n\n\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\n\t\t\toffset: [ this.offset.x, this.offset.y ],\n\t\t\tcenter: [ this.center.x, this.center.y ],\n\t\t\trotation: this.rotation,\n\n\t\t\twrap: [ this.wrapS, this.wrapT ],\n\n\t\t\tformat: this.format,\n\t\t\ttype: this.type,\n\t\t\tencoding: this.encoding,\n\n\t\t\tminFilter: this.minFilter,\n\t\t\tmagFilter: this.magFilter,\n\t\t\tanisotropy: this.anisotropy,\n\n\t\t\tflipY: this.flipY,\n\n\t\t\tpremultiplyAlpha: this.premultiplyAlpha,\n\t\t\tunpackAlignment: this.unpackAlignment\n\n\t\t};\n\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) output.userData = this.userData;\n\n\t\tif ( ! isRootObject ) {\n\n\t\t\tmeta.textures[ this.uuid ] = output;\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\ttransformUv( uv ) {\n\n\t\tif ( this.mapping !== UVMapping ) return uv;\n\n\t\tuv.applyMatrix3( this.matrix );\n\n\t\tif ( uv.x < 0 || uv.x > 1 ) {\n\n\t\t\tswitch ( this.wrapS ) {\n\n\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( uv.y < 0 || uv.y > 1 ) {\n\n\t\t\tswitch ( this.wrapT ) {\n\n\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.flipY ) {\n\n\t\t\tuv.y = 1 - uv.y;\n\n\t\t}\n\n\t\treturn uv;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) {\n\n\t\t\tthis.version ++;\n\t\t\tthis.source.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nTexture.DEFAULT_IMAGE = null;\nTexture.DEFAULT_MAPPING = UVMapping;\n\nTexture.prototype.isTexture = true;\n\nexport { Texture };\n", "class Vector4 {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t}\n\n\tget width() {\n\n\t\treturn this.z;\n\n\t}\n\n\tset width( value ) {\n\n\t\tthis.z = value;\n\n\t}\n\n\tget height() {\n\n\t\treturn this.w;\n\n\t}\n\n\tset height( value ) {\n\n\t\tthis.w = value;\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\t\tthis.z = scalar;\n\t\tthis.w = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetW( w ) {\n\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tcase 3: this.w = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tcase 3: return this.w;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\treturn this.addVectors( v, w );\n\n\t\t}\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\t\tthis.w += v.w;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\t\tthis.w += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\t\tthis.w = a.w + b.w;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\t\tthis.w += v.w * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\treturn this.subVectors( v, w );\n\n\t\t}\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\t\tthis.w -= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\t\tthis.w -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\t\tthis.w = a.w - b.w;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\t\tthis.w *= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\t\tthis.w *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z, w = this.w;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\n\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tsetAxisAngleFromQuaternion( q ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\n\n\t\t// q is assumed to be normalized\n\n\t\tthis.w = 2 * Math.acos( q.w );\n\n\t\tconst s = Math.sqrt( 1 - q.w * q.w );\n\n\t\tif ( s < 0.0001 ) {\n\n\t\t\tthis.x = 1;\n\t\t\tthis.y = 0;\n\t\t\tthis.z = 0;\n\n\t\t} else {\n\n\t\t\tthis.x = q.x / s;\n\t\t\tthis.y = q.y / s;\n\t\t\tthis.z = q.z / s;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetAxisAngleFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tlet angle, x, y, z; // variables for result\n\t\tconst epsilon = 0.01,\t\t// margin to allow for rounding errors\n\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\n\n\t\t\tte = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tif ( ( Math.abs( m12 - m21 ) < epsilon ) &&\n\t\t     ( Math.abs( m13 - m31 ) < epsilon ) &&\n\t\t     ( Math.abs( m23 - m32 ) < epsilon ) ) {\n\n\t\t\t// singularity found\n\t\t\t// first check for identity matrix which must have +1 for all terms\n\t\t\t// in leading diagonal and zero in other terms\n\n\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m13 + m31 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m23 + m32 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\n\n\t\t\t\t// this singularity is identity matrix so angle = 0\n\n\t\t\t\tthis.set( 1, 0, 0, 0 );\n\n\t\t\t\treturn this; // zero angle, arbitrary axis\n\n\t\t\t}\n\n\t\t\t// otherwise this singularity is angle = 180\n\n\t\t\tangle = Math.PI;\n\n\t\t\tconst xx = ( m11 + 1 ) / 2;\n\t\t\tconst yy = ( m22 + 1 ) / 2;\n\t\t\tconst zz = ( m33 + 1 ) / 2;\n\t\t\tconst xy = ( m12 + m21 ) / 4;\n\t\t\tconst xz = ( m13 + m31 ) / 4;\n\t\t\tconst yz = ( m23 + m32 ) / 4;\n\n\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\n\n\t\t\t\t// m11 is the largest diagonal term\n\n\t\t\t\tif ( xx < epsilon ) {\n\n\t\t\t\t\tx = 0;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tx = Math.sqrt( xx );\n\t\t\t\t\ty = xy / x;\n\t\t\t\t\tz = xz / x;\n\n\t\t\t\t}\n\n\t\t\t} else if ( yy > zz ) {\n\n\t\t\t\t// m22 is the largest diagonal term\n\n\t\t\t\tif ( yy < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ty = Math.sqrt( yy );\n\t\t\t\t\tx = xy / y;\n\t\t\t\t\tz = yz / y;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// m33 is the largest diagonal term so base result on this\n\n\t\t\t\tif ( zz < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tz = Math.sqrt( zz );\n\t\t\t\t\tx = xz / z;\n\t\t\t\t\ty = yz / z;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.set( x, y, z, angle );\n\n\t\t\treturn this; // return 180 deg rotation\n\n\t\t}\n\n\t\t// as we have reached here there are no singularities so we can handle normally\n\n\t\tlet s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 ) +\n\t\t\t( m13 - m31 ) * ( m13 - m31 ) +\n\t\t\t( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\n\n\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\n\n\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\n\t\t// caught by singularity test above, but I've left it in just in case\n\n\t\tthis.x = ( m32 - m23 ) / s;\n\t\tthis.y = ( m13 - m31 ) / s;\n\t\tthis.z = ( m21 - m12 ) / s;\n\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\n\n\t\treturn this;\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\t\tthis.z = Math.min( this.z, v.z );\n\t\tthis.w = Math.min( this.w, v.w );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\t\tthis.z = Math.max( this.z, v.z );\n\t\tthis.w = Math.max( this.w, v.w );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\n\t\tthis.w = Math.max( min.w, Math.min( max.w, this.w ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\t\tthis.z = Math.max( minVal, Math.min( maxVal, this.z ) );\n\t\tthis.w = Math.max( minVal, Math.min( maxVal, this.w ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\t\tthis.w = Math.floor( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\t\tthis.w = Math.ceil( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\t\tthis.w = Math.round( this.w );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\n\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\t\tthis.w = - this.w;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\t\tthis.w += ( v.w - this.w ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\t\tthis.z = v1.z + ( v2.z - v1.z ) * alpha;\n\t\tthis.w = v1.w + ( v2.w - v1.w ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\t\tthis.w = array[ offset + 3 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\t\tarray[ offset + 3 ] = this.w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index, offset ) {\n\n\t\tif ( offset !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector4: offset has been removed from .fromBufferAttribute().' );\n\n\t\t}\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\t\tthis.z = attribute.getZ( index );\n\t\tthis.w = attribute.getW( index );\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\t\tthis.z = Math.random();\n\t\tthis.w = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\t\tyield this.z;\n\t\tyield this.w;\n\n\t}\n\n}\n\nVector4.prototype.isVector4 = true;\n\nexport { Vector4 };\n", "import * as MathUtils from './MathUtils.js';\n\nclass Quaternion {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t}\n\n\tstatic slerp( qa, qb, qm, t ) {\n\n\t\tconsole.warn( 'THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead.' );\n\t\treturn qm.slerpQuaternions( qa, qb, t );\n\n\t}\n\n\tstatic slerpFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1, t ) {\n\n\t\t// fuzz-free, array-based Quaternion SLERP operation\n\n\t\tlet x0 = src0[ srcOffset0 + 0 ],\n\t\t\ty0 = src0[ srcOffset0 + 1 ],\n\t\t\tz0 = src0[ srcOffset0 + 2 ],\n\t\t\tw0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 + 0 ],\n\t\t\ty1 = src1[ srcOffset1 + 1 ],\n\t\t\tz1 = src1[ srcOffset1 + 2 ],\n\t\t\tw1 = src1[ srcOffset1 + 3 ];\n\n\t\tif ( t === 0 ) {\n\n\t\t\tdst[ dstOffset + 0 ] = x0;\n\t\t\tdst[ dstOffset + 1 ] = y0;\n\t\t\tdst[ dstOffset + 2 ] = z0;\n\t\t\tdst[ dstOffset + 3 ] = w0;\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( t === 1 ) {\n\n\t\t\tdst[ dstOffset + 0 ] = x1;\n\t\t\tdst[ dstOffset + 1 ] = y1;\n\t\t\tdst[ dstOffset + 2 ] = z1;\n\t\t\tdst[ dstOffset + 3 ] = w1;\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {\n\n\t\t\tlet s = 1 - t;\n\t\t\tconst cos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\n\t\t\t\tdir = ( cos >= 0 ? 1 : - 1 ),\n\t\t\t\tsqrSin = 1 - cos * cos;\n\n\t\t\t// Skip the Slerp for tiny steps to avoid numeric problems:\n\t\t\tif ( sqrSin > Number.EPSILON ) {\n\n\t\t\t\tconst sin = Math.sqrt( sqrSin ),\n\t\t\t\t\tlen = Math.atan2( sin, cos * dir );\n\n\t\t\t\ts = Math.sin( s * len ) / sin;\n\t\t\t\tt = Math.sin( t * len ) / sin;\n\n\t\t\t}\n\n\t\t\tconst tDir = t * dir;\n\n\t\t\tx0 = x0 * s + x1 * tDir;\n\t\t\ty0 = y0 * s + y1 * tDir;\n\t\t\tz0 = z0 * s + z1 * tDir;\n\t\t\tw0 = w0 * s + w1 * tDir;\n\n\t\t\t// Normalize in case we just did a lerp:\n\t\t\tif ( s === 1 - t ) {\n\n\t\t\t\tconst f = 1 / Math.sqrt( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );\n\n\t\t\t\tx0 *= f;\n\t\t\t\ty0 *= f;\n\t\t\t\tz0 *= f;\n\t\t\t\tw0 *= f;\n\n\t\t\t}\n\n\t\t}\n\n\t\tdst[ dstOffset ] = x0;\n\t\tdst[ dstOffset + 1 ] = y0;\n\t\tdst[ dstOffset + 2 ] = z0;\n\t\tdst[ dstOffset + 3 ] = w0;\n\n\t}\n\n\tstatic multiplyQuaternionsFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1 ) {\n\n\t\tconst x0 = src0[ srcOffset0 ];\n\t\tconst y0 = src0[ srcOffset0 + 1 ];\n\t\tconst z0 = src0[ srcOffset0 + 2 ];\n\t\tconst w0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 ];\n\t\tconst y1 = src1[ srcOffset1 + 1 ];\n\t\tconst z1 = src1[ srcOffset1 + 2 ];\n\t\tconst w1 = src1[ srcOffset1 + 3 ];\n\n\t\tdst[ dstOffset ] = x0 * w1 + w0 * x1 + y0 * z1 - z0 * y1;\n\t\tdst[ dstOffset + 1 ] = y0 * w1 + w0 * y1 + z0 * x1 - x0 * z1;\n\t\tdst[ dstOffset + 2 ] = z0 * w1 + w0 * z1 + x0 * y1 - y0 * x1;\n\t\tdst[ dstOffset + 3 ] = w0 * w1 - x0 * x1 - y0 * y1 - z0 * z1;\n\n\t\treturn dst;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget w() {\n\n\t\treturn this._w;\n\n\t}\n\n\tset w( value ) {\n\n\t\tthis._w = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\n\n\t}\n\n\tcopy( quaternion ) {\n\n\t\tthis._x = quaternion.x;\n\t\tthis._y = quaternion.y;\n\t\tthis._z = quaternion.z;\n\t\tthis._w = quaternion.w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromEuler( euler, update ) {\n\n\t\tif ( ! ( euler && euler.isEuler ) ) {\n\n\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.' );\n\n\t\t}\n\n\t\tconst x = euler._x, y = euler._y, z = euler._z, order = euler._order;\n\n\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\n\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\n\t\t//\tcontent/SpinCalc.m\n\n\t\tconst cos = Math.cos;\n\t\tconst sin = Math.sin;\n\n\t\tconst c1 = cos( x / 2 );\n\t\tconst c2 = cos( y / 2 );\n\t\tconst c3 = cos( z / 2 );\n\n\t\tconst s1 = sin( x / 2 );\n\t\tconst s2 = sin( y / 2 );\n\t\tconst s3 = sin( z / 2 );\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.Quaternion: .setFromEuler() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tif ( update !== false ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAxisAngle( axis, angle ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n\n\t\t// assumes axis is normalized\n\n\t\tconst halfAngle = angle / 2, s = Math.sin( halfAngle );\n\n\t\tthis._x = axis.x * s;\n\t\tthis._y = axis.y * s;\n\t\tthis._z = axis.z * s;\n\t\tthis._w = Math.cos( halfAngle );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\n\n\t\t\ttrace = m11 + m22 + m33;\n\n\t\tif ( trace > 0 ) {\n\n\t\t\tconst s = 0.5 / Math.sqrt( trace + 1.0 );\n\n\t\t\tthis._w = 0.25 / s;\n\t\t\tthis._x = ( m32 - m23 ) * s;\n\t\t\tthis._y = ( m13 - m31 ) * s;\n\t\t\tthis._z = ( m21 - m12 ) * s;\n\n\t\t} else if ( m11 > m22 && m11 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\n\n\t\t\tthis._w = ( m32 - m23 ) / s;\n\t\t\tthis._x = 0.25 * s;\n\t\t\tthis._y = ( m12 + m21 ) / s;\n\t\t\tthis._z = ( m13 + m31 ) / s;\n\n\t\t} else if ( m22 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\n\n\t\t\tthis._w = ( m13 - m31 ) / s;\n\t\t\tthis._x = ( m12 + m21 ) / s;\n\t\t\tthis._y = 0.25 * s;\n\t\t\tthis._z = ( m23 + m32 ) / s;\n\n\t\t} else {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\n\n\t\t\tthis._w = ( m21 - m12 ) / s;\n\t\t\tthis._x = ( m13 + m31 ) / s;\n\t\t\tthis._y = ( m23 + m32 ) / s;\n\t\t\tthis._z = 0.25 * s;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromUnitVectors( vFrom, vTo ) {\n\n\t\t// assumes direction vectors vFrom and vTo are normalized\n\n\t\tlet r = vFrom.dot( vTo ) + 1;\n\n\t\tif ( r < Number.EPSILON ) {\n\n\t\t\t// vFrom and vTo point in opposite directions\n\n\t\t\tr = 0;\n\n\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\n\n\t\t\t\tthis._x = - vFrom.y;\n\t\t\t\tthis._y = vFrom.x;\n\t\t\t\tthis._z = 0;\n\t\t\t\tthis._w = r;\n\n\t\t\t} else {\n\n\t\t\t\tthis._x = 0;\n\t\t\t\tthis._y = - vFrom.z;\n\t\t\t\tthis._z = vFrom.y;\n\t\t\t\tthis._w = r;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// crossVectors( vFrom, vTo ); // inlined to avoid cyclic dependency on Vector3\n\n\t\t\tthis._x = vFrom.y * vTo.z - vFrom.z * vTo.y;\n\t\t\tthis._y = vFrom.z * vTo.x - vFrom.x * vTo.z;\n\t\t\tthis._z = vFrom.x * vTo.y - vFrom.y * vTo.x;\n\t\t\tthis._w = r;\n\n\t\t}\n\n\t\treturn this.normalize();\n\n\t}\n\n\tangleTo( q ) {\n\n\t\treturn 2 * Math.acos( Math.abs( MathUtils.clamp( this.dot( q ), - 1, 1 ) ) );\n\n\t}\n\n\trotateTowards( q, step ) {\n\n\t\tconst angle = this.angleTo( q );\n\n\t\tif ( angle === 0 ) return this;\n\n\t\tconst t = Math.min( 1, step / angle );\n\n\t\tthis.slerp( q, t );\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\treturn this.set( 0, 0, 0, 1 );\n\n\t}\n\n\tinvert() {\n\n\t\t// quaternion is assumed to have unit length\n\n\t\treturn this.conjugate();\n\n\t}\n\n\tconjugate() {\n\n\t\tthis._x *= - 1;\n\t\tthis._y *= - 1;\n\t\tthis._z *= - 1;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\n\n\t}\n\n\tnormalize() {\n\n\t\tlet l = this.length();\n\n\t\tif ( l === 0 ) {\n\n\t\t\tthis._x = 0;\n\t\t\tthis._y = 0;\n\t\t\tthis._z = 0;\n\t\t\tthis._w = 1;\n\n\t\t} else {\n\n\t\t\tl = 1 / l;\n\n\t\t\tthis._x = this._x * l;\n\t\t\tthis._y = this._y * l;\n\t\t\tthis._z = this._z * l;\n\t\t\tthis._w = this._w * l;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( q, p ) {\n\n\t\tif ( p !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\n\t\t\treturn this.multiplyQuaternions( q, p );\n\n\t\t}\n\n\t\treturn this.multiplyQuaternions( this, q );\n\n\t}\n\n\tpremultiply( q ) {\n\n\t\treturn this.multiplyQuaternions( q, this );\n\n\t}\n\n\tmultiplyQuaternions( a, b ) {\n\n\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n\n\t\tconst qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\n\t\tconst qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\n\n\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerp( qb, t ) {\n\n\t\tif ( t === 0 ) return this;\n\t\tif ( t === 1 ) return this.copy( qb );\n\n\t\tconst x = this._x, y = this._y, z = this._z, w = this._w;\n\n\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\n\t\tlet cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\n\n\t\tif ( cosHalfTheta < 0 ) {\n\n\t\t\tthis._w = - qb._w;\n\t\t\tthis._x = - qb._x;\n\t\t\tthis._y = - qb._y;\n\t\t\tthis._z = - qb._z;\n\n\t\t\tcosHalfTheta = - cosHalfTheta;\n\n\t\t} else {\n\n\t\t\tthis.copy( qb );\n\n\t\t}\n\n\t\tif ( cosHalfTheta >= 1.0 ) {\n\n\t\t\tthis._w = w;\n\t\t\tthis._x = x;\n\t\t\tthis._y = y;\n\t\t\tthis._z = z;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sqrSinHalfTheta = 1.0 - cosHalfTheta * cosHalfTheta;\n\n\t\tif ( sqrSinHalfTheta <= Number.EPSILON ) {\n\n\t\t\tconst s = 1 - t;\n\t\t\tthis._w = s * w + t * this._w;\n\t\t\tthis._x = s * x + t * this._x;\n\t\t\tthis._y = s * y + t * this._y;\n\t\t\tthis._z = s * z + t * this._z;\n\n\t\t\tthis.normalize();\n\t\t\tthis._onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sinHalfTheta = Math.sqrt( sqrSinHalfTheta );\n\t\tconst halfTheta = Math.atan2( sinHalfTheta, cosHalfTheta );\n\t\tconst ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\n\t\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\n\n\t\tthis._w = ( w * ratioA + this._w * ratioB );\n\t\tthis._x = ( x * ratioA + this._x * ratioB );\n\t\tthis._y = ( y * ratioA + this._y * ratioB );\n\t\tthis._z = ( z * ratioA + this._z * ratioB );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerpQuaternions( qa, qb, t ) {\n\n\t\treturn this.copy( qa ).slerp( qb, t );\n\n\t}\n\n\trandom() {\n\n\t\t// Derived from http://planning.cs.uiuc.edu/node198.html\n\t\t// Note, this source uses w, x, y, z ordering,\n\t\t// so we swap the order below.\n\n\t\tconst u1 = Math.random();\n\t\tconst sqrt1u1 = Math.sqrt( 1 - u1 );\n\t\tconst sqrtu1 = Math.sqrt( u1 );\n\n\t\tconst u2 = 2 * Math.PI * Math.random();\n\n\t\tconst u3 = 2 * Math.PI * Math.random();\n\n\t\treturn this.set(\n\t\t\tsqrt1u1 * Math.cos( u2 ),\n\t\t\tsqrtu1 * Math.sin( u3 ),\n\t\t\tsqrtu1 * Math.cos( u3 ),\n\t\t\tsqrt1u1 * Math.sin( u2 ),\n\t\t);\n\n\t}\n\n\tequals( quaternion ) {\n\n\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis._x = array[ offset ];\n\t\tthis._y = array[ offset + 1 ];\n\t\tthis._z = array[ offset + 2 ];\n\t\tthis._w = array[ offset + 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis._x = attribute.getX( index );\n\t\tthis._y = attribute.getY( index );\n\t\tthis._z = attribute.getZ( index );\n\t\tthis._w = attribute.getW( index );\n\n\t\treturn this;\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n}\n\nQuaternion.prototype.isQuaternion = true;\n\nexport { Quaternion };\n", "import * as MathUtils from './MathUtils.js';\nimport { Quaternion } from './Quaternion.js';\n\nclass Vector3 {\n\n\tconstructor( x = 0, y = 0, z = 0 ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t}\n\n\tset( x, y, z ) {\n\n\t\tif ( z === undefined ) z = this.z; // sprite.scale.set(x,y)\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\t\tthis.z = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y, this.z );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\treturn this.addVectors( v, w );\n\n\t\t}\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\treturn this.subVectors( v, w );\n\n\t\t}\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.' );\n\t\t\treturn this.multiplyVectors( v, w );\n\n\t\t}\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyVectors( a, b ) {\n\n\t\tthis.x = a.x * b.x;\n\t\tthis.y = a.y * b.y;\n\t\tthis.z = a.z * b.z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyEuler( euler ) {\n\n\t\tif ( ! ( euler && euler.isEuler ) ) {\n\n\t\t\tconsole.error( 'THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.' );\n\n\t\t}\n\n\t\treturn this.applyQuaternion( _quaternion.setFromEuler( euler ) );\n\n\t}\n\n\tapplyAxisAngle( axis, angle ) {\n\n\t\treturn this.applyQuaternion( _quaternion.setFromAxisAngle( axis, angle ) );\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\treturn this.applyMatrix3( m ).normalize();\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tconst w = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] );\n\n\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] ) * w;\n\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] ) * w;\n\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * w;\n\n\t\treturn this;\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst qx = q.x, qy = q.y, qz = q.z, qw = q.w;\n\n\t\t// calculate quat * vector\n\n\t\tconst ix = qw * x + qy * z - qz * y;\n\t\tconst iy = qw * y + qz * x - qx * z;\n\t\tconst iz = qw * z + qx * y - qy * x;\n\t\tconst iw = - qx * x - qy * y - qz * z;\n\n\t\t// calculate result * inverse quat\n\n\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\n\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\n\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\n\n\t\treturn this;\n\n\t}\n\n\tproject( camera ) {\n\n\t\treturn this.applyMatrix4( camera.matrixWorldInverse ).applyMatrix4( camera.projectionMatrix );\n\n\t}\n\n\tunproject( camera ) {\n\n\t\treturn this.applyMatrix4( camera.projectionMatrixInverse ).applyMatrix4( camera.matrixWorld );\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\t// input: THREE.Matrix4 affine matrix\n\t\t// vector interpreted as a direction\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\n\n\t\treturn this.normalize();\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\t\tthis.z /= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\t\tthis.z = Math.min( this.z, v.z );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\t\tthis.z = Math.max( this.z, v.z );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\t\tthis.z = Math.max( minVal, Math.min( maxVal, this.z ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\n\n\t}\n\n\t// TODO lengthSquared?\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\t\tthis.z = v1.z + ( v2.z - v1.z ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tcross( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.' );\n\t\t\treturn this.crossVectors( v, w );\n\n\t\t}\n\n\t\treturn this.crossVectors( this, v );\n\n\t}\n\n\tcrossVectors( a, b ) {\n\n\t\tconst ax = a.x, ay = a.y, az = a.z;\n\t\tconst bx = b.x, by = b.y, bz = b.z;\n\n\t\tthis.x = ay * bz - az * by;\n\t\tthis.y = az * bx - ax * bz;\n\t\tthis.z = ax * by - ay * bx;\n\n\t\treturn this;\n\n\t}\n\n\tprojectOnVector( v ) {\n\n\t\tconst denominator = v.lengthSq();\n\n\t\tif ( denominator === 0 ) return this.set( 0, 0, 0 );\n\n\t\tconst scalar = v.dot( this ) / denominator;\n\n\t\treturn this.copy( v ).multiplyScalar( scalar );\n\n\t}\n\n\tprojectOnPlane( planeNormal ) {\n\n\t\t_vector.copy( this ).projectOnVector( planeNormal );\n\n\t\treturn this.sub( _vector );\n\n\t}\n\n\treflect( normal ) {\n\n\t\t// reflect incident vector off plane orthogonal to normal\n\t\t// normal is assumed to have unit length\n\n\t\treturn this.sub( _vector.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\n\n\t}\n\n\tangleTo( v ) {\n\n\t\tconst denominator = Math.sqrt( this.lengthSq() * v.lengthSq() );\n\n\t\tif ( denominator === 0 ) return Math.PI / 2;\n\n\t\tconst theta = this.dot( v ) / denominator;\n\n\t\t// clamp, to handle numerical problems\n\n\t\treturn Math.acos( MathUtils.clamp( theta, - 1, 1 ) );\n\n\t}\n\n\tdistanceTo( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t}\n\n\tdistanceToSquared( v ) {\n\n\t\tconst dx = this.x - v.x, dy = this.y - v.y, dz = this.z - v.z;\n\n\t\treturn dx * dx + dy * dy + dz * dz;\n\n\t}\n\n\tmanhattanDistanceTo( v ) {\n\n\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y ) + Math.abs( this.z - v.z );\n\n\t}\n\n\tsetFromSpherical( s ) {\n\n\t\treturn this.setFromSphericalCoords( s.radius, s.phi, s.theta );\n\n\t}\n\n\tsetFromSphericalCoords( radius, phi, theta ) {\n\n\t\tconst sinPhiRadius = Math.sin( phi ) * radius;\n\n\t\tthis.x = sinPhiRadius * Math.sin( theta );\n\t\tthis.y = Math.cos( phi ) * radius;\n\t\tthis.z = sinPhiRadius * Math.cos( theta );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCylindrical( c ) {\n\n\t\treturn this.setFromCylindricalCoords( c.radius, c.theta, c.y );\n\n\t}\n\n\tsetFromCylindricalCoords( radius, theta, y ) {\n\n\t\tthis.x = radius * Math.sin( theta );\n\t\tthis.y = y;\n\t\tthis.z = radius * Math.cos( theta );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixPosition( m ) {\n\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 12 ];\n\t\tthis.y = e[ 13 ];\n\t\tthis.z = e[ 14 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixScale( m ) {\n\n\t\tconst sx = this.setFromMatrixColumn( m, 0 ).length();\n\t\tconst sy = this.setFromMatrixColumn( m, 1 ).length();\n\t\tconst sz = this.setFromMatrixColumn( m, 2 ).length();\n\n\t\tthis.x = sx;\n\t\tthis.y = sy;\n\t\tthis.z = sz;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixColumn( m, index ) {\n\n\t\treturn this.fromArray( m.elements, index * 4 );\n\n\t}\n\n\tsetFromMatrix3Column( m, index ) {\n\n\t\treturn this.fromArray( m.elements, index * 3 );\n\n\t}\n\n\tsetFromEuler( e ) {\n\n\t\tthis.x = e._x;\n\t\tthis.y = e._y;\n\t\tthis.z = e._z;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index, offset ) {\n\n\t\tif ( offset !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: offset has been removed from .fromBufferAttribute().' );\n\n\t\t}\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\t\tthis.z = attribute.getZ( index );\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\t\tthis.z = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\trandomDirection() {\n\n\t\t// Derived from https://mathworld.wolfram.com/SpherePointPicking.html\n\n\t\tconst u = ( Math.random() - 0.5 ) * 2;\n\t\tconst t = Math.random() * Math.PI * 2;\n\t\tconst f = Math.sqrt( 1 - u ** 2 );\n\n\t\tthis.x = f * Math.cos( t );\n\t\tthis.y = f * Math.sin( t );\n\t\tthis.z = u;\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\t\tyield this.z;\n\n\t}\n\n}\n\nVector3.prototype.isVector3 = true;\n\nconst _vector = /*@__PURE__*/ new Vector3();\nconst _quaternion = /*@__PURE__*/ new Quaternion();\n\nexport { Vector3 };\n", "import { Vector3 } from './Vector3.js';\n\nclass Box3 {\n\n\tconstructor( min = new Vector3( + Infinity, + Infinity, + Infinity ), max = new Vector3( - Infinity, - Infinity, - Infinity ) ) {\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\n\t}\n\n\tset( min, max ) {\n\n\t\tthis.min.copy( min );\n\t\tthis.max.copy( max );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromArray( array ) {\n\n\t\tlet minX = + Infinity;\n\t\tlet minY = + Infinity;\n\t\tlet minZ = + Infinity;\n\n\t\tlet maxX = - Infinity;\n\t\tlet maxY = - Infinity;\n\t\tlet maxZ = - Infinity;\n\n\t\tfor ( let i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\tconst x = array[ i ];\n\t\t\tconst y = array[ i + 1 ];\n\t\t\tconst z = array[ i + 2 ];\n\n\t\t\tif ( x < minX ) minX = x;\n\t\t\tif ( y < minY ) minY = y;\n\t\t\tif ( z < minZ ) minZ = z;\n\n\t\t\tif ( x > maxX ) maxX = x;\n\t\t\tif ( y > maxY ) maxY = y;\n\t\t\tif ( z > maxZ ) maxZ = z;\n\n\t\t}\n\n\t\tthis.min.set( minX, minY, minZ );\n\t\tthis.max.set( maxX, maxY, maxZ );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromBufferAttribute( attribute ) {\n\n\t\tlet minX = + Infinity;\n\t\tlet minY = + Infinity;\n\t\tlet minZ = + Infinity;\n\n\t\tlet maxX = - Infinity;\n\t\tlet maxY = - Infinity;\n\t\tlet maxZ = - Infinity;\n\n\t\tfor ( let i = 0, l = attribute.count; i < l; i ++ ) {\n\n\t\t\tconst x = attribute.getX( i );\n\t\t\tconst y = attribute.getY( i );\n\t\t\tconst z = attribute.getZ( i );\n\n\t\t\tif ( x < minX ) minX = x;\n\t\t\tif ( y < minY ) minY = y;\n\t\t\tif ( z < minZ ) minZ = z;\n\n\t\t\tif ( x > maxX ) maxX = x;\n\t\t\tif ( y > maxY ) maxY = y;\n\t\t\tif ( z > maxZ ) maxZ = z;\n\n\t\t}\n\n\t\tthis.min.set( minX, minY, minZ );\n\t\tthis.max.set( maxX, maxY, maxZ );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCenterAndSize( center, size ) {\n\n\t\tconst halfSize = _vector.copy( size ).multiplyScalar( 0.5 );\n\n\t\tthis.min.copy( center ).sub( halfSize );\n\t\tthis.max.copy( center ).add( halfSize );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromObject( object, precise = false ) {\n\n\t\tthis.makeEmpty();\n\n\t\treturn this.expandByObject( object, precise );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( box ) {\n\n\t\tthis.min.copy( box.min );\n\t\tthis.max.copy( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.min.x = this.min.y = this.min.z = + Infinity;\n\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t}\n\n\tgetSize( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.subVectors( this.max, this.min );\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tthis.min.min( point );\n\t\tthis.max.max( point );\n\n\t\treturn this;\n\n\t}\n\n\texpandByVector( vector ) {\n\n\t\tthis.min.sub( vector );\n\t\tthis.max.add( vector );\n\n\t\treturn this;\n\n\t}\n\n\texpandByScalar( scalar ) {\n\n\t\tthis.min.addScalar( - scalar );\n\t\tthis.max.addScalar( scalar );\n\n\t\treturn this;\n\n\t}\n\n\texpandByObject( object, precise = false ) {\n\n\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\n\t\t// accounting for both the object's, and children's, world transforms\n\n\t\tobject.updateWorldMatrix( false, false );\n\n\t\tconst geometry = object.geometry;\n\n\t\tif ( geometry !== undefined ) {\n\n\t\t\tif ( precise && geometry.attributes != undefined && geometry.attributes.position !== undefined ) {\n\n\t\t\t\tconst position = geometry.attributes.position;\n\t\t\t\tfor ( let i = 0, l = position.count; i < l; i ++ ) {\n\n\t\t\t\t\t_vector.fromBufferAttribute( position, i ).applyMatrix4( object.matrixWorld );\n\t\t\t\t\tthis.expandByPoint( _vector );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( geometry.boundingBox === null ) {\n\n\t\t\t\t\tgeometry.computeBoundingBox();\n\n\t\t\t\t}\n\n\t\t\t\t_box.copy( geometry.boundingBox );\n\t\t\t\t_box.applyMatrix4( object.matrixWorld );\n\n\t\t\t\tthis.union( _box );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tthis.expandByObject( children[ i ], precise );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn point.x < this.min.x || point.x > this.max.x ||\n\t\t\tpoint.y < this.min.y || point.y > this.max.y ||\n\t\t\tpoint.z < this.min.z || point.z > this.max.z ? false : true;\n\n\t}\n\n\tcontainsBox( box ) {\n\n\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\n\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y &&\n\t\t\tthis.min.z <= box.min.z && box.max.z <= this.max.z;\n\n\t}\n\n\tgetParameter( point, target ) {\n\n\t\t// This can potentially have a divide by zero if the box\n\t\t// has a size dimension of 0.\n\n\t\treturn target.set(\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\n\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\n\t\t);\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\t// using 6 splitting planes to rule out intersections.\n\t\treturn box.max.x < this.min.x || box.min.x > this.max.x ||\n\t\t\tbox.max.y < this.min.y || box.min.y > this.max.y ||\n\t\t\tbox.max.z < this.min.z || box.min.z > this.max.z ? false : true;\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\t// Find the point on the AABB closest to the sphere center.\n\t\tthis.clampPoint( sphere.center, _vector );\n\n\t\t// If that point is inside the sphere, the AABB and sphere intersect.\n\t\treturn _vector.distanceToSquared( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\t// We compute the minimum and maximum dot product values. If those values\n\t\t// are on the same side (back or front) of the plane, then there is no intersection.\n\n\t\tlet min, max;\n\n\t\tif ( plane.normal.x > 0 ) {\n\n\t\t\tmin = plane.normal.x * this.min.x;\n\t\t\tmax = plane.normal.x * this.max.x;\n\n\t\t} else {\n\n\t\t\tmin = plane.normal.x * this.max.x;\n\t\t\tmax = plane.normal.x * this.min.x;\n\n\t\t}\n\n\t\tif ( plane.normal.y > 0 ) {\n\n\t\t\tmin += plane.normal.y * this.min.y;\n\t\t\tmax += plane.normal.y * this.max.y;\n\n\t\t} else {\n\n\t\t\tmin += plane.normal.y * this.max.y;\n\t\t\tmax += plane.normal.y * this.min.y;\n\n\t\t}\n\n\t\tif ( plane.normal.z > 0 ) {\n\n\t\t\tmin += plane.normal.z * this.min.z;\n\t\t\tmax += plane.normal.z * this.max.z;\n\n\t\t} else {\n\n\t\t\tmin += plane.normal.z * this.max.z;\n\t\t\tmax += plane.normal.z * this.min.z;\n\n\t\t}\n\n\t\treturn ( min <= - plane.constant && max >= - plane.constant );\n\n\t}\n\n\tintersectsTriangle( triangle ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// compute box center and extents\n\t\tthis.getCenter( _center );\n\t\t_extents.subVectors( this.max, _center );\n\n\t\t// translate triangle to aabb origin\n\t\t_v0.subVectors( triangle.a, _center );\n\t\t_v1.subVectors( triangle.b, _center );\n\t\t_v2.subVectors( triangle.c, _center );\n\n\t\t// compute edge vectors for triangle\n\t\t_f0.subVectors( _v1, _v0 );\n\t\t_f1.subVectors( _v2, _v1 );\n\t\t_f2.subVectors( _v0, _v2 );\n\n\t\t// test against axes that are given by cross product combinations of the edges of the triangle and the edges of the aabb\n\t\t// make an axis testing of each of the 3 sides of the aabb against each of the 3 sides of the triangle = 9 axis of separation\n\t\t// axis_ij = u_i x f_j (u0, u1, u2 = face normals of aabb = x,y,z axes vectors since aabb is axis aligned)\n\t\tlet axes = [\n\t\t\t0, - _f0.z, _f0.y, 0, - _f1.z, _f1.y, 0, - _f2.z, _f2.y,\n\t\t\t_f0.z, 0, - _f0.x, _f1.z, 0, - _f1.x, _f2.z, 0, - _f2.x,\n\t\t\t- _f0.y, _f0.x, 0, - _f1.y, _f1.x, 0, - _f2.y, _f2.x, 0\n\t\t];\n\t\tif ( ! satForAxes( axes, _v0, _v1, _v2, _extents ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// test 3 face normals from the aabb\n\t\taxes = [ 1, 0, 0, 0, 1, 0, 0, 0, 1 ];\n\t\tif ( ! satForAxes( axes, _v0, _v1, _v2, _extents ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// finally testing the face normal of the triangle\n\t\t// use already existing triangle edge vectors here\n\t\t_triangleNormal.crossVectors( _f0, _f1 );\n\t\taxes = [ _triangleNormal.x, _triangleNormal.y, _triangleNormal.z ];\n\n\t\treturn satForAxes( axes, _v0, _v1, _v2, _extents );\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\treturn target.copy( point ).clamp( this.min, this.max );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\tconst clampedPoint = _vector.copy( point ).clamp( this.min, this.max );\n\n\t\treturn clampedPoint.sub( point ).length();\n\n\t}\n\n\tgetBoundingSphere( target ) {\n\n\t\tthis.getCenter( target.center );\n\n\t\ttarget.radius = this.getSize( _vector ).length() * 0.5;\n\n\t\treturn target;\n\n\t}\n\n\tintersect( box ) {\n\n\t\tthis.min.max( box.min );\n\t\tthis.max.min( box.max );\n\n\t\t// ensure that if there is no overlap, the result is fully empty, not slightly empty with non-inf/+inf values that will cause subsequence intersects to erroneously return valid values.\n\t\tif ( this.isEmpty() ) this.makeEmpty();\n\n\t\treturn this;\n\n\t}\n\n\tunion( box ) {\n\n\t\tthis.min.min( box.min );\n\t\tthis.max.max( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\t// transform of empty box is an empty box.\n\t\tif ( this.isEmpty() ) return this;\n\n\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\n\t\t_points[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\n\t\t_points[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\n\t\t_points[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\n\t\t_points[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\n\t\t_points[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\n\t\t_points[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\n\t\t_points[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\n\t\t_points[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 111\n\n\t\tthis.setFromPoints( _points );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.min.add( offset );\n\t\tthis.max.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\tequals( box ) {\n\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t}\n\n}\n\nBox3.prototype.isBox3 = true;\n\nconst _points = [\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3()\n];\n\nconst _vector = /*@__PURE__*/ new Vector3();\n\nconst _box = /*@__PURE__*/ new Box3();\n\n// triangle centered vertices\n\nconst _v0 = /*@__PURE__*/ new Vector3();\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _v2 = /*@__PURE__*/ new Vector3();\n\n// triangle edge vectors\n\nconst _f0 = /*@__PURE__*/ new Vector3();\nconst _f1 = /*@__PURE__*/ new Vector3();\nconst _f2 = /*@__PURE__*/ new Vector3();\n\nconst _center = /*@__PURE__*/ new Vector3();\nconst _extents = /*@__PURE__*/ new Vector3();\nconst _triangleNormal = /*@__PURE__*/ new Vector3();\nconst _testAxis = /*@__PURE__*/ new Vector3();\n\nfunction satForAxes( axes, v0, v1, v2, extents ) {\n\n\tfor ( let i = 0, j = axes.length - 3; i <= j; i += 3 ) {\n\n\t\t_testAxis.fromArray( axes, i );\n\t\t// project the aabb onto the separating axis\n\t\tconst r = extents.x * Math.abs( _testAxis.x ) + extents.y * Math.abs( _testAxis.y ) + extents.z * Math.abs( _testAxis.z );\n\t\t// project all 3 vertices of the triangle onto the separating axis\n\t\tconst p0 = v0.dot( _testAxis );\n\t\tconst p1 = v1.dot( _testAxis );\n\t\tconst p2 = v2.dot( _testAxis );\n\t\t// actual test, basically see if either of the most extreme of the triangle points intersects r\n\t\tif ( Math.max( - Math.max( p0, p1, p2 ), Math.min( p0, p1, p2 ) ) > r ) {\n\n\t\t\t// points of the projected triangle are outside the projected half-length of the aabb\n\t\t\t// the axis is separating and we can exit\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nexport { Box3 };\n", "import { Box3 } from './Box3.js';\nimport { Vector3 } from './Vector3.js';\n\nconst _box = /*@__PURE__*/ new Box3();\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _toFarthestPoint = /*@__PURE__*/ new Vector3();\nconst _toPoint = /*@__PURE__*/ new Vector3();\n\nclass Sphere {\n\n\tconstructor( center = new Vector3(), radius = - 1 ) {\n\n\t\tthis.center = center;\n\t\tthis.radius = radius;\n\n\t}\n\n\tset( center, radius ) {\n\n\t\tthis.center.copy( center );\n\t\tthis.radius = radius;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points, optionalCenter ) {\n\n\t\tconst center = this.center;\n\n\t\tif ( optionalCenter !== undefined ) {\n\n\t\t\tcenter.copy( optionalCenter );\n\n\t\t} else {\n\n\t\t\t_box.setFromPoints( points ).getCenter( center );\n\n\t\t}\n\n\t\tlet maxRadiusSq = 0;\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\n\n\t\t}\n\n\t\tthis.radius = Math.sqrt( maxRadiusSq );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( sphere ) {\n\n\t\tthis.center.copy( sphere.center );\n\t\tthis.radius = sphere.radius;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\treturn ( this.radius < 0 );\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.center.set( 0, 0, 0 );\n\t\tthis.radius = - 1;\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn ( point.distanceTo( this.center ) - this.radius );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\tconst radiusSum = this.radius + sphere.radius;\n\n\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsSphere( this );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\treturn Math.abs( plane.distanceToPoint( this.center ) ) <= this.radius;\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\tconst deltaLengthSq = this.center.distanceToSquared( point );\n\n\t\ttarget.copy( point );\n\n\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\ttarget.sub( this.center ).normalize();\n\t\t\ttarget.multiplyScalar( this.radius ).add( this.center );\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\tgetBoundingBox( target ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\t// Empty sphere produces empty bounding box\n\t\t\ttarget.makeEmpty();\n\t\t\treturn target;\n\n\t\t}\n\n\t\ttarget.set( this.center, this.center );\n\t\ttarget.expandByScalar( this.radius );\n\n\t\treturn target;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tthis.center.applyMatrix4( matrix );\n\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.center.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\t// from https://github.com/juj/MathGeoLib/blob/2940b99b99cfe575dd45103ef20f4019dee15b54/src/Geometry/Sphere.cpp#L649-L671\n\n\t\t_toPoint.subVectors( point, this.center );\n\n\t\tconst lengthSq = _toPoint.lengthSq();\n\n\t\tif ( lengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\tconst length = Math.sqrt( lengthSq );\n\t\t\tconst missingRadiusHalf = ( length - this.radius ) * 0.5;\n\n\t\t\t// Nudge this sphere towards the target point. Add half the missing distance to radius,\n\t\t\t// and the other half to position. This gives a tighter enclosure, instead of if\n\t\t\t// the whole missing distance were just added to radius.\n\n\t\t\tthis.center.add( _toPoint.multiplyScalar( missingRadiusHalf / length ) );\n\t\t\tthis.radius += missingRadiusHalf;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunion( sphere ) {\n\n\t\t// from https://github.com/juj/MathGeoLib/blob/2940b99b99cfe575dd45103ef20f4019dee15b54/src/Geometry/Sphere.cpp#L759-L769\n\n\t\t// To enclose another sphere into this sphere, we only need to enclose two points:\n\t\t// 1) Enclose the farthest point on the other sphere into this sphere.\n\t\t// 2) Enclose the opposite point of the farthest point into this sphere.\n\n\t\t if ( this.center.equals( sphere.center ) === true ) {\n\n\t\t\t _toFarthestPoint.set( 0, 0, 1 ).multiplyScalar( sphere.radius );\n\n\n\t\t} else {\n\n\t\t\t_toFarthestPoint.subVectors( sphere.center, this.center ).normalize().multiplyScalar( sphere.radius );\n\n\t\t}\n\n\t\tthis.expandByPoint( _v1.copy( sphere.center ).add( _toFarthestPoint ) );\n\t\tthis.expandByPoint( _v1.copy( sphere.center ).sub( _toFarthestPoint ) );\n\n\t\treturn this;\n\n\t}\n\n\tequals( sphere ) {\n\n\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nexport { Sphere };\n", "import { Vector3 } from './Vector3.js';\n\nconst _vector = /*@__PURE__*/ new Vector3();\nconst _segCenter = /*@__PURE__*/ new Vector3();\nconst _segDir = /*@__PURE__*/ new Vector3();\nconst _diff = /*@__PURE__*/ new Vector3();\n\nconst _edge1 = /*@__PURE__*/ new Vector3();\nconst _edge2 = /*@__PURE__*/ new Vector3();\nconst _normal = /*@__PURE__*/ new Vector3();\n\nclass Ray {\n\n\tconstructor( origin = new Vector3(), direction = new Vector3( 0, 0, - 1 ) ) {\n\n\t\tthis.origin = origin;\n\t\tthis.direction = direction;\n\n\t}\n\n\tset( origin, direction ) {\n\n\t\tthis.origin.copy( origin );\n\t\tthis.direction.copy( direction );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( ray ) {\n\n\t\tthis.origin.copy( ray.origin );\n\t\tthis.direction.copy( ray.direction );\n\n\t\treturn this;\n\n\t}\n\n\tat( t, target ) {\n\n\t\treturn target.copy( this.direction ).multiplyScalar( t ).add( this.origin );\n\n\t}\n\n\tlookAt( v ) {\n\n\t\tthis.direction.copy( v ).sub( this.origin ).normalize();\n\n\t\treturn this;\n\n\t}\n\n\trecast( t ) {\n\n\t\tthis.origin.copy( this.at( t, _vector ) );\n\n\t\treturn this;\n\n\t}\n\n\tclosestPointToPoint( point, target ) {\n\n\t\ttarget.subVectors( point, this.origin );\n\n\t\tconst directionDistance = target.dot( this.direction );\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn target.copy( this.origin );\n\n\t\t}\n\n\t\treturn target.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\n\n\t}\n\n\tdistanceSqToPoint( point ) {\n\n\t\tconst directionDistance = _vector.subVectors( point, this.origin ).dot( this.direction );\n\n\t\t// point behind the ray\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn this.origin.distanceToSquared( point );\n\n\t\t}\n\n\t\t_vector.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\n\n\t\treturn _vector.distanceToSquared( point );\n\n\t}\n\n\tdistanceSqToSegment( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\n\n\t\t// from https://github.com/pmjoniak/GeometricTools/blob/master/GTEngine/Include/Mathematics/GteDistRaySegment.h\n\t\t// It returns the min distance between the ray and the segment\n\t\t// defined by v0 and v1\n\t\t// It can also set two optional targets :\n\t\t// - The closest point on the ray\n\t\t// - The closest point on the segment\n\n\t\t_segCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\n\t\t_segDir.copy( v1 ).sub( v0 ).normalize();\n\t\t_diff.copy( this.origin ).sub( _segCenter );\n\n\t\tconst segExtent = v0.distanceTo( v1 ) * 0.5;\n\t\tconst a01 = - this.direction.dot( _segDir );\n\t\tconst b0 = _diff.dot( this.direction );\n\t\tconst b1 = - _diff.dot( _segDir );\n\t\tconst c = _diff.lengthSq();\n\t\tconst det = Math.abs( 1 - a01 * a01 );\n\t\tlet s0, s1, sqrDist, extDet;\n\n\t\tif ( det > 0 ) {\n\n\t\t\t// The ray and segment are not parallel.\n\n\t\t\ts0 = a01 * b1 - b0;\n\t\t\ts1 = a01 * b0 - b1;\n\t\t\textDet = segExtent * det;\n\n\t\t\tif ( s0 >= 0 ) {\n\n\t\t\t\tif ( s1 >= - extDet ) {\n\n\t\t\t\t\tif ( s1 <= extDet ) {\n\n\t\t\t\t\t\t// region 0\n\t\t\t\t\t\t// Minimum at interior points of ray and segment.\n\n\t\t\t\t\t\tconst invDet = 1 / det;\n\t\t\t\t\t\ts0 *= invDet;\n\t\t\t\t\t\ts1 *= invDet;\n\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// region 1\n\n\t\t\t\t\t\ts1 = segExtent;\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// region 5\n\n\t\t\t\t\ts1 = - segExtent;\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( s1 <= - extDet ) {\n\n\t\t\t\t\t// region 4\n\n\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\n\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t} else if ( s1 <= extDet ) {\n\n\t\t\t\t\t// region 3\n\n\t\t\t\t\ts0 = 0;\n\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// region 2\n\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\n\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// Ray and segment are parallel.\n\n\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\n\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t}\n\n\t\tif ( optionalPointOnRay ) {\n\n\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\n\n\t\t}\n\n\t\tif ( optionalPointOnSegment ) {\n\n\t\t\toptionalPointOnSegment.copy( _segDir ).multiplyScalar( s1 ).add( _segCenter );\n\n\t\t}\n\n\t\treturn sqrDist;\n\n\t}\n\n\tintersectSphere( sphere, target ) {\n\n\t\t_vector.subVectors( sphere.center, this.origin );\n\t\tconst tca = _vector.dot( this.direction );\n\t\tconst d2 = _vector.dot( _vector ) - tca * tca;\n\t\tconst radius2 = sphere.radius * sphere.radius;\n\n\t\tif ( d2 > radius2 ) return null;\n\n\t\tconst thc = Math.sqrt( radius2 - d2 );\n\n\t\t// t0 = first intersect point - entrance on front of sphere\n\t\tconst t0 = tca - thc;\n\n\t\t// t1 = second intersect point - exit point on back of sphere\n\t\tconst t1 = tca + thc;\n\n\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\n\t\tif ( t0 < 0 && t1 < 0 ) return null;\n\n\t\t// test to see if t0 is behind the ray:\n\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\n\t\t// in order to always return an intersect point that is in front of the ray.\n\t\tif ( t0 < 0 ) return this.at( t1, target );\n\n\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\n\t\treturn this.at( t0, target );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\treturn this.distanceSqToPoint( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t}\n\n\tdistanceToPlane( plane ) {\n\n\t\tconst denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\n\n\t\t\t\treturn 0;\n\n\t\t\t}\n\n\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\n\n\t\t// Return if the ray never intersects the plane\n\n\t\treturn t >= 0 ? t : null;\n\n\t}\n\n\tintersectPlane( plane, target ) {\n\n\t\tconst t = this.distanceToPlane( plane );\n\n\t\tif ( t === null ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn this.at( t, target );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\t// check if the ray lies on the plane first\n\n\t\tconst distToPoint = plane.distanceToPoint( this.origin );\n\n\t\tif ( distToPoint === 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tconst denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator * distToPoint < 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\t// ray origin is behind the plane (and is pointing behind it)\n\n\t\treturn false;\n\n\t}\n\n\tintersectBox( box, target ) {\n\n\t\tlet tmin, tmax, tymin, tymax, tzmin, tzmax;\n\n\t\tconst invdirx = 1 / this.direction.x,\n\t\t\tinvdiry = 1 / this.direction.y,\n\t\t\tinvdirz = 1 / this.direction.z;\n\n\t\tconst origin = this.origin;\n\n\t\tif ( invdirx >= 0 ) {\n\n\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\n\n\t\t} else {\n\n\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\n\n\t\t}\n\n\t\tif ( invdiry >= 0 ) {\n\n\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\n\n\t\t} else {\n\n\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\n\n\t\t}\n\n\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\n\n\t\t// These lines also handle the case where tmin or tmax is NaN\n\t\t// (result of 0 * Infinity). x !== x returns true if x is NaN\n\n\t\tif ( tymin > tmin || tmin !== tmin ) tmin = tymin;\n\n\t\tif ( tymax < tmax || tmax !== tmax ) tmax = tymax;\n\n\t\tif ( invdirz >= 0 ) {\n\n\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\n\n\t\t} else {\n\n\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\n\n\t\t}\n\n\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\n\n\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\n\n\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\n\n\t\t//return point closest to the ray (positive side)\n\n\t\tif ( tmax < 0 ) return null;\n\n\t\treturn this.at( tmin >= 0 ? tmin : tmax, target );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn this.intersectBox( box, _vector ) !== null;\n\n\t}\n\n\tintersectTriangle( a, b, c, backfaceCulling, target ) {\n\n\t\t// Compute the offset origin, edges, and normal.\n\n\t\t// from https://github.com/pmjoniak/GeometricTools/blob/master/GTEngine/Include/Mathematics/GteIntrRay3Triangle3.h\n\n\t\t_edge1.subVectors( b, a );\n\t\t_edge2.subVectors( c, a );\n\t\t_normal.crossVectors( _edge1, _edge2 );\n\n\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\n\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\n\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\n\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\n\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\n\t\tlet DdN = this.direction.dot( _normal );\n\t\tlet sign;\n\n\t\tif ( DdN > 0 ) {\n\n\t\t\tif ( backfaceCulling ) return null;\n\t\t\tsign = 1;\n\n\t\t} else if ( DdN < 0 ) {\n\n\t\t\tsign = - 1;\n\t\t\tDdN = - DdN;\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t_diff.subVectors( this.origin, a );\n\t\tconst DdQxE2 = sign * this.direction.dot( _edge2.crossVectors( _diff, _edge2 ) );\n\n\t\t// b1 < 0, no intersection\n\t\tif ( DdQxE2 < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst DdE1xQ = sign * this.direction.dot( _edge1.cross( _diff ) );\n\n\t\t// b2 < 0, no intersection\n\t\tif ( DdE1xQ < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// b1+b2 > 1, no intersection\n\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// Line intersects triangle, check if ray does.\n\t\tconst QdN = - sign * _diff.dot( _normal );\n\n\t\t// t < 0, no intersection\n\t\tif ( QdN < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// Ray intersects triangle.\n\t\treturn this.at( QdN / DdN, target );\n\n\t}\n\n\tapplyMatrix4( matrix4 ) {\n\n\t\tthis.origin.applyMatrix4( matrix4 );\n\t\tthis.direction.transformDirection( matrix4 );\n\n\t\treturn this;\n\n\t}\n\n\tequals( ray ) {\n\n\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nexport { Ray };\n", "import { Vector3 } from './Vector3.js';\n\nclass Matrix4 {\n\n\tconstructor() {\n\n\t\tthis.elements = [\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t];\n\n\t\tif ( arguments.length > 0 ) {\n\n\t\t\tconsole.error( 'THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.' );\n\n\t\t}\n\n\t}\n\n\tset( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\n\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\n\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\n\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Matrix4().fromArray( this.elements );\n\n\t}\n\n\tcopy( m ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ]; te[ 3 ] = me[ 3 ];\n\t\tte[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ]; te[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ];\n\t\tte[ 8 ] = me[ 8 ]; te[ 9 ] = me[ 9 ]; te[ 10 ] = me[ 10 ]; te[ 11 ] = me[ 11 ];\n\t\tte[ 12 ] = me[ 12 ]; te[ 13 ] = me[ 13 ]; te[ 14 ] = me[ 14 ]; te[ 15 ] = me[ 15 ];\n\n\t\treturn this;\n\n\t}\n\n\tcopyPosition( m ) {\n\n\t\tconst te = this.elements, me = m.elements;\n\n\t\tte[ 12 ] = me[ 12 ];\n\t\tte[ 13 ] = me[ 13 ];\n\t\tte[ 14 ] = me[ 14 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrix3( m ) {\n\n\t\tconst me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 3 ], me[ 6 ], 0,\n\t\t\tme[ 1 ], me[ 4 ], me[ 7 ], 0,\n\t\t\tme[ 2 ], me[ 5 ], me[ 8 ], 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\textractBasis( xAxis, yAxis, zAxis ) {\n\n\t\txAxis.setFromMatrixColumn( this, 0 );\n\t\tyAxis.setFromMatrixColumn( this, 1 );\n\t\tzAxis.setFromMatrixColumn( this, 2 );\n\n\t\treturn this;\n\n\t}\n\n\tmakeBasis( xAxis, yAxis, zAxis ) {\n\n\t\tthis.set(\n\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\n\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\n\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\n\t\t\t0, 0, 0, 1\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\textractRotation( m ) {\n\n\t\t// this method does not support reflection matrices\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tconst scaleX = 1 / _v1.setFromMatrixColumn( m, 0 ).length();\n\t\tconst scaleY = 1 / _v1.setFromMatrixColumn( m, 1 ).length();\n\t\tconst scaleZ = 1 / _v1.setFromMatrixColumn( m, 2 ).length();\n\n\t\tte[ 0 ] = me[ 0 ] * scaleX;\n\t\tte[ 1 ] = me[ 1 ] * scaleX;\n\t\tte[ 2 ] = me[ 2 ] * scaleX;\n\t\tte[ 3 ] = 0;\n\n\t\tte[ 4 ] = me[ 4 ] * scaleY;\n\t\tte[ 5 ] = me[ 5 ] * scaleY;\n\t\tte[ 6 ] = me[ 6 ] * scaleY;\n\t\tte[ 7 ] = 0;\n\n\t\tte[ 8 ] = me[ 8 ] * scaleZ;\n\t\tte[ 9 ] = me[ 9 ] * scaleZ;\n\t\tte[ 10 ] = me[ 10 ] * scaleZ;\n\t\tte[ 11 ] = 0;\n\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationFromEuler( euler ) {\n\n\t\tif ( ! ( euler && euler.isEuler ) ) {\n\n\t\t\tconsole.error( 'THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\n\n\t\t}\n\n\t\tconst te = this.elements;\n\n\t\tconst x = euler.x, y = euler.y, z = euler.z;\n\t\tconst a = Math.cos( x ), b = Math.sin( x );\n\t\tconst c = Math.cos( y ), d = Math.sin( y );\n\t\tconst e = Math.cos( z ), f = Math.sin( z );\n\n\t\tif ( euler.order === 'XYZ' ) {\n\n\t\t\tconst ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - c * f;\n\t\t\tte[ 8 ] = d;\n\n\t\t\tte[ 1 ] = af + be * d;\n\t\t\tte[ 5 ] = ae - bf * d;\n\t\t\tte[ 9 ] = - b * c;\n\n\t\t\tte[ 2 ] = bf - ae * d;\n\t\t\tte[ 6 ] = be + af * d;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YXZ' ) {\n\n\t\t\tconst ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce + df * b;\n\t\t\tte[ 4 ] = de * b - cf;\n\t\t\tte[ 8 ] = a * d;\n\n\t\t\tte[ 1 ] = a * f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b;\n\n\t\t\tte[ 2 ] = cf * b - de;\n\t\t\tte[ 6 ] = df + ce * b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZXY' ) {\n\n\t\t\tconst ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce - df * b;\n\t\t\tte[ 4 ] = - a * f;\n\t\t\tte[ 8 ] = de + cf * b;\n\n\t\t\tte[ 1 ] = cf + de * b;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = df - ce * b;\n\n\t\t\tte[ 2 ] = - a * d;\n\t\t\tte[ 6 ] = b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZYX' ) {\n\n\t\t\tconst ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = be * d - af;\n\t\t\tte[ 8 ] = ae * d + bf;\n\n\t\t\tte[ 1 ] = c * f;\n\t\t\tte[ 5 ] = bf * d + ae;\n\t\t\tte[ 9 ] = af * d - be;\n\n\t\t\tte[ 2 ] = - d;\n\t\t\tte[ 6 ] = b * c;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YZX' ) {\n\n\t\t\tconst ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = bd - ac * f;\n\t\t\tte[ 8 ] = bc * f + ad;\n\n\t\t\tte[ 1 ] = f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b * e;\n\n\t\t\tte[ 2 ] = - d * e;\n\t\t\tte[ 6 ] = ad * f + bc;\n\t\t\tte[ 10 ] = ac - bd * f;\n\n\t\t} else if ( euler.order === 'XZY' ) {\n\n\t\t\tconst ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - f;\n\t\t\tte[ 8 ] = d * e;\n\n\t\t\tte[ 1 ] = ac * f + bd;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = ad * f - bc;\n\n\t\t\tte[ 2 ] = bc * f - ad;\n\t\t\tte[ 6 ] = b * e;\n\t\t\tte[ 10 ] = bd * f + ac;\n\n\t\t}\n\n\t\t// bottom row\n\t\tte[ 3 ] = 0;\n\t\tte[ 7 ] = 0;\n\t\tte[ 11 ] = 0;\n\n\t\t// last column\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationFromQuaternion( q ) {\n\n\t\treturn this.compose( _zero, q, _one );\n\n\t}\n\n\tlookAt( eye, target, up ) {\n\n\t\tconst te = this.elements;\n\n\t\t_z.subVectors( eye, target );\n\n\t\tif ( _z.lengthSq() === 0 ) {\n\n\t\t\t// eye and target are in the same position\n\n\t\t\t_z.z = 1;\n\n\t\t}\n\n\t\t_z.normalize();\n\t\t_x.crossVectors( up, _z );\n\n\t\tif ( _x.lengthSq() === 0 ) {\n\n\t\t\t// up and z are parallel\n\n\t\t\tif ( Math.abs( up.z ) === 1 ) {\n\n\t\t\t\t_z.x += 0.0001;\n\n\t\t\t} else {\n\n\t\t\t\t_z.z += 0.0001;\n\n\t\t\t}\n\n\t\t\t_z.normalize();\n\t\t\t_x.crossVectors( up, _z );\n\n\t\t}\n\n\t\t_x.normalize();\n\t\t_y.crossVectors( _z, _x );\n\n\t\tte[ 0 ] = _x.x; te[ 4 ] = _y.x; te[ 8 ] = _z.x;\n\t\tte[ 1 ] = _x.y; te[ 5 ] = _y.y; te[ 9 ] = _z.y;\n\t\tte[ 2 ] = _x.z; te[ 6 ] = _y.z; te[ 10 ] = _z.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( m, n ) {\n\n\t\tif ( n !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\n\t\t\treturn this.multiplyMatrices( m, n );\n\n\t\t}\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t}\n\n\tpremultiply( m ) {\n\n\t\treturn this.multiplyMatrices( m, this );\n\n\t}\n\n\tmultiplyMatrices( a, b ) {\n\n\t\tconst ae = a.elements;\n\t\tconst be = b.elements;\n\t\tconst te = this.elements;\n\n\t\tconst a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\n\t\tconst a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\n\t\tconst a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\n\t\tconst a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\n\n\t\tconst b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\n\t\tconst b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\n\t\tconst b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\n\t\tconst b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\n\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\n\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\n\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\n\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\n\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\n\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\n\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\n\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\n\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\n\n\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\n\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\n\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\n\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\n\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\n\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\n\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\n\n\t\treturn this;\n\n\t}\n\n\tdeterminant() {\n\n\t\tconst te = this.elements;\n\n\t\tconst n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\n\t\tconst n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\n\t\tconst n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\n\t\tconst n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\n\n\t\t//TODO: make this more efficient\n\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\n\n\t\treturn (\n\t\t\tn41 * (\n\t\t\t\t+ n14 * n23 * n32\n\t\t\t\t - n13 * n24 * n32\n\t\t\t\t - n14 * n22 * n33\n\t\t\t\t + n12 * n24 * n33\n\t\t\t\t + n13 * n22 * n34\n\t\t\t\t - n12 * n23 * n34\n\t\t\t) +\n\t\t\tn42 * (\n\t\t\t\t+ n11 * n23 * n34\n\t\t\t\t - n11 * n24 * n33\n\t\t\t\t + n14 * n21 * n33\n\t\t\t\t - n13 * n21 * n34\n\t\t\t\t + n13 * n24 * n31\n\t\t\t\t - n14 * n23 * n31\n\t\t\t) +\n\t\t\tn43 * (\n\t\t\t\t+ n11 * n24 * n32\n\t\t\t\t - n11 * n22 * n34\n\t\t\t\t - n14 * n21 * n32\n\t\t\t\t + n12 * n21 * n34\n\t\t\t\t + n14 * n22 * n31\n\t\t\t\t - n12 * n24 * n31\n\t\t\t) +\n\t\t\tn44 * (\n\t\t\t\t- n13 * n22 * n31\n\t\t\t\t - n11 * n23 * n32\n\t\t\t\t + n11 * n22 * n33\n\t\t\t\t + n13 * n21 * n32\n\t\t\t\t - n12 * n21 * n33\n\t\t\t\t + n12 * n23 * n31\n\t\t\t)\n\n\t\t);\n\n\t}\n\n\ttranspose() {\n\n\t\tconst te = this.elements;\n\t\tlet tmp;\n\n\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\n\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\n\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\n\n\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\n\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\n\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\n\n\t\treturn this;\n\n\t}\n\n\tsetPosition( x, y, z ) {\n\n\t\tconst te = this.elements;\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\tte[ 12 ] = x.x;\n\t\t\tte[ 13 ] = x.y;\n\t\t\tte[ 14 ] = x.z;\n\n\t\t} else {\n\n\t\t\tte[ 12 ] = x;\n\t\t\tte[ 13 ] = y;\n\t\t\tte[ 14 ] = z;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tinvert() {\n\n\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\n\t\tconst te = this.elements,\n\n\t\t\tn11 = te[ 0 ], n21 = te[ 1 ], n31 = te[ 2 ], n41 = te[ 3 ],\n\t\t\tn12 = te[ 4 ], n22 = te[ 5 ], n32 = te[ 6 ], n42 = te[ 7 ],\n\t\t\tn13 = te[ 8 ], n23 = te[ 9 ], n33 = te[ 10 ], n43 = te[ 11 ],\n\t\t\tn14 = te[ 12 ], n24 = te[ 13 ], n34 = te[ 14 ], n44 = te[ 15 ],\n\n\t\t\tt11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\n\t\t\tt12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\n\t\t\tt13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\n\t\t\tt14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\n\n\t\tconst det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\n\n\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );\n\n\t\tconst detInv = 1 / det;\n\n\t\tte[ 0 ] = t11 * detInv;\n\t\tte[ 1 ] = ( n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44 ) * detInv;\n\t\tte[ 2 ] = ( n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44 ) * detInv;\n\t\tte[ 3 ] = ( n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43 ) * detInv;\n\n\t\tte[ 4 ] = t12 * detInv;\n\t\tte[ 5 ] = ( n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44 ) * detInv;\n\t\tte[ 6 ] = ( n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44 ) * detInv;\n\t\tte[ 7 ] = ( n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43 ) * detInv;\n\n\t\tte[ 8 ] = t13 * detInv;\n\t\tte[ 9 ] = ( n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44 ) * detInv;\n\t\tte[ 10 ] = ( n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44 ) * detInv;\n\t\tte[ 11 ] = ( n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43 ) * detInv;\n\n\t\tte[ 12 ] = t14 * detInv;\n\t\tte[ 13 ] = ( n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34 ) * detInv;\n\t\tte[ 14 ] = ( n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34 ) * detInv;\n\t\tte[ 15 ] = ( n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33 ) * detInv;\n\n\t\treturn this;\n\n\t}\n\n\tscale( v ) {\n\n\t\tconst te = this.elements;\n\t\tconst x = v.x, y = v.y, z = v.z;\n\n\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\n\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\n\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\n\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\n\n\t\treturn this;\n\n\t}\n\n\tgetMaxScaleOnAxis() {\n\n\t\tconst te = this.elements;\n\n\t\tconst scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\n\t\tconst scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\n\t\tconst scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\n\n\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\n\n\t}\n\n\tmakeTranslation( x, y, z ) {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, x,\n\t\t\t0, 1, 0, y,\n\t\t\t0, 0, 1, z,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationX( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, c, - s, 0,\n\t\t\t0, s, c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationY( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t c, 0, s, 0,\n\t\t\t 0, 1, 0, 0,\n\t\t\t- s, 0, c, 0,\n\t\t\t 0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationZ( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\tc, - s, 0, 0,\n\t\t\ts, c, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationAxis( axis, angle ) {\n\n\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\n\n\t\tconst c = Math.cos( angle );\n\t\tconst s = Math.sin( angle );\n\t\tconst t = 1 - c;\n\t\tconst x = axis.x, y = axis.y, z = axis.z;\n\t\tconst tx = t * x, ty = t * y;\n\n\t\tthis.set(\n\n\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\n\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\n\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeScale( x, y, z ) {\n\n\t\tthis.set(\n\n\t\t\tx, 0, 0, 0,\n\t\t\t0, y, 0, 0,\n\t\t\t0, 0, z, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeShear( xy, xz, yx, yz, zx, zy ) {\n\n\t\tthis.set(\n\n\t\t\t1, yx, zx, 0,\n\t\t\txy, 1, zy, 0,\n\t\t\txz, yz, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tcompose( position, quaternion, scale ) {\n\n\t\tconst te = this.elements;\n\n\t\tconst x = quaternion._x, y = quaternion._y, z = quaternion._z, w = quaternion._w;\n\t\tconst x2 = x + x,\ty2 = y + y, z2 = z + z;\n\t\tconst xx = x * x2, xy = x * y2, xz = x * z2;\n\t\tconst yy = y * y2, yz = y * z2, zz = z * z2;\n\t\tconst wx = w * x2, wy = w * y2, wz = w * z2;\n\n\t\tconst sx = scale.x, sy = scale.y, sz = scale.z;\n\n\t\tte[ 0 ] = ( 1 - ( yy + zz ) ) * sx;\n\t\tte[ 1 ] = ( xy + wz ) * sx;\n\t\tte[ 2 ] = ( xz - wy ) * sx;\n\t\tte[ 3 ] = 0;\n\n\t\tte[ 4 ] = ( xy - wz ) * sy;\n\t\tte[ 5 ] = ( 1 - ( xx + zz ) ) * sy;\n\t\tte[ 6 ] = ( yz + wx ) * sy;\n\t\tte[ 7 ] = 0;\n\n\t\tte[ 8 ] = ( xz + wy ) * sz;\n\t\tte[ 9 ] = ( yz - wx ) * sz;\n\t\tte[ 10 ] = ( 1 - ( xx + yy ) ) * sz;\n\t\tte[ 11 ] = 0;\n\n\t\tte[ 12 ] = position.x;\n\t\tte[ 13 ] = position.y;\n\t\tte[ 14 ] = position.z;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tdecompose( position, quaternion, scale ) {\n\n\t\tconst te = this.elements;\n\n\t\tlet sx = _v1.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\n\t\tconst sy = _v1.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\n\t\tconst sz = _v1.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\n\n\t\t// if determine is negative, we need to invert one scale\n\t\tconst det = this.determinant();\n\t\tif ( det < 0 ) sx = - sx;\n\n\t\tposition.x = te[ 12 ];\n\t\tposition.y = te[ 13 ];\n\t\tposition.z = te[ 14 ];\n\n\t\t// scale the rotation part\n\t\t_m1.copy( this );\n\n\t\tconst invSX = 1 / sx;\n\t\tconst invSY = 1 / sy;\n\t\tconst invSZ = 1 / sz;\n\n\t\t_m1.elements[ 0 ] *= invSX;\n\t\t_m1.elements[ 1 ] *= invSX;\n\t\t_m1.elements[ 2 ] *= invSX;\n\n\t\t_m1.elements[ 4 ] *= invSY;\n\t\t_m1.elements[ 5 ] *= invSY;\n\t\t_m1.elements[ 6 ] *= invSY;\n\n\t\t_m1.elements[ 8 ] *= invSZ;\n\t\t_m1.elements[ 9 ] *= invSZ;\n\t\t_m1.elements[ 10 ] *= invSZ;\n\n\t\tquaternion.setFromRotationMatrix( _m1 );\n\n\t\tscale.x = sx;\n\t\tscale.y = sy;\n\t\tscale.z = sz;\n\n\t\treturn this;\n\n\t}\n\n\tmakePerspective( left, right, top, bottom, near, far ) {\n\n\t\tif ( far === undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.' );\n\n\t\t}\n\n\t\tconst te = this.elements;\n\t\tconst x = 2 * near / ( right - left );\n\t\tconst y = 2 * near / ( top - bottom );\n\n\t\tconst a = ( right + left ) / ( right - left );\n\t\tconst b = ( top + bottom ) / ( top - bottom );\n\t\tconst c = - ( far + near ) / ( far - near );\n\t\tconst d = - 2 * far * near / ( far - near );\n\n\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\n\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\n\n\t\treturn this;\n\n\t}\n\n\tmakeOrthographic( left, right, top, bottom, near, far ) {\n\n\t\tconst te = this.elements;\n\t\tconst w = 1.0 / ( right - left );\n\t\tconst h = 1.0 / ( top - bottom );\n\t\tconst p = 1.0 / ( far - near );\n\n\t\tconst x = ( right + left ) * w;\n\t\tconst y = ( top + bottom ) * h;\n\t\tconst z = ( far + near ) * p;\n\n\t\tte[ 0 ] = 2 * w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\n\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 * h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 * p;\tte[ 14 ] = - z;\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tequals( matrix ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = matrix.elements;\n\n\t\tfor ( let i = 0; i < 16; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 16; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\n\t\tarray[ offset + 8 ] = te[ 8 ];\n\t\tarray[ offset + 9 ] = te[ 9 ];\n\t\tarray[ offset + 10 ] = te[ 10 ];\n\t\tarray[ offset + 11 ] = te[ 11 ];\n\n\t\tarray[ offset + 12 ] = te[ 12 ];\n\t\tarray[ offset + 13 ] = te[ 13 ];\n\t\tarray[ offset + 14 ] = te[ 14 ];\n\t\tarray[ offset + 15 ] = te[ 15 ];\n\n\t\treturn array;\n\n\t}\n\n}\n\nMatrix4.prototype.isMatrix4 = true;\n\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _m1 = /*@__PURE__*/ new Matrix4();\nconst _zero = /*@__PURE__*/ new Vector3( 0, 0, 0 );\nconst _one = /*@__PURE__*/ new Vector3( 1, 1, 1 );\nconst _x = /*@__PURE__*/ new Vector3();\nconst _y = /*@__PURE__*/ new Vector3();\nconst _z = /*@__PURE__*/ new Vector3();\n\nexport { Matrix4 };\n", "import { Quaternion } from './Quaternion.js';\nimport { Matrix4 } from './Matrix4.js';\nimport { clamp } from './MathUtils.js';\n\nconst _matrix = /*@__PURE__*/ new Matrix4();\nconst _quaternion = /*@__PURE__*/ new Quaternion();\n\nclass Euler {\n\n\tconstructor( x = 0, y = 0, z = 0, order = Euler.DefaultOrder ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget order() {\n\n\t\treturn this._order;\n\n\t}\n\n\tset order( value ) {\n\n\t\tthis._order = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, order = this._order ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._order );\n\n\t}\n\n\tcopy( euler ) {\n\n\t\tthis._x = euler._x;\n\t\tthis._y = euler._y;\n\t\tthis._z = euler._z;\n\t\tthis._order = euler._order;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m, order = this._order, update = true ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements;\n\t\tconst m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\n\t\tconst m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\n\t\tconst m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\n\t\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m13 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\n\t\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m23 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\n\t\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m32 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = 0;\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\n\t\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m31 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\n\t\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m21 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m22 );\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\n\t\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m12 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._y = Math.atan2( m13, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._y = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tthis._order = order;\n\n\t\tif ( update === true ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromQuaternion( q, order, update ) {\n\n\t\t_matrix.makeRotationFromQuaternion( q );\n\n\t\treturn this.setFromRotationMatrix( _matrix, order, update );\n\n\t}\n\n\tsetFromVector3( v, order = this._order ) {\n\n\t\treturn this.set( v.x, v.y, v.z, order );\n\n\t}\n\n\treorder( newOrder ) {\n\n\t\t// WARNING: this discards revolution information -bhouston\n\n\t\t_quaternion.setFromEuler( this );\n\n\t\treturn this.setFromQuaternion( _quaternion, newOrder );\n\n\t}\n\n\tequals( euler ) {\n\n\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\n\n\t}\n\n\tfromArray( array ) {\n\n\t\tthis._x = array[ 0 ];\n\t\tthis._y = array[ 1 ];\n\t\tthis._z = array[ 2 ];\n\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._order;\n\n\t\treturn array;\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n}\n\nEuler.prototype.isEuler = true;\n\nEuler.DefaultOrder = 'XYZ';\nEuler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\n\nexport { Euler };\n", "class Layers {\n\n\tconstructor() {\n\n\t\tthis.mask = 1 | 0;\n\n\t}\n\n\tset( channel ) {\n\n\t\tthis.mask = ( 1 << channel | 0 ) >>> 0;\n\n\t}\n\n\tenable( channel ) {\n\n\t\tthis.mask |= 1 << channel | 0;\n\n\t}\n\n\tenableAll() {\n\n\t\tthis.mask = 0xffffffff | 0;\n\n\t}\n\n\ttoggle( channel ) {\n\n\t\tthis.mask ^= 1 << channel | 0;\n\n\t}\n\n\tdisable( channel ) {\n\n\t\tthis.mask &= ~ ( 1 << channel | 0 );\n\n\t}\n\n\tdisableAll() {\n\n\t\tthis.mask = 0;\n\n\t}\n\n\ttest( layers ) {\n\n\t\treturn ( this.mask & layers.mask ) !== 0;\n\n\t}\n\n\tisEnabled( channel ) {\n\n\t\treturn ( this.mask & ( 1 << channel | 0 ) ) !== 0;\n\n\t}\n\n}\n\n\nexport { Layers };\n", "import { Quaternion } from '../math/Quaternion.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { EventDispatcher } from './EventDispatcher.js';\nimport { Euler } from '../math/Euler.js';\nimport { Layers } from './Layers.js';\nimport { Matrix3 } from '../math/Matrix3.js';\nimport * as MathUtils from '../math/MathUtils.js';\n\nlet _object3DId = 0;\n\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _q1 = /*@__PURE__*/ new Quaternion();\nconst _m1 = /*@__PURE__*/ new Matrix4();\nconst _target = /*@__PURE__*/ new Vector3();\n\nconst _position = /*@__PURE__*/ new Vector3();\nconst _scale = /*@__PURE__*/ new Vector3();\nconst _quaternion = /*@__PURE__*/ new Quaternion();\n\nconst _xAxis = /*@__PURE__*/ new Vector3( 1, 0, 0 );\nconst _yAxis = /*@__PURE__*/ new Vector3( 0, 1, 0 );\nconst _zAxis = /*@__PURE__*/ new Vector3( 0, 0, 1 );\n\nconst _addedEvent = { type: 'added' };\nconst _removedEvent = { type: 'removed' };\n\nclass Object3D extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tObject.defineProperty( this, 'id', { value: _object3DId ++ } );\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Object3D';\n\n\t\tthis.parent = null;\n\t\tthis.children = [];\n\n\t\tthis.up = Object3D.DefaultUp.clone();\n\n\t\tconst position = new Vector3();\n\t\tconst rotation = new Euler();\n\t\tconst quaternion = new Quaternion();\n\t\tconst scale = new Vector3( 1, 1, 1 );\n\n\t\tfunction onRotationChange() {\n\n\t\t\tquaternion.setFromEuler( rotation, false );\n\n\t\t}\n\n\t\tfunction onQuaternionChange() {\n\n\t\t\trotation.setFromQuaternion( quaternion, undefined, false );\n\n\t\t}\n\n\t\trotation._onChange( onRotationChange );\n\t\tquaternion._onChange( onQuaternionChange );\n\n\t\tObject.defineProperties( this, {\n\t\t\tposition: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: position\n\t\t\t},\n\t\t\trotation: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: rotation\n\t\t\t},\n\t\t\tquaternion: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: quaternion\n\t\t\t},\n\t\t\tscale: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: scale\n\t\t\t},\n\t\t\tmodelViewMatrix: {\n\t\t\t\tvalue: new Matrix4()\n\t\t\t},\n\t\t\tnormalMatrix: {\n\t\t\t\tvalue: new Matrix3()\n\t\t\t}\n\t\t} );\n\n\t\tthis.matrix = new Matrix4();\n\t\tthis.matrixWorld = new Matrix4();\n\n\t\tthis.matrixAutoUpdate = Object3D.DefaultMatrixAutoUpdate;\n\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\tthis.layers = new Layers();\n\t\tthis.visible = true;\n\n\t\tthis.castShadow = false;\n\t\tthis.receiveShadow = false;\n\n\t\tthis.frustumCulled = true;\n\t\tthis.renderOrder = 0;\n\n\t\tthis.animations = [];\n\n\t\tthis.userData = {};\n\n\t}\n\n\tonBeforeRender( /* renderer, scene, camera, geometry, material, group */ ) {}\n\n\tonAfterRender( /* renderer, scene, camera, geometry, material, group */ ) {}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tthis.matrix.premultiply( matrix );\n\n\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\tthis.quaternion.premultiply( q );\n\n\t\treturn this;\n\n\t}\n\n\tsetRotationFromAxisAngle( axis, angle ) {\n\n\t\t// assumes axis is normalized\n\n\t\tthis.quaternion.setFromAxisAngle( axis, angle );\n\n\t}\n\n\tsetRotationFromEuler( euler ) {\n\n\t\tthis.quaternion.setFromEuler( euler, true );\n\n\t}\n\n\tsetRotationFromMatrix( m ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tthis.quaternion.setFromRotationMatrix( m );\n\n\t}\n\n\tsetRotationFromQuaternion( q ) {\n\n\t\t// assumes q is normalized\n\n\t\tthis.quaternion.copy( q );\n\n\t}\n\n\trotateOnAxis( axis, angle ) {\n\n\t\t// rotate object on axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\t_q1.setFromAxisAngle( axis, angle );\n\n\t\tthis.quaternion.multiply( _q1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateOnWorldAxis( axis, angle ) {\n\n\t\t// rotate object on axis in world space\n\t\t// axis is assumed to be normalized\n\t\t// method assumes no rotated parent\n\n\t\t_q1.setFromAxisAngle( axis, angle );\n\n\t\tthis.quaternion.premultiply( _q1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\treturn this.rotateOnAxis( _xAxis, angle );\n\n\t}\n\n\trotateY( angle ) {\n\n\t\treturn this.rotateOnAxis( _yAxis, angle );\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\treturn this.rotateOnAxis( _zAxis, angle );\n\n\t}\n\n\ttranslateOnAxis( axis, distance ) {\n\n\t\t// translate object by distance along axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\t_v1.copy( axis ).applyQuaternion( this.quaternion );\n\n\t\tthis.position.add( _v1.multiplyScalar( distance ) );\n\n\t\treturn this;\n\n\t}\n\n\ttranslateX( distance ) {\n\n\t\treturn this.translateOnAxis( _xAxis, distance );\n\n\t}\n\n\ttranslateY( distance ) {\n\n\t\treturn this.translateOnAxis( _yAxis, distance );\n\n\t}\n\n\ttranslateZ( distance ) {\n\n\t\treturn this.translateOnAxis( _zAxis, distance );\n\n\t}\n\n\tlocalToWorld( vector ) {\n\n\t\treturn vector.applyMatrix4( this.matrixWorld );\n\n\t}\n\n\tworldToLocal( vector ) {\n\n\t\treturn vector.applyMatrix4( _m1.copy( this.matrixWorld ).invert() );\n\n\t}\n\n\tlookAt( x, y, z ) {\n\n\t\t// This method does not support objects having non-uniformly-scaled parent(s)\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\t_target.copy( x );\n\n\t\t} else {\n\n\t\t\t_target.set( x, y, z );\n\n\t\t}\n\n\t\tconst parent = this.parent;\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\t_position.setFromMatrixPosition( this.matrixWorld );\n\n\t\tif ( this.isCamera || this.isLight ) {\n\n\t\t\t_m1.lookAt( _position, _target, this.up );\n\n\t\t} else {\n\n\t\t\t_m1.lookAt( _target, _position, this.up );\n\n\t\t}\n\n\t\tthis.quaternion.setFromRotationMatrix( _m1 );\n\n\t\tif ( parent ) {\n\n\t\t\t_m1.extractRotation( parent.matrixWorld );\n\t\t\t_q1.setFromRotationMatrix( _m1 );\n\t\t\tthis.quaternion.premultiply( _q1.invert() );\n\n\t\t}\n\n\t}\n\n\tadd( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.add( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object === this ) {\n\n\t\t\tconsole.error( 'THREE.Object3D.add: object can\\'t be added as a child of itself.', object );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object && object.isObject3D ) {\n\n\t\t\tif ( object.parent !== null ) {\n\n\t\t\t\tobject.parent.remove( object );\n\n\t\t\t}\n\n\t\t\tobject.parent = this;\n\t\t\tthis.children.push( object );\n\n\t\t\tobject.dispatchEvent( _addedEvent );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Object3D.add: object not an instance of THREE.Object3D.', object );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremove( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.remove( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst index = this.children.indexOf( object );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tobject.parent = null;\n\t\t\tthis.children.splice( index, 1 );\n\n\t\t\tobject.dispatchEvent( _removedEvent );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremoveFromParent() {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tparent.remove( this );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclear() {\n\n\t\tfor ( let i = 0; i < this.children.length; i ++ ) {\n\n\t\t\tconst object = this.children[ i ];\n\n\t\t\tobject.parent = null;\n\n\t\t\tobject.dispatchEvent( _removedEvent );\n\n\t\t}\n\n\t\tthis.children.length = 0;\n\n\t\treturn this;\n\n\n\t}\n\n\tattach( object ) {\n\n\t\t// adds object as a child of this, while maintaining the object's world transform\n\n\t\t// Note: This method does not support scene graphs having non-uniformly-scaled nodes(s)\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\t_m1.copy( this.matrixWorld ).invert();\n\n\t\tif ( object.parent !== null ) {\n\n\t\t\tobject.parent.updateWorldMatrix( true, false );\n\n\t\t\t_m1.multiply( object.parent.matrixWorld );\n\n\t\t}\n\n\t\tobject.applyMatrix4( _m1 );\n\n\t\tthis.add( object );\n\n\t\tobject.updateWorldMatrix( false, true );\n\n\t\treturn this;\n\n\t}\n\n\tgetObjectById( id ) {\n\n\t\treturn this.getObjectByProperty( 'id', id );\n\n\t}\n\n\tgetObjectByName( name ) {\n\n\t\treturn this.getObjectByProperty( 'name', name );\n\n\t}\n\n\tgetObjectByProperty( name, value ) {\n\n\t\tif ( this[ name ] === value ) return this;\n\n\t\tfor ( let i = 0, l = this.children.length; i < l; i ++ ) {\n\n\t\t\tconst child = this.children[ i ];\n\t\t\tconst object = child.getObjectByProperty( name, value );\n\n\t\t\tif ( object !== undefined ) {\n\n\t\t\t\treturn object;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\tgetWorldPosition( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\treturn target.setFromMatrixPosition( this.matrixWorld );\n\n\t}\n\n\tgetWorldQuaternion( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tthis.matrixWorld.decompose( _position, target, _scale );\n\n\t\treturn target;\n\n\t}\n\n\tgetWorldScale( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tthis.matrixWorld.decompose( _position, _quaternion, target );\n\n\t\treturn target;\n\n\t}\n\n\tgetWorldDirection( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tconst e = this.matrixWorld.elements;\n\n\t\treturn target.set( e[ 8 ], e[ 9 ], e[ 10 ] ).normalize();\n\n\t}\n\n\traycast( /* raycaster, intersects */ ) {}\n\n\ttraverse( callback ) {\n\n\t\tcallback( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverse( callback );\n\n\t\t}\n\n\t}\n\n\ttraverseVisible( callback ) {\n\n\t\tif ( this.visible === false ) return;\n\n\t\tcallback( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverseVisible( callback );\n\n\t\t}\n\n\t}\n\n\ttraverseAncestors( callback ) {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tcallback( parent );\n\n\t\t\tparent.traverseAncestors( callback );\n\n\t\t}\n\n\t}\n\n\tupdateMatrix() {\n\n\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\n\n\t\tthis.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tif ( this.matrixWorldNeedsUpdate || force ) {\n\n\t\t\tif ( this.parent === null ) {\n\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t\t} else {\n\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t\t}\n\n\t\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\t\tforce = true;\n\n\t\t}\n\n\t\t// update children\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].updateMatrixWorld( force );\n\n\t\t}\n\n\t}\n\n\tupdateWorldMatrix( updateParents, updateChildren ) {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( updateParents === true && parent !== null ) {\n\n\t\t\tparent.updateWorldMatrix( true, false );\n\n\t\t}\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tif ( this.parent === null ) {\n\n\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t} else {\n\n\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t}\n\n\t\t// update children\n\n\t\tif ( updateChildren === true ) {\n\n\t\t\tconst children = this.children;\n\n\t\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tchildren[ i ].updateWorldMatrix( false, true );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\t// meta is a string when called from JSON.stringify\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tconst output = {};\n\n\t\t// meta is a hash used to collect geometries, materials.\n\t\t// not providing it implies that this is the root object\n\t\t// being serialized.\n\t\tif ( isRootObject ) {\n\n\t\t\t// initialize meta obj\n\t\t\tmeta = {\n\t\t\t\tgeometries: {},\n\t\t\t\tmaterials: {},\n\t\t\t\ttextures: {},\n\t\t\t\timages: {},\n\t\t\t\tshapes: {},\n\t\t\t\tskeletons: {},\n\t\t\t\tanimations: {},\n\t\t\t\tnodes: {}\n\t\t\t};\n\n\t\t\toutput.metadata = {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Object',\n\t\t\t\tgenerator: 'Object3D.toJSON'\n\t\t\t};\n\n\t\t}\n\n\t\t// standard Object3D serialization\n\n\t\tconst object = {};\n\n\t\tobject.uuid = this.uuid;\n\t\tobject.type = this.type;\n\n\t\tif ( this.name !== '' ) object.name = this.name;\n\t\tif ( this.castShadow === true ) object.castShadow = true;\n\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\n\t\tif ( this.visible === false ) object.visible = false;\n\t\tif ( this.frustumCulled === false ) object.frustumCulled = false;\n\t\tif ( this.renderOrder !== 0 ) object.renderOrder = this.renderOrder;\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) object.userData = this.userData;\n\n\t\tobject.layers = this.layers.mask;\n\t\tobject.matrix = this.matrix.toArray();\n\n\t\tif ( this.matrixAutoUpdate === false ) object.matrixAutoUpdate = false;\n\n\t\t// object specific properties\n\n\t\tif ( this.isInstancedMesh ) {\n\n\t\t\tobject.type = 'InstancedMesh';\n\t\t\tobject.count = this.count;\n\t\t\tobject.instanceMatrix = this.instanceMatrix.toJSON();\n\t\t\tif ( this.instanceColor !== null ) object.instanceColor = this.instanceColor.toJSON();\n\n\t\t}\n\n\t\t//\n\n\t\tfunction serialize( library, element ) {\n\n\t\t\tif ( library[ element.uuid ] === undefined ) {\n\n\t\t\t\tlibrary[ element.uuid ] = element.toJSON( meta );\n\n\t\t\t}\n\n\t\t\treturn element.uuid;\n\n\t\t}\n\n\t\tif ( this.isScene ) {\n\n\t\t\tif ( this.background ) {\n\n\t\t\t\tif ( this.background.isColor ) {\n\n\t\t\t\t\tobject.background = this.background.toJSON();\n\n\t\t\t\t} else if ( this.background.isTexture ) {\n\n\t\t\t\t\tobject.background = this.background.toJSON( meta ).uuid;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.environment && this.environment.isTexture ) {\n\n\t\t\t\tobject.environment = this.environment.toJSON( meta ).uuid;\n\n\t\t\t}\n\n\t\t} else if ( this.isMesh || this.isLine || this.isPoints ) {\n\n\t\t\tobject.geometry = serialize( meta.geometries, this.geometry );\n\n\t\t\tconst parameters = this.geometry.parameters;\n\n\t\t\tif ( parameters !== undefined && parameters.shapes !== undefined ) {\n\n\t\t\t\tconst shapes = parameters.shapes;\n\n\t\t\t\tif ( Array.isArray( shapes ) ) {\n\n\t\t\t\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\t\t\t\tconst shape = shapes[ i ];\n\n\t\t\t\t\t\tserialize( meta.shapes, shape );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tserialize( meta.shapes, shapes );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.isSkinnedMesh ) {\n\n\t\t\tobject.bindMode = this.bindMode;\n\t\t\tobject.bindMatrix = this.bindMatrix.toArray();\n\n\t\t\tif ( this.skeleton !== undefined ) {\n\n\t\t\t\tserialize( meta.skeletons, this.skeleton );\n\n\t\t\t\tobject.skeleton = this.skeleton.uuid;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.material !== undefined ) {\n\n\t\t\tif ( Array.isArray( this.material ) ) {\n\n\t\t\t\tconst uuids = [];\n\n\t\t\t\tfor ( let i = 0, l = this.material.length; i < l; i ++ ) {\n\n\t\t\t\t\tuuids.push( serialize( meta.materials, this.material[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\tobject.material = uuids;\n\n\t\t\t} else {\n\n\t\t\t\tobject.material = serialize( meta.materials, this.material );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.children.length > 0 ) {\n\n\t\t\tobject.children = [];\n\n\t\t\tfor ( let i = 0; i < this.children.length; i ++ ) {\n\n\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.animations.length > 0 ) {\n\n\t\t\tobject.animations = [];\n\n\t\t\tfor ( let i = 0; i < this.animations.length; i ++ ) {\n\n\t\t\t\tconst animation = this.animations[ i ];\n\n\t\t\t\tobject.animations.push( serialize( meta.animations, animation ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( isRootObject ) {\n\n\t\t\tconst geometries = extractFromCache( meta.geometries );\n\t\t\tconst materials = extractFromCache( meta.materials );\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\t\t\tconst shapes = extractFromCache( meta.shapes );\n\t\t\tconst skeletons = extractFromCache( meta.skeletons );\n\t\t\tconst animations = extractFromCache( meta.animations );\n\t\t\tconst nodes = extractFromCache( meta.nodes );\n\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\n\t\t\tif ( images.length > 0 ) output.images = images;\n\t\t\tif ( shapes.length > 0 ) output.shapes = shapes;\n\t\t\tif ( skeletons.length > 0 ) output.skeletons = skeletons;\n\t\t\tif ( animations.length > 0 ) output.animations = animations;\n\t\t\tif ( nodes.length > 0 ) output.nodes = nodes;\n\n\t\t}\n\n\t\toutput.object = object;\n\n\t\treturn output;\n\n\t\t// extract data from the cache hash\n\t\t// remove metadata on each item\n\t\t// and return as array\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t}\n\n\tclone( recursive ) {\n\n\t\treturn new this.constructor().copy( this, recursive );\n\n\t}\n\n\tcopy( source, recursive = true ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.up.copy( source.up );\n\n\t\tthis.position.copy( source.position );\n\t\tthis.rotation.order = source.rotation.order;\n\t\tthis.quaternion.copy( source.quaternion );\n\t\tthis.scale.copy( source.scale );\n\n\t\tthis.matrix.copy( source.matrix );\n\t\tthis.matrixWorld.copy( source.matrixWorld );\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\n\n\t\tthis.layers.mask = source.layers.mask;\n\t\tthis.visible = source.visible;\n\n\t\tthis.castShadow = source.castShadow;\n\t\tthis.receiveShadow = source.receiveShadow;\n\n\t\tthis.frustumCulled = source.frustumCulled;\n\t\tthis.renderOrder = source.renderOrder;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\tif ( recursive === true ) {\n\n\t\t\tfor ( let i = 0; i < source.children.length; i ++ ) {\n\n\t\t\t\tconst child = source.children[ i ];\n\t\t\t\tthis.add( child.clone() );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nObject3D.DefaultUp = new Vector3( 0, 1, 0 );\nObject3D.DefaultMatrixAutoUpdate = true;\n\nObject3D.prototype.isObject3D = true;\n\nexport { Object3D };\n", "import { Vector3 } from './Vector3.js';\n\nconst _v0 = /*@__PURE__*/ new Vector3();\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _v2 = /*@__PURE__*/ new Vector3();\nconst _v3 = /*@__PURE__*/ new Vector3();\n\nconst _vab = /*@__PURE__*/ new Vector3();\nconst _vac = /*@__PURE__*/ new Vector3();\nconst _vbc = /*@__PURE__*/ new Vector3();\nconst _vap = /*@__PURE__*/ new Vector3();\nconst _vbp = /*@__PURE__*/ new Vector3();\nconst _vcp = /*@__PURE__*/ new Vector3();\n\nclass Triangle {\n\n\tconstructor( a = new Vector3(), b = new Vector3(), c = new Vector3() ) {\n\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\n\t}\n\n\tstatic getNormal( a, b, c, target ) {\n\n\t\ttarget.subVectors( c, b );\n\t\t_v0.subVectors( a, b );\n\t\ttarget.cross( _v0 );\n\n\t\tconst targetLengthSq = target.lengthSq();\n\t\tif ( targetLengthSq > 0 ) {\n\n\t\t\treturn target.multiplyScalar( 1 / Math.sqrt( targetLengthSq ) );\n\n\t\t}\n\n\t\treturn target.set( 0, 0, 0 );\n\n\t}\n\n\t// static/instance method to calculate barycentric coordinates\n\t// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\n\tstatic getBarycoord( point, a, b, c, target ) {\n\n\t\t_v0.subVectors( c, a );\n\t\t_v1.subVectors( b, a );\n\t\t_v2.subVectors( point, a );\n\n\t\tconst dot00 = _v0.dot( _v0 );\n\t\tconst dot01 = _v0.dot( _v1 );\n\t\tconst dot02 = _v0.dot( _v2 );\n\t\tconst dot11 = _v1.dot( _v1 );\n\t\tconst dot12 = _v1.dot( _v2 );\n\n\t\tconst denom = ( dot00 * dot11 - dot01 * dot01 );\n\n\t\t// collinear or singular triangle\n\t\tif ( denom === 0 ) {\n\n\t\t\t// arbitrary location outside of triangle?\n\t\t\t// not sure if this is the best idea, maybe should be returning undefined\n\t\t\treturn target.set( - 2, - 1, - 1 );\n\n\t\t}\n\n\t\tconst invDenom = 1 / denom;\n\t\tconst u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\n\t\tconst v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\n\n\t\t// barycentric coordinates must always sum to 1\n\t\treturn target.set( 1 - u - v, v, u );\n\n\t}\n\n\tstatic containsPoint( point, a, b, c ) {\n\n\t\tthis.getBarycoord( point, a, b, c, _v3 );\n\n\t\treturn ( _v3.x >= 0 ) && ( _v3.y >= 0 ) && ( ( _v3.x + _v3.y ) <= 1 );\n\n\t}\n\n\tstatic getUV( point, p1, p2, p3, uv1, uv2, uv3, target ) {\n\n\t\tthis.getBarycoord( point, p1, p2, p3, _v3 );\n\n\t\ttarget.set( 0, 0 );\n\t\ttarget.addScaledVector( uv1, _v3.x );\n\t\ttarget.addScaledVector( uv2, _v3.y );\n\t\ttarget.addScaledVector( uv3, _v3.z );\n\n\t\treturn target;\n\n\t}\n\n\tstatic isFrontFacing( a, b, c, direction ) {\n\n\t\t_v0.subVectors( c, b );\n\t\t_v1.subVectors( a, b );\n\n\t\t// strictly front facing\n\t\treturn ( _v0.cross( _v1 ).dot( direction ) < 0 ) ? true : false;\n\n\t}\n\n\tset( a, b, c ) {\n\n\t\tthis.a.copy( a );\n\t\tthis.b.copy( b );\n\t\tthis.c.copy( c );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPointsAndIndices( points, i0, i1, i2 ) {\n\n\t\tthis.a.copy( points[ i0 ] );\n\t\tthis.b.copy( points[ i1 ] );\n\t\tthis.c.copy( points[ i2 ] );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAttributeAndIndices( attribute, i0, i1, i2 ) {\n\n\t\tthis.a.fromBufferAttribute( attribute, i0 );\n\t\tthis.b.fromBufferAttribute( attribute, i1 );\n\t\tthis.c.fromBufferAttribute( attribute, i2 );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( triangle ) {\n\n\t\tthis.a.copy( triangle.a );\n\t\tthis.b.copy( triangle.b );\n\t\tthis.c.copy( triangle.c );\n\n\t\treturn this;\n\n\t}\n\n\tgetArea() {\n\n\t\t_v0.subVectors( this.c, this.b );\n\t\t_v1.subVectors( this.a, this.b );\n\n\t\treturn _v0.cross( _v1 ).length() * 0.5;\n\n\t}\n\n\tgetMidpoint( target ) {\n\n\t\treturn target.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\n\n\t}\n\n\tgetNormal( target ) {\n\n\t\treturn Triangle.getNormal( this.a, this.b, this.c, target );\n\n\t}\n\n\tgetPlane( target ) {\n\n\t\treturn target.setFromCoplanarPoints( this.a, this.b, this.c );\n\n\t}\n\n\tgetBarycoord( point, target ) {\n\n\t\treturn Triangle.getBarycoord( point, this.a, this.b, this.c, target );\n\n\t}\n\n\tgetUV( point, uv1, uv2, uv3, target ) {\n\n\t\treturn Triangle.getUV( point, this.a, this.b, this.c, uv1, uv2, uv3, target );\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn Triangle.containsPoint( point, this.a, this.b, this.c );\n\n\t}\n\n\tisFrontFacing( direction ) {\n\n\t\treturn Triangle.isFrontFacing( this.a, this.b, this.c, direction );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsTriangle( this );\n\n\t}\n\n\tclosestPointToPoint( p, target ) {\n\n\t\tconst a = this.a, b = this.b, c = this.c;\n\t\tlet v, w;\n\n\t\t// algorithm thanks to Real-Time Collision Detection by Christer Ericson,\n\t\t// published by Morgan Kaufmann Publishers, (c) 2005 Elsevier Inc.,\n\t\t// under the accompanying license; see chapter 5.1.5 for detailed explanation.\n\t\t// basically, we're distinguishing which of the voronoi regions of the triangle\n\t\t// the point lies in with the minimum amount of redundant computation.\n\n\t\t_vab.subVectors( b, a );\n\t\t_vac.subVectors( c, a );\n\t\t_vap.subVectors( p, a );\n\t\tconst d1 = _vab.dot( _vap );\n\t\tconst d2 = _vac.dot( _vap );\n\t\tif ( d1 <= 0 && d2 <= 0 ) {\n\n\t\t\t// vertex region of A; barycentric coords (1, 0, 0)\n\t\t\treturn target.copy( a );\n\n\t\t}\n\n\t\t_vbp.subVectors( p, b );\n\t\tconst d3 = _vab.dot( _vbp );\n\t\tconst d4 = _vac.dot( _vbp );\n\t\tif ( d3 >= 0 && d4 <= d3 ) {\n\n\t\t\t// vertex region of B; barycentric coords (0, 1, 0)\n\t\t\treturn target.copy( b );\n\n\t\t}\n\n\t\tconst vc = d1 * d4 - d3 * d2;\n\t\tif ( vc <= 0 && d1 >= 0 && d3 <= 0 ) {\n\n\t\t\tv = d1 / ( d1 - d3 );\n\t\t\t// edge region of AB; barycentric coords (1-v, v, 0)\n\t\t\treturn target.copy( a ).addScaledVector( _vab, v );\n\n\t\t}\n\n\t\t_vcp.subVectors( p, c );\n\t\tconst d5 = _vab.dot( _vcp );\n\t\tconst d6 = _vac.dot( _vcp );\n\t\tif ( d6 >= 0 && d5 <= d6 ) {\n\n\t\t\t// vertex region of C; barycentric coords (0, 0, 1)\n\t\t\treturn target.copy( c );\n\n\t\t}\n\n\t\tconst vb = d5 * d2 - d1 * d6;\n\t\tif ( vb <= 0 && d2 >= 0 && d6 <= 0 ) {\n\n\t\t\tw = d2 / ( d2 - d6 );\n\t\t\t// edge region of AC; barycentric coords (1-w, 0, w)\n\t\t\treturn target.copy( a ).addScaledVector( _vac, w );\n\n\t\t}\n\n\t\tconst va = d3 * d6 - d5 * d4;\n\t\tif ( va <= 0 && ( d4 - d3 ) >= 0 && ( d5 - d6 ) >= 0 ) {\n\n\t\t\t_vbc.subVectors( c, b );\n\t\t\tw = ( d4 - d3 ) / ( ( d4 - d3 ) + ( d5 - d6 ) );\n\t\t\t// edge region of BC; barycentric coords (0, 1-w, w)\n\t\t\treturn target.copy( b ).addScaledVector( _vbc, w ); // edge region of BC\n\n\t\t}\n\n\t\t// face region\n\t\tconst denom = 1 / ( va + vb + vc );\n\t\t// u = va * denom\n\t\tv = vb * denom;\n\t\tw = vc * denom;\n\n\t\treturn target.copy( a ).addScaledVector( _vab, v ).addScaledVector( _vac, w );\n\n\t}\n\n\tequals( triangle ) {\n\n\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\n\n\t}\n\n}\n\nexport { Triangle };\n", "import { EventDispatcher } from '../core/EventDispatcher.js';\nimport { FrontSide, FlatShading, NormalBlending, LessEqualDepth, AddEquation, OneMinusSrcAlphaFactor, SrcAlphaFactor, AlwaysStencilFunc, KeepStencilOp } from '../constants.js';\nimport * as MathUtils from '../math/MathUtils.js';\n\nlet materialId = 0;\n\nclass Material extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tObject.defineProperty( this, 'id', { value: materialId ++ } );\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Material';\n\n\t\tthis.fog = true;\n\n\t\tthis.blending = NormalBlending;\n\t\tthis.side = FrontSide;\n\t\tthis.vertexColors = false;\n\n\t\tthis.opacity = 1;\n\t\tthis.transparent = false;\n\n\t\tthis.blendSrc = SrcAlphaFactor;\n\t\tthis.blendDst = OneMinusSrcAlphaFactor;\n\t\tthis.blendEquation = AddEquation;\n\t\tthis.blendSrcAlpha = null;\n\t\tthis.blendDstAlpha = null;\n\t\tthis.blendEquationAlpha = null;\n\n\t\tthis.depthFunc = LessEqualDepth;\n\t\tthis.depthTest = true;\n\t\tthis.depthWrite = true;\n\n\t\tthis.stencilWriteMask = 0xff;\n\t\tthis.stencilFunc = AlwaysStencilFunc;\n\t\tthis.stencilRef = 0;\n\t\tthis.stencilFuncMask = 0xff;\n\t\tthis.stencilFail = KeepStencilOp;\n\t\tthis.stencilZFail = KeepStencilOp;\n\t\tthis.stencilZPass = KeepStencilOp;\n\t\tthis.stencilWrite = false;\n\n\t\tthis.clippingPlanes = null;\n\t\tthis.clipIntersection = false;\n\t\tthis.clipShadows = false;\n\n\t\tthis.shadowSide = null;\n\n\t\tthis.colorWrite = true;\n\n\t\tthis.precision = null; // override the renderer's default precision for this material\n\n\t\tthis.polygonOffset = false;\n\t\tthis.polygonOffsetFactor = 0;\n\t\tthis.polygonOffsetUnits = 0;\n\n\t\tthis.dithering = false;\n\n\t\tthis.alphaToCoverage = false;\n\t\tthis.premultipliedAlpha = false;\n\n\t\tthis.visible = true;\n\n\t\tthis.toneMapped = true;\n\n\t\tthis.userData = {};\n\n\t\tthis.version = 0;\n\n\t\tthis._alphaTest = 0;\n\n\t}\n\n\tget alphaTest() {\n\n\t\treturn this._alphaTest;\n\n\t}\n\n\tset alphaTest( value ) {\n\n\t\tif ( this._alphaTest > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._alphaTest = value;\n\n\t}\n\n\tonBuild( /* shaderobject, renderer */ ) {}\n\n\tonBeforeRender( /* renderer, scene, camera, geometry, object, group */ ) {}\n\n\tonBeforeCompile( /* shaderobject, renderer */ ) {}\n\n\tcustomProgramCacheKey() {\n\n\t\treturn this.onBeforeCompile.toString();\n\n\t}\n\n\tsetValues( values ) {\n\n\t\tif ( values === undefined ) return;\n\n\t\tfor ( const key in values ) {\n\n\t\t\tconst newValue = values[ key ];\n\n\t\t\tif ( newValue === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Material: \\'' + key + '\\' parameter is undefined.' );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\t// for backward compatibility if shading is set in the constructor\n\t\t\tif ( key === 'shading' ) {\n\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': .shading has been removed. Use the boolean .flatShading instead.' );\n\t\t\t\tthis.flatShading = ( newValue === FlatShading ) ? true : false;\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tconst currentValue = this[ key ];\n\n\t\t\tif ( currentValue === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': \\'' + key + '\\' is not a property of this material.' );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tif ( currentValue && currentValue.isColor ) {\n\n\t\t\t\tcurrentValue.set( newValue );\n\n\t\t\t} else if ( ( currentValue && currentValue.isVector3 ) && ( newValue && newValue.isVector3 ) ) {\n\n\t\t\t\tcurrentValue.copy( newValue );\n\n\t\t\t} else {\n\n\t\t\t\tthis[ key ] = newValue;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( isRootObject ) {\n\n\t\t\tmeta = {\n\t\t\t\ttextures: {},\n\t\t\t\timages: {}\n\t\t\t};\n\n\t\t}\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Material',\n\t\t\t\tgenerator: 'Material.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard Material serialization\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\tif ( this.color && this.color.isColor ) data.color = this.color.getHex();\n\n\t\tif ( this.roughness !== undefined ) data.roughness = this.roughness;\n\t\tif ( this.metalness !== undefined ) data.metalness = this.metalness;\n\n\t\tif ( this.sheen !== undefined ) data.sheen = this.sheen;\n\t\tif ( this.sheenColor && this.sheenColor.isColor ) data.sheenColor = this.sheenColor.getHex();\n\t\tif ( this.sheenRoughness !== undefined ) data.sheenRoughness = this.sheenRoughness;\n\t\tif ( this.emissive && this.emissive.isColor ) data.emissive = this.emissive.getHex();\n\t\tif ( this.emissiveIntensity && this.emissiveIntensity !== 1 ) data.emissiveIntensity = this.emissiveIntensity;\n\n\t\tif ( this.specular && this.specular.isColor ) data.specular = this.specular.getHex();\n\t\tif ( this.specularIntensity !== undefined ) data.specularIntensity = this.specularIntensity;\n\t\tif ( this.specularColor && this.specularColor.isColor ) data.specularColor = this.specularColor.getHex();\n\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\n\t\tif ( this.clearcoat !== undefined ) data.clearcoat = this.clearcoat;\n\t\tif ( this.clearcoatRoughness !== undefined ) data.clearcoatRoughness = this.clearcoatRoughness;\n\n\t\tif ( this.clearcoatMap && this.clearcoatMap.isTexture ) {\n\n\t\t\tdata.clearcoatMap = this.clearcoatMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.clearcoatRoughnessMap && this.clearcoatRoughnessMap.isTexture ) {\n\n\t\t\tdata.clearcoatRoughnessMap = this.clearcoatRoughnessMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.clearcoatNormalMap && this.clearcoatNormalMap.isTexture ) {\n\n\t\t\tdata.clearcoatNormalMap = this.clearcoatNormalMap.toJSON( meta ).uuid;\n\t\t\tdata.clearcoatNormalScale = this.clearcoatNormalScale.toArray();\n\n\t\t}\n\n\t\tif ( this.map && this.map.isTexture ) data.map = this.map.toJSON( meta ).uuid;\n\t\tif ( this.matcap && this.matcap.isTexture ) data.matcap = this.matcap.toJSON( meta ).uuid;\n\t\tif ( this.alphaMap && this.alphaMap.isTexture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\n\n\t\tif ( this.lightMap && this.lightMap.isTexture ) {\n\n\t\t\tdata.lightMap = this.lightMap.toJSON( meta ).uuid;\n\t\t\tdata.lightMapIntensity = this.lightMapIntensity;\n\n\t\t}\n\n\t\tif ( this.aoMap && this.aoMap.isTexture ) {\n\n\t\t\tdata.aoMap = this.aoMap.toJSON( meta ).uuid;\n\t\t\tdata.aoMapIntensity = this.aoMapIntensity;\n\n\t\t}\n\n\t\tif ( this.bumpMap && this.bumpMap.isTexture ) {\n\n\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\n\t\t\tdata.bumpScale = this.bumpScale;\n\n\t\t}\n\n\t\tif ( this.normalMap && this.normalMap.isTexture ) {\n\n\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\n\t\t\tdata.normalMapType = this.normalMapType;\n\t\t\tdata.normalScale = this.normalScale.toArray();\n\n\t\t}\n\n\t\tif ( this.displacementMap && this.displacementMap.isTexture ) {\n\n\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\n\t\t\tdata.displacementScale = this.displacementScale;\n\t\t\tdata.displacementBias = this.displacementBias;\n\n\t\t}\n\n\t\tif ( this.roughnessMap && this.roughnessMap.isTexture ) data.roughnessMap = this.roughnessMap.toJSON( meta ).uuid;\n\t\tif ( this.metalnessMap && this.metalnessMap.isTexture ) data.metalnessMap = this.metalnessMap.toJSON( meta ).uuid;\n\n\t\tif ( this.emissiveMap && this.emissiveMap.isTexture ) data.emissiveMap = this.emissiveMap.toJSON( meta ).uuid;\n\t\tif ( this.specularMap && this.specularMap.isTexture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\n\t\tif ( this.specularIntensityMap && this.specularIntensityMap.isTexture ) data.specularIntensityMap = this.specularIntensityMap.toJSON( meta ).uuid;\n\t\tif ( this.specularColorMap && this.specularColorMap.isTexture ) data.specularColorMap = this.specularColorMap.toJSON( meta ).uuid;\n\n\t\tif ( this.envMap && this.envMap.isTexture ) {\n\n\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\n\n\t\t\tif ( this.combine !== undefined ) data.combine = this.combine;\n\n\t\t}\n\n\t\tif ( this.envMapIntensity !== undefined ) data.envMapIntensity = this.envMapIntensity;\n\t\tif ( this.reflectivity !== undefined ) data.reflectivity = this.reflectivity;\n\t\tif ( this.refractionRatio !== undefined ) data.refractionRatio = this.refractionRatio;\n\n\t\tif ( this.gradientMap && this.gradientMap.isTexture ) {\n\n\t\t\tdata.gradientMap = this.gradientMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.transmission !== undefined ) data.transmission = this.transmission;\n\t\tif ( this.transmissionMap && this.transmissionMap.isTexture ) data.transmissionMap = this.transmissionMap.toJSON( meta ).uuid;\n\t\tif ( this.thickness !== undefined ) data.thickness = this.thickness;\n\t\tif ( this.thicknessMap && this.thicknessMap.isTexture ) data.thicknessMap = this.thicknessMap.toJSON( meta ).uuid;\n\t\tif ( this.attenuationDistance !== undefined ) data.attenuationDistance = this.attenuationDistance;\n\t\tif ( this.attenuationColor !== undefined ) data.attenuationColor = this.attenuationColor.getHex();\n\n\t\tif ( this.size !== undefined ) data.size = this.size;\n\t\tif ( this.shadowSide !== null ) data.shadowSide = this.shadowSide;\n\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\n\n\t\tif ( this.blending !== NormalBlending ) data.blending = this.blending;\n\t\tif ( this.side !== FrontSide ) data.side = this.side;\n\t\tif ( this.vertexColors ) data.vertexColors = true;\n\n\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\n\t\tif ( this.transparent === true ) data.transparent = this.transparent;\n\n\t\tdata.depthFunc = this.depthFunc;\n\t\tdata.depthTest = this.depthTest;\n\t\tdata.depthWrite = this.depthWrite;\n\t\tdata.colorWrite = this.colorWrite;\n\n\t\tdata.stencilWrite = this.stencilWrite;\n\t\tdata.stencilWriteMask = this.stencilWriteMask;\n\t\tdata.stencilFunc = this.stencilFunc;\n\t\tdata.stencilRef = this.stencilRef;\n\t\tdata.stencilFuncMask = this.stencilFuncMask;\n\t\tdata.stencilFail = this.stencilFail;\n\t\tdata.stencilZFail = this.stencilZFail;\n\t\tdata.stencilZPass = this.stencilZPass;\n\n\t\t// rotation (SpriteMaterial)\n\t\tif ( this.rotation !== undefined && this.rotation !== 0 ) data.rotation = this.rotation;\n\n\t\tif ( this.polygonOffset === true ) data.polygonOffset = true;\n\t\tif ( this.polygonOffsetFactor !== 0 ) data.polygonOffsetFactor = this.polygonOffsetFactor;\n\t\tif ( this.polygonOffsetUnits !== 0 ) data.polygonOffsetUnits = this.polygonOffsetUnits;\n\n\t\tif ( this.linewidth !== undefined && this.linewidth !== 1 ) data.linewidth = this.linewidth;\n\t\tif ( this.dashSize !== undefined ) data.dashSize = this.dashSize;\n\t\tif ( this.gapSize !== undefined ) data.gapSize = this.gapSize;\n\t\tif ( this.scale !== undefined ) data.scale = this.scale;\n\n\t\tif ( this.dithering === true ) data.dithering = true;\n\n\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\n\t\tif ( this.alphaToCoverage === true ) data.alphaToCoverage = this.alphaToCoverage;\n\t\tif ( this.premultipliedAlpha === true ) data.premultipliedAlpha = this.premultipliedAlpha;\n\n\t\tif ( this.wireframe === true ) data.wireframe = this.wireframe;\n\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\n\t\tif ( this.wireframeLinecap !== 'round' ) data.wireframeLinecap = this.wireframeLinecap;\n\t\tif ( this.wireframeLinejoin !== 'round' ) data.wireframeLinejoin = this.wireframeLinejoin;\n\n\t\tif ( this.flatShading === true ) data.flatShading = this.flatShading;\n\n\t\tif ( this.visible === false ) data.visible = false;\n\n\t\tif ( this.toneMapped === false ) data.toneMapped = false;\n\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) data.userData = this.userData;\n\n\t\t// TODO: Copied from Object3D.toJSON\n\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t\tif ( isRootObject ) {\n\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\tif ( images.length > 0 ) data.images = images;\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.fog = source.fog;\n\n\t\tthis.blending = source.blending;\n\t\tthis.side = source.side;\n\t\tthis.vertexColors = source.vertexColors;\n\n\t\tthis.opacity = source.opacity;\n\t\tthis.transparent = source.transparent;\n\n\t\tthis.blendSrc = source.blendSrc;\n\t\tthis.blendDst = source.blendDst;\n\t\tthis.blendEquation = source.blendEquation;\n\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\n\t\tthis.blendDstAlpha = source.blendDstAlpha;\n\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\n\n\t\tthis.depthFunc = source.depthFunc;\n\t\tthis.depthTest = source.depthTest;\n\t\tthis.depthWrite = source.depthWrite;\n\n\t\tthis.stencilWriteMask = source.stencilWriteMask;\n\t\tthis.stencilFunc = source.stencilFunc;\n\t\tthis.stencilRef = source.stencilRef;\n\t\tthis.stencilFuncMask = source.stencilFuncMask;\n\t\tthis.stencilFail = source.stencilFail;\n\t\tthis.stencilZFail = source.stencilZFail;\n\t\tthis.stencilZPass = source.stencilZPass;\n\t\tthis.stencilWrite = source.stencilWrite;\n\n\t\tconst srcPlanes = source.clippingPlanes;\n\t\tlet dstPlanes = null;\n\n\t\tif ( srcPlanes !== null ) {\n\n\t\t\tconst n = srcPlanes.length;\n\t\t\tdstPlanes = new Array( n );\n\n\t\t\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\t\t\tdstPlanes[ i ] = srcPlanes[ i ].clone();\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.clippingPlanes = dstPlanes;\n\t\tthis.clipIntersection = source.clipIntersection;\n\t\tthis.clipShadows = source.clipShadows;\n\n\t\tthis.shadowSide = source.shadowSide;\n\n\t\tthis.colorWrite = source.colorWrite;\n\n\t\tthis.precision = source.precision;\n\n\t\tthis.polygonOffset = source.polygonOffset;\n\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\n\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\n\n\t\tthis.dithering = source.dithering;\n\n\t\tthis.alphaTest = source.alphaTest;\n\t\tthis.alphaToCoverage = source.alphaToCoverage;\n\t\tthis.premultipliedAlpha = source.premultipliedAlpha;\n\n\t\tthis.visible = source.visible;\n\n\t\tthis.toneMapped = source.toneMapped;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n}\n\nMaterial.prototype.isMaterial = true;\n\nMaterial.fromType = function ( /*type*/ ) {\n\n\t// TODO: Behavior added in Materials.js\n\n\treturn null;\n\n};\n\nexport { Material };\n", "import { Material } from './Material.js';\nimport { MultiplyOperation } from '../constants.js';\nimport { Color } from '../math/Color.js';\n\nclass MeshBasicMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshBasicMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // emissive\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshBasicMaterial.prototype.isMeshBasicMaterial = true;\n\nexport { MeshBasicMaterial };\n", "import { Vector4 } from '../math/Vector4.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Color } from '../math/Color.js';\nimport { StaticDrawUsage } from '../constants.js';\n\nconst _vector = /*@__PURE__*/ new Vector3();\nconst _vector2 = /*@__PURE__*/ new Vector2();\n\nclass BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tif ( Array.isArray( array ) ) {\n\n\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\n\n\t\t}\n\n\t\tthis.name = '';\n\n\t\tthis.array = array;\n\t\tthis.itemSize = itemSize;\n\t\tthis.count = array !== undefined ? array.length / itemSize : 0;\n\t\tthis.normalized = normalized === true;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.updateRange = { offset: 0, count: - 1 };\n\n\t\tthis.version = 0;\n\n\t}\n\n\tonUploadCallback() {}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.itemSize = source.itemSize;\n\t\tthis.count = source.count;\n\t\tthis.normalized = source.normalized;\n\n\t\tthis.usage = source.usage;\n\n\t\treturn this;\n\n\t}\n\n\tcopyAt( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.itemSize;\n\t\tindex2 *= attribute.itemSize;\n\n\t\tfor ( let i = 0, l = this.itemSize; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyArray( array ) {\n\n\t\tthis.array.set( array );\n\n\t\treturn this;\n\n\t}\n\n\tcopyColorsArray( colors ) {\n\n\t\tconst array = this.array;\n\t\tlet offset = 0;\n\n\t\tfor ( let i = 0, l = colors.length; i < l; i ++ ) {\n\n\t\t\tlet color = colors[ i ];\n\n\t\t\tif ( color === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyColorsArray(): color is undefined', i );\n\t\t\t\tcolor = new Color();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = color.r;\n\t\t\tarray[ offset ++ ] = color.g;\n\t\t\tarray[ offset ++ ] = color.b;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyVector2sArray( vectors ) {\n\n\t\tconst array = this.array;\n\t\tlet offset = 0;\n\n\t\tfor ( let i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\tlet vector = vectors[ i ];\n\n\t\t\tif ( vector === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector2sArray(): vector is undefined', i );\n\t\t\t\tvector = new Vector2();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\tarray[ offset ++ ] = vector.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyVector3sArray( vectors ) {\n\n\t\tconst array = this.array;\n\t\tlet offset = 0;\n\n\t\tfor ( let i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\tlet vector = vectors[ i ];\n\n\t\t\tif ( vector === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector3sArray(): vector is undefined', i );\n\t\t\t\tvector = new Vector3();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\tarray[ offset ++ ] = vector.y;\n\t\t\tarray[ offset ++ ] = vector.z;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyVector4sArray( vectors ) {\n\n\t\tconst array = this.array;\n\t\tlet offset = 0;\n\n\t\tfor ( let i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\tlet vector = vectors[ i ];\n\n\t\t\tif ( vector === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector4sArray(): vector is undefined', i );\n\t\t\t\tvector = new Vector4();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\tarray[ offset ++ ] = vector.y;\n\t\t\tarray[ offset ++ ] = vector.z;\n\t\t\tarray[ offset ++ ] = vector.w;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tif ( this.itemSize === 2 ) {\n\n\t\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t\t_vector2.fromBufferAttribute( this, i );\n\t\t\t\t_vector2.applyMatrix3( m );\n\n\t\t\t\tthis.setXY( i, _vector2.x, _vector2.y );\n\n\t\t\t}\n\n\t\t} else if ( this.itemSize === 3 ) {\n\n\t\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t\t_vector.fromBufferAttribute( this, i );\n\t\t\t\t_vector.applyMatrix3( m );\n\n\t\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector.fromBufferAttribute( this, i );\n\n\t\t\t_vector.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector.fromBufferAttribute( this, i );\n\n\t\t\t_vector.applyNormalMatrix( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector.fromBufferAttribute( this, i );\n\n\t\t\t_vector.transformDirection( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( value, offset = 0 ) {\n\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t}\n\n\tgetX( index ) {\n\n\t\treturn this.array[ index * this.itemSize ];\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tthis.array[ index * this.itemSize ] = x;\n\n\t\treturn this;\n\n\t}\n\n\tgetY( index ) {\n\n\t\treturn this.array[ index * this.itemSize + 1 ];\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tthis.array[ index * this.itemSize + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tgetZ( index ) {\n\n\t\treturn this.array[ index * this.itemSize + 2 ];\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tthis.array[ index * this.itemSize + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tgetW( index ) {\n\n\t\treturn this.array[ index * this.itemSize + 3 ];\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tthis.array[ index * this.itemSize + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\t\tthis.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tonUpload( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.array, this.itemSize ).copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\titemSize: this.itemSize,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tarray: Array.prototype.slice.call( this.array ),\n\t\t\tnormalized: this.normalized\n\t\t};\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( this.usage !== StaticDrawUsage ) data.usage = this.usage;\n\t\tif ( this.updateRange.offset !== 0 || this.updateRange.count !== - 1 ) data.updateRange = this.updateRange;\n\n\t\treturn data;\n\n\t}\n\n}\n\nBufferAttribute.prototype.isBufferAttribute = true;\n\n//\n\nclass Int8BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int8Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint8BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint8Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint8ClampedBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint8ClampedArray( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Int16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Int32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Float16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nFloat16BufferAttribute.prototype.isFloat16BufferAttribute = true;\n\nclass Float32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Float32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Float64BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Float64Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\n//\n\nexport {\n\tFloat64BufferAttribute,\n\tFloat32BufferAttribute,\n\tFloat16BufferAttribute,\n\tUint32BufferAttribute,\n\tInt32BufferAttribute,\n\tUint16BufferAttribute,\n\tInt16BufferAttribute,\n\tUint8ClampedBufferAttribute,\n\tUint8BufferAttribute,\n\tInt8BufferAttribute,\n\tBufferAttribute\n};\n", "import { Vector3 } from '../math/Vector3.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Box3 } from '../math/Box3.js';\nimport { EventDispatcher } from './EventDispatcher.js';\nimport { BufferAttribute, Float32BufferAttribute, Uint16BufferAttribute, Uint32BufferAttribute } from './BufferAttribute.js';\nimport { Sphere } from '../math/Sphere.js';\nimport { Object3D } from './Object3D.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Matrix3 } from '../math/Matrix3.js';\nimport * as MathUtils from '../math/MathUtils.js';\nimport { arrayNeedsUint32 } from '../utils.js';\n\nlet _id = 0;\n\nconst _m1 = /*@__PURE__*/ new Matrix4();\nconst _obj = /*@__PURE__*/ new Object3D();\nconst _offset = /*@__PURE__*/ new Vector3();\nconst _box = /*@__PURE__*/ new Box3();\nconst _boxMorphTargets = /*@__PURE__*/ new Box3();\nconst _vector = /*@__PURE__*/ new Vector3();\n\nclass BufferGeometry extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tObject.defineProperty( this, 'id', { value: _id ++ } );\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'BufferGeometry';\n\n\t\tthis.index = null;\n\t\tthis.attributes = {};\n\n\t\tthis.morphAttributes = {};\n\t\tthis.morphTargetsRelative = false;\n\n\t\tthis.groups = [];\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\tthis.drawRange = { start: 0, count: Infinity };\n\n\t\tthis.userData = {};\n\n\t}\n\n\tgetIndex() {\n\n\t\treturn this.index;\n\n\t}\n\n\tsetIndex( index ) {\n\n\t\tif ( Array.isArray( index ) ) {\n\n\t\t\tthis.index = new ( arrayNeedsUint32( index ) ? Uint32BufferAttribute : Uint16BufferAttribute )( index, 1 );\n\n\t\t} else {\n\n\t\t\tthis.index = index;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetAttribute( name ) {\n\n\t\treturn this.attributes[ name ];\n\n\t}\n\n\tsetAttribute( name, attribute ) {\n\n\t\tthis.attributes[ name ] = attribute;\n\n\t\treturn this;\n\n\t}\n\n\tdeleteAttribute( name ) {\n\n\t\tdelete this.attributes[ name ];\n\n\t\treturn this;\n\n\t}\n\n\thasAttribute( name ) {\n\n\t\treturn this.attributes[ name ] !== undefined;\n\n\t}\n\n\taddGroup( start, count, materialIndex = 0 ) {\n\n\t\tthis.groups.push( {\n\n\t\t\tstart: start,\n\t\t\tcount: count,\n\t\t\tmaterialIndex: materialIndex\n\n\t\t} );\n\n\t}\n\n\tclearGroups() {\n\n\t\tthis.groups = [];\n\n\t}\n\n\tsetDrawRange( start, count ) {\n\n\t\tthis.drawRange.start = start;\n\t\tthis.drawRange.count = count;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tconst position = this.attributes.position;\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tposition.applyMatrix4( matrix );\n\n\t\t\tposition.needsUpdate = true;\n\n\t\t}\n\n\t\tconst normal = this.attributes.normal;\n\n\t\tif ( normal !== undefined ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( matrix );\n\n\t\t\tnormal.applyNormalMatrix( normalMatrix );\n\n\t\t\tnormal.needsUpdate = true;\n\n\t\t}\n\n\t\tconst tangent = this.attributes.tangent;\n\n\t\tif ( tangent !== undefined ) {\n\n\t\t\ttangent.transformDirection( matrix );\n\n\t\t\ttangent.needsUpdate = true;\n\n\t\t}\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t}\n\n\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\t_m1.makeRotationFromQuaternion( q );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\t// rotate geometry around world x-axis\n\n\t\t_m1.makeRotationX( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateY( angle ) {\n\n\t\t// rotate geometry around world y-axis\n\n\t\t_m1.makeRotationY( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\t// rotate geometry around world z-axis\n\n\t\t_m1.makeRotationZ( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( x, y, z ) {\n\n\t\t// translate geometry\n\n\t\t_m1.makeTranslation( x, y, z );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\tscale( x, y, z ) {\n\n\t\t// scale geometry\n\n\t\t_m1.makeScale( x, y, z );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\tlookAt( vector ) {\n\n\t\t_obj.lookAt( vector );\n\n\t\t_obj.updateMatrix();\n\n\t\tthis.applyMatrix4( _obj.matrix );\n\n\t\treturn this;\n\n\t}\n\n\tcenter() {\n\n\t\tthis.computeBoundingBox();\n\n\t\tthis.boundingBox.getCenter( _offset ).negate();\n\n\t\tthis.translate( _offset.x, _offset.y, _offset.z );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tconst position = [];\n\n\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\tconst point = points[ i ];\n\t\t\tposition.push( point.x, point.y, point.z || 0 );\n\n\t\t}\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( position, 3 ) );\n\n\t\treturn this;\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tconst position = this.attributes.position;\n\t\tconst morphAttributesPosition = this.morphAttributes.position;\n\n\t\tif ( position && position.isGLBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set \"mesh.frustumCulled\" to \"false\".', this );\n\n\t\t\tthis.boundingBox.set(\n\t\t\t\tnew Vector3( - Infinity, - Infinity, - Infinity ),\n\t\t\t\tnew Vector3( + Infinity, + Infinity, + Infinity )\n\t\t\t);\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tthis.boundingBox.setFromBufferAttribute( position );\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\t_box.setFromBufferAttribute( morphAttribute );\n\n\t\t\t\t\tif ( this.morphTargetsRelative ) {\n\n\t\t\t\t\t\t_vector.addVectors( this.boundingBox.min, _box.min );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector );\n\n\t\t\t\t\t\t_vector.addVectors( this.boundingBox.max, _box.max );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box.min );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box.max );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.boundingBox.makeEmpty();\n\n\t\t}\n\n\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tconst position = this.attributes.position;\n\t\tconst morphAttributesPosition = this.morphAttributes.position;\n\n\t\tif ( position && position.isGLBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set \"mesh.frustumCulled\" to \"false\".', this );\n\n\t\t\tthis.boundingSphere.set( new Vector3(), Infinity );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( position ) {\n\n\t\t\t// first, find the center of the bounding sphere\n\n\t\t\tconst center = this.boundingSphere.center;\n\n\t\t\t_box.setFromBufferAttribute( position );\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\t_boxMorphTargets.setFromBufferAttribute( morphAttribute );\n\n\t\t\t\t\tif ( this.morphTargetsRelative ) {\n\n\t\t\t\t\t\t_vector.addVectors( _box.min, _boxMorphTargets.min );\n\t\t\t\t\t\t_box.expandByPoint( _vector );\n\n\t\t\t\t\t\t_vector.addVectors( _box.max, _boxMorphTargets.max );\n\t\t\t\t\t\t_box.expandByPoint( _vector );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_box.expandByPoint( _boxMorphTargets.min );\n\t\t\t\t\t\t_box.expandByPoint( _boxMorphTargets.max );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_box.getCenter( center );\n\n\t\t\t// second, try to find a boundingSphere with a radius smaller than the\n\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\n\n\t\t\tlet maxRadiusSq = 0;\n\n\t\t\tfor ( let i = 0, il = position.count; i < il; i ++ ) {\n\n\t\t\t\t_vector.fromBufferAttribute( position, i );\n\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector ) );\n\n\t\t\t}\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\tconst morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t\t\t\tfor ( let j = 0, jl = morphAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t_vector.fromBufferAttribute( morphAttribute, j );\n\n\t\t\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t\t\t_offset.fromBufferAttribute( position, j );\n\t\t\t\t\t\t\t_vector.add( _offset );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcomputeTangents() {\n\n\t\tconst index = this.index;\n\t\tconst attributes = this.attributes;\n\n\t\t// based on http://www.terathon.com/code/tangent.html\n\t\t// (per vertex tangents)\n\n\t\tif ( index === null ||\n\t\t\t attributes.position === undefined ||\n\t\t\t attributes.normal === undefined ||\n\t\t\t attributes.uv === undefined ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst indices = index.array;\n\t\tconst positions = attributes.position.array;\n\t\tconst normals = attributes.normal.array;\n\t\tconst uvs = attributes.uv.array;\n\n\t\tconst nVertices = positions.length / 3;\n\n\t\tif ( this.hasAttribute( 'tangent' ) === false ) {\n\n\t\t\tthis.setAttribute( 'tangent', new BufferAttribute( new Float32Array( 4 * nVertices ), 4 ) );\n\n\t\t}\n\n\t\tconst tangents = this.getAttribute( 'tangent' ).array;\n\n\t\tconst tan1 = [], tan2 = [];\n\n\t\tfor ( let i = 0; i < nVertices; i ++ ) {\n\n\t\t\ttan1[ i ] = new Vector3();\n\t\t\ttan2[ i ] = new Vector3();\n\n\t\t}\n\n\t\tconst vA = new Vector3(),\n\t\t\tvB = new Vector3(),\n\t\t\tvC = new Vector3(),\n\n\t\t\tuvA = new Vector2(),\n\t\t\tuvB = new Vector2(),\n\t\t\tuvC = new Vector2(),\n\n\t\t\tsdir = new Vector3(),\n\t\t\ttdir = new Vector3();\n\n\t\tfunction handleTriangle( a, b, c ) {\n\n\t\t\tvA.fromArray( positions, a * 3 );\n\t\t\tvB.fromArray( positions, b * 3 );\n\t\t\tvC.fromArray( positions, c * 3 );\n\n\t\t\tuvA.fromArray( uvs, a * 2 );\n\t\t\tuvB.fromArray( uvs, b * 2 );\n\t\t\tuvC.fromArray( uvs, c * 2 );\n\n\t\t\tvB.sub( vA );\n\t\t\tvC.sub( vA );\n\n\t\t\tuvB.sub( uvA );\n\t\t\tuvC.sub( uvA );\n\n\t\t\tconst r = 1.0 / ( uvB.x * uvC.y - uvC.x * uvB.y );\n\n\t\t\t// silently ignore degenerate uv triangles having coincident or colinear vertices\n\n\t\t\tif ( ! isFinite( r ) ) return;\n\n\t\t\tsdir.copy( vB ).multiplyScalar( uvC.y ).addScaledVector( vC, - uvB.y ).multiplyScalar( r );\n\t\t\ttdir.copy( vC ).multiplyScalar( uvB.x ).addScaledVector( vB, - uvC.x ).multiplyScalar( r );\n\n\t\t\ttan1[ a ].add( sdir );\n\t\t\ttan1[ b ].add( sdir );\n\t\t\ttan1[ c ].add( sdir );\n\n\t\t\ttan2[ a ].add( tdir );\n\t\t\ttan2[ b ].add( tdir );\n\t\t\ttan2[ c ].add( tdir );\n\n\t\t}\n\n\t\tlet groups = this.groups;\n\n\t\tif ( groups.length === 0 ) {\n\n\t\t\tgroups = [ {\n\t\t\t\tstart: 0,\n\t\t\t\tcount: indices.length\n\t\t\t} ];\n\n\t\t}\n\n\t\tfor ( let i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tconst group = groups[ i ];\n\n\t\t\tconst start = group.start;\n\t\t\tconst count = group.count;\n\n\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleTriangle(\n\t\t\t\t\tindices[ j + 0 ],\n\t\t\t\t\tindices[ j + 1 ],\n\t\t\t\t\tindices[ j + 2 ]\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst tmp = new Vector3(), tmp2 = new Vector3();\n\t\tconst n = new Vector3(), n2 = new Vector3();\n\n\t\tfunction handleVertex( v ) {\n\n\t\t\tn.fromArray( normals, v * 3 );\n\t\t\tn2.copy( n );\n\n\t\t\tconst t = tan1[ v ];\n\n\t\t\t// Gram-Schmidt orthogonalize\n\n\t\t\ttmp.copy( t );\n\t\t\ttmp.sub( n.multiplyScalar( n.dot( t ) ) ).normalize();\n\n\t\t\t// Calculate handedness\n\n\t\t\ttmp2.crossVectors( n2, t );\n\t\t\tconst test = tmp2.dot( tan2[ v ] );\n\t\t\tconst w = ( test < 0.0 ) ? - 1.0 : 1.0;\n\n\t\t\ttangents[ v * 4 ] = tmp.x;\n\t\t\ttangents[ v * 4 + 1 ] = tmp.y;\n\t\t\ttangents[ v * 4 + 2 ] = tmp.z;\n\t\t\ttangents[ v * 4 + 3 ] = w;\n\n\t\t}\n\n\t\tfor ( let i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tconst group = groups[ i ];\n\n\t\t\tconst start = group.start;\n\t\t\tconst count = group.count;\n\n\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleVertex( indices[ j + 0 ] );\n\t\t\t\thandleVertex( indices[ j + 1 ] );\n\t\t\t\thandleVertex( indices[ j + 2 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcomputeVertexNormals() {\n\n\t\tconst index = this.index;\n\t\tconst positionAttribute = this.getAttribute( 'position' );\n\n\t\tif ( positionAttribute !== undefined ) {\n\n\t\t\tlet normalAttribute = this.getAttribute( 'normal' );\n\n\t\t\tif ( normalAttribute === undefined ) {\n\n\t\t\t\tnormalAttribute = new BufferAttribute( new Float32Array( positionAttribute.count * 3 ), 3 );\n\t\t\t\tthis.setAttribute( 'normal', normalAttribute );\n\n\t\t\t} else {\n\n\t\t\t\t// reset existing normals to zero\n\n\t\t\t\tfor ( let i = 0, il = normalAttribute.count; i < il; i ++ ) {\n\n\t\t\t\t\tnormalAttribute.setXYZ( i, 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst pA = new Vector3(), pB = new Vector3(), pC = new Vector3();\n\t\t\tconst nA = new Vector3(), nB = new Vector3(), nC = new Vector3();\n\t\t\tconst cb = new Vector3(), ab = new Vector3();\n\n\t\t\t// indexed elements\n\n\t\t\tif ( index ) {\n\n\t\t\t\tfor ( let i = 0, il = index.count; i < il; i += 3 ) {\n\n\t\t\t\t\tconst vA = index.getX( i + 0 );\n\t\t\t\t\tconst vB = index.getX( i + 1 );\n\t\t\t\t\tconst vC = index.getX( i + 2 );\n\n\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, vA );\n\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, vB );\n\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, vC );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnA.fromBufferAttribute( normalAttribute, vA );\n\t\t\t\t\tnB.fromBufferAttribute( normalAttribute, vB );\n\t\t\t\t\tnC.fromBufferAttribute( normalAttribute, vC );\n\n\t\t\t\t\tnA.add( cb );\n\t\t\t\t\tnB.add( cb );\n\t\t\t\t\tnC.add( cb );\n\n\t\t\t\t\tnormalAttribute.setXYZ( vA, nA.x, nA.y, nA.z );\n\t\t\t\t\tnormalAttribute.setXYZ( vB, nB.x, nB.y, nB.z );\n\t\t\t\t\tnormalAttribute.setXYZ( vC, nC.x, nC.y, nC.z );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// non-indexed elements (unconnected triangle soup)\n\n\t\t\t\tfor ( let i = 0, il = positionAttribute.count; i < il; i += 3 ) {\n\n\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, i + 0 );\n\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, i + 1 );\n\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, i + 2 );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnormalAttribute.setXYZ( i + 0, cb.x, cb.y, cb.z );\n\t\t\t\t\tnormalAttribute.setXYZ( i + 1, cb.x, cb.y, cb.z );\n\t\t\t\t\tnormalAttribute.setXYZ( i + 2, cb.x, cb.y, cb.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.normalizeNormals();\n\n\t\t\tnormalAttribute.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tmerge( geometry, offset ) {\n\n\t\tif ( ! ( geometry && geometry.isBufferGeometry ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( offset === undefined ) {\n\n\t\t\toffset = 0;\n\n\t\t\tconsole.warn(\n\t\t\t\t'THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. '\n\t\t\t\t+ 'Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.'\n\t\t\t);\n\n\t\t}\n\n\t\tconst attributes = this.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tif ( geometry.attributes[ key ] === undefined ) continue;\n\n\t\t\tconst attribute1 = attributes[ key ];\n\t\t\tconst attributeArray1 = attribute1.array;\n\n\t\t\tconst attribute2 = geometry.attributes[ key ];\n\t\t\tconst attributeArray2 = attribute2.array;\n\n\t\t\tconst attributeOffset = attribute2.itemSize * offset;\n\t\t\tconst length = Math.min( attributeArray2.length, attributeArray1.length - attributeOffset );\n\n\t\t\tfor ( let i = 0, j = attributeOffset; i < length; i ++, j ++ ) {\n\n\t\t\t\tattributeArray1[ j ] = attributeArray2[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tnormalizeNormals() {\n\n\t\tconst normals = this.attributes.normal;\n\n\t\tfor ( let i = 0, il = normals.count; i < il; i ++ ) {\n\n\t\t\t_vector.fromBufferAttribute( normals, i );\n\n\t\t\t_vector.normalize();\n\n\t\t\tnormals.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t}\n\n\ttoNonIndexed() {\n\n\t\tfunction convertBufferAttribute( attribute, indices ) {\n\n\t\t\tconst array = attribute.array;\n\t\t\tconst itemSize = attribute.itemSize;\n\t\t\tconst normalized = attribute.normalized;\n\n\t\t\tconst array2 = new array.constructor( indices.length * itemSize );\n\n\t\t\tlet index = 0, index2 = 0;\n\n\t\t\tfor ( let i = 0, l = indices.length; i < l; i ++ ) {\n\n\t\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\tindex = indices[ i ] * attribute.data.stride + attribute.offset;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tindex = indices[ i ] * itemSize;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let j = 0; j < itemSize; j ++ ) {\n\n\t\t\t\t\tarray2[ index2 ++ ] = array[ index ++ ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( array2, itemSize, normalized );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.index === null ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed.' );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst geometry2 = new BufferGeometry();\n\n\t\tconst indices = this.index.array;\n\t\tconst attributes = this.attributes;\n\n\t\t// attributes\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\n\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\n\n\t\t\tgeometry2.setAttribute( name, newAttribute );\n\n\t\t}\n\n\t\t// morph attributes\n\n\t\tconst morphAttributes = this.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst morphArray = [];\n\t\t\tconst morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i ++ ) {\n\n\t\t\t\tconst attribute = morphAttribute[ i ];\n\n\t\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\n\n\t\t\t\tmorphArray.push( newAttribute );\n\n\t\t\t}\n\n\t\t\tgeometry2.morphAttributes[ name ] = morphArray;\n\n\t\t}\n\n\t\tgeometry2.morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t// groups\n\n\t\tconst groups = this.groups;\n\n\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tconst group = groups[ i ];\n\t\t\tgeometry2.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\treturn geometry2;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'BufferGeometry',\n\t\t\t\tgenerator: 'BufferGeometry.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard BufferGeometry serialization\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( Object.keys( this.userData ).length > 0 ) data.userData = this.userData;\n\n\t\tif ( this.parameters !== undefined ) {\n\n\t\t\tconst parameters = this.parameters;\n\n\t\t\tfor ( const key in parameters ) {\n\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\t// for simplicity the code assumes attributes are not shared across geometries, see #15811\n\n\t\tdata.data = { attributes: {} };\n\n\t\tconst index = this.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tdata.data.index = {\n\t\t\t\ttype: index.array.constructor.name,\n\t\t\t\tarray: Array.prototype.slice.call( index.array )\n\t\t\t};\n\n\t\t}\n\n\t\tconst attributes = this.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tconst attribute = attributes[ key ];\n\n\t\t\tdata.data.attributes[ key ] = attribute.toJSON( data.data );\n\n\t\t}\n\n\t\tconst morphAttributes = {};\n\t\tlet hasMorphAttributes = false;\n\n\t\tfor ( const key in this.morphAttributes ) {\n\n\t\t\tconst attributeArray = this.morphAttributes[ key ];\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0, il = attributeArray.length; i < il; i ++ ) {\n\n\t\t\t\tconst attribute = attributeArray[ i ];\n\n\t\t\t\tarray.push( attribute.toJSON( data.data ) );\n\n\t\t\t}\n\n\t\t\tif ( array.length > 0 ) {\n\n\t\t\t\tmorphAttributes[ key ] = array;\n\n\t\t\t\thasMorphAttributes = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( hasMorphAttributes ) {\n\n\t\t\tdata.data.morphAttributes = morphAttributes;\n\t\t\tdata.data.morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t}\n\n\t\tconst groups = this.groups;\n\n\t\tif ( groups.length > 0 ) {\n\n\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\n\n\t\t}\n\n\t\tconst boundingSphere = this.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tdata.data.boundingSphere = {\n\t\t\t\tcenter: boundingSphere.center.toArray(),\n\t\t\t\tradius: boundingSphere.radius\n\t\t\t};\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\t return new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\t// reset\n\n\t\tthis.index = null;\n\t\tthis.attributes = {};\n\t\tthis.morphAttributes = {};\n\t\tthis.groups = [];\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\t// used for storing cloned, shared data\n\n\t\tconst data = {};\n\n\t\t// name\n\n\t\tthis.name = source.name;\n\n\t\t// index\n\n\t\tconst index = source.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tthis.setIndex( index.clone( data ) );\n\n\t\t}\n\n\t\t// attributes\n\n\t\tconst attributes = source.attributes;\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\t\t\tthis.setAttribute( name, attribute.clone( data ) );\n\n\t\t}\n\n\t\t// morph attributes\n\n\t\tconst morphAttributes = source.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst array = [];\n\t\t\tconst morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\tfor ( let i = 0, l = morphAttribute.length; i < l; i ++ ) {\n\n\t\t\t\tarray.push( morphAttribute[ i ].clone( data ) );\n\n\t\t\t}\n\n\t\t\tthis.morphAttributes[ name ] = array;\n\n\t\t}\n\n\t\tthis.morphTargetsRelative = source.morphTargetsRelative;\n\n\t\t// groups\n\n\t\tconst groups = source.groups;\n\n\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tconst group = groups[ i ];\n\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\t// bounding box\n\n\t\tconst boundingBox = source.boundingBox;\n\n\t\tif ( boundingBox !== null ) {\n\n\t\t\tthis.boundingBox = boundingBox.clone();\n\n\t\t}\n\n\t\t// bounding sphere\n\n\t\tconst boundingSphere = source.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tthis.boundingSphere = boundingSphere.clone();\n\n\t\t}\n\n\t\t// draw range\n\n\t\tthis.drawRange.start = source.drawRange.start;\n\t\tthis.drawRange.count = source.drawRange.count;\n\n\t\t// user data\n\n\t\tthis.userData = source.userData;\n\n\t\t// geometry generator parameters\n\n\t\tif ( source.parameters !== undefined ) this.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nBufferGeometry.prototype.isBufferGeometry = true;\n\nexport { BufferGeometry };\n", "import { Vector3 } from '../math/Vector3.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Sphere } from '../math/Sphere.js';\nimport { Ray } from '../math/Ray.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Object3D } from '../core/Object3D.js';\nimport { Triangle } from '../math/Triangle.js';\nimport { DoubleSide, BackSide } from '../constants.js';\nimport { MeshBasicMaterial } from '../materials/MeshBasicMaterial.js';\nimport { BufferGeometry } from '../core/BufferGeometry.js';\n\nconst _inverseMatrix = /*@__PURE__*/ new Matrix4();\nconst _ray = /*@__PURE__*/ new Ray();\nconst _sphere = /*@__PURE__*/ new Sphere();\n\nconst _vA = /*@__PURE__*/ new Vector3();\nconst _vB = /*@__PURE__*/ new Vector3();\nconst _vC = /*@__PURE__*/ new Vector3();\n\nconst _tempA = /*@__PURE__*/ new Vector3();\nconst _tempB = /*@__PURE__*/ new Vector3();\nconst _tempC = /*@__PURE__*/ new Vector3();\n\nconst _morphA = /*@__PURE__*/ new Vector3();\nconst _morphB = /*@__PURE__*/ new Vector3();\nconst _morphC = /*@__PURE__*/ new Vector3();\n\nconst _uvA = /*@__PURE__*/ new Vector2();\nconst _uvB = /*@__PURE__*/ new Vector2();\nconst _uvC = /*@__PURE__*/ new Vector2();\n\nconst _intersectionPoint = /*@__PURE__*/ new Vector3();\nconst _intersectionPointWorld = /*@__PURE__*/ new Vector3();\n\nclass Mesh extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new MeshBasicMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Mesh';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tif ( source.morphTargetInfluences !== undefined ) {\n\n\t\t\tthis.morphTargetInfluences = source.morphTargetInfluences.slice();\n\n\t\t}\n\n\t\tif ( source.morphTargetDictionary !== undefined ) {\n\n\t\t\tthis.morphTargetDictionary = Object.assign( {}, source.morphTargetDictionary );\n\n\t\t}\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst morphAttributes = geometry.morphAttributes;\n\t\t\tconst keys = Object.keys( morphAttributes );\n\n\t\t\tif ( keys.length > 0 ) {\n\n\t\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst morphTargets = geometry.morphTargets;\n\n\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\n\n\t\t\t\tconsole.error( 'THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst material = this.material;\n\t\tconst matrixWorld = this.matrixWorld;\n\n\t\tif ( material === undefined ) return;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere );\n\t\t_sphere.applyMatrix4( matrixWorld );\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix.copy( matrixWorld ).invert();\n\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\n\n\t\t// Check boundingBox before continuing\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tif ( _ray.intersectsBox( geometry.boundingBox ) === false ) return;\n\n\t\t}\n\n\t\tlet intersection;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst position = geometry.attributes.position;\n\t\t\tconst morphPosition = geometry.morphAttributes.position;\n\t\t\tconst morphTargetsRelative = geometry.morphTargetsRelative;\n\t\t\tconst uv = geometry.attributes.uv;\n\t\t\tconst uv2 = geometry.attributes.uv2;\n\t\t\tconst groups = geometry.groups;\n\t\t\tconst drawRange = geometry.drawRange;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\t// indexed buffer geometry\n\n\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\tfor ( let i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\tconst start = Math.max( group.start, drawRange.start );\n\t\t\t\t\t\tconst end = Math.min( index.count, Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) ) );\n\n\t\t\t\t\t\tfor ( let j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\t\t\tconst a = index.getX( j );\n\t\t\t\t\t\t\tconst b = index.getX( j + 1 );\n\t\t\t\t\t\t\tconst c = index.getX( j + 2 );\n\n\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, groupMaterial, raycaster, _ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\n\n\t\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in indexed buffer semantics\n\t\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\n\t\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\t\tfor ( let i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\t\t\tconst a = index.getX( i );\n\t\t\t\t\t\tconst b = index.getX( i + 1 );\n\t\t\t\t\t\tconst c = index.getX( i + 2 );\n\n\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, material, raycaster, _ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indexed buffer semantics\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( position !== undefined ) {\n\n\t\t\t\t// non-indexed buffer geometry\n\n\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\tfor ( let i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\tconst start = Math.max( group.start, drawRange.start );\n\t\t\t\t\t\tconst end = Math.min( position.count, Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) ) );\n\n\t\t\t\t\t\tfor ( let j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\t\t\tconst a = j;\n\t\t\t\t\t\t\tconst b = j + 1;\n\t\t\t\t\t\t\tconst c = j + 2;\n\n\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, groupMaterial, raycaster, _ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\n\n\t\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in non-indexed buffer semantics\n\t\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\n\t\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\t\tconst end = Math.min( position.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\t\tfor ( let i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\t\t\tconst a = i;\n\t\t\t\t\t\tconst b = i + 1;\n\t\t\t\t\t\tconst c = i + 2;\n\n\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, material, raycaster, _ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in non-indexed buffer semantics\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconsole.error( 'THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t}\n\n}\n\nMesh.prototype.isMesh = true;\n\nfunction checkIntersection( object, material, raycaster, ray, pA, pB, pC, point ) {\n\n\tlet intersect;\n\n\tif ( material.side === BackSide ) {\n\n\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\n\n\t} else {\n\n\t\tintersect = ray.intersectTriangle( pA, pB, pC, material.side !== DoubleSide, point );\n\n\t}\n\n\tif ( intersect === null ) return null;\n\n\t_intersectionPointWorld.copy( point );\n\t_intersectionPointWorld.applyMatrix4( object.matrixWorld );\n\n\tconst distance = raycaster.ray.origin.distanceTo( _intersectionPointWorld );\n\n\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\n\n\treturn {\n\t\tdistance: distance,\n\t\tpoint: _intersectionPointWorld.clone(),\n\t\tobject: object\n\t};\n\n}\n\nfunction checkBufferGeometryIntersection( object, material, raycaster, ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c ) {\n\n\t_vA.fromBufferAttribute( position, a );\n\t_vB.fromBufferAttribute( position, b );\n\t_vC.fromBufferAttribute( position, c );\n\n\tconst morphInfluences = object.morphTargetInfluences;\n\n\tif ( morphPosition && morphInfluences ) {\n\n\t\t_morphA.set( 0, 0, 0 );\n\t\t_morphB.set( 0, 0, 0 );\n\t\t_morphC.set( 0, 0, 0 );\n\n\t\tfor ( let i = 0, il = morphPosition.length; i < il; i ++ ) {\n\n\t\t\tconst influence = morphInfluences[ i ];\n\t\t\tconst morphAttribute = morphPosition[ i ];\n\n\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t_tempA.fromBufferAttribute( morphAttribute, a );\n\t\t\t_tempB.fromBufferAttribute( morphAttribute, b );\n\t\t\t_tempC.fromBufferAttribute( morphAttribute, c );\n\n\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t_morphA.addScaledVector( _tempA, influence );\n\t\t\t\t_morphB.addScaledVector( _tempB, influence );\n\t\t\t\t_morphC.addScaledVector( _tempC, influence );\n\n\t\t\t} else {\n\n\t\t\t\t_morphA.addScaledVector( _tempA.sub( _vA ), influence );\n\t\t\t\t_morphB.addScaledVector( _tempB.sub( _vB ), influence );\n\t\t\t\t_morphC.addScaledVector( _tempC.sub( _vC ), influence );\n\n\t\t\t}\n\n\t\t}\n\n\t\t_vA.add( _morphA );\n\t\t_vB.add( _morphB );\n\t\t_vC.add( _morphC );\n\n\t}\n\n\tif ( object.isSkinnedMesh ) {\n\n\t\tobject.boneTransform( a, _vA );\n\t\tobject.boneTransform( b, _vB );\n\t\tobject.boneTransform( c, _vC );\n\n\t}\n\n\tconst intersection = checkIntersection( object, material, raycaster, ray, _vA, _vB, _vC, _intersectionPoint );\n\n\tif ( intersection ) {\n\n\t\tif ( uv ) {\n\n\t\t\t_uvA.fromBufferAttribute( uv, a );\n\t\t\t_uvB.fromBufferAttribute( uv, b );\n\t\t\t_uvC.fromBufferAttribute( uv, c );\n\n\t\t\tintersection.uv = Triangle.getUV( _intersectionPoint, _vA, _vB, _vC, _uvA, _uvB, _uvC, new Vector2() );\n\n\t\t}\n\n\t\tif ( uv2 ) {\n\n\t\t\t_uvA.fromBufferAttribute( uv2, a );\n\t\t\t_uvB.fromBufferAttribute( uv2, b );\n\t\t\t_uvC.fromBufferAttribute( uv2, c );\n\n\t\t\tintersection.uv2 = Triangle.getUV( _intersectionPoint, _vA, _vB, _vC, _uvA, _uvB, _uvC, new Vector2() );\n\n\t\t}\n\n\t\tconst face = {\n\t\t\ta: a,\n\t\t\tb: b,\n\t\t\tc: c,\n\t\t\tnormal: new Vector3(),\n\t\t\tmaterialIndex: 0\n\t\t};\n\n\t\tTriangle.getNormal( _vA, _vB, _vC, face.normal );\n\n\t\tintersection.face = face;\n\n\t}\n\n\treturn intersection;\n\n}\n\nexport { Mesh };\n", "/**\n * Uniform Utilities\n */\n\nexport function cloneUniforms( src ) {\n\n\tconst dst = {};\n\n\tfor ( const u in src ) {\n\n\t\tdst[ u ] = {};\n\n\t\tfor ( const p in src[ u ] ) {\n\n\t\t\tconst property = src[ u ][ p ];\n\n\t\t\tif ( property && ( property.isColor ||\n\t\t\t\tproperty.isMatrix3 || property.isMatrix4 ||\n\t\t\t\tproperty.isVector2 || property.isVector3 || property.isVector4 ||\n\t\t\t\tproperty.isTexture || property.isQuaternion ) ) {\n\n\t\t\t\tdst[ u ][ p ] = property.clone();\n\n\t\t\t} else if ( Array.isArray( property ) ) {\n\n\t\t\t\tdst[ u ][ p ] = property.slice();\n\n\t\t\t} else {\n\n\t\t\t\tdst[ u ][ p ] = property;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn dst;\n\n}\n\nexport function mergeUniforms( uniforms ) {\n\n\tconst merged = {};\n\n\tfor ( let u = 0; u < uniforms.length; u ++ ) {\n\n\t\tconst tmp = cloneUniforms( uniforms[ u ] );\n\n\t\tfor ( const p in tmp ) {\n\n\t\t\tmerged[ p ] = tmp[ p ];\n\n\t\t}\n\n\t}\n\n\treturn merged;\n\n}\n\n// Legacy\n\nconst UniformsUtils = { clone: cloneUniforms, merge: mergeUniforms };\n\nexport { UniformsUtils };\n", "export default /* glsl */`\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n`;\n", "export default /* glsl */`\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n`;\n", "import { Material } from './Material.js';\nimport { cloneUniforms } from '../renderers/shaders/UniformsUtils.js';\n\nimport default_vertex from '../renderers/shaders/ShaderChunk/default_vertex.glsl.js';\nimport default_fragment from '../renderers/shaders/ShaderChunk/default_fragment.glsl.js';\n\nclass ShaderMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ShaderMaterial';\n\n\t\tthis.defines = {};\n\t\tthis.uniforms = {};\n\n\t\tthis.vertexShader = default_vertex;\n\t\tthis.fragmentShader = default_fragment;\n\n\t\tthis.linewidth = 1;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false; // set to use scene fog\n\t\tthis.lights = false; // set to use scene lights\n\t\tthis.clipping = false; // set to use user-defined clipping planes\n\n\t\tthis.extensions = {\n\t\t\tderivatives: false, // set to use derivatives\n\t\t\tfragDepth: false, // set to use fragment depth values\n\t\t\tdrawBuffers: false, // set to use draw buffers\n\t\t\tshaderTextureLOD: false // set to use shader texture LOD\n\t\t};\n\n\t\t// When rendered geometry doesn't include these attributes but the material does,\n\t\t// use these default values in WebGL. This avoids errors when buffer data is missing.\n\t\tthis.defaultAttributeValues = {\n\t\t\t'color': [ 1, 1, 1 ],\n\t\t\t'uv': [ 0, 0 ],\n\t\t\t'uv2': [ 0, 0 ]\n\t\t};\n\n\t\tthis.index0AttributeName = undefined;\n\t\tthis.uniformsNeedUpdate = false;\n\n\t\tthis.glslVersion = null;\n\n\t\tif ( parameters !== undefined ) {\n\n\t\t\tif ( parameters.attributes !== undefined ) {\n\n\t\t\t\tconsole.error( 'THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t\tthis.setValues( parameters );\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.fragmentShader = source.fragmentShader;\n\t\tthis.vertexShader = source.vertexShader;\n\n\t\tthis.uniforms = cloneUniforms( source.uniforms );\n\n\t\tthis.defines = Object.assign( {}, source.defines );\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.lights = source.lights;\n\t\tthis.clipping = source.clipping;\n\n\t\tthis.extensions = Object.assign( {}, source.extensions );\n\n\t\tthis.glslVersion = source.glslVersion;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.glslVersion = this.glslVersion;\n\t\tdata.uniforms = {};\n\n\t\tfor ( const name in this.uniforms ) {\n\n\t\t\tconst uniform = this.uniforms[ name ];\n\t\t\tconst value = uniform.value;\n\n\t\t\tif ( value && value.isTexture ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 't',\n\t\t\t\t\tvalue: value.toJSON( meta ).uuid\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isColor ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'c',\n\t\t\t\t\tvalue: value.getHex()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector2 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v2',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector3 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v3',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector4 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v4',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isMatrix3 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'm3',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isMatrix4 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'm4',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\tvalue: value\n\t\t\t\t};\n\n\t\t\t\t// note: the array variants v2v, v3v, v4v, m4v and tv are not supported so far\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( Object.keys( this.defines ).length > 0 ) data.defines = this.defines;\n\n\t\tdata.vertexShader = this.vertexShader;\n\t\tdata.fragmentShader = this.fragmentShader;\n\n\t\tconst extensions = {};\n\n\t\tfor ( const key in this.extensions ) {\n\n\t\t\tif ( this.extensions[ key ] === true ) extensions[ key ] = true;\n\n\t\t}\n\n\t\tif ( Object.keys( extensions ).length > 0 ) data.extensions = extensions;\n\n\t\treturn data;\n\n\t}\n\n}\n\nShaderMaterial.prototype.isShaderMaterial = true;\n\nexport { ShaderMaterial };\n", "import { Matrix4 } from '../math/Matrix4.js';\nimport { Object3D } from '../core/Object3D.js';\n\nclass Camera extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'Camera';\n\n\t\tthis.matrixWorldInverse = new Matrix4();\n\n\t\tthis.projectionMatrix = new Matrix4();\n\t\tthis.projectionMatrixInverse = new Matrix4();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\n\n\t\tthis.projectionMatrix.copy( source.projectionMatrix );\n\t\tthis.projectionMatrixInverse.copy( source.projectionMatrixInverse );\n\n\t\treturn this;\n\n\t}\n\n\tgetWorldDirection( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tconst e = this.matrixWorld.elements;\n\n\t\treturn target.set( - e[ 8 ], - e[ 9 ], - e[ 10 ] ).normalize();\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tthis.matrixWorldInverse.copy( this.matrixWorld ).invert();\n\n\t}\n\n\tupdateWorldMatrix( updateParents, updateChildren ) {\n\n\t\tsuper.updateWorldMatrix( updateParents, updateChildren );\n\n\t\tthis.matrixWorldInverse.copy( this.matrixWorld ).invert();\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nCamera.prototype.isCamera = true;\n\nexport { Camera };\n", "import { Camera } from './Camera.js';\nimport * as MathUtils from '../math/MathUtils.js';\n\nclass PerspectiveCamera extends Camera {\n\n\tconstructor( fov = 50, aspect = 1, near = 0.1, far = 2000 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PerspectiveCamera';\n\n\t\tthis.fov = fov;\n\t\tthis.zoom = 1;\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\t\tthis.focus = 10;\n\n\t\tthis.aspect = aspect;\n\t\tthis.view = null;\n\n\t\tthis.filmGauge = 35;\t// width of the film (default in millimeters)\n\t\tthis.filmOffset = 0;\t// horizontal film offset (same unit as gauge)\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.fov = source.fov;\n\t\tthis.zoom = source.zoom;\n\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\t\tthis.focus = source.focus;\n\n\t\tthis.aspect = source.aspect;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\tthis.filmGauge = source.filmGauge;\n\t\tthis.filmOffset = source.filmOffset;\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Sets the FOV by focal length in respect to the current .filmGauge.\n\t *\n\t * The default film gauge is 35, so that the focal length can be specified for\n\t * a 35mm (full frame) camera.\n\t *\n\t * Values for focal length and film gauge must have the same unit.\n\t */\n\tsetFocalLength( focalLength ) {\n\n\t\t/** see {@link http://www.bobatkins.com/photography/technical/field_of_view.html} */\n\t\tconst vExtentSlope = 0.5 * this.getFilmHeight() / focalLength;\n\n\t\tthis.fov = MathUtils.RAD2DEG * 2 * Math.atan( vExtentSlope );\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\t/**\n\t * Calculates the focal length from the current .fov and .filmGauge.\n\t */\n\tgetFocalLength() {\n\n\t\tconst vExtentSlope = Math.tan( MathUtils.DEG2RAD * 0.5 * this.fov );\n\n\t\treturn 0.5 * this.getFilmHeight() / vExtentSlope;\n\n\t}\n\n\tgetEffectiveFOV() {\n\n\t\treturn MathUtils.RAD2DEG * 2 * Math.atan(\n\t\t\tMath.tan( MathUtils.DEG2RAD * 0.5 * this.fov ) / this.zoom );\n\n\t}\n\n\tgetFilmWidth() {\n\n\t\t// film not completely covered in portrait format (aspect < 1)\n\t\treturn this.filmGauge * Math.min( this.aspect, 1 );\n\n\t}\n\n\tgetFilmHeight() {\n\n\t\t// film not completely covered in landscape format (aspect > 1)\n\t\treturn this.filmGauge / Math.max( this.aspect, 1 );\n\n\t}\n\n\t/**\n\t * Sets an offset in a larger frustum. This is useful for multi-window or\n\t * multi-monitor/multi-machine setups.\n\t *\n\t * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\n\t * the monitors are in grid like this\n\t *\n\t *   +---+---+---+\n\t *   | A | B | C |\n\t *   +---+---+---+\n\t *   | D | E | F |\n\t *   +---+---+---+\n\t *\n\t * then for each monitor you would call it like this\n\t *\n\t *   const w = 1920;\n\t *   const h = 1080;\n\t *   const fullWidth = w * 3;\n\t *   const fullHeight = h * 2;\n\t *\n\t *   --A--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\n\t *   --B--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\n\t *   --C--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\n\t *   --D--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\n\t *   --E--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\n\t *   --F--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\n\t *\n\t *   Note there is no reason monitors have to be the same size or in a grid.\n\t */\n\tsetViewOffset( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tthis.aspect = fullWidth / fullHeight;\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tclearViewOffset() {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tupdateProjectionMatrix() {\n\n\t\tconst near = this.near;\n\t\tlet top = near * Math.tan( MathUtils.DEG2RAD * 0.5 * this.fov ) / this.zoom;\n\t\tlet height = 2 * top;\n\t\tlet width = this.aspect * height;\n\t\tlet left = - 0.5 * width;\n\t\tconst view = this.view;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst fullWidth = view.fullWidth,\n\t\t\t\tfullHeight = view.fullHeight;\n\n\t\t\tleft += view.offsetX * width / fullWidth;\n\t\t\ttop -= view.offsetY * height / fullHeight;\n\t\t\twidth *= view.width / fullWidth;\n\t\t\theight *= view.height / fullHeight;\n\n\t\t}\n\n\t\tconst skew = this.filmOffset;\n\t\tif ( skew !== 0 ) left += near * skew / this.getFilmWidth();\n\n\t\tthis.projectionMatrix.makePerspective( left, left + width, top, top - height, near, this.far );\n\n\t\tthis.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.fov = this.fov;\n\t\tdata.object.zoom = this.zoom;\n\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\t\tdata.object.focus = this.focus;\n\n\t\tdata.object.aspect = this.aspect;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\tdata.object.filmGauge = this.filmGauge;\n\t\tdata.object.filmOffset = this.filmOffset;\n\n\t\treturn data;\n\n\t}\n\n}\n\nPerspectiveCamera.prototype.isPerspectiveCamera = true;\n\nexport { PerspectiveCamera };\n", "import { Matrix3 } from './Matrix3.js';\nimport { Vector3 } from './Vector3.js';\n\nconst _vector1 = /*@__PURE__*/ new Vector3();\nconst _vector2 = /*@__PURE__*/ new Vector3();\nconst _normalMatrix = /*@__PURE__*/ new Matrix3();\n\nclass Plane {\n\n\tconstructor( normal = new Vector3( 1, 0, 0 ), constant = 0 ) {\n\n\t\t// normal is assumed to be normalized\n\n\t\tthis.normal = normal;\n\t\tthis.constant = constant;\n\n\t}\n\n\tset( normal, constant ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = constant;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponents( x, y, z, w ) {\n\n\t\tthis.normal.set( x, y, z );\n\t\tthis.constant = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromNormalAndCoplanarPoint( normal, point ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = - point.dot( this.normal );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCoplanarPoints( a, b, c ) {\n\n\t\tconst normal = _vector1.subVectors( c, b ).cross( _vector2.subVectors( a, b ) ).normalize();\n\n\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\n\n\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( plane ) {\n\n\t\tthis.normal.copy( plane.normal );\n\t\tthis.constant = plane.constant;\n\n\t\treturn this;\n\n\t}\n\n\tnormalize() {\n\n\t\t// Note: will lead to a divide by zero if the plane is invalid.\n\n\t\tconst inverseNormalLength = 1.0 / this.normal.length();\n\t\tthis.normal.multiplyScalar( inverseNormalLength );\n\t\tthis.constant *= inverseNormalLength;\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.constant *= - 1;\n\t\tthis.normal.negate();\n\n\t\treturn this;\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn this.normal.dot( point ) + this.constant;\n\n\t}\n\n\tdistanceToSphere( sphere ) {\n\n\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\n\n\t}\n\n\tprojectPoint( point, target ) {\n\n\t\treturn target.copy( this.normal ).multiplyScalar( - this.distanceToPoint( point ) ).add( point );\n\n\t}\n\n\tintersectLine( line, target ) {\n\n\t\tconst direction = line.delta( _vector1 );\n\n\t\tconst denominator = this.normal.dot( direction );\n\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\n\n\t\t\t\treturn target.copy( line.start );\n\n\t\t\t}\n\n\t\t\t// Unsure if this is the correct method to handle this case.\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\n\n\t\tif ( t < 0 || t > 1 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn target.copy( direction ).multiplyScalar( t ).add( line.start );\n\n\t}\n\n\tintersectsLine( line ) {\n\n\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\n\n\t\tconst startSign = this.distanceToPoint( line.start );\n\t\tconst endSign = this.distanceToPoint( line.end );\n\n\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsPlane( this );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\treturn sphere.intersectsPlane( this );\n\n\t}\n\n\tcoplanarPoint( target ) {\n\n\t\treturn target.copy( this.normal ).multiplyScalar( - this.constant );\n\n\t}\n\n\tapplyMatrix4( matrix, optionalNormalMatrix ) {\n\n\t\tconst normalMatrix = optionalNormalMatrix || _normalMatrix.getNormalMatrix( matrix );\n\n\t\tconst referencePoint = this.coplanarPoint( _vector1 ).applyMatrix4( matrix );\n\n\t\tconst normal = this.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\tthis.constant = - referencePoint.dot( normal );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.constant -= offset.dot( this.normal );\n\n\t\treturn this;\n\n\t}\n\n\tequals( plane ) {\n\n\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nPlane.prototype.isPlane = true;\n\nexport { Plane };\n", "import { Vector3 } from './Vector3.js';\nimport { Sphere } from './Sphere.js';\nimport { Plane } from './Plane.js';\n\nconst _sphere = /*@__PURE__*/ new Sphere();\nconst _vector = /*@__PURE__*/ new Vector3();\n\nclass Frustum {\n\n\tconstructor( p0 = new Plane(), p1 = new Plane(), p2 = new Plane(), p3 = new Plane(), p4 = new Plane(), p5 = new Plane() ) {\n\n\t\tthis.planes = [ p0, p1, p2, p3, p4, p5 ];\n\n\t}\n\n\tset( p0, p1, p2, p3, p4, p5 ) {\n\n\t\tconst planes = this.planes;\n\n\t\tplanes[ 0 ].copy( p0 );\n\t\tplanes[ 1 ].copy( p1 );\n\t\tplanes[ 2 ].copy( p2 );\n\t\tplanes[ 3 ].copy( p3 );\n\t\tplanes[ 4 ].copy( p4 );\n\t\tplanes[ 5 ].copy( p5 );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( frustum ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromProjectionMatrix( m ) {\n\n\t\tconst planes = this.planes;\n\t\tconst me = m.elements;\n\t\tconst me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\n\t\tconst me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\n\t\tconst me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\n\t\tconst me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\n\n\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\n\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\n\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\n\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\n\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\n\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\n\n\t\treturn this;\n\n\t}\n\n\tintersectsObject( object ) {\n\n\t\tconst geometry = object.geometry;\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere ).applyMatrix4( object.matrixWorld );\n\n\t\treturn this.intersectsSphere( _sphere );\n\n\t}\n\n\tintersectsSprite( sprite ) {\n\n\t\t_sphere.center.set( 0, 0, 0 );\n\t\t_sphere.radius = 0.7071067811865476;\n\t\t_sphere.applyMatrix4( sprite.matrixWorld );\n\n\t\treturn this.intersectsSphere( _sphere );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\tconst planes = this.planes;\n\t\tconst center = sphere.center;\n\t\tconst negRadius = - sphere.radius;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst distance = planes[ i ].distanceToPoint( center );\n\n\t\t\tif ( distance < negRadius ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst plane = planes[ i ];\n\n\t\t\t// corner at max distance\n\n\t\t\t_vector.x = plane.normal.x > 0 ? box.max.x : box.min.x;\n\t\t\t_vector.y = plane.normal.y > 0 ? box.max.y : box.min.y;\n\t\t\t_vector.z = plane.normal.z > 0 ? box.max.z : box.min.z;\n\n\t\t\tif ( plane.distanceToPoint( _vector ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\n\nexport { Frustum };\n", "import { Camera } from './Camera.js';\n\nclass OrthographicCamera extends Camera {\n\n\tconstructor( left = - 1, right = 1, top = 1, bottom = - 1, near = 0.1, far = 2000 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'OrthographicCamera';\n\n\t\tthis.zoom = 1;\n\t\tthis.view = null;\n\n\t\tthis.left = left;\n\t\tthis.right = right;\n\t\tthis.top = top;\n\t\tthis.bottom = bottom;\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.left = source.left;\n\t\tthis.right = source.right;\n\t\tthis.top = source.top;\n\t\tthis.bottom = source.bottom;\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\n\t\tthis.zoom = source.zoom;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\treturn this;\n\n\t}\n\n\tsetViewOffset( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tclearViewOffset() {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tupdateProjectionMatrix() {\n\n\t\tconst dx = ( this.right - this.left ) / ( 2 * this.zoom );\n\t\tconst dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\n\t\tconst cx = ( this.right + this.left ) / 2;\n\t\tconst cy = ( this.top + this.bottom ) / 2;\n\n\t\tlet left = cx - dx;\n\t\tlet right = cx + dx;\n\t\tlet top = cy + dy;\n\t\tlet bottom = cy - dy;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst scaleW = ( this.right - this.left ) / this.view.fullWidth / this.zoom;\n\t\t\tconst scaleH = ( this.top - this.bottom ) / this.view.fullHeight / this.zoom;\n\n\t\t\tleft += scaleW * this.view.offsetX;\n\t\t\tright = left + scaleW * this.view.width;\n\t\t\ttop -= scaleH * this.view.offsetY;\n\t\t\tbottom = top - scaleH * this.view.height;\n\n\t\t}\n\n\t\tthis.projectionMatrix.makeOrthographic( left, right, top, bottom, this.near, this.far );\n\n\t\tthis.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.zoom = this.zoom;\n\t\tdata.object.left = this.left;\n\t\tdata.object.right = this.right;\n\t\tdata.object.top = this.top;\n\t\tdata.object.bottom = this.bottom;\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\treturn data;\n\n\t}\n\n}\n\nOrthographicCamera.prototype.isOrthographicCamera = true;\n\nexport { OrthographicCamera };\n", "import { Material } from './Material.js';\nimport { BasicDepthPacking } from '../constants.js';\n\nclass MeshDepthMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshDepthMaterial';\n\n\t\tthis.depthPacking = BasicDepthPacking;\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.depthPacking = source.depthPacking;\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshDepthMaterial.prototype.isMeshDepthMaterial = true;\n\nexport { MeshDepthMaterial };\n", "import { Material } from './Material.js';\nimport { Vector3 } from '../math/Vector3.js';\n\nclass MeshDistanceMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshDistanceMaterial';\n\n\t\tthis.referencePosition = new Vector3();\n\t\tthis.nearDistance = 1;\n\t\tthis.farDistance = 1000;\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.fog = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.referencePosition.copy( source.referencePosition );\n\t\tthis.nearDistance = source.nearDistance;\n\t\tthis.farDistance = source.farDistance;\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshDistanceMaterial.prototype.isMeshDistanceMaterial = true;\n\nexport { MeshDistanceMaterial };\n", "import { Object3D } from '../core/Object3D.js';\n\nclass Group extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'Group';\n\n\t}\n\n}\n\nGroup.prototype.isGroup = true;\n\nexport { Group };\n", "import * as MathUtils from '../math/MathUtils.js';\nimport { StaticDrawUsage } from '../constants.js';\n\nclass InterleavedBuffer {\n\n\tconstructor( array, stride ) {\n\n\t\tthis.array = array;\n\t\tthis.stride = stride;\n\t\tthis.count = array !== undefined ? array.length / stride : 0;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.updateRange = { offset: 0, count: - 1 };\n\n\t\tthis.version = 0;\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t}\n\n\tonUploadCallback() {}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.count = source.count;\n\t\tthis.stride = source.stride;\n\t\tthis.usage = source.usage;\n\n\t\treturn this;\n\n\t}\n\n\tcopyAt( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.stride;\n\t\tindex2 *= attribute.stride;\n\n\t\tfor ( let i = 0, l = this.stride; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( value, offset = 0 ) {\n\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = MathUtils.generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = this.array.slice( 0 ).buffer;\n\n\t\t}\n\n\t\tconst array = new this.array.constructor( data.arrayBuffers[ this.array.buffer._uuid ] );\n\n\t\tconst ib = new this.constructor( array, this.stride );\n\t\tib.setUsage( this.usage );\n\n\t\treturn ib;\n\n\t}\n\n\tonUpload( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\t// generate UUID for array buffer if necessary\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = MathUtils.generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = Array.prototype.slice.call( new Uint32Array( this.array.buffer ) );\n\n\t\t}\n\n\t\t//\n\n\t\treturn {\n\t\t\tuuid: this.uuid,\n\t\t\tbuffer: this.array.buffer._uuid,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tstride: this.stride\n\t\t};\n\n\t}\n\n}\n\nInterleavedBuffer.prototype.isInterleavedBuffer = true;\n\nexport { InterleavedBuffer };\n", "import { Vector3 } from '../math/Vector3.js';\nimport { BufferAttribute } from './BufferAttribute.js';\n\nconst _vector = /*@__PURE__*/ new Vector3();\n\nclass InterleavedBufferAttribute {\n\n\tconstructor( interleavedBuffer, itemSize, offset, normalized = false ) {\n\n\t\tthis.name = '';\n\n\t\tthis.data = interleavedBuffer;\n\t\tthis.itemSize = itemSize;\n\t\tthis.offset = offset;\n\n\t\tthis.normalized = normalized === true;\n\n\t}\n\n\tget count() {\n\n\t\treturn this.data.count;\n\n\t}\n\n\tget array() {\n\n\t\treturn this.data.array;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tthis.data.needsUpdate = value;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tfor ( let i = 0, l = this.data.count; i < l; i ++ ) {\n\n\t\t\t_vector.fromBufferAttribute( this, i );\n\n\t\t\t_vector.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector.fromBufferAttribute( this, i );\n\n\t\t\t_vector.applyNormalMatrix( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector.fromBufferAttribute( this, i );\n\n\t\t\t_vector.transformDirection( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tgetX( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset ];\n\n\t}\n\n\tgetY( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 1 ];\n\n\t}\n\n\tgetZ( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 2 ];\n\n\t}\n\n\tgetW( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 3 ];\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\t\tthis.data.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( new this.array.constructor( array ), this.itemSize, this.normalized );\n\n\t\t} else {\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.clone( data );\n\n\t\t\t}\n\n\t\t\treturn new InterleavedBufferAttribute( data.interleavedBuffers[ this.data.uuid ], this.itemSize, this.offset, this.normalized );\n\n\t\t}\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// deinterleave data and save it as an ordinary buffer attribute for now\n\n\t\t\treturn {\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\ttype: this.array.constructor.name,\n\t\t\t\tarray: array,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t} else {\n\n\t\t\t// save as true interlaved attribtue\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.toJSON( data );\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tisInterleavedBufferAttribute: true,\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\tdata: this.data.uuid,\n\t\t\t\toffset: this.offset,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t}\n\n\t}\n\n}\n\nInterleavedBufferAttribute.prototype.isInterleavedBufferAttribute = true;\n\n\nexport { InterleavedBufferAttribute };\n", "import { Material } from './Material.js';\nimport { Color } from '../math/Color.js';\n\nclass SpriteMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'SpriteMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.rotation = 0;\n\n\t\tthis.sizeAttenuation = true;\n\n\t\tthis.transparent = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.rotation = source.rotation;\n\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\t\treturn this;\n\n\t}\n\n}\n\nSpriteMaterial.prototype.isSpriteMaterial = true;\n\nexport { SpriteMaterial };\n", "import { Mesh } from './Mesh.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Vector4 } from '../math/Vector4.js';\n\nconst _basePosition = /*@__PURE__*/ new Vector3();\n\nconst _skinIndex = /*@__PURE__*/ new Vector4();\nconst _skinWeight = /*@__PURE__*/ new Vector4();\n\nconst _vector = /*@__PURE__*/ new Vector3();\nconst _matrix = /*@__PURE__*/ new Matrix4();\n\nclass SkinnedMesh extends Mesh {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'SkinnedMesh';\n\n\t\tthis.bindMode = 'attached';\n\t\tthis.bindMatrix = new Matrix4();\n\t\tthis.bindMatrixInverse = new Matrix4();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.bindMode = source.bindMode;\n\t\tthis.bindMatrix.copy( source.bindMatrix );\n\t\tthis.bindMatrixInverse.copy( source.bindMatrixInverse );\n\n\t\tthis.skeleton = source.skeleton;\n\n\t\treturn this;\n\n\t}\n\n\tbind( skeleton, bindMatrix ) {\n\n\t\tthis.skeleton = skeleton;\n\n\t\tif ( bindMatrix === undefined ) {\n\n\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\tthis.skeleton.calculateInverses();\n\n\t\t\tbindMatrix = this.matrixWorld;\n\n\t\t}\n\n\t\tthis.bindMatrix.copy( bindMatrix );\n\t\tthis.bindMatrixInverse.copy( bindMatrix ).invert();\n\n\t}\n\n\tpose() {\n\n\t\tthis.skeleton.pose();\n\n\t}\n\n\tnormalizeSkinWeights() {\n\n\t\tconst vector = new Vector4();\n\n\t\tconst skinWeight = this.geometry.attributes.skinWeight;\n\n\t\tfor ( let i = 0, l = skinWeight.count; i < l; i ++ ) {\n\n\t\t\tvector.fromBufferAttribute( skinWeight, i );\n\n\t\t\tconst scale = 1.0 / vector.manhattanLength();\n\n\t\t\tif ( scale !== Infinity ) {\n\n\t\t\t\tvector.multiplyScalar( scale );\n\n\t\t\t} else {\n\n\t\t\t\tvector.set( 1, 0, 0, 0 ); // do something reasonable\n\n\t\t\t}\n\n\t\t\tskinWeight.setXYZW( i, vector.x, vector.y, vector.z, vector.w );\n\n\t\t}\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tif ( this.bindMode === 'attached' ) {\n\n\t\t\tthis.bindMatrixInverse.copy( this.matrixWorld ).invert();\n\n\t\t} else if ( this.bindMode === 'detached' ) {\n\n\t\t\tthis.bindMatrixInverse.copy( this.bindMatrix ).invert();\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.SkinnedMesh: Unrecognized bindMode: ' + this.bindMode );\n\n\t\t}\n\n\t}\n\n\tboneTransform( index, target ) {\n\n\t\tconst skeleton = this.skeleton;\n\t\tconst geometry = this.geometry;\n\n\t\t_skinIndex.fromBufferAttribute( geometry.attributes.skinIndex, index );\n\t\t_skinWeight.fromBufferAttribute( geometry.attributes.skinWeight, index );\n\n\t\t_basePosition.copy( target ).applyMatrix4( this.bindMatrix );\n\n\t\ttarget.set( 0, 0, 0 );\n\n\t\tfor ( let i = 0; i < 4; i ++ ) {\n\n\t\t\tconst weight = _skinWeight.getComponent( i );\n\n\t\t\tif ( weight !== 0 ) {\n\n\t\t\t\tconst boneIndex = _skinIndex.getComponent( i );\n\n\t\t\t\t_matrix.multiplyMatrices( skeleton.bones[ boneIndex ].matrixWorld, skeleton.boneInverses[ boneIndex ] );\n\n\t\t\t\ttarget.addScaledVector( _vector.copy( _basePosition ).applyMatrix4( _matrix ), weight );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn target.applyMatrix4( this.bindMatrixInverse );\n\n\t}\n\n}\n\nSkinnedMesh.prototype.isSkinnedMesh = true;\n\nexport { SkinnedMesh };\n", "import { Object3D } from '../core/Object3D.js';\n\nclass Bone extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'Bone';\n\n\t}\n\n}\n\nBone.prototype.isBone = true;\n\nexport { Bone };\n", "import { Texture } from './Texture.js';\nimport { NearestFilter } from '../constants.js';\n\nclass DataTexture extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, format, type, mapping, wrapS, wrapT, magFilter = NearestFilter, minFilter = NearestFilter, anisotropy, encoding ) {\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\n\n\t\tthis.image = { data: data, width: width, height: height };\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t}\n\n}\n\nDataTexture.prototype.isDataTexture = true;\n\nexport { DataTexture };\n", "import {\n\tRGBAFormat,\n\tFloatType\n} from '../constants.js';\nimport { Bone } from './Bone.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { DataTexture } from '../textures/DataTexture.js';\nimport * as MathUtils from '../math/MathUtils.js';\n\nconst _offsetMatrix = /*@__PURE__*/ new Matrix4();\nconst _identityMatrix = /*@__PURE__*/ new Matrix4();\n\nclass Skeleton {\n\n\tconstructor( bones = [], boneInverses = [] ) {\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.bones = bones.slice( 0 );\n\t\tthis.boneInverses = boneInverses;\n\t\tthis.boneMatrices = null;\n\n\t\tthis.boneTexture = null;\n\t\tthis.boneTextureSize = 0;\n\n\t\tthis.frame = - 1;\n\n\t\tthis.init();\n\n\t}\n\n\tinit() {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\n\t\tthis.boneMatrices = new Float32Array( bones.length * 16 );\n\n\t\t// calculate inverse bone matrices if necessary\n\n\t\tif ( boneInverses.length === 0 ) {\n\n\t\t\tthis.calculateInverses();\n\n\t\t} else {\n\n\t\t\t// handle special case\n\n\t\t\tif ( bones.length !== boneInverses.length ) {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.' );\n\n\t\t\t\tthis.boneInverses = [];\n\n\t\t\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\t\t\tthis.boneInverses.push( new Matrix4() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcalculateInverses() {\n\n\t\tthis.boneInverses.length = 0;\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst inverse = new Matrix4();\n\n\t\t\tif ( this.bones[ i ] ) {\n\n\t\t\t\tinverse.copy( this.bones[ i ].matrixWorld ).invert();\n\n\t\t\t}\n\n\t\t\tthis.boneInverses.push( inverse );\n\n\t\t}\n\n\t}\n\n\tpose() {\n\n\t\t// recover the bind-time world matrices\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tbone.matrixWorld.copy( this.boneInverses[ i ] ).invert();\n\n\t\t\t}\n\n\t\t}\n\n\t\t// compute the local matrices, positions, rotations and scales\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t\tbone.matrix.copy( bone.parent.matrixWorld ).invert();\n\t\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbone.matrix.copy( bone.matrixWorld );\n\n\t\t\t\t}\n\n\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdate() {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\t\tconst boneMatrices = this.boneMatrices;\n\t\tconst boneTexture = this.boneTexture;\n\n\t\t// flatten bone matrices to array\n\n\t\tfor ( let i = 0, il = bones.length; i < il; i ++ ) {\n\n\t\t\t// compute the offset between the current and the original transform\n\n\t\t\tconst matrix = bones[ i ] ? bones[ i ].matrixWorld : _identityMatrix;\n\n\t\t\t_offsetMatrix.multiplyMatrices( matrix, boneInverses[ i ] );\n\t\t\t_offsetMatrix.toArray( boneMatrices, i * 16 );\n\n\t\t}\n\n\t\tif ( boneTexture !== null ) {\n\n\t\t\tboneTexture.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new Skeleton( this.bones, this.boneInverses );\n\n\t}\n\n\tcomputeBoneTexture() {\n\n\t\t// layout (1 matrix = 4 pixels)\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\n\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\n\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\n\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\n\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\n\n\t\tlet size = Math.sqrt( this.bones.length * 4 ); // 4 pixels needed for 1 matrix\n\t\tsize = MathUtils.ceilPowerOfTwo( size );\n\t\tsize = Math.max( size, 4 );\n\n\t\tconst boneMatrices = new Float32Array( size * size * 4 ); // 4 floats per RGBA pixel\n\t\tboneMatrices.set( this.boneMatrices ); // copy current values\n\n\t\tconst boneTexture = new DataTexture( boneMatrices, size, size, RGBAFormat, FloatType );\n\t\tboneTexture.needsUpdate = true;\n\n\t\tthis.boneMatrices = boneMatrices;\n\t\tthis.boneTexture = boneTexture;\n\t\tthis.boneTextureSize = size;\n\n\t\treturn this;\n\n\t}\n\n\tgetBoneByName( name ) {\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone.name === name ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\tdispose( ) {\n\n\t\tif ( this.boneTexture !== null ) {\n\n\t\t\tthis.boneTexture.dispose();\n\n\t\t\tthis.boneTexture = null;\n\n\t\t}\n\n\t}\n\n\tfromJSON( json, bones ) {\n\n\t\tthis.uuid = json.uuid;\n\n\t\tfor ( let i = 0, l = json.bones.length; i < l; i ++ ) {\n\n\t\t\tconst uuid = json.bones[ i ];\n\t\t\tlet bone = bones[ uuid ];\n\n\t\t\tif ( bone === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton: No bone found with UUID:', uuid );\n\t\t\t\tbone = new Bone();\n\n\t\t\t}\n\n\t\t\tthis.bones.push( bone );\n\t\t\tthis.boneInverses.push( new Matrix4().fromArray( json.boneInverses[ i ] ) );\n\n\t\t}\n\n\t\tthis.init();\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Skeleton',\n\t\t\t\tgenerator: 'Skeleton.toJSON'\n\t\t\t},\n\t\t\tbones: [],\n\t\t\tboneInverses: []\n\t\t};\n\n\t\tdata.uuid = this.uuid;\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\n\t\tfor ( let i = 0, l = bones.length; i < l; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\t\t\tdata.bones.push( bone.uuid );\n\n\t\t\tconst boneInverse = boneInverses[ i ];\n\t\t\tdata.boneInverses.push( boneInverse.toArray() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nexport { Skeleton };\n", "import { BufferAttribute } from './BufferAttribute.js';\n\nclass InstancedBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized, meshPerAttribute = 1 ) {\n\n\t\tif ( typeof normalized === 'number' ) {\n\n\t\t\tmeshPerAttribute = normalized;\n\n\t\t\tnormalized = false;\n\n\t\t\tconsole.error( 'THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.' );\n\n\t\t}\n\n\t\tsuper( array, itemSize, normalized );\n\n\t\tthis.meshPerAttribute = meshPerAttribute;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.meshPerAttribute = this.meshPerAttribute;\n\n\t\tdata.isInstancedBufferAttribute = true;\n\n\t\treturn data;\n\n\t}\n\n}\n\nInstancedBufferAttribute.prototype.isInstancedBufferAttribute = true;\n\nexport { InstancedBufferAttribute };\n", "import { InstancedBufferAttribute } from '../core/InstancedBufferAttribute.js';\nimport { Mesh } from './Mesh.js';\nimport { Matrix4 } from '../math/Matrix4.js';\n\nconst _instanceLocalMatrix = /*@__PURE__*/ new Matrix4();\nconst _instanceWorldMatrix = /*@__PURE__*/ new Matrix4();\n\nconst _instanceIntersects = [];\n\nconst _mesh = /*@__PURE__*/ new Mesh();\n\nclass InstancedMesh extends Mesh {\n\n\tconstructor( geometry, material, count ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.instanceMatrix = new InstancedBufferAttribute( new Float32Array( count * 16 ), 16 );\n\t\tthis.instanceColor = null;\n\n\t\tthis.count = count;\n\n\t\tthis.frustumCulled = false;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.instanceMatrix.copy( source.instanceMatrix );\n\n\t\tif ( source.instanceColor !== null ) this.instanceColor = source.instanceColor.clone();\n\n\t\tthis.count = source.count;\n\n\t\treturn this;\n\n\t}\n\n\tgetColorAt( index, color ) {\n\n\t\tcolor.fromArray( this.instanceColor.array, index * 3 );\n\n\t}\n\n\tgetMatrixAt( index, matrix ) {\n\n\t\tmatrix.fromArray( this.instanceMatrix.array, index * 16 );\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst raycastTimes = this.count;\n\n\t\t_mesh.geometry = this.geometry;\n\t\t_mesh.material = this.material;\n\n\t\tif ( _mesh.material === undefined ) return;\n\n\t\tfor ( let instanceId = 0; instanceId < raycastTimes; instanceId ++ ) {\n\n\t\t\t// calculate the world matrix for each instance\n\n\t\t\tthis.getMatrixAt( instanceId, _instanceLocalMatrix );\n\n\t\t\t_instanceWorldMatrix.multiplyMatrices( matrixWorld, _instanceLocalMatrix );\n\n\t\t\t// the mesh represents this single instance\n\n\t\t\t_mesh.matrixWorld = _instanceWorldMatrix;\n\n\t\t\t_mesh.raycast( raycaster, _instanceIntersects );\n\n\t\t\t// process the result of raycast\n\n\t\t\tfor ( let i = 0, l = _instanceIntersects.length; i < l; i ++ ) {\n\n\t\t\t\tconst intersect = _instanceIntersects[ i ];\n\t\t\t\tintersect.instanceId = instanceId;\n\t\t\t\tintersect.object = this;\n\t\t\t\tintersects.push( intersect );\n\n\t\t\t}\n\n\t\t\t_instanceIntersects.length = 0;\n\n\t\t}\n\n\t}\n\n\tsetColorAt( index, color ) {\n\n\t\tif ( this.instanceColor === null ) {\n\n\t\t\tthis.instanceColor = new InstancedBufferAttribute( new Float32Array( this.instanceMatrix.count * 3 ), 3 );\n\n\t\t}\n\n\t\tcolor.toArray( this.instanceColor.array, index * 3 );\n\n\t}\n\n\tsetMatrixAt( index, matrix ) {\n\n\t\tmatrix.toArray( this.instanceMatrix.array, index * 16 );\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nInstancedMesh.prototype.isInstancedMesh = true;\n\nexport { InstancedMesh };\n", "import { Material } from './Material.js';\nimport { Color } from '../math/Color.js';\n\nclass LineBasicMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LineBasicMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.linewidth = 1;\n\t\tthis.linecap = 'round';\n\t\tthis.linejoin = 'round';\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.linewidth = source.linewidth;\n\t\tthis.linecap = source.linecap;\n\t\tthis.linejoin = source.linejoin;\n\n\t\treturn this;\n\n\t}\n\n}\n\nLineBasicMaterial.prototype.isLineBasicMaterial = true;\n\nexport { LineBasicMaterial };\n", "import { Sphere } from '../math/Sphere.js';\nimport { Ray } from '../math/Ray.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Object3D } from '../core/Object3D.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { LineBasicMaterial } from '../materials/LineBasicMaterial.js';\nimport { BufferGeometry } from '../core/BufferGeometry.js';\nimport { Float32BufferAttribute } from '../core/BufferAttribute.js';\n\nconst _start = /*@__PURE__*/ new Vector3();\nconst _end = /*@__PURE__*/ new Vector3();\nconst _inverseMatrix = /*@__PURE__*/ new Matrix4();\nconst _ray = /*@__PURE__*/ new Ray();\nconst _sphere = /*@__PURE__*/ new Sphere();\n\nclass Line extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new LineBasicMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Line';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\t// we assume non-indexed geometry\n\n\t\t\tif ( geometry.index === null ) {\n\n\t\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\t\tconst lineDistances = [ 0 ];\n\n\t\t\t\tfor ( let i = 1, l = positionAttribute.count; i < l; i ++ ) {\n\n\t\t\t\t\t_start.fromBufferAttribute( positionAttribute, i - 1 );\n\t\t\t\t\t_end.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\t\tlineDistances[ i ] = lineDistances[ i - 1 ];\n\t\t\t\t\tlineDistances[ i ] += _start.distanceTo( _end );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconsole.error( 'THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Line.threshold;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere );\n\t\t_sphere.applyMatrix4( matrixWorld );\n\t\t_sphere.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix.copy( matrixWorld ).invert();\n\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tconst vStart = new Vector3();\n\t\tconst vEnd = new Vector3();\n\t\tconst interSegment = new Vector3();\n\t\tconst interRay = new Vector3();\n\t\tconst step = this.isLineSegments ? 2 : 1;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst attributes = geometry.attributes;\n\t\t\tconst positionAttribute = attributes.position;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, l = end - 1; i < l; i += step ) {\n\n\t\t\t\t\tconst a = index.getX( i );\n\t\t\t\t\tconst b = index.getX( i + 1 );\n\n\t\t\t\t\tvStart.fromBufferAttribute( positionAttribute, a );\n\t\t\t\t\tvEnd.fromBufferAttribute( positionAttribute, b );\n\n\t\t\t\t\tconst distSq = _ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\t\tif ( distSq > localThresholdSq ) continue;\n\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, l = end - 1; i < l; i += step ) {\n\n\t\t\t\t\tvStart.fromBufferAttribute( positionAttribute, i );\n\t\t\t\t\tvEnd.fromBufferAttribute( positionAttribute, i + 1 );\n\n\t\t\t\t\tconst distSq = _ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\t\tif ( distSq > localThresholdSq ) continue;\n\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconsole.error( 'THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst morphAttributes = geometry.morphAttributes;\n\t\t\tconst keys = Object.keys( morphAttributes );\n\n\t\t\tif ( keys.length > 0 ) {\n\n\t\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst morphTargets = geometry.morphTargets;\n\n\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\n\n\t\t\t\tconsole.error( 'THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nLine.prototype.isLine = true;\n\n\nexport { Line };\n", "import { Line } from './Line.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Float32BufferAttribute } from '../core/BufferAttribute.js';\n\nconst _start = /*@__PURE__*/ new Vector3();\nconst _end = /*@__PURE__*/ new Vector3();\n\nclass LineSegments extends Line {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'LineSegments';\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\t// we assume non-indexed geometry\n\n\t\t\tif ( geometry.index === null ) {\n\n\t\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\t\tconst lineDistances = [];\n\n\t\t\t\tfor ( let i = 0, l = positionAttribute.count; i < l; i += 2 ) {\n\n\t\t\t\t\t_start.fromBufferAttribute( positionAttribute, i );\n\t\t\t\t\t_end.fromBufferAttribute( positionAttribute, i + 1 );\n\n\t\t\t\t\tlineDistances[ i ] = ( i === 0 ) ? 0 : lineDistances[ i - 1 ];\n\t\t\t\t\tlineDistances[ i + 1 ] = lineDistances[ i ] + _start.distanceTo( _end );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconsole.error( 'THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nLineSegments.prototype.isLineSegments = true;\n\nexport { LineSegments };\n", "import { Line } from './Line.js';\n\nclass LineLoop extends Line {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'LineLoop';\n\n\t}\n\n}\n\nLineLoop.prototype.isLineLoop = true;\n\nexport { LineLoop };\n", "import { Material } from './Material.js';\nimport { Color } from '../math/Color.js';\n\nclass PointsMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PointsMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.size = 1;\n\t\tthis.sizeAttenuation = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.size = source.size;\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\t\treturn this;\n\n\t}\n\n}\n\nPointsMaterial.prototype.isPointsMaterial = true;\n\nexport { PointsMaterial };\n", "import { Sphere } from '../math/Sphere.js';\nimport { Ray } from '../math/Ray.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Object3D } from '../core/Object3D.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { PointsMaterial } from '../materials/PointsMaterial.js';\nimport { BufferGeometry } from '../core/BufferGeometry.js';\n\nconst _inverseMatrix = /*@__PURE__*/ new Matrix4();\nconst _ray = /*@__PURE__*/ new Ray();\nconst _sphere = /*@__PURE__*/ new Sphere();\nconst _position = /*@__PURE__*/ new Vector3();\n\nclass Points extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new PointsMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Points';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Points.threshold;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere );\n\t\t_sphere.applyMatrix4( matrixWorld );\n\t\t_sphere.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix.copy( matrixWorld ).invert();\n\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst attributes = geometry.attributes;\n\t\t\tconst positionAttribute = attributes.position;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, il = end; i < il; i ++ ) {\n\n\t\t\t\t\tconst a = index.getX( i );\n\n\t\t\t\t\t_position.fromBufferAttribute( positionAttribute, a );\n\n\t\t\t\t\ttestPoint( _position, a, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, l = end; i < l; i ++ ) {\n\n\t\t\t\t\t_position.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\t\ttestPoint( _position, i, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst morphAttributes = geometry.morphAttributes;\n\t\t\tconst keys = Object.keys( morphAttributes );\n\n\t\t\tif ( keys.length > 0 ) {\n\n\t\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst morphTargets = geometry.morphTargets;\n\n\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\n\n\t\t\t\tconsole.error( 'THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nPoints.prototype.isPoints = true;\n\nfunction testPoint( point, index, localThresholdSq, matrixWorld, raycaster, intersects, object ) {\n\n\tconst rayPointDistanceSq = _ray.distanceSqToPoint( point );\n\n\tif ( rayPointDistanceSq < localThresholdSq ) {\n\n\t\tconst intersectPoint = new Vector3();\n\n\t\t_ray.closestPointToPoint( point, intersectPoint );\n\t\tintersectPoint.applyMatrix4( matrixWorld );\n\n\t\tconst distance = raycaster.ray.origin.distanceTo( intersectPoint );\n\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\tintersects.push( {\n\n\t\t\tdistance: distance,\n\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\n\t\t\tpoint: intersectPoint,\n\t\t\tindex: index,\n\t\t\tface: null,\n\t\t\tobject: object\n\n\t\t} );\n\n\t}\n\n}\n\nexport { Points };\n", "import { Material } from './Material.js';\nimport { Color } from '../math/Color.js';\n\nclass ShadowMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ShadowMaterial';\n\n\t\tthis.color = new Color( 0x000000 );\n\t\tthis.transparent = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\treturn this;\n\n\t}\n\n}\n\nShadowMaterial.prototype.isShadowMaterial = true;\n\nexport { ShadowMaterial };\n", "import { ShaderMaterial } from './ShaderMaterial.js';\n\nclass RawShaderMaterial extends ShaderMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.type = 'RawShaderMaterial';\n\n\t}\n\n}\n\nRawShaderMaterial.prototype.isRawShaderMaterial = true;\n\nexport { RawShaderMaterial };\n", "import { TangentSpaceNormalMap } from '../constants.js';\nimport { Material } from './Material.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Color } from '../math/Color.js';\n\nclass MeshStandardMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.type = 'MeshStandardMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.roughness = 1.0;\n\t\tthis.metalness = 0.0;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.roughnessMap = null;\n\n\t\tthis.metalnessMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.envMapIntensity = 1.0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.color.copy( source.color );\n\t\tthis.roughness = source.roughness;\n\t\tthis.metalness = source.metalness;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.roughnessMap = source.roughnessMap;\n\n\t\tthis.metalnessMap = source.metalnessMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapIntensity = source.envMapIntensity;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshStandardMaterial.prototype.isMeshStandardMaterial = true;\n\nexport { MeshStandardMaterial };\n", "import { Vector2 } from '../math/Vector2.js';\nimport { MeshStandardMaterial } from './MeshStandardMaterial.js';\nimport { Color } from '../math/Color.js';\nimport * as MathUtils from '../math/MathUtils.js';\n\nclass MeshPhysicalMaterial extends MeshStandardMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.defines = {\n\n\t\t\t'STANDARD': '',\n\t\t\t'PHYSICAL': ''\n\n\t\t};\n\n\t\tthis.type = 'MeshPhysicalMaterial';\n\n\t\tthis.clearcoatMap = null;\n\t\tthis.clearcoatRoughness = 0.0;\n\t\tthis.clearcoatRoughnessMap = null;\n\t\tthis.clearcoatNormalScale = new Vector2( 1, 1 );\n\t\tthis.clearcoatNormalMap = null;\n\n\t\tthis.ior = 1.5;\n\n\t\tObject.defineProperty( this, 'reflectivity', {\n\t\t\tget: function () {\n\n\t\t\t\treturn ( MathUtils.clamp( 2.5 * ( this.ior - 1 ) / ( this.ior + 1 ), 0, 1 ) );\n\n\t\t\t},\n\t\t\tset: function ( reflectivity ) {\n\n\t\t\t\tthis.ior = ( 1 + 0.4 * reflectivity ) / ( 1 - 0.4 * reflectivity );\n\n\t\t\t}\n\t\t} );\n\n\t\tthis.sheenColor = new Color( 0x000000 );\n\t\tthis.sheenColorMap = null;\n\t\tthis.sheenRoughness = 1.0;\n\t\tthis.sheenRoughnessMap = null;\n\n\t\tthis.transmissionMap = null;\n\n\t\tthis.thickness = 0;\n\t\tthis.thicknessMap = null;\n\t\tthis.attenuationDistance = 0.0;\n\t\tthis.attenuationColor = new Color( 1, 1, 1 );\n\n\t\tthis.specularIntensity = 1.0;\n\t\tthis.specularIntensityMap = null;\n\t\tthis.specularColor = new Color( 1, 1, 1 );\n\t\tthis.specularColorMap = null;\n\n\t\tthis._sheen = 0.0;\n\t\tthis._clearcoat = 0;\n\t\tthis._transmission = 0;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tget sheen() {\n\n\t\treturn this._sheen;\n\n\t}\n\n\tset sheen( value ) {\n\n\t\tif ( this._sheen > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._sheen = value;\n\n\t}\n\n\tget clearcoat() {\n\n\t\treturn this._clearcoat;\n\n\t}\n\n\tset clearcoat( value ) {\n\n\t\tif ( this._clearcoat > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._clearcoat = value;\n\n\t}\n\n\tget transmission() {\n\n\t\treturn this._transmission;\n\n\t}\n\n\tset transmission( value ) {\n\n\t\tif ( this._transmission > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._transmission = value;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = {\n\n\t\t\t'STANDARD': '',\n\t\t\t'PHYSICAL': ''\n\n\t\t};\n\n\t\tthis.clearcoat = source.clearcoat;\n\t\tthis.clearcoatMap = source.clearcoatMap;\n\t\tthis.clearcoatRoughness = source.clearcoatRoughness;\n\t\tthis.clearcoatRoughnessMap = source.clearcoatRoughnessMap;\n\t\tthis.clearcoatNormalMap = source.clearcoatNormalMap;\n\t\tthis.clearcoatNormalScale.copy( source.clearcoatNormalScale );\n\n\t\tthis.ior = source.ior;\n\n\t\tthis.sheen = source.sheen;\n\t\tthis.sheenColor.copy( source.sheenColor );\n\t\tthis.sheenColorMap = source.sheenColorMap;\n\t\tthis.sheenRoughness = source.sheenRoughness;\n\t\tthis.sheenRoughnessMap = source.sheenRoughnessMap;\n\n\t\tthis.transmission = source.transmission;\n\t\tthis.transmissionMap = source.transmissionMap;\n\n\t\tthis.thickness = source.thickness;\n\t\tthis.thicknessMap = source.thicknessMap;\n\t\tthis.attenuationDistance = source.attenuationDistance;\n\t\tthis.attenuationColor.copy( source.attenuationColor );\n\n\t\tthis.specularIntensity = source.specularIntensity;\n\t\tthis.specularIntensityMap = source.specularIntensityMap;\n\t\tthis.specularColor.copy( source.specularColor );\n\t\tthis.specularColorMap = source.specularColorMap;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshPhysicalMaterial.prototype.isMeshPhysicalMaterial = true;\n\nexport { MeshPhysicalMaterial };\n", "import { MultiplyOperation, TangentSpaceNormalMap } from '../constants.js';\nimport { Material } from './Material.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Color } from '../math/Color.js';\n\nclass MeshPhongMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshPhongMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.specular = new Color( 0x111111 );\n\t\tthis.shininess = 30;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.specular.copy( source.specular );\n\t\tthis.shininess = source.shininess;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshPhongMaterial.prototype.isMeshPhongMaterial = true;\n\nexport { MeshPhongMaterial };\n", "import { TangentSpaceNormalMap } from '../constants.js';\nimport { Material } from './Material.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Color } from '../math/Color.js';\n\nclass MeshToonMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.defines = { 'TOON': '' };\n\n\t\tthis.type = 'MeshToonMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\t\tthis.gradientMap = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\t\tthis.gradientMap = source.gradientMap;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshToonMaterial.prototype.isMeshToonMaterial = true;\n\nexport { MeshToonMaterial };\n", "import { TangentSpaceNormalMap } from '../constants.js';\nimport { Material } from './Material.js';\nimport { Vector2 } from '../math/Vector2.js';\n\nclass MeshNormalMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshNormalMaterial';\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false;\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshNormalMaterial.prototype.isMeshNormalMaterial = true;\n\nexport { MeshNormalMaterial };\n", "import { Material } from './Material.js';\nimport { MultiplyOperation } from '../constants.js';\nimport { Color } from '../math/Color.js';\n\nclass MeshLambertMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshLambertMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshLambertMaterial.prototype.isMeshLambertMaterial = true;\n\nexport { MeshLambertMaterial };\n", "import { TangentSpaceNormalMap } from '../constants.js';\nimport { Material } from './Material.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Color } from '../math/Color.js';\n\nclass MeshMatcapMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.defines = { 'MATCAP': '' };\n\n\t\tthis.type = 'MeshMatcapMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\n\t\tthis.matcap = null;\n\n\t\tthis.map = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = { 'MATCAP': '' };\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.matcap = source.matcap;\n\n\t\tthis.map = source.map;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshMatcapMaterial.prototype.isMeshMatcapMaterial = true;\n\nexport { MeshMatcapMaterial };\n", "import { LineBasicMaterial } from './LineBasicMaterial.js';\n\nclass LineDashedMaterial extends LineBasicMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LineDashedMaterial';\n\n\t\tthis.scale = 1;\n\t\tthis.dashSize = 3;\n\t\tthis.gapSize = 1;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.scale = source.scale;\n\t\tthis.dashSize = source.dashSize;\n\t\tthis.gapSize = source.gapSize;\n\n\t\treturn this;\n\n\t}\n\n}\n\nLineDashedMaterial.prototype.isLineDashedMaterial = true;\n\nexport { LineDashedMaterial };\n", "import { ShadowMaterial } from './ShadowMaterial.js';\nimport { SpriteMaterial } from './SpriteMaterial.js';\nimport { RawShaderMaterial } from './RawShaderMaterial.js';\nimport { ShaderMaterial } from './ShaderMaterial.js';\nimport { PointsMaterial } from './PointsMaterial.js';\nimport { MeshPhysicalMaterial } from './MeshPhysicalMaterial.js';\nimport { MeshStandardMaterial } from './MeshStandardMaterial.js';\nimport { MeshPhongMaterial } from './MeshPhongMaterial.js';\nimport { MeshToonMaterial } from './MeshToonMaterial.js';\nimport { MeshNormalMaterial } from './MeshNormalMaterial.js';\nimport { MeshLambertMaterial } from './MeshLambertMaterial.js';\nimport { MeshDepthMaterial } from './MeshDepthMaterial.js';\nimport { MeshDistanceMaterial } from './MeshDistanceMaterial.js';\nimport { MeshBasicMaterial } from './MeshBasicMaterial.js';\nimport { MeshMatcapMaterial } from './MeshMatcapMaterial.js';\nimport { LineDashedMaterial } from './LineDashedMaterial.js';\nimport { LineBasicMaterial } from './LineBasicMaterial.js';\nimport { Material } from './Material.js';\n\nexport {\n\tShadowMaterial,\n\tSpriteMaterial,\n\tRawShaderMaterial,\n\tShaderMaterial,\n\tPointsMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMeshPhongMaterial,\n\tMeshToonMaterial,\n\tMeshNormalMaterial,\n\tMeshLambertMaterial,\n\tMeshDepthMaterial,\n\tMeshDistanceMaterial,\n\tMeshBasicMaterial,\n\tMeshMatcapMaterial,\n\tLineDashedMaterial,\n\tLineBasicMaterial,\n\tMaterial\n};\n\nconst materialLib = {\n\tShadowMaterial,\n\tSpriteMaterial,\n\tRawShaderMaterial,\n\tShaderMaterial,\n\tPointsMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMeshPhongMaterial,\n\tMeshToonMaterial,\n\tMeshNormalMaterial,\n\tMeshLambertMaterial,\n\tMeshDepthMaterial,\n\tMeshDistanceMaterial,\n\tMeshBasicMaterial,\n\tMeshMatcapMaterial,\n\tLineDashedMaterial,\n\tLineBasicMaterial,\n\tMaterial\n};\n\nMaterial.fromType = function ( type ) {\n\n\treturn new materialLib[ type ]();\n\n};\n", "import { Quaternion } from '../math/Quaternion.js';\nimport { AdditiveAnimationBlendMode } from '../constants.js';\n\nconst AnimationUtils = {\n\n\t// same as Array.prototype.slice, but also works on typed arrays\n\tarraySlice: function ( array, from, to ) {\n\n\t\tif ( AnimationUtils.isTypedArray( array ) ) {\n\n\t\t\t// in ios9 array.subarray(from, undefined) will return empty array\n\t\t\t// but array.subarray(from) or array.subarray(from, len) is correct\n\t\t\treturn new array.constructor( array.subarray( from, to !== undefined ? to : array.length ) );\n\n\t\t}\n\n\t\treturn array.slice( from, to );\n\n\t},\n\n\t// converts an array to a specific type\n\tconvertArray: function ( array, type, forceClone ) {\n\n\t\tif ( ! array || // let 'undefined' and 'null' pass\n\t\t\t! forceClone && array.constructor === type ) return array;\n\n\t\tif ( typeof type.BYTES_PER_ELEMENT === 'number' ) {\n\n\t\t\treturn new type( array ); // create typed array\n\n\t\t}\n\n\t\treturn Array.prototype.slice.call( array ); // create Array\n\n\t},\n\n\tisTypedArray: function ( object ) {\n\n\t\treturn ArrayBuffer.isView( object ) &&\n\t\t\t! ( object instanceof DataView );\n\n\t},\n\n\t// returns an array by which times and values can be sorted\n\tgetKeyframeOrder: function ( times ) {\n\n\t\tfunction compareTime( i, j ) {\n\n\t\t\treturn times[ i ] - times[ j ];\n\n\t\t}\n\n\t\tconst n = times.length;\n\t\tconst result = new Array( n );\n\t\tfor ( let i = 0; i !== n; ++ i ) result[ i ] = i;\n\n\t\tresult.sort( compareTime );\n\n\t\treturn result;\n\n\t},\n\n\t// uses the array previously returned by 'getKeyframeOrder' to sort data\n\tsortedArray: function ( values, stride, order ) {\n\n\t\tconst nValues = values.length;\n\t\tconst result = new values.constructor( nValues );\n\n\t\tfor ( let i = 0, dstOffset = 0; dstOffset !== nValues; ++ i ) {\n\n\t\t\tconst srcOffset = order[ i ] * stride;\n\n\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\tresult[ dstOffset ++ ] = values[ srcOffset + j ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn result;\n\n\t},\n\n\t// function for parsing AOS keyframe formats\n\tflattenJSON: function ( jsonKeys, times, values, valuePropertyName ) {\n\n\t\tlet i = 1, key = jsonKeys[ 0 ];\n\n\t\twhile ( key !== undefined && key[ valuePropertyName ] === undefined ) {\n\n\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t}\n\n\t\tif ( key === undefined ) return; // no data\n\n\t\tlet value = key[ valuePropertyName ];\n\t\tif ( value === undefined ) return; // no data\n\n\t\tif ( Array.isArray( value ) ) {\n\n\t\t\tdo {\n\n\t\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\ttimes.push( key.time );\n\t\t\t\t\tvalues.push.apply( values, value ); // push all elements\n\n\t\t\t\t}\n\n\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t} while ( key !== undefined );\n\n\t\t} else if ( value.toArray !== undefined ) {\n\n\t\t\t// ...assume THREE.Math-ish\n\n\t\t\tdo {\n\n\t\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\ttimes.push( key.time );\n\t\t\t\t\tvalue.toArray( values, values.length );\n\n\t\t\t\t}\n\n\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t} while ( key !== undefined );\n\n\t\t} else {\n\n\t\t\t// otherwise push as-is\n\n\t\t\tdo {\n\n\t\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\ttimes.push( key.time );\n\t\t\t\t\tvalues.push( value );\n\n\t\t\t\t}\n\n\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t} while ( key !== undefined );\n\n\t\t}\n\n\t},\n\n\tsubclip: function ( sourceClip, name, startFrame, endFrame, fps = 30 ) {\n\n\t\tconst clip = sourceClip.clone();\n\n\t\tclip.name = name;\n\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\t\tconst track = clip.tracks[ i ];\n\t\t\tconst valueSize = track.getValueSize();\n\n\t\t\tconst times = [];\n\t\t\tconst values = [];\n\n\t\t\tfor ( let j = 0; j < track.times.length; ++ j ) {\n\n\t\t\t\tconst frame = track.times[ j ] * fps;\n\n\t\t\t\tif ( frame < startFrame || frame >= endFrame ) continue;\n\n\t\t\t\ttimes.push( track.times[ j ] );\n\n\t\t\t\tfor ( let k = 0; k < valueSize; ++ k ) {\n\n\t\t\t\t\tvalues.push( track.values[ j * valueSize + k ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( times.length === 0 ) continue;\n\n\t\t\ttrack.times = AnimationUtils.convertArray( times, track.times.constructor );\n\t\t\ttrack.values = AnimationUtils.convertArray( values, track.values.constructor );\n\n\t\t\ttracks.push( track );\n\n\t\t}\n\n\t\tclip.tracks = tracks;\n\n\t\t// find minimum .times value across all tracks in the trimmed clip\n\n\t\tlet minStartTime = Infinity;\n\n\t\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\t\tif ( minStartTime > clip.tracks[ i ].times[ 0 ] ) {\n\n\t\t\t\tminStartTime = clip.tracks[ i ].times[ 0 ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// shift all tracks such that clip begins at t=0\n\n\t\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\t\tclip.tracks[ i ].shift( - 1 * minStartTime );\n\n\t\t}\n\n\t\tclip.resetDuration();\n\n\t\treturn clip;\n\n\t},\n\n\tmakeClipAdditive: function ( targetClip, referenceFrame = 0, referenceClip = targetClip, fps = 30 ) {\n\n\t\tif ( fps <= 0 ) fps = 30;\n\n\t\tconst numTracks = referenceClip.tracks.length;\n\t\tconst referenceTime = referenceFrame / fps;\n\n\t\t// Make each track's values relative to the values at the reference frame\n\t\tfor ( let i = 0; i < numTracks; ++ i ) {\n\n\t\t\tconst referenceTrack = referenceClip.tracks[ i ];\n\t\t\tconst referenceTrackType = referenceTrack.ValueTypeName;\n\n\t\t\t// Skip this track if it's non-numeric\n\t\t\tif ( referenceTrackType === 'bool' || referenceTrackType === 'string' ) continue;\n\n\t\t\t// Find the track in the target clip whose name and type matches the reference track\n\t\t\tconst targetTrack = targetClip.tracks.find( function ( track ) {\n\n\t\t\t\treturn track.name === referenceTrack.name\n\t\t\t\t\t&& track.ValueTypeName === referenceTrackType;\n\n\t\t\t} );\n\n\t\t\tif ( targetTrack === undefined ) continue;\n\n\t\t\tlet referenceOffset = 0;\n\t\t\tconst referenceValueSize = referenceTrack.getValueSize();\n\n\t\t\tif ( referenceTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline ) {\n\n\t\t\t\treferenceOffset = referenceValueSize / 3;\n\n\t\t\t}\n\n\t\t\tlet targetOffset = 0;\n\t\t\tconst targetValueSize = targetTrack.getValueSize();\n\n\t\t\tif ( targetTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline ) {\n\n\t\t\t\ttargetOffset = targetValueSize / 3;\n\n\t\t\t}\n\n\t\t\tconst lastIndex = referenceTrack.times.length - 1;\n\t\t\tlet referenceValue;\n\n\t\t\t// Find the value to subtract out of the track\n\t\t\tif ( referenceTime <= referenceTrack.times[ 0 ] ) {\n\n\t\t\t\t// Reference frame is earlier than the first keyframe, so just use the first keyframe\n\t\t\t\tconst startIndex = referenceOffset;\n\t\t\t\tconst endIndex = referenceValueSize - referenceOffset;\n\t\t\t\treferenceValue = AnimationUtils.arraySlice( referenceTrack.values, startIndex, endIndex );\n\n\t\t\t} else if ( referenceTime >= referenceTrack.times[ lastIndex ] ) {\n\n\t\t\t\t// Reference frame is after the last keyframe, so just use the last keyframe\n\t\t\t\tconst startIndex = lastIndex * referenceValueSize + referenceOffset;\n\t\t\t\tconst endIndex = startIndex + referenceValueSize - referenceOffset;\n\t\t\t\treferenceValue = AnimationUtils.arraySlice( referenceTrack.values, startIndex, endIndex );\n\n\t\t\t} else {\n\n\t\t\t\t// Interpolate to the reference value\n\t\t\t\tconst interpolant = referenceTrack.createInterpolant();\n\t\t\t\tconst startIndex = referenceOffset;\n\t\t\t\tconst endIndex = referenceValueSize - referenceOffset;\n\t\t\t\tinterpolant.evaluate( referenceTime );\n\t\t\t\treferenceValue = AnimationUtils.arraySlice( interpolant.resultBuffer, startIndex, endIndex );\n\n\t\t\t}\n\n\t\t\t// Conjugate the quaternion\n\t\t\tif ( referenceTrackType === 'quaternion' ) {\n\n\t\t\t\tconst referenceQuat = new Quaternion().fromArray( referenceValue ).normalize().conjugate();\n\t\t\t\treferenceQuat.toArray( referenceValue );\n\n\t\t\t}\n\n\t\t\t// Subtract the reference value from all of the track values\n\n\t\t\tconst numTimes = targetTrack.times.length;\n\t\t\tfor ( let j = 0; j < numTimes; ++ j ) {\n\n\t\t\t\tconst valueStart = j * targetValueSize + targetOffset;\n\n\t\t\t\tif ( referenceTrackType === 'quaternion' ) {\n\n\t\t\t\t\t// Multiply the conjugate for quaternion track types\n\t\t\t\t\tQuaternion.multiplyQuaternionsFlat(\n\t\t\t\t\t\ttargetTrack.values,\n\t\t\t\t\t\tvalueStart,\n\t\t\t\t\t\treferenceValue,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\ttargetTrack.values,\n\t\t\t\t\t\tvalueStart\n\t\t\t\t\t);\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst valueEnd = targetValueSize - targetOffset * 2;\n\n\t\t\t\t\t// Subtract each value for all other numeric track types\n\t\t\t\t\tfor ( let k = 0; k < valueEnd; ++ k ) {\n\n\t\t\t\t\t\ttargetTrack.values[ valueStart + k ] -= referenceValue[ k ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\ttargetClip.blendMode = AdditiveAnimationBlendMode;\n\n\t\treturn targetClip;\n\n\t}\n\n};\n\nexport { AnimationUtils };\n", "/**\n * Abstract base class of interpolants over parametric samples.\n *\n * The parameter domain is one dimensional, typically the time or a path\n * along a curve defined by the data.\n *\n * The sample values can have any dimensionality and derived classes may\n * apply special interpretations to the data.\n *\n * This class provides the interval seek in a Template Method, deferring\n * the actual interpolation to derived classes.\n *\n * Time complexity is O(1) for linear access crossing at most two points\n * and O(log N) for random access, where N is the number of positions.\n *\n * References:\n *\n * \t\thttp://www.oodesign.com/template-method-pattern.html\n *\n */\n\nclass Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tthis.parameterPositions = parameterPositions;\n\t\tthis._cachedIndex = 0;\n\n\t\tthis.resultBuffer = resultBuffer !== undefined ?\n\t\t\tresultBuffer : new sampleValues.constructor( sampleSize );\n\t\tthis.sampleValues = sampleValues;\n\t\tthis.valueSize = sampleSize;\n\n\t\tthis.settings = null;\n\t\tthis.DefaultSettings_ = {};\n\n\t}\n\n\tevaluate( t ) {\n\n\t\tconst pp = this.parameterPositions;\n\t\tlet i1 = this._cachedIndex,\n\t\t\tt1 = pp[ i1 ],\n\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\tvalidate_interval: {\n\n\t\t\tseek: {\n\n\t\t\t\tlet right;\n\n\t\t\t\tlinear_scan: {\n\n\t\t\t\t\t//- See http://jsperf.com/comparison-to-undefined/3\n\t\t\t\t\t//- slower code:\n\t\t\t\t\t//-\n\t\t\t\t\t//- \t\t\t\tif ( t >= t1 || t1 === undefined ) {\n\t\t\t\t\tforward_scan: if ( ! ( t < t1 ) ) {\n\n\t\t\t\t\t\tfor ( let giveUpAt = i1 + 2; ; ) {\n\n\t\t\t\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\t\t\t\tif ( t < t0 ) break forward_scan;\n\n\t\t\t\t\t\t\t\t// after end\n\n\t\t\t\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\t\t\t\treturn this.afterEnd_( i1 - 1, t, t0 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\tt0 = t1;\n\t\t\t\t\t\t\tt1 = pp[ ++ i1 ];\n\n\t\t\t\t\t\t\tif ( t < t1 ) {\n\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// prepare binary search on the right side of the index\n\t\t\t\t\t\tright = pp.length;\n\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t//- slower code:\n\t\t\t\t\t//-\t\t\t\t\tif ( t < t0 || t0 === undefined ) {\n\t\t\t\t\tif ( ! ( t >= t0 ) ) {\n\n\t\t\t\t\t\t// looping?\n\n\t\t\t\t\t\tconst t1global = pp[ 1 ];\n\n\t\t\t\t\t\tif ( t < t1global ) {\n\n\t\t\t\t\t\t\ti1 = 2; // + 1, using the scan for the details\n\t\t\t\t\t\t\tt0 = t1global;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// linear reverse scan\n\n\t\t\t\t\t\tfor ( let giveUpAt = i1 - 2; ; ) {\n\n\t\t\t\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\t\t\t\t// before start\n\n\t\t\t\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\tt1 = t0;\n\t\t\t\t\t\t\tt0 = pp[ -- i1 - 1 ];\n\n\t\t\t\t\t\t\tif ( t >= t0 ) {\n\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// prepare binary search on the left side of the index\n\t\t\t\t\t\tright = i1;\n\t\t\t\t\t\ti1 = 0;\n\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// the interval is valid\n\n\t\t\t\t\tbreak validate_interval;\n\n\t\t\t\t} // linear scan\n\n\t\t\t\t// binary search\n\n\t\t\t\twhile ( i1 < right ) {\n\n\t\t\t\t\tconst mid = ( i1 + right ) >>> 1;\n\n\t\t\t\t\tif ( t < pp[ mid ] ) {\n\n\t\t\t\t\t\tright = mid;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ti1 = mid + 1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tt1 = pp[ i1 ];\n\t\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\t\t\t// check boundary cases, again\n\n\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\n\n\t\t\t\t}\n\n\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\treturn this.afterEnd_( i1 - 1, t0, t );\n\n\t\t\t\t}\n\n\t\t\t} // seek\n\n\t\t\tthis._cachedIndex = i1;\n\n\t\t\tthis.intervalChanged_( i1, t0, t1 );\n\n\t\t} // validate_interval\n\n\t\treturn this.interpolate_( i1, t0, t, t1 );\n\n\t}\n\n\tgetSettings_() {\n\n\t\treturn this.settings || this.DefaultSettings_;\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// copies a sample value to the result buffer\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = index * stride;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\t// Template methods for derived classes:\n\n\tinterpolate_( /* i1, t0, t, t1 */ ) {\n\n\t\tthrow new Error( 'call to abstract method' );\n\t\t// implementations shall return this.resultBuffer\n\n\t}\n\n\tintervalChanged_( /* i1, t0, t1 */ ) {\n\n\t\t// empty\n\n\t}\n\n}\n\n// ALIAS DEFINITIONS\n\nInterpolant.prototype.beforeStart_ = Interpolant.prototype.copySampleValue_;\nInterpolant.prototype.afterEnd_ = Interpolant.prototype.copySampleValue_;\n\nexport { Interpolant };\n", "import { ZeroCurvatureEnding } from '../../constants.js';\nimport { Interpolant } from '../Interpolant.js';\nimport { WrapAroundEnding, ZeroSlopeEnding } from '../../constants.js';\n\n/**\n * Fast and simple cubic spline interpolant.\n *\n * It was derived from a Hermitian construction setting the first derivative\n * at each sample position to the linear slope between neighboring positions\n * over their parameter interval.\n */\n\nclass CubicInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t\tthis._weightPrev = - 0;\n\t\tthis._offsetPrev = - 0;\n\t\tthis._weightNext = - 0;\n\t\tthis._offsetNext = - 0;\n\n\t\tthis.DefaultSettings_ = {\n\n\t\t\tendingStart: ZeroCurvatureEnding,\n\t\t\tendingEnd: ZeroCurvatureEnding\n\n\t\t};\n\n\t}\n\n\tintervalChanged_( i1, t0, t1 ) {\n\n\t\tconst pp = this.parameterPositions;\n\t\tlet iPrev = i1 - 2,\n\t\t\tiNext = i1 + 1,\n\n\t\t\ttPrev = pp[ iPrev ],\n\t\t\ttNext = pp[ iNext ];\n\n\t\tif ( tPrev === undefined ) {\n\n\t\t\tswitch ( this.getSettings_().endingStart ) {\n\n\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t// f'(t0) = 0\n\t\t\t\t\tiPrev = i1;\n\t\t\t\t\ttPrev = 2 * t0 - t1;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\tiPrev = pp.length - 2;\n\t\t\t\t\ttPrev = t0 + pp[ iPrev ] - pp[ iPrev + 1 ];\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t// f''(t0) = 0 a.k.a. Natural Spline\n\t\t\t\t\tiPrev = i1;\n\t\t\t\t\ttPrev = t1;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tNext === undefined ) {\n\n\t\t\tswitch ( this.getSettings_().endingEnd ) {\n\n\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t// f'(tN) = 0\n\t\t\t\t\tiNext = i1;\n\t\t\t\t\ttNext = 2 * t1 - t0;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\tiNext = 1;\n\t\t\t\t\ttNext = t1 + pp[ 1 ] - pp[ 0 ];\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t// f''(tN) = 0, a.k.a. Natural Spline\n\t\t\t\t\tiNext = i1 - 1;\n\t\t\t\t\ttNext = t0;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst halfDt = ( t1 - t0 ) * 0.5,\n\t\t\tstride = this.valueSize;\n\n\t\tthis._weightPrev = halfDt / ( t0 - tPrev );\n\t\tthis._weightNext = halfDt / ( tNext - t1 );\n\t\tthis._offsetPrev = iPrev * stride;\n\t\tthis._offsetNext = iNext * stride;\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\to1 = i1 * stride,\t\to0 = o1 - stride,\n\t\t\toP = this._offsetPrev, \toN = this._offsetNext,\n\t\t\twP = this._weightPrev,\twN = this._weightNext,\n\n\t\t\tp = ( t - t0 ) / ( t1 - t0 ),\n\t\t\tpp = p * p,\n\t\t\tppp = pp * p;\n\n\t\t// evaluate polynomials\n\n\t\tconst sP = - wP * ppp + 2 * wP * pp - wP * p;\n\t\tconst s0 = ( 1 + wP ) * ppp + ( - 1.5 - 2 * wP ) * pp + ( - 0.5 + wP ) * p + 1;\n\t\tconst s1 = ( - 1 - wN ) * ppp + ( 1.5 + wN ) * pp + 0.5 * p;\n\t\tconst sN = wN * ppp - wN * pp;\n\n\t\t// combine data linearly\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] =\n\t\t\t\t\tsP * values[ oP + i ] +\n\t\t\t\t\ts0 * values[ o0 + i ] +\n\t\t\t\t\ts1 * values[ o1 + i ] +\n\t\t\t\t\tsN * values[ oN + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nexport { CubicInterpolant };\n", "import { Interpolant } from '../Interpolant.js';\n\nclass LinearInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\toffset1 = i1 * stride,\n\t\t\toffset0 = offset1 - stride,\n\n\t\t\tweight1 = ( t - t0 ) / ( t1 - t0 ),\n\t\t\tweight0 = 1 - weight1;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] =\n\t\t\t\t\tvalues[ offset0 + i ] * weight0 +\n\t\t\t\t\tvalues[ offset1 + i ] * weight1;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\n\nexport { LinearInterpolant };\n", "import { Interpolant } from '../Interpolant.js';\n\n/**\n *\n * Interpolant that evaluates to the sample value at the position preceding\n * the parameter.\n */\n\nclass DiscreteInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1 /*, t0, t, t1 */ ) {\n\n\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t}\n\n}\n\n\nexport { DiscreteInterpolant };\n", "import {\n\tInterpolateLinear,\n\tInterpolateSmooth,\n\tInterpolateDiscrete\n} from '../constants.js';\nimport { CubicInterpolant } from '../math/interpolants/CubicInterpolant.js';\nimport { LinearInterpolant } from '../math/interpolants/LinearInterpolant.js';\nimport { DiscreteInterpolant } from '../math/interpolants/DiscreteInterpolant.js';\nimport { AnimationUtils } from './AnimationUtils.js';\n\nclass KeyframeTrack {\n\n\tconstructor( name, times, values, interpolation ) {\n\n\t\tif ( name === undefined ) throw new Error( 'THREE.KeyframeTrack: track name is undefined' );\n\t\tif ( times === undefined || times.length === 0 ) throw new Error( 'THREE.KeyframeTrack: no keyframes in track named ' + name );\n\n\t\tthis.name = name;\n\n\t\tthis.times = AnimationUtils.convertArray( times, this.TimeBufferType );\n\t\tthis.values = AnimationUtils.convertArray( values, this.ValueBufferType );\n\n\t\tthis.setInterpolation( interpolation || this.DefaultInterpolation );\n\n\t}\n\n\t// Serialization (in static context, because of constructor invocation\n\t// and automatic invocation of .toJSON):\n\n\tstatic toJSON( track ) {\n\n\t\tconst trackType = track.constructor;\n\n\t\tlet json;\n\n\t\t// derived classes can define a static toJSON method\n\t\tif ( trackType.toJSON !== this.toJSON ) {\n\n\t\t\tjson = trackType.toJSON( track );\n\n\t\t} else {\n\n\t\t\t// by default, we assume the data can be serialized as-is\n\t\t\tjson = {\n\n\t\t\t\t'name': track.name,\n\t\t\t\t'times': AnimationUtils.convertArray( track.times, Array ),\n\t\t\t\t'values': AnimationUtils.convertArray( track.values, Array )\n\n\t\t\t};\n\n\t\t\tconst interpolation = track.getInterpolation();\n\n\t\t\tif ( interpolation !== track.DefaultInterpolation ) {\n\n\t\t\t\tjson.interpolation = interpolation;\n\n\t\t\t}\n\n\t\t}\n\n\t\tjson.type = track.ValueTypeName; // mandatory\n\n\t\treturn json;\n\n\t}\n\n\tInterpolantFactoryMethodDiscrete( result ) {\n\n\t\treturn new DiscreteInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tInterpolantFactoryMethodLinear( result ) {\n\n\t\treturn new LinearInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tInterpolantFactoryMethodSmooth( result ) {\n\n\t\treturn new CubicInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tsetInterpolation( interpolation ) {\n\n\t\tlet factoryMethod;\n\n\t\tswitch ( interpolation ) {\n\n\t\t\tcase InterpolateDiscrete:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodDiscrete;\n\n\t\t\t\tbreak;\n\n\t\t\tcase InterpolateLinear:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodLinear;\n\n\t\t\t\tbreak;\n\n\t\t\tcase InterpolateSmooth:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodSmooth;\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( factoryMethod === undefined ) {\n\n\t\t\tconst message = 'unsupported interpolation for ' +\n\t\t\t\tthis.ValueTypeName + ' keyframe track named ' + this.name;\n\n\t\t\tif ( this.createInterpolant === undefined ) {\n\n\t\t\t\t// fall back to default, unless the default itself is messed up\n\t\t\t\tif ( interpolation !== this.DefaultInterpolation ) {\n\n\t\t\t\t\tthis.setInterpolation( this.DefaultInterpolation );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( message ); // fatal, in this case\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconsole.warn( 'THREE.KeyframeTrack:', message );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tthis.createInterpolant = factoryMethod;\n\n\t\treturn this;\n\n\t}\n\n\tgetInterpolation() {\n\n\t\tswitch ( this.createInterpolant ) {\n\n\t\t\tcase this.InterpolantFactoryMethodDiscrete:\n\n\t\t\t\treturn InterpolateDiscrete;\n\n\t\t\tcase this.InterpolantFactoryMethodLinear:\n\n\t\t\t\treturn InterpolateLinear;\n\n\t\t\tcase this.InterpolantFactoryMethodSmooth:\n\n\t\t\t\treturn InterpolateSmooth;\n\n\t\t}\n\n\t}\n\n\tgetValueSize() {\n\n\t\treturn this.values.length / this.times.length;\n\n\t}\n\n\t// move all keyframes either forwards or backwards in time\n\tshift( timeOffset ) {\n\n\t\tif ( timeOffset !== 0.0 ) {\n\n\t\t\tconst times = this.times;\n\n\t\t\tfor ( let i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\ttimes[ i ] += timeOffset;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\n\tscale( timeScale ) {\n\n\t\tif ( timeScale !== 1.0 ) {\n\n\t\t\tconst times = this.times;\n\n\t\t\tfor ( let i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\ttimes[ i ] *= timeScale;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\n\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\n\ttrim( startTime, endTime ) {\n\n\t\tconst times = this.times,\n\t\t\tnKeys = times.length;\n\n\t\tlet from = 0,\n\t\t\tto = nKeys - 1;\n\n\t\twhile ( from !== nKeys && times[ from ] < startTime ) {\n\n\t\t\t++ from;\n\n\t\t}\n\n\t\twhile ( to !== - 1 && times[ to ] > endTime ) {\n\n\t\t\t-- to;\n\n\t\t}\n\n\t\t++ to; // inclusive -> exclusive bound\n\n\t\tif ( from !== 0 || to !== nKeys ) {\n\n\t\t\t// empty tracks are forbidden, so keep at least one keyframe\n\t\t\tif ( from >= to ) {\n\n\t\t\t\tto = Math.max( to, 1 );\n\t\t\t\tfrom = to - 1;\n\n\t\t\t}\n\n\t\t\tconst stride = this.getValueSize();\n\t\t\tthis.times = AnimationUtils.arraySlice( times, from, to );\n\t\t\tthis.values = AnimationUtils.arraySlice( this.values, from * stride, to * stride );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\n\tvalidate() {\n\n\t\tlet valid = true;\n\n\t\tconst valueSize = this.getValueSize();\n\t\tif ( valueSize - Math.floor( valueSize ) !== 0 ) {\n\n\t\t\tconsole.error( 'THREE.KeyframeTrack: Invalid value size in track.', this );\n\t\t\tvalid = false;\n\n\t\t}\n\n\t\tconst times = this.times,\n\t\t\tvalues = this.values,\n\n\t\t\tnKeys = times.length;\n\n\t\tif ( nKeys === 0 ) {\n\n\t\t\tconsole.error( 'THREE.KeyframeTrack: Track is empty.', this );\n\t\t\tvalid = false;\n\n\t\t}\n\n\t\tlet prevTime = null;\n\n\t\tfor ( let i = 0; i !== nKeys; i ++ ) {\n\n\t\t\tconst currTime = times[ i ];\n\n\t\t\tif ( typeof currTime === 'number' && isNaN( currTime ) ) {\n\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Time is not a valid number.', this, i, currTime );\n\t\t\t\tvalid = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( prevTime !== null && prevTime > currTime ) {\n\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Out of order keys.', this, i, currTime, prevTime );\n\t\t\t\tvalid = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tprevTime = currTime;\n\n\t\t}\n\n\t\tif ( values !== undefined ) {\n\n\t\t\tif ( AnimationUtils.isTypedArray( values ) ) {\n\n\t\t\t\tfor ( let i = 0, n = values.length; i !== n; ++ i ) {\n\n\t\t\t\t\tconst value = values[ i ];\n\n\t\t\t\t\tif ( isNaN( value ) ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Value is not a valid number.', this, i, value );\n\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn valid;\n\n\t}\n\n\t// removes equivalent sequential keys as common in morph target sequences\n\t// (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0)\n\toptimize() {\n\n\t\t// times or values may be shared with other tracks, so overwriting is unsafe\n\t\tconst times = AnimationUtils.arraySlice( this.times ),\n\t\t\tvalues = AnimationUtils.arraySlice( this.values ),\n\t\t\tstride = this.getValueSize(),\n\n\t\t\tsmoothInterpolation = this.getInterpolation() === InterpolateSmooth,\n\n\t\t\tlastIndex = times.length - 1;\n\n\t\tlet writeIndex = 1;\n\n\t\tfor ( let i = 1; i < lastIndex; ++ i ) {\n\n\t\t\tlet keep = false;\n\n\t\t\tconst time = times[ i ];\n\t\t\tconst timeNext = times[ i + 1 ];\n\n\t\t\t// remove adjacent keyframes scheduled at the same time\n\n\t\t\tif ( time !== timeNext && ( i !== 1 || time !== times[ 0 ] ) ) {\n\n\t\t\t\tif ( ! smoothInterpolation ) {\n\n\t\t\t\t\t// remove unnecessary keyframes same as their neighbors\n\n\t\t\t\t\tconst offset = i * stride,\n\t\t\t\t\t\toffsetP = offset - stride,\n\t\t\t\t\t\toffsetN = offset + stride;\n\n\t\t\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\tconst value = values[ offset + j ];\n\n\t\t\t\t\t\tif ( value !== values[ offsetP + j ] ||\n\t\t\t\t\t\t\tvalue !== values[ offsetN + j ] ) {\n\n\t\t\t\t\t\t\tkeep = true;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tkeep = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// in-place compaction\n\n\t\t\tif ( keep ) {\n\n\t\t\t\tif ( i !== writeIndex ) {\n\n\t\t\t\t\ttimes[ writeIndex ] = times[ i ];\n\n\t\t\t\t\tconst readOffset = i * stride,\n\t\t\t\t\t\twriteOffset = writeIndex * stride;\n\n\t\t\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t++ writeIndex;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// flush last keyframe (compaction looks ahead)\n\n\t\tif ( lastIndex > 0 ) {\n\n\t\t\ttimes[ writeIndex ] = times[ lastIndex ];\n\n\t\t\tfor ( let readOffset = lastIndex * stride, writeOffset = writeIndex * stride, j = 0; j !== stride; ++ j ) {\n\n\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t}\n\n\t\t\t++ writeIndex;\n\n\t\t}\n\n\t\tif ( writeIndex !== times.length ) {\n\n\t\t\tthis.times = AnimationUtils.arraySlice( times, 0, writeIndex );\n\t\t\tthis.values = AnimationUtils.arraySlice( values, 0, writeIndex * stride );\n\n\t\t} else {\n\n\t\t\tthis.times = times;\n\t\t\tthis.values = values;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\tconst times = AnimationUtils.arraySlice( this.times, 0 );\n\t\tconst values = AnimationUtils.arraySlice( this.values, 0 );\n\n\t\tconst TypedKeyframeTrack = this.constructor;\n\t\tconst track = new TypedKeyframeTrack( this.name, times, values );\n\n\t\t// Interpolant argument to constructor is not saved, so copy the factory method directly.\n\t\ttrack.createInterpolant = this.createInterpolant;\n\n\t\treturn track;\n\n\t}\n\n}\n\nKeyframeTrack.prototype.TimeBufferType = Float32Array;\nKeyframeTrack.prototype.ValueBufferType = Float32Array;\nKeyframeTrack.prototype.DefaultInterpolation = InterpolateLinear;\n\nexport { KeyframeTrack };\n", "import { InterpolateDiscrete } from '../../constants.js';\nimport { KeyframeTrack } from '../KeyframeTrack.js';\n\n/**\n * A Track of Boolean keyframe values.\n */\nclass BooleanKeyframeTrack extends KeyframeTrack {}\n\nBooleanKeyframeTrack.prototype.ValueTypeName = 'bool';\nBooleanKeyframeTrack.prototype.ValueBufferType = Array;\nBooleanKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete;\nBooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear = undefined;\nBooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n// Note: Actually this track could have a optimized / compressed\n// representation of a single value and a custom interpolant that\n// computes \"firstValue ^ isOdd( index )\".\n\nexport { BooleanKeyframeTrack };\n", "import { KeyframeTrack } from '../KeyframeTrack.js';\n\n/**\n * A Track of keyframe values that represent color.\n */\nclass ColorKeyframeTrack extends KeyframeTrack {}\n\nColorKeyframeTrack.prototype.ValueTypeName = 'color';\n// ValueBufferType is inherited\n// DefaultInterpolation is inherited\n\n// Note: Very basic implementation and nothing special yet.\n// However, this is the place for color space parameterization.\n\nexport { ColorKeyframeTrack };\n", "import { KeyframeTrack } from '../KeyframeTrack.js';\n\n/**\n * A Track of numeric keyframe values.\n */\nclass NumberKeyframeTrack extends KeyframeTrack {}\n\nNumberKeyframeTrack.prototype.ValueTypeName = 'number';\n// ValueBufferType is inherited\n// DefaultInterpolation is inherited\n\nexport { NumberKeyframeTrack };\n", "import { Interpolant } from '../Interpolant.js';\nimport { Quaternion } from '../Quaternion.js';\n\n/**\n * Spherical linear unit quaternion interpolant.\n */\n\nclass QuaternionLinearInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\talpha = ( t - t0 ) / ( t1 - t0 );\n\n\t\tlet offset = i1 * stride;\n\n\t\tfor ( let end = offset + stride; offset !== end; offset += 4 ) {\n\n\t\t\tQuaternion.slerpFlat( result, 0, values, offset - stride, values, offset, alpha );\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\n\nexport { QuaternionLinearInterpolant };\n", "import { InterpolateLinear } from '../../constants.js';\nimport { KeyframeTrack } from '../KeyframeTrack.js';\nimport { QuaternionLinearInterpolant } from '../../math/interpolants/QuaternionLinearInterpolant.js';\n\n/**\n * A Track of quaternion keyframe values.\n */\nclass QuaternionKeyframeTrack extends KeyframeTrack {\n\n\tInterpolantFactoryMethodLinear( result ) {\n\n\t\treturn new QuaternionLinearInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n}\n\nQuaternionKeyframeTrack.prototype.ValueTypeName = 'quaternion';\n// ValueBufferType is inherited\nQuaternionKeyframeTrack.prototype.DefaultInterpolation = InterpolateLinear;\nQuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\nexport { QuaternionKeyframeTrack };\n", "import { InterpolateDiscrete } from '../../constants.js';\nimport { KeyframeTrack } from '../KeyframeTrack.js';\n\n/**\n * A Track that interpolates Strings\n */\nclass StringKeyframeTrack extends KeyframeTrack {}\n\nStringKeyframeTrack.prototype.ValueTypeName = 'string';\nStringKeyframeTrack.prototype.ValueBufferType = Array;\nStringKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete;\nStringKeyframeTrack.prototype.InterpolantFactoryMethodLinear = undefined;\nStringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\nexport { StringKeyframeTrack };\n", "import { KeyframeTrack } from '../KeyframeTrack.js';\n\n/**\n * A Track of vectored keyframe values.\n */\nclass VectorKeyframeTrack extends KeyframeTrack {}\n\nVectorKeyframeTrack.prototype.ValueTypeName = 'vector';\n// ValueBufferType is inherited\n// DefaultInterpolation is inherited\n\nexport { VectorKeyframeTrack };\n", "import { AnimationUtils } from './AnimationUtils.js';\nimport { KeyframeTrack } from './KeyframeTrack.js';\nimport { BooleanKeyframeTrack } from './tracks/BooleanKeyframeTrack.js';\nimport { ColorKeyframeTrack } from './tracks/ColorKeyframeTrack.js';\nimport { NumberKeyframeTrack } from './tracks/NumberKeyframeTrack.js';\nimport { QuaternionKeyframeTrack } from './tracks/QuaternionKeyframeTrack.js';\nimport { StringKeyframeTrack } from './tracks/StringKeyframeTrack.js';\nimport { VectorKeyframeTrack } from './tracks/VectorKeyframeTrack.js';\nimport * as MathUtils from '../math/MathUtils.js';\nimport { NormalAnimationBlendMode } from '../constants.js';\n\nclass AnimationClip {\n\n\tconstructor( name, duration = - 1, tracks, blendMode = NormalAnimationBlendMode ) {\n\n\t\tthis.name = name;\n\t\tthis.tracks = tracks;\n\t\tthis.duration = duration;\n\t\tthis.blendMode = blendMode;\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\t// this means it should figure out its duration by scanning the tracks\n\t\tif ( this.duration < 0 ) {\n\n\t\t\tthis.resetDuration();\n\n\t\t}\n\n\t}\n\n\n\tstatic parse( json ) {\n\n\t\tconst tracks = [],\n\t\t\tjsonTracks = json.tracks,\n\t\t\tframeTime = 1.0 / ( json.fps || 1.0 );\n\n\t\tfor ( let i = 0, n = jsonTracks.length; i !== n; ++ i ) {\n\n\t\t\ttracks.push( parseKeyframeTrack( jsonTracks[ i ] ).scale( frameTime ) );\n\n\t\t}\n\n\t\tconst clip = new this( json.name, json.duration, tracks, json.blendMode );\n\t\tclip.uuid = json.uuid;\n\n\t\treturn clip;\n\n\t}\n\n\tstatic toJSON( clip ) {\n\n\t\tconst tracks = [],\n\t\t\tclipTracks = clip.tracks;\n\n\t\tconst json = {\n\n\t\t\t'name': clip.name,\n\t\t\t'duration': clip.duration,\n\t\t\t'tracks': tracks,\n\t\t\t'uuid': clip.uuid,\n\t\t\t'blendMode': clip.blendMode\n\n\t\t};\n\n\t\tfor ( let i = 0, n = clipTracks.length; i !== n; ++ i ) {\n\n\t\t\ttracks.push( KeyframeTrack.toJSON( clipTracks[ i ] ) );\n\n\t\t}\n\n\t\treturn json;\n\n\t}\n\n\tstatic CreateFromMorphTargetSequence( name, morphTargetSequence, fps, noLoop ) {\n\n\t\tconst numMorphTargets = morphTargetSequence.length;\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < numMorphTargets; i ++ ) {\n\n\t\t\tlet times = [];\n\t\t\tlet values = [];\n\n\t\t\ttimes.push(\n\t\t\t\t( i + numMorphTargets - 1 ) % numMorphTargets,\n\t\t\t\ti,\n\t\t\t\t( i + 1 ) % numMorphTargets );\n\n\t\t\tvalues.push( 0, 1, 0 );\n\n\t\t\tconst order = AnimationUtils.getKeyframeOrder( times );\n\t\t\ttimes = AnimationUtils.sortedArray( times, 1, order );\n\t\t\tvalues = AnimationUtils.sortedArray( values, 1, order );\n\n\t\t\t// if there is a key at the first frame, duplicate it as the\n\t\t\t// last frame as well for perfect loop.\n\t\t\tif ( ! noLoop && times[ 0 ] === 0 ) {\n\n\t\t\t\ttimes.push( numMorphTargets );\n\t\t\t\tvalues.push( values[ 0 ] );\n\n\t\t\t}\n\n\t\t\ttracks.push(\n\t\t\t\tnew NumberKeyframeTrack(\n\t\t\t\t\t'.morphTargetInfluences[' + morphTargetSequence[ i ].name + ']',\n\t\t\t\t\ttimes, values\n\t\t\t\t).scale( 1.0 / fps ) );\n\n\t\t}\n\n\t\treturn new this( name, - 1, tracks );\n\n\t}\n\n\tstatic findByName( objectOrClipArray, name ) {\n\n\t\tlet clipArray = objectOrClipArray;\n\n\t\tif ( ! Array.isArray( objectOrClipArray ) ) {\n\n\t\t\tconst o = objectOrClipArray;\n\t\t\tclipArray = o.geometry && o.geometry.animations || o.animations;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < clipArray.length; i ++ ) {\n\n\t\t\tif ( clipArray[ i ].name === name ) {\n\n\t\t\t\treturn clipArray[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tstatic CreateClipsFromMorphTargetSequences( morphTargets, fps, noLoop ) {\n\n\t\tconst animationToMorphTargets = {};\n\n\t\t// tested with https://regex101.com/ on trick sequences\n\t\t// such flamingo_flyA_003, flamingo_run1_003, crdeath0059\n\t\tconst pattern = /^([\\w-]*?)([\\d]+)$/;\n\n\t\t// sort morph target names into animation groups based\n\t\t// patterns like Walk_001, Walk_002, Run_001, Run_002\n\t\tfor ( let i = 0, il = morphTargets.length; i < il; i ++ ) {\n\n\t\t\tconst morphTarget = morphTargets[ i ];\n\t\t\tconst parts = morphTarget.name.match( pattern );\n\n\t\t\tif ( parts && parts.length > 1 ) {\n\n\t\t\t\tconst name = parts[ 1 ];\n\n\t\t\t\tlet animationMorphTargets = animationToMorphTargets[ name ];\n\n\t\t\t\tif ( ! animationMorphTargets ) {\n\n\t\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\n\n\t\t\t\t}\n\n\t\t\t\tanimationMorphTargets.push( morphTarget );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst clips = [];\n\n\t\tfor ( const name in animationToMorphTargets ) {\n\n\t\t\tclips.push( this.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps, noLoop ) );\n\n\t\t}\n\n\t\treturn clips;\n\n\t}\n\n\t// parse the animation.hierarchy format\n\tstatic parseAnimation( animation, bones ) {\n\n\t\tif ( ! animation ) {\n\n\t\t\tconsole.error( 'THREE.AnimationClip: No animation in JSONLoader data.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst addNonemptyTrack = function ( trackType, trackName, animationKeys, propertyName, destTracks ) {\n\n\t\t\t// only return track if there are actually keys.\n\t\t\tif ( animationKeys.length !== 0 ) {\n\n\t\t\t\tconst times = [];\n\t\t\t\tconst values = [];\n\n\t\t\t\tAnimationUtils.flattenJSON( animationKeys, times, values, propertyName );\n\n\t\t\t\t// empty keys are filtered out, so check again\n\t\t\t\tif ( times.length !== 0 ) {\n\n\t\t\t\t\tdestTracks.push( new trackType( trackName, times, values ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tconst tracks = [];\n\n\t\tconst clipName = animation.name || 'default';\n\t\tconst fps = animation.fps || 30;\n\t\tconst blendMode = animation.blendMode;\n\n\t\t// automatic length determination in AnimationClip.\n\t\tlet duration = animation.length || - 1;\n\n\t\tconst hierarchyTracks = animation.hierarchy || [];\n\n\t\tfor ( let h = 0; h < hierarchyTracks.length; h ++ ) {\n\n\t\t\tconst animationKeys = hierarchyTracks[ h ].keys;\n\n\t\t\t// skip empty tracks\n\t\t\tif ( ! animationKeys || animationKeys.length === 0 ) continue;\n\n\t\t\t// process morph targets\n\t\t\tif ( animationKeys[ 0 ].morphTargets ) {\n\n\t\t\t\t// figure out all morph targets used in this track\n\t\t\t\tconst morphTargetNames = {};\n\n\t\t\t\tlet k;\n\n\t\t\t\tfor ( k = 0; k < animationKeys.length; k ++ ) {\n\n\t\t\t\t\tif ( animationKeys[ k ].morphTargets ) {\n\n\t\t\t\t\t\tfor ( let m = 0; m < animationKeys[ k ].morphTargets.length; m ++ ) {\n\n\t\t\t\t\t\t\tmorphTargetNames[ animationKeys[ k ].morphTargets[ m ] ] = - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// create a track for each morph target with all zero\n\t\t\t\t// morphTargetInfluences except for the keys in which\n\t\t\t\t// the morphTarget is named.\n\t\t\t\tfor ( const morphTargetName in morphTargetNames ) {\n\n\t\t\t\t\tconst times = [];\n\t\t\t\t\tconst values = [];\n\n\t\t\t\t\tfor ( let m = 0; m !== animationKeys[ k ].morphTargets.length; ++ m ) {\n\n\t\t\t\t\t\tconst animationKey = animationKeys[ k ];\n\n\t\t\t\t\t\ttimes.push( animationKey.time );\n\t\t\t\t\t\tvalues.push( ( animationKey.morphTarget === morphTargetName ) ? 1 : 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( new NumberKeyframeTrack( '.morphTargetInfluence[' + morphTargetName + ']', times, values ) );\n\n\t\t\t\t}\n\n\t\t\t\tduration = morphTargetNames.length * fps;\n\n\t\t\t} else {\n\n\t\t\t\t// ...assume skeletal animation\n\n\t\t\t\tconst boneName = '.bones[' + bones[ h ].name + ']';\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tVectorKeyframeTrack, boneName + '.position',\n\t\t\t\t\tanimationKeys, 'pos', tracks );\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tQuaternionKeyframeTrack, boneName + '.quaternion',\n\t\t\t\t\tanimationKeys, 'rot', tracks );\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tVectorKeyframeTrack, boneName + '.scale',\n\t\t\t\t\tanimationKeys, 'scl', tracks );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tracks.length === 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst clip = new this( clipName, duration, tracks, blendMode );\n\n\t\treturn clip;\n\n\t}\n\n\tresetDuration() {\n\n\t\tconst tracks = this.tracks;\n\t\tlet duration = 0;\n\n\t\tfor ( let i = 0, n = tracks.length; i !== n; ++ i ) {\n\n\t\t\tconst track = this.tracks[ i ];\n\n\t\t\tduration = Math.max( duration, track.times[ track.times.length - 1 ] );\n\n\t\t}\n\n\t\tthis.duration = duration;\n\n\t\treturn this;\n\n\t}\n\n\ttrim() {\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tthis.tracks[ i ].trim( 0, this.duration );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tvalidate() {\n\n\t\tlet valid = true;\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tvalid = valid && this.tracks[ i ].validate();\n\n\t\t}\n\n\t\treturn valid;\n\n\t}\n\n\toptimize() {\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tthis.tracks[ i ].optimize();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\ttracks.push( this.tracks[ i ].clone() );\n\n\t\t}\n\n\t\treturn new this.constructor( this.name, this.duration, tracks, this.blendMode );\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.constructor.toJSON( this );\n\n\t}\n\n}\n\nfunction getTrackTypeForValueTypeName( typeName ) {\n\n\tswitch ( typeName.toLowerCase() ) {\n\n\t\tcase 'scalar':\n\t\tcase 'double':\n\t\tcase 'float':\n\t\tcase 'number':\n\t\tcase 'integer':\n\n\t\t\treturn NumberKeyframeTrack;\n\n\t\tcase 'vector':\n\t\tcase 'vector2':\n\t\tcase 'vector3':\n\t\tcase 'vector4':\n\n\t\t\treturn VectorKeyframeTrack;\n\n\t\tcase 'color':\n\n\t\t\treturn ColorKeyframeTrack;\n\n\t\tcase 'quaternion':\n\n\t\t\treturn QuaternionKeyframeTrack;\n\n\t\tcase 'bool':\n\t\tcase 'boolean':\n\n\t\t\treturn BooleanKeyframeTrack;\n\n\t\tcase 'string':\n\n\t\t\treturn StringKeyframeTrack;\n\n\t}\n\n\tthrow new Error( 'THREE.KeyframeTrack: Unsupported typeName: ' + typeName );\n\n}\n\nfunction parseKeyframeTrack( json ) {\n\n\tif ( json.type === undefined ) {\n\n\t\tthrow new Error( 'THREE.KeyframeTrack: track type undefined, can not parse' );\n\n\t}\n\n\tconst trackType = getTrackTypeForValueTypeName( json.type );\n\n\tif ( json.times === undefined ) {\n\n\t\tconst times = [], values = [];\n\n\t\tAnimationUtils.flattenJSON( json.keys, times, values, 'value' );\n\n\t\tjson.times = times;\n\t\tjson.values = values;\n\n\t}\n\n\t// derived classes can define a static parse method\n\tif ( trackType.parse !== undefined ) {\n\n\t\treturn trackType.parse( json );\n\n\t} else {\n\n\t\t// by default, we assume a constructor compatible with the base\n\t\treturn new trackType( json.name, json.times, json.values, json.interpolation );\n\n\t}\n\n}\n\nexport { AnimationClip };\n", "const Cache = {\n\n\tenabled: false,\n\n\tfiles: {},\n\n\tadd: function ( key, file ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\n\n\t\tthis.files[ key ] = file;\n\n\t},\n\n\tget: function ( key ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\n\n\t\treturn this.files[ key ];\n\n\t},\n\n\tremove: function ( key ) {\n\n\t\tdelete this.files[ key ];\n\n\t},\n\n\tclear: function () {\n\n\t\tthis.files = {};\n\n\t}\n\n};\n\n\nexport { Cache };\n", "class LoadingManager {\n\n\tconstructor( onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet isLoading = false;\n\t\tlet itemsLoaded = 0;\n\t\tlet itemsTotal = 0;\n\t\tlet urlModifier = undefined;\n\t\tconst handlers = [];\n\n\t\t// Refer to #5689 for the reason why we don't set .onStart\n\t\t// in the constructor\n\n\t\tthis.onStart = undefined;\n\t\tthis.onLoad = onLoad;\n\t\tthis.onProgress = onProgress;\n\t\tthis.onError = onError;\n\n\t\tthis.itemStart = function ( url ) {\n\n\t\t\titemsTotal ++;\n\n\t\t\tif ( isLoading === false ) {\n\n\t\t\t\tif ( scope.onStart !== undefined ) {\n\n\t\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tisLoading = true;\n\n\t\t};\n\n\t\tthis.itemEnd = function ( url ) {\n\n\t\t\titemsLoaded ++;\n\n\t\t\tif ( scope.onProgress !== undefined ) {\n\n\t\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\n\n\t\t\t}\n\n\t\t\tif ( itemsLoaded === itemsTotal ) {\n\n\t\t\t\tisLoading = false;\n\n\t\t\t\tif ( scope.onLoad !== undefined ) {\n\n\t\t\t\t\tscope.onLoad();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.itemError = function ( url ) {\n\n\t\t\tif ( scope.onError !== undefined ) {\n\n\t\t\t\tscope.onError( url );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.resolveURL = function ( url ) {\n\n\t\t\tif ( urlModifier ) {\n\n\t\t\t\treturn urlModifier( url );\n\n\t\t\t}\n\n\t\t\treturn url;\n\n\t\t};\n\n\t\tthis.setURLModifier = function ( transform ) {\n\n\t\t\turlModifier = transform;\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.addHandler = function ( regex, loader ) {\n\n\t\t\thandlers.push( regex, loader );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.removeHandler = function ( regex ) {\n\n\t\t\tconst index = handlers.indexOf( regex );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\thandlers.splice( index, 2 );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.getHandler = function ( file ) {\n\n\t\t\tfor ( let i = 0, l = handlers.length; i < l; i += 2 ) {\n\n\t\t\t\tconst regex = handlers[ i ];\n\t\t\t\tconst loader = handlers[ i + 1 ];\n\n\t\t\t\tif ( regex.global ) regex.lastIndex = 0; // see #17920\n\n\t\t\t\tif ( regex.test( file ) ) {\n\n\t\t\t\t\treturn loader;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t};\n\n\t}\n\n}\n\nconst DefaultLoadingManager = new LoadingManager();\n\nexport { DefaultLoadingManager, LoadingManager };\n", "import { DefaultLoadingManager } from './LoadingManager.js';\n\nclass Loader {\n\n\tconstructor( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t\tthis.crossOrigin = 'anonymous';\n\t\tthis.withCredentials = false;\n\t\tthis.path = '';\n\t\tthis.resourcePath = '';\n\t\tthis.requestHeader = {};\n\n\t}\n\n\tload( /* url, onLoad, onProgress, onError */ ) {}\n\n\tloadAsync( url, onProgress ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.load( url, resolve, onProgress, reject );\n\n\t\t} );\n\n\t}\n\n\tparse( /* data */ ) {}\n\n\tsetCrossOrigin( crossOrigin ) {\n\n\t\tthis.crossOrigin = crossOrigin;\n\t\treturn this;\n\n\t}\n\n\tsetWithCredentials( value ) {\n\n\t\tthis.withCredentials = value;\n\t\treturn this;\n\n\t}\n\n\tsetPath( path ) {\n\n\t\tthis.path = path;\n\t\treturn this;\n\n\t}\n\n\tsetResourcePath( resourcePath ) {\n\n\t\tthis.resourcePath = resourcePath;\n\t\treturn this;\n\n\t}\n\n\tsetRequestHeader( requestHeader ) {\n\n\t\tthis.requestHeader = requestHeader;\n\t\treturn this;\n\n\t}\n\n}\n\nexport { Loader };\n", "import { Cache } from './Cache.js';\nimport { Loader } from './Loader.js';\n\nconst loading = {};\n\nclass FileLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tthis.manager.itemStart( url );\n\n\t\t\tsetTimeout( () => {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\t// Check if request is duplicate\n\n\t\tif ( loading[ url ] !== undefined ) {\n\n\t\t\tloading[ url ].push( {\n\n\t\t\t\tonLoad: onLoad,\n\t\t\t\tonProgress: onProgress,\n\t\t\t\tonError: onError\n\n\t\t\t} );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Initialise array for duplicate requests\n\t\tloading[ url ] = [];\n\n\t\tloading[ url ].push( {\n\t\t\tonLoad: onLoad,\n\t\t\tonProgress: onProgress,\n\t\t\tonError: onError,\n\t\t} );\n\n\t\t// create request\n\t\tconst req = new Request( url, {\n\t\t\theaders: new Headers( this.requestHeader ),\n\t\t\tcredentials: this.withCredentials ? 'include' : 'same-origin',\n\t\t\t// An abort controller could be added within a future PR\n\t\t} );\n\n\t\t// record states ( avoid data race )\n\t\tconst mimeType = this.mimeType;\n\t\tconst responseType = this.responseType;\n\n\t\t// start the fetch\n\t\tfetch( req )\n\t\t\t.then( response => {\n\n\t\t\t\tif ( response.status === 200 || response.status === 0 ) {\n\n\t\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\n\t\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\n\n\t\t\t\t\tif ( response.status === 0 ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FileLoader: HTTP Status 0 received.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Workaround: Checking if response.body === undefined for Alipay browser #23548\n\n\t\t\t\t\tif ( typeof ReadableStream === 'undefined' || response.body === undefined || response.body.getReader === undefined ) {\n\n\t\t\t\t\t\treturn response;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\t\tconst reader = response.body.getReader();\n\t\t\t\t\tconst contentLength = response.headers.get( 'Content-Length' );\n\t\t\t\t\tconst total = contentLength ? parseInt( contentLength ) : 0;\n\t\t\t\t\tconst lengthComputable = total !== 0;\n\t\t\t\t\tlet loaded = 0;\n\n\t\t\t\t\t// periodically read data into the new stream tracking while download progress\n\t\t\t\t\tconst stream = new ReadableStream( {\n\t\t\t\t\t\tstart( controller ) {\n\n\t\t\t\t\t\t\treadData();\n\n\t\t\t\t\t\t\tfunction readData() {\n\n\t\t\t\t\t\t\t\treader.read().then( ( { done, value } ) => {\n\n\t\t\t\t\t\t\t\t\tif ( done ) {\n\n\t\t\t\t\t\t\t\t\t\tcontroller.close();\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\tloaded += value.byteLength;\n\n\t\t\t\t\t\t\t\t\t\tconst event = new ProgressEvent( 'progress', { lengthComputable, loaded, total } );\n\t\t\t\t\t\t\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\t\t\t\t\t\t\tif ( callback.onProgress ) callback.onProgress( event );\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tcontroller.enqueue( value );\n\t\t\t\t\t\t\t\t\t\treadData();\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn new Response( stream );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow Error( `fetch for \"${response.url}\" responded with ${response.status}: ${response.statusText}` );\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.then( response => {\n\n\t\t\t\tswitch ( responseType ) {\n\n\t\t\t\t\tcase 'arraybuffer':\n\n\t\t\t\t\t\treturn response.arrayBuffer();\n\n\t\t\t\t\tcase 'blob':\n\n\t\t\t\t\t\treturn response.blob();\n\n\t\t\t\t\tcase 'document':\n\n\t\t\t\t\t\treturn response.text()\n\t\t\t\t\t\t\t.then( text => {\n\n\t\t\t\t\t\t\t\tconst parser = new DOMParser();\n\t\t\t\t\t\t\t\treturn parser.parseFromString( text, mimeType );\n\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\tcase 'json':\n\n\t\t\t\t\t\treturn response.json();\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( mimeType === undefined ) {\n\n\t\t\t\t\t\t\treturn response.text();\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// sniff encoding\n\t\t\t\t\t\t\tconst re = /charset=\"?([^;\"\\s]*)\"?/i;\n\t\t\t\t\t\t\tconst exec = re.exec( mimeType );\n\t\t\t\t\t\t\tconst label = exec && exec[ 1 ] ? exec[ 1 ].toLowerCase() : undefined;\n\t\t\t\t\t\t\tconst decoder = new TextDecoder( label );\n\t\t\t\t\t\t\treturn response.arrayBuffer().then( ab => decoder.decode( ab ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.then( data => {\n\n\t\t\t\t// Add to cache only on HTTP success, so that we do not cache\n\t\t\t\t// error response bodies as proper responses to requests.\n\t\t\t\tCache.add( url, data );\n\n\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onLoad ) callback.onLoad( data );\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.catch( err => {\n\n\t\t\t\t// Abort errors and other errors are handled the same\n\n\t\t\t\tconst callbacks = loading[ url ];\n\n\t\t\t\tif ( callbacks === undefined ) {\n\n\t\t\t\t\t// When onLoad was called and url was deleted in `loading`\n\t\t\t\t\tthis.manager.itemError( url );\n\t\t\t\t\tthrow err;\n\n\t\t\t\t}\n\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onError ) callback.onError( err );\n\n\t\t\t\t}\n\n\t\t\t\tthis.manager.itemError( url );\n\n\t\t\t} )\n\t\t\t.finally( () => {\n\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t} );\n\n\t\tthis.manager.itemStart( url );\n\n\t}\n\n\tsetResponseType( value ) {\n\n\t\tthis.responseType = value;\n\t\treturn this;\n\n\t}\n\n\tsetMimeType( value ) {\n\n\t\tthis.mimeType = value;\n\t\treturn this;\n\n\t}\n\n}\n\n\nexport { FileLoader };\n", "import { Cache } from './Cache.js';\nimport { Loader } from './Loader.js';\nimport { createElementNS } from '../utils.js';\n\nclass ImageLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst image = createElementNS( 'img' );\n\n\t\tfunction onImageLoad() {\n\n\t\t\tremoveEventListeners();\n\n\t\t\tCache.add( url, this );\n\n\t\t\tif ( onLoad ) onLoad( this );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction onImageError( event ) {\n\n\t\t\tremoveEventListeners();\n\n\t\t\tif ( onError ) onError( event );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction removeEventListeners() {\n\n\t\t\timage.removeEventListener( 'load', onImageLoad, false );\n\t\t\timage.removeEventListener( 'error', onImageError, false );\n\n\t\t}\n\n\t\timage.addEventListener( 'load', onImageLoad, false );\n\t\timage.addEventListener( 'error', onImageError, false );\n\n\t\tif ( url.slice( 0, 5 ) !== 'data:' ) {\n\n\t\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\n\n\t\t}\n\n\t\tscope.manager.itemStart( url );\n\n\t\timage.src = url;\n\n\t\treturn image;\n\n\t}\n\n}\n\n\nexport { ImageLoader };\n", "import { ImageLoader } from './ImageLoader.js';\nimport { Texture } from '../textures/Texture.js';\nimport { Loader } from './Loader.js';\n\nclass TextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst texture = new Texture();\n\n\t\tconst loader = new ImageLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setPath( this.path );\n\n\t\tloader.load( url, function ( image ) {\n\n\t\t\ttexture.image = image;\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad !== undefined ) {\n\n\t\t\t\tonLoad( texture );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t\treturn texture;\n\n\t}\n\n}\n\n\nexport { TextureLoader };\n", "import { Object3D } from '../core/Object3D.js';\nimport { Color } from '../math/Color.js';\n\nclass Light extends Object3D {\n\n\tconstructor( color, intensity = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Light';\n\n\t\tthis.color = new Color( color );\n\t\tthis.intensity = intensity;\n\n\t}\n\n\tdispose() {\n\n\t\t// Empty here in base class; some subclasses override.\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.intensity = source.intensity;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.color = this.color.getHex();\n\t\tdata.object.intensity = this.intensity;\n\n\t\tif ( this.groundColor !== undefined ) data.object.groundColor = this.groundColor.getHex();\n\n\t\tif ( this.distance !== undefined ) data.object.distance = this.distance;\n\t\tif ( this.angle !== undefined ) data.object.angle = this.angle;\n\t\tif ( this.decay !== undefined ) data.object.decay = this.decay;\n\t\tif ( this.penumbra !== undefined ) data.object.penumbra = this.penumbra;\n\n\t\tif ( this.shadow !== undefined ) data.object.shadow = this.shadow.toJSON();\n\n\t\treturn data;\n\n\t}\n\n}\n\nLight.prototype.isLight = true;\n\nexport { Light };\n", "import { Matrix4 } from '../math/Matrix4.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Vector4 } from '../math/Vector4.js';\nimport { Frustum } from '../math/Frustum.js';\n\nconst _projScreenMatrix = /*@__PURE__*/ new Matrix4();\nconst _lightPositionWorld = /*@__PURE__*/ new Vector3();\nconst _lookTarget = /*@__PURE__*/ new Vector3();\n\nclass LightShadow {\n\n\tconstructor( camera ) {\n\n\t\tthis.camera = camera;\n\n\t\tthis.bias = 0;\n\t\tthis.normalBias = 0;\n\t\tthis.radius = 1;\n\t\tthis.blurSamples = 8;\n\n\t\tthis.mapSize = new Vector2( 512, 512 );\n\n\t\tthis.map = null;\n\t\tthis.mapPass = null;\n\t\tthis.matrix = new Matrix4();\n\n\t\tthis.autoUpdate = true;\n\t\tthis.needsUpdate = false;\n\n\t\tthis._frustum = new Frustum();\n\t\tthis._frameExtents = new Vector2( 1, 1 );\n\n\t\tthis._viewportCount = 1;\n\n\t\tthis._viewports = [\n\n\t\t\tnew Vector4( 0, 0, 1, 1 )\n\n\t\t];\n\n\t}\n\n\tgetViewportCount() {\n\n\t\treturn this._viewportCount;\n\n\t}\n\n\tgetFrustum() {\n\n\t\treturn this._frustum;\n\n\t}\n\n\tupdateMatrices( light ) {\n\n\t\tconst shadowCamera = this.camera;\n\t\tconst shadowMatrix = this.matrix;\n\n\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\n\t\tshadowCamera.position.copy( _lightPositionWorld );\n\n\t\t_lookTarget.setFromMatrixPosition( light.target.matrixWorld );\n\t\tshadowCamera.lookAt( _lookTarget );\n\t\tshadowCamera.updateMatrixWorld();\n\n\t\t_projScreenMatrix.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( _projScreenMatrix );\n\n\t\tshadowMatrix.set(\n\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t);\n\n\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\n\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\n\n\t}\n\n\tgetViewport( viewportIndex ) {\n\n\t\treturn this._viewports[ viewportIndex ];\n\n\t}\n\n\tgetFrameExtents() {\n\n\t\treturn this._frameExtents;\n\n\t}\n\n\tdispose() {\n\n\t\tif ( this.map ) {\n\n\t\t\tthis.map.dispose();\n\n\t\t}\n\n\t\tif ( this.mapPass ) {\n\n\t\t\tthis.mapPass.dispose();\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.camera = source.camera.clone();\n\n\t\tthis.bias = source.bias;\n\t\tthis.radius = source.radius;\n\n\t\tthis.mapSize.copy( source.mapSize );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst object = {};\n\n\t\tif ( this.bias !== 0 ) object.bias = this.bias;\n\t\tif ( this.normalBias !== 0 ) object.normalBias = this.normalBias;\n\t\tif ( this.radius !== 1 ) object.radius = this.radius;\n\t\tif ( this.mapSize.x !== 512 || this.mapSize.y !== 512 ) object.mapSize = this.mapSize.toArray();\n\n\t\tobject.camera = this.camera.toJSON( false ).object;\n\t\tdelete object.camera.matrix;\n\n\t\treturn object;\n\n\t}\n\n}\n\nexport { LightShadow };\n", "import { LightShadow } from './LightShadow.js';\nimport * as MathUtils from '../math/MathUtils.js';\nimport { PerspectiveCamera } from '../cameras/PerspectiveCamera.js';\n\nclass SpotLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new PerspectiveCamera( 50, 1, 0.5, 500 ) );\n\n\t\tthis.focus = 1;\n\n\t}\n\n\tupdateMatrices( light ) {\n\n\t\tconst camera = this.camera;\n\n\t\tconst fov = MathUtils.RAD2DEG * 2 * light.angle * this.focus;\n\t\tconst aspect = this.mapSize.width / this.mapSize.height;\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( fov !== camera.fov || aspect !== camera.aspect || far !== camera.far ) {\n\n\t\t\tcamera.fov = fov;\n\t\t\tcamera.aspect = aspect;\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\tsuper.updateMatrices( light );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.focus = source.focus;\n\n\t\treturn this;\n\n\t}\n\n}\n\nSpotLightShadow.prototype.isSpotLightShadow = true;\n\nexport { SpotLightShadow };\n", "import { Light } from './Light.js';\nimport { SpotLightShadow } from './SpotLightShadow.js';\nimport { Object3D } from '../core/Object3D.js';\n\nclass SpotLight extends Light {\n\n\tconstructor( color, intensity, distance = 0, angle = Math.PI / 3, penumbra = 0, decay = 1 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.type = 'SpotLight';\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.distance = distance;\n\t\tthis.angle = angle;\n\t\tthis.penumbra = penumbra;\n\t\tthis.decay = decay; // for physically correct lights, should be 2.\n\n\t\tthis.shadow = new SpotLightShadow();\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in candela)\n\t\t// by convention for a spotlight, luminous power (lm) = \u03C0 * luminous intensity (cd)\n\t\treturn this.intensity * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in candela) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / Math.PI;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.distance = source.distance;\n\t\tthis.angle = source.angle;\n\t\tthis.penumbra = source.penumbra;\n\t\tthis.decay = source.decay;\n\n\t\tthis.target = source.target.clone();\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nSpotLight.prototype.isSpotLight = true;\n\nexport { SpotLight };\n", "import { LightShadow } from './LightShadow.js';\nimport { PerspectiveCamera } from '../cameras/PerspectiveCamera.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Vector4 } from '../math/Vector4.js';\n\nconst _projScreenMatrix = /*@__PURE__*/ new Matrix4();\nconst _lightPositionWorld = /*@__PURE__*/ new Vector3();\nconst _lookTarget = /*@__PURE__*/ new Vector3();\n\nclass PointLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new PerspectiveCamera( 90, 1, 0.5, 500 ) );\n\n\t\tthis._frameExtents = new Vector2( 4, 2 );\n\n\t\tthis._viewportCount = 6;\n\n\t\tthis._viewports = [\n\t\t\t// These viewports map a cube-map onto a 2D texture with the\n\t\t\t// following orientation:\n\t\t\t//\n\t\t\t//  xzXZ\n\t\t\t//   y Y\n\t\t\t//\n\t\t\t// X - Positive x direction\n\t\t\t// x - Negative x direction\n\t\t\t// Y - Positive y direction\n\t\t\t// y - Negative y direction\n\t\t\t// Z - Positive z direction\n\t\t\t// z - Negative z direction\n\n\t\t\t// positive X\n\t\t\tnew Vector4( 2, 1, 1, 1 ),\n\t\t\t// negative X\n\t\t\tnew Vector4( 0, 1, 1, 1 ),\n\t\t\t// positive Z\n\t\t\tnew Vector4( 3, 1, 1, 1 ),\n\t\t\t// negative Z\n\t\t\tnew Vector4( 1, 1, 1, 1 ),\n\t\t\t// positive Y\n\t\t\tnew Vector4( 3, 0, 1, 1 ),\n\t\t\t// negative Y\n\t\t\tnew Vector4( 1, 0, 1, 1 )\n\t\t];\n\n\t\tthis._cubeDirections = [\n\t\t\tnew Vector3( 1, 0, 0 ), new Vector3( - 1, 0, 0 ), new Vector3( 0, 0, 1 ),\n\t\t\tnew Vector3( 0, 0, - 1 ), new Vector3( 0, 1, 0 ), new Vector3( 0, - 1, 0 )\n\t\t];\n\n\t\tthis._cubeUps = [\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ),\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 0, 1 ),\tnew Vector3( 0, 0, - 1 )\n\t\t];\n\n\t}\n\n\tupdateMatrices( light, viewportIndex = 0 ) {\n\n\t\tconst camera = this.camera;\n\t\tconst shadowMatrix = this.matrix;\n\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( far !== camera.far ) {\n\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\n\t\tcamera.position.copy( _lightPositionWorld );\n\n\t\t_lookTarget.copy( camera.position );\n\t\t_lookTarget.add( this._cubeDirections[ viewportIndex ] );\n\t\tcamera.up.copy( this._cubeUps[ viewportIndex ] );\n\t\tcamera.lookAt( _lookTarget );\n\t\tcamera.updateMatrixWorld();\n\n\t\tshadowMatrix.makeTranslation( - _lightPositionWorld.x, - _lightPositionWorld.y, - _lightPositionWorld.z );\n\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( _projScreenMatrix );\n\n\t}\n\n}\n\nPointLightShadow.prototype.isPointLightShadow = true;\n\nexport { PointLightShadow };\n", "import { Light } from './Light.js';\nimport { PointLightShadow } from './PointLightShadow.js';\n\nclass PointLight extends Light {\n\n\tconstructor( color, intensity, distance = 0, decay = 1 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.type = 'PointLight';\n\n\t\tthis.distance = distance;\n\t\tthis.decay = decay; // for physically correct lights, should be 2.\n\n\t\tthis.shadow = new PointLightShadow();\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in candela)\n\t\t// for an isotropic light source, luminous power (lm) = 4 \u03C0 luminous intensity (cd)\n\t\treturn this.intensity * 4 * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in candela) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / ( 4 * Math.PI );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.distance = source.distance;\n\t\tthis.decay = source.decay;\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nPointLight.prototype.isPointLight = true;\n\nexport { PointLight };\n", "import { LightShadow } from './LightShadow.js';\nimport { OrthographicCamera } from '../cameras/OrthographicCamera.js';\n\nclass DirectionalLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new OrthographicCamera( - 5, 5, 5, - 5, 0.5, 500 ) );\n\n\t}\n\n}\n\nDirectionalLightShadow.prototype.isDirectionalLightShadow = true;\n\nexport { DirectionalLightShadow };\n", "import { Light } from './Light.js';\nimport { DirectionalLightShadow } from './DirectionalLightShadow.js';\nimport { Object3D } from '../core/Object3D.js';\n\nclass DirectionalLight extends Light {\n\n\tconstructor( color, intensity ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.type = 'DirectionalLight';\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.shadow = new DirectionalLightShadow();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.target = source.target.clone();\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nDirectionalLight.prototype.isDirectionalLight = true;\n\nexport { DirectionalLight };\n", "class LoaderUtils {\n\n\tstatic decodeText( array ) {\n\n\t\tif ( typeof TextDecoder !== 'undefined' ) {\n\n\t\t\treturn new TextDecoder().decode( array );\n\n\t\t}\n\n\t\t// Avoid the String.fromCharCode.apply(null, array) shortcut, which\n\t\t// throws a \"maximum call stack size exceeded\" error for large arrays.\n\n\t\tlet s = '';\n\n\t\tfor ( let i = 0, il = array.length; i < il; i ++ ) {\n\n\t\t\t// Implicitly assumes little-endian.\n\t\t\ts += String.fromCharCode( array[ i ] );\n\n\t\t}\n\n\t\ttry {\n\n\t\t\t// merges multi-byte utf-8 characters.\n\n\t\t\treturn decodeURIComponent( escape( s ) );\n\n\t\t} catch ( e ) { // see #16358\n\n\t\t\treturn s;\n\n\t\t}\n\n\t}\n\n\tstatic extractUrlBase( url ) {\n\n\t\tconst index = url.lastIndexOf( '/' );\n\n\t\tif ( index === - 1 ) return './';\n\n\t\treturn url.slice( 0, index + 1 );\n\n\t}\n\n\tstatic resolveURL( url, path ) {\n\n\t\t// Invalid URL\n\t\tif ( typeof url !== 'string' || url === '' ) return '';\n\n\t\t// Host Relative URL\n\t\tif ( /^https?:\\/\\//i.test( path ) && /^\\//.test( url ) ) {\n\n\t\t\tpath = path.replace( /(^https?:\\/\\/[^\\/]+).*/i, '$1' );\n\n\t\t}\n\n\t\t// Absolute URL http://,https://,//\n\t\tif ( /^(https?:)?\\/\\//i.test( url ) ) return url;\n\n\t\t// Data URI\n\t\tif ( /^data:.*,.*$/i.test( url ) ) return url;\n\n\t\t// Blob URL\n\t\tif ( /^blob:.*$/i.test( url ) ) return url;\n\n\t\t// Relative URL\n\t\treturn path + url;\n\n\t}\n\n}\n\nexport { LoaderUtils };\n", "import { Cache } from './Cache.js';\nimport { Loader } from './Loader.js';\n\nclass ImageBitmapLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tif ( typeof createImageBitmap === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: createImageBitmap() not supported.' );\n\n\t\t}\n\n\t\tif ( typeof fetch === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: fetch() not supported.' );\n\n\t\t}\n\n\t\tthis.options = { premultiplyAlpha: 'none' };\n\n\t}\n\n\tsetOptions( options ) {\n\n\t\tthis.options = options;\n\n\t\treturn this;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst fetchOptions = {};\n\t\tfetchOptions.credentials = ( this.crossOrigin === 'anonymous' ) ? 'same-origin' : 'include';\n\t\tfetchOptions.headers = this.requestHeader;\n\n\t\tfetch( url, fetchOptions ).then( function ( res ) {\n\n\t\t\treturn res.blob();\n\n\t\t} ).then( function ( blob ) {\n\n\t\t\treturn createImageBitmap( blob, Object.assign( scope.options, { colorSpaceConversion: 'none' } ) );\n\n\t\t} ).then( function ( imageBitmap ) {\n\n\t\t\tCache.add( url, imageBitmap );\n\n\t\t\tif ( onLoad ) onLoad( imageBitmap );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t} ).catch( function ( e ) {\n\n\t\t\tif ( onError ) onError( e );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t} );\n\n\t\tscope.manager.itemStart( url );\n\n\t}\n\n}\n\nImageBitmapLoader.prototype.isImageBitmapLoader = true;\n\nexport { ImageBitmapLoader };\n", "// Characters [].:/ are reserved for track binding syntax.\nconst _RESERVED_CHARS_RE = '\\\\[\\\\]\\\\.:\\\\/';\nconst _reservedRe = new RegExp( '[' + _RESERVED_CHARS_RE + ']', 'g' );\n\n// Attempts to allow node names from any language. ES5's `\\w` regexp matches\n// only latin characters, and the unicode \\p{L} is not yet supported. So\n// instead, we exclude reserved characters and match everything else.\nconst _wordChar = '[^' + _RESERVED_CHARS_RE + ']';\nconst _wordCharOrDot = '[^' + _RESERVED_CHARS_RE.replace( '\\\\.', '' ) + ']';\n\n// Parent directories, delimited by '/' or ':'. Currently unused, but must\n// be matched to parse the rest of the track name.\nconst _directoryRe = /((?:WC+[\\/:])*)/.source.replace( 'WC', _wordChar );\n\n// Target node. May contain word characters (a-zA-Z0-9_) and '.' or '-'.\nconst _nodeRe = /(WCOD+)?/.source.replace( 'WCOD', _wordCharOrDot );\n\n// Object on target node, and accessor. May not contain reserved\n// characters. Accessor may contain any character except closing bracket.\nconst _objectRe = /(?:\\.(WC+)(?:\\[(.+)\\])?)?/.source.replace( 'WC', _wordChar );\n\n// Property and accessor. May not contain reserved characters. Accessor may\n// contain any non-bracket characters.\nconst _propertyRe = /\\.(WC+)(?:\\[(.+)\\])?/.source.replace( 'WC', _wordChar );\n\nconst _trackRe = new RegExp( ''\n\t+ '^'\n\t+ _directoryRe\n\t+ _nodeRe\n\t+ _objectRe\n\t+ _propertyRe\n\t+ '$'\n);\n\nconst _supportedObjectNames = [ 'material', 'materials', 'bones' ];\n\nclass Composite {\n\n\tconstructor( targetGroup, path, optionalParsedPath ) {\n\n\t\tconst parsedPath = optionalParsedPath || PropertyBinding.parseTrackName( path );\n\n\t\tthis._targetGroup = targetGroup;\n\t\tthis._bindings = targetGroup.subscribe_( path, parsedPath );\n\n\t}\n\n\tgetValue( array, offset ) {\n\n\t\tthis.bind(); // bind all binding\n\n\t\tconst firstValidIndex = this._targetGroup.nCachedObjects_,\n\t\t\tbinding = this._bindings[ firstValidIndex ];\n\n\t\t// and only call .getValue on the first\n\t\tif ( binding !== undefined ) binding.getValue( array, offset );\n\n\t}\n\n\tsetValue( array, offset ) {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].setValue( array, offset );\n\n\t\t}\n\n\t}\n\n\tbind() {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].bind();\n\n\t\t}\n\n\t}\n\n\tunbind() {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].unbind();\n\n\t\t}\n\n\t}\n\n}\n\n// Note: This class uses a State pattern on a per-method basis:\n// 'bind' sets 'this.getValue' / 'setValue' and shadows the\n// prototype version of these methods with one that represents\n// the bound state. When the property is not found, the methods\n// become no-ops.\nclass PropertyBinding {\n\n\tconstructor( rootNode, path, parsedPath ) {\n\n\t\tthis.path = path;\n\t\tthis.parsedPath = parsedPath || PropertyBinding.parseTrackName( path );\n\n\t\tthis.node = PropertyBinding.findNode( rootNode, this.parsedPath.nodeName ) || rootNode;\n\n\t\tthis.rootNode = rootNode;\n\n\t\t// initial state of these methods that calls 'bind'\n\t\tthis.getValue = this._getValue_unbound;\n\t\tthis.setValue = this._setValue_unbound;\n\n\t}\n\n\n\tstatic create( root, path, parsedPath ) {\n\n\t\tif ( ! ( root && root.isAnimationObjectGroup ) ) {\n\n\t\t\treturn new PropertyBinding( root, path, parsedPath );\n\n\t\t} else {\n\n\t\t\treturn new PropertyBinding.Composite( root, path, parsedPath );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Replaces spaces with underscores and removes unsupported characters from\n\t * node names, to ensure compatibility with parseTrackName().\n\t *\n\t * @param {string} name Node name to be sanitized.\n\t * @return {string}\n\t */\n\tstatic sanitizeNodeName( name ) {\n\n\t\treturn name.replace( /\\s/g, '_' ).replace( _reservedRe, '' );\n\n\t}\n\n\tstatic parseTrackName( trackName ) {\n\n\t\tconst matches = _trackRe.exec( trackName );\n\n\t\tif ( matches === null ) {\n\n\t\t\tthrow new Error( 'PropertyBinding: Cannot parse trackName: ' + trackName );\n\n\t\t}\n\n\t\tconst results = {\n\t\t\t// directoryName: matches[ 1 ], // (tschw) currently unused\n\t\t\tnodeName: matches[ 2 ],\n\t\t\tobjectName: matches[ 3 ],\n\t\t\tobjectIndex: matches[ 4 ],\n\t\t\tpropertyName: matches[ 5 ], // required\n\t\t\tpropertyIndex: matches[ 6 ]\n\t\t};\n\n\t\tconst lastDot = results.nodeName && results.nodeName.lastIndexOf( '.' );\n\n\t\tif ( lastDot !== undefined && lastDot !== - 1 ) {\n\n\t\t\tconst objectName = results.nodeName.substring( lastDot + 1 );\n\n\t\t\t// Object names must be checked against an allowlist. Otherwise, there\n\t\t\t// is no way to parse 'foo.bar.baz': 'baz' must be a property, but\n\t\t\t// 'bar' could be the objectName, or part of a nodeName (which can\n\t\t\t// include '.' characters).\n\t\t\tif ( _supportedObjectNames.indexOf( objectName ) !== - 1 ) {\n\n\t\t\t\tresults.nodeName = results.nodeName.substring( 0, lastDot );\n\t\t\t\tresults.objectName = objectName;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( results.propertyName === null || results.propertyName.length === 0 ) {\n\n\t\t\tthrow new Error( 'PropertyBinding: can not parse propertyName from trackName: ' + trackName );\n\n\t\t}\n\n\t\treturn results;\n\n\t}\n\n\tstatic findNode( root, nodeName ) {\n\n\t\tif ( nodeName === undefined || nodeName === '' || nodeName === '.' || nodeName === - 1 || nodeName === root.name || nodeName === root.uuid ) {\n\n\t\t\treturn root;\n\n\t\t}\n\n\t\t// search into skeleton bones.\n\t\tif ( root.skeleton ) {\n\n\t\t\tconst bone = root.skeleton.getBoneByName( nodeName );\n\n\t\t\tif ( bone !== undefined ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// search into node subtree.\n\t\tif ( root.children ) {\n\n\t\t\tconst searchNodeSubtree = function ( children ) {\n\n\t\t\t\tfor ( let i = 0; i < children.length; i ++ ) {\n\n\t\t\t\t\tconst childNode = children[ i ];\n\n\t\t\t\t\tif ( childNode.name === nodeName || childNode.uuid === nodeName ) {\n\n\t\t\t\t\t\treturn childNode;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = searchNodeSubtree( childNode.children );\n\n\t\t\t\t\tif ( result ) return result;\n\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\n\t\t\t};\n\n\t\t\tconst subTreeNode = searchNodeSubtree( root.children );\n\n\t\t\tif ( subTreeNode ) {\n\n\t\t\t\treturn subTreeNode;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t// these are used to \"bind\" a nonexistent property\n\t_getValue_unavailable() {}\n\t_setValue_unavailable() {}\n\n\t// Getters\n\n\t_getValue_direct( buffer, offset ) {\n\n\t\tbuffer[ offset ] = this.targetObject[ this.propertyName ];\n\n\t}\n\n\t_getValue_array( buffer, offset ) {\n\n\t\tconst source = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = source.length; i !== n; ++ i ) {\n\n\t\t\tbuffer[ offset ++ ] = source[ i ];\n\n\t\t}\n\n\t}\n\n\t_getValue_arrayElement( buffer, offset ) {\n\n\t\tbuffer[ offset ] = this.resolvedProperty[ this.propertyIndex ];\n\n\t}\n\n\t_getValue_toArray( buffer, offset ) {\n\n\t\tthis.resolvedProperty.toArray( buffer, offset );\n\n\t}\n\n\t// Direct\n\n\t_setValue_direct( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\n\t}\n\n\t_setValue_direct_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_direct_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// EntireArray\n\n\t_setValue_array( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t}\n\n\t_setValue_array_setNeedsUpdate( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_array_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// ArrayElement\n\n\t_setValue_arrayElement( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\n\t}\n\n\t_setValue_arrayElement_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_arrayElement_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// HasToFromArray\n\n\t_setValue_fromArray( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\n\t}\n\n\t_setValue_fromArray_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_fromArray_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t_getValue_unbound( targetArray, offset ) {\n\n\t\tthis.bind();\n\t\tthis.getValue( targetArray, offset );\n\n\t}\n\n\t_setValue_unbound( sourceArray, offset ) {\n\n\t\tthis.bind();\n\t\tthis.setValue( sourceArray, offset );\n\n\t}\n\n\t// create getter / setter pair for a property in the scene graph\n\tbind() {\n\n\t\tlet targetObject = this.node;\n\t\tconst parsedPath = this.parsedPath;\n\n\t\tconst objectName = parsedPath.objectName;\n\t\tconst propertyName = parsedPath.propertyName;\n\t\tlet propertyIndex = parsedPath.propertyIndex;\n\n\t\tif ( ! targetObject ) {\n\n\t\t\ttargetObject = PropertyBinding.findNode( this.rootNode, parsedPath.nodeName ) || this.rootNode;\n\n\t\t\tthis.node = targetObject;\n\n\t\t}\n\n\t\t// set fail state so we can just 'return' on error\n\t\tthis.getValue = this._getValue_unavailable;\n\t\tthis.setValue = this._setValue_unavailable;\n\n\t\t// ensure there is a value node\n\t\tif ( ! targetObject ) {\n\n\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update node for track: ' + this.path + ' but it wasn\\'t found.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( objectName ) {\n\n\t\t\tlet objectIndex = parsedPath.objectIndex;\n\n\t\t\t// special cases were we need to reach deeper into the hierarchy to get the face materials....\n\t\t\tswitch ( objectName ) {\n\n\t\t\t\tcase 'materials':\n\n\t\t\t\t\tif ( ! targetObject.material ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material as node does not have a material.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.material.materials ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject.material.materials;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bones':\n\n\t\t\t\t\tif ( ! targetObject.skeleton ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer\n\t\t\t\t\t// and convert the integer string to a true integer.\n\n\t\t\t\t\ttargetObject = targetObject.skeleton.bones;\n\n\t\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\t\tfor ( let i = 0; i < targetObject.length; i ++ ) {\n\n\t\t\t\t\t\tif ( targetObject[ i ].name === objectIndex ) {\n\n\t\t\t\t\t\t\tobjectIndex = i;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tif ( targetObject[ objectName ] === undefined ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to objectName of node undefined.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject[ objectName ];\n\n\t\t\t}\n\n\n\t\t\tif ( objectIndex !== undefined ) {\n\n\t\t\t\tif ( targetObject[ objectIndex ] === undefined ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.', this, targetObject );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\ttargetObject = targetObject[ objectIndex ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// resolve property\n\t\tconst nodeProperty = targetObject[ propertyName ];\n\n\t\tif ( nodeProperty === undefined ) {\n\n\t\t\tconst nodeName = parsedPath.nodeName;\n\n\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update property for track: ' + nodeName +\n\t\t\t\t'.' + propertyName + ' but it wasn\\'t found.', targetObject );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// determine versioning scheme\n\t\tlet versioning = this.Versioning.None;\n\n\t\tthis.targetObject = targetObject;\n\n\t\tif ( targetObject.needsUpdate !== undefined ) { // material\n\n\t\t\tversioning = this.Versioning.NeedsUpdate;\n\n\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\n\n\t\t\tversioning = this.Versioning.MatrixWorldNeedsUpdate;\n\n\t\t}\n\n\t\t// determine how the property gets bound\n\t\tlet bindingType = this.BindingType.Direct;\n\n\t\tif ( propertyIndex !== undefined ) {\n\n\t\t\t// access a sub element of the property array (only primitives are supported right now)\n\n\t\t\tif ( propertyName === 'morphTargetInfluences' ) {\n\n\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\n\n\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\tif ( ! targetObject.geometry ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.', this );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( targetObject.geometry.isBufferGeometry ) {\n\n\t\t\t\t\tif ( ! targetObject.geometry.morphAttributes ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( targetObject.morphTargetDictionary[ propertyIndex ] !== undefined ) {\n\n\t\t\t\t\t\tpropertyIndex = targetObject.morphTargetDictionary[ propertyIndex ];\n\n\t\t\t\t\t}\n\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.', this );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tbindingType = this.BindingType.ArrayElement;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\t\t\tthis.propertyIndex = propertyIndex;\n\n\t\t} else if ( nodeProperty.fromArray !== undefined && nodeProperty.toArray !== undefined ) {\n\n\t\t\t// must use copy for Object3D.Euler/Quaternion\n\n\t\t\tbindingType = this.BindingType.HasFromToArray;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t} else if ( Array.isArray( nodeProperty ) ) {\n\n\t\t\tbindingType = this.BindingType.EntireArray;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t} else {\n\n\t\t\tthis.propertyName = propertyName;\n\n\t\t}\n\n\t\t// select getter / setter\n\t\tthis.getValue = this.GetterByBindingType[ bindingType ];\n\t\tthis.setValue = this.SetterByBindingTypeAndVersioning[ bindingType ][ versioning ];\n\n\t}\n\n\tunbind() {\n\n\t\tthis.node = null;\n\n\t\t// back to the prototype version of getValue / setValue\n\t\t// note: avoiding to mutate the shape of 'this' via 'delete'\n\t\tthis.getValue = this._getValue_unbound;\n\t\tthis.setValue = this._setValue_unbound;\n\n\t}\n\n}\n\nPropertyBinding.Composite = Composite;\n\nPropertyBinding.prototype.BindingType = {\n\tDirect: 0,\n\tEntireArray: 1,\n\tArrayElement: 2,\n\tHasFromToArray: 3\n};\n\nPropertyBinding.prototype.Versioning = {\n\tNone: 0,\n\tNeedsUpdate: 1,\n\tMatrixWorldNeedsUpdate: 2\n};\n\nPropertyBinding.prototype.GetterByBindingType = [\n\n\tPropertyBinding.prototype._getValue_direct,\n\tPropertyBinding.prototype._getValue_array,\n\tPropertyBinding.prototype._getValue_arrayElement,\n\tPropertyBinding.prototype._getValue_toArray,\n\n];\n\nPropertyBinding.prototype.SetterByBindingTypeAndVersioning = [\n\n\t[\n\t\t// Direct\n\t\tPropertyBinding.prototype._setValue_direct,\n\t\tPropertyBinding.prototype._setValue_direct_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// EntireArray\n\n\t\tPropertyBinding.prototype._setValue_array,\n\t\tPropertyBinding.prototype._setValue_array_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// ArrayElement\n\t\tPropertyBinding.prototype._setValue_arrayElement,\n\t\tPropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// HasToFromArray\n\t\tPropertyBinding.prototype._setValue_fromArray,\n\t\tPropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate,\n\n\t]\n\n];\n\n\nexport { PropertyBinding };\n", "import { REVISION } from './constants.js';\n\nexport { WebGLArrayRenderTarget } from './renderers/WebGLArrayRenderTarget.js';\nexport { WebGL3DRenderTarget } from './renderers/WebGL3DRenderTarget.js';\nexport { WebGLMultipleRenderTargets } from './renderers/WebGLMultipleRenderTargets.js';\nexport { WebGLCubeRenderTarget } from './renderers/WebGLCubeRenderTarget.js';\nexport { WebGLRenderTarget } from './renderers/WebGLRenderTarget.js';\nexport { WebGLRenderer } from './renderers/WebGLRenderer.js';\nexport { WebGL1Renderer } from './renderers/WebGL1Renderer.js';\nexport { ShaderLib } from './renderers/shaders/ShaderLib.js';\nexport { UniformsLib } from './renderers/shaders/UniformsLib.js';\nexport { UniformsUtils } from './renderers/shaders/UniformsUtils.js';\nexport { ShaderChunk } from './renderers/shaders/ShaderChunk.js';\nexport { FogExp2 } from './scenes/FogExp2.js';\nexport { Fog } from './scenes/Fog.js';\nexport { Scene } from './scenes/Scene.js';\nexport { Sprite } from './objects/Sprite.js';\nexport { LOD } from './objects/LOD.js';\nexport { SkinnedMesh } from './objects/SkinnedMesh.js';\nexport { Skeleton } from './objects/Skeleton.js';\nexport { Bone } from './objects/Bone.js';\nexport { Mesh } from './objects/Mesh.js';\nexport { InstancedMesh } from './objects/InstancedMesh.js';\nexport { LineSegments } from './objects/LineSegments.js';\nexport { LineLoop } from './objects/LineLoop.js';\nexport { Line } from './objects/Line.js';\nexport { Points } from './objects/Points.js';\nexport { Group } from './objects/Group.js';\nexport { VideoTexture } from './textures/VideoTexture.js';\nexport { FramebufferTexture } from './textures/FramebufferTexture.js';\nexport { Source } from './textures/Source.js';\nexport { DataTexture } from './textures/DataTexture.js';\nexport { DataArrayTexture } from './textures/DataArrayTexture.js';\nexport { Data3DTexture } from './textures/Data3DTexture.js';\nexport { CompressedTexture } from './textures/CompressedTexture.js';\nexport { CubeTexture } from './textures/CubeTexture.js';\nexport { CanvasTexture } from './textures/CanvasTexture.js';\nexport { DepthTexture } from './textures/DepthTexture.js';\nexport { Texture } from './textures/Texture.js';\nexport * from './geometries/Geometries.js';\nexport * from './materials/Materials.js';\nexport { AnimationLoader } from './loaders/AnimationLoader.js';\nexport { CompressedTextureLoader } from './loaders/CompressedTextureLoader.js';\nexport { CubeTextureLoader } from './loaders/CubeTextureLoader.js';\nexport { DataTextureLoader } from './loaders/DataTextureLoader.js';\nexport { TextureLoader } from './loaders/TextureLoader.js';\nexport { ObjectLoader } from './loaders/ObjectLoader.js';\nexport { MaterialLoader } from './loaders/MaterialLoader.js';\nexport { BufferGeometryLoader } from './loaders/BufferGeometryLoader.js';\nexport { DefaultLoadingManager, LoadingManager } from './loaders/LoadingManager.js';\nexport { ImageLoader } from './loaders/ImageLoader.js';\nexport { ImageBitmapLoader } from './loaders/ImageBitmapLoader.js';\nexport { FileLoader } from './loaders/FileLoader.js';\nexport { Loader } from './loaders/Loader.js';\nexport { LoaderUtils } from './loaders/LoaderUtils.js';\nexport { Cache } from './loaders/Cache.js';\nexport { AudioLoader } from './loaders/AudioLoader.js';\nexport { SpotLight } from './lights/SpotLight.js';\nexport { PointLight } from './lights/PointLight.js';\nexport { RectAreaLight } from './lights/RectAreaLight.js';\nexport { HemisphereLight } from './lights/HemisphereLight.js';\nexport { HemisphereLightProbe } from './lights/HemisphereLightProbe.js';\nexport { DirectionalLight } from './lights/DirectionalLight.js';\nexport { AmbientLight } from './lights/AmbientLight.js';\nexport { AmbientLightProbe } from './lights/AmbientLightProbe.js';\nexport { Light } from './lights/Light.js';\nexport { LightProbe } from './lights/LightProbe.js';\nexport { StereoCamera } from './cameras/StereoCamera.js';\nexport { PerspectiveCamera } from './cameras/PerspectiveCamera.js';\nexport { OrthographicCamera } from './cameras/OrthographicCamera.js';\nexport { CubeCamera } from './cameras/CubeCamera.js';\nexport { ArrayCamera } from './cameras/ArrayCamera.js';\nexport { Camera } from './cameras/Camera.js';\nexport { AudioListener } from './audio/AudioListener.js';\nexport { PositionalAudio } from './audio/PositionalAudio.js';\nexport { AudioContext } from './audio/AudioContext.js';\nexport { AudioAnalyser } from './audio/AudioAnalyser.js';\nexport { Audio } from './audio/Audio.js';\nexport { VectorKeyframeTrack } from './animation/tracks/VectorKeyframeTrack.js';\nexport { StringKeyframeTrack } from './animation/tracks/StringKeyframeTrack.js';\nexport { QuaternionKeyframeTrack } from './animation/tracks/QuaternionKeyframeTrack.js';\nexport { NumberKeyframeTrack } from './animation/tracks/NumberKeyframeTrack.js';\nexport { ColorKeyframeTrack } from './animation/tracks/ColorKeyframeTrack.js';\nexport { BooleanKeyframeTrack } from './animation/tracks/BooleanKeyframeTrack.js';\nexport { PropertyMixer } from './animation/PropertyMixer.js';\nexport { PropertyBinding } from './animation/PropertyBinding.js';\nexport { KeyframeTrack } from './animation/KeyframeTrack.js';\nexport { AnimationUtils } from './animation/AnimationUtils.js';\nexport { AnimationObjectGroup } from './animation/AnimationObjectGroup.js';\nexport { AnimationMixer } from './animation/AnimationMixer.js';\nexport { AnimationClip } from './animation/AnimationClip.js';\nexport { Uniform } from './core/Uniform.js';\nexport { InstancedBufferGeometry } from './core/InstancedBufferGeometry.js';\nexport { BufferGeometry } from './core/BufferGeometry.js';\nexport { InterleavedBufferAttribute } from './core/InterleavedBufferAttribute.js';\nexport { InstancedInterleavedBuffer } from './core/InstancedInterleavedBuffer.js';\nexport { InterleavedBuffer } from './core/InterleavedBuffer.js';\nexport { InstancedBufferAttribute } from './core/InstancedBufferAttribute.js';\nexport { GLBufferAttribute } from './core/GLBufferAttribute.js';\nexport * from './core/BufferAttribute.js';\nexport { Object3D } from './core/Object3D.js';\nexport { Raycaster } from './core/Raycaster.js';\nexport { Layers } from './core/Layers.js';\nexport { EventDispatcher } from './core/EventDispatcher.js';\nexport { Clock } from './core/Clock.js';\nexport { QuaternionLinearInterpolant } from './math/interpolants/QuaternionLinearInterpolant.js';\nexport { LinearInterpolant } from './math/interpolants/LinearInterpolant.js';\nexport { DiscreteInterpolant } from './math/interpolants/DiscreteInterpolant.js';\nexport { CubicInterpolant } from './math/interpolants/CubicInterpolant.js';\nexport { Interpolant } from './math/Interpolant.js';\nexport { Triangle } from './math/Triangle.js';\nexport * as MathUtils from './math/MathUtils.js';\nexport { Spherical } from './math/Spherical.js';\nexport { Cylindrical } from './math/Cylindrical.js';\nexport { Plane } from './math/Plane.js';\nexport { Frustum } from './math/Frustum.js';\nexport { Sphere } from './math/Sphere.js';\nexport { Ray } from './math/Ray.js';\nexport { Matrix4 } from './math/Matrix4.js';\nexport { Matrix3 } from './math/Matrix3.js';\nexport { Box3 } from './math/Box3.js';\nexport { Box2 } from './math/Box2.js';\nexport { Line3 } from './math/Line3.js';\nexport { Euler } from './math/Euler.js';\nexport { Vector4 } from './math/Vector4.js';\nexport { Vector3 } from './math/Vector3.js';\nexport { Vector2 } from './math/Vector2.js';\nexport { Quaternion } from './math/Quaternion.js';\nexport { Color } from './math/Color.js';\nexport { ColorManagement } from './math/ColorManagement.js';\nexport { SphericalHarmonics3 } from './math/SphericalHarmonics3.js';\nexport { SpotLightHelper } from './helpers/SpotLightHelper.js';\nexport { SkeletonHelper } from './helpers/SkeletonHelper.js';\nexport { PointLightHelper } from './helpers/PointLightHelper.js';\nexport { HemisphereLightHelper } from './helpers/HemisphereLightHelper.js';\nexport { GridHelper } from './helpers/GridHelper.js';\nexport { PolarGridHelper } from './helpers/PolarGridHelper.js';\nexport { DirectionalLightHelper } from './helpers/DirectionalLightHelper.js';\nexport { CameraHelper } from './helpers/CameraHelper.js';\nexport { BoxHelper } from './helpers/BoxHelper.js';\nexport { Box3Helper } from './helpers/Box3Helper.js';\nexport { PlaneHelper } from './helpers/PlaneHelper.js';\nexport { ArrowHelper } from './helpers/ArrowHelper.js';\nexport { AxesHelper } from './helpers/AxesHelper.js';\nexport * from './extras/curves/Curves.js';\nexport { Shape } from './extras/core/Shape.js';\nexport { Path } from './extras/core/Path.js';\nexport { ShapePath } from './extras/core/ShapePath.js';\nexport { CurvePath } from './extras/core/CurvePath.js';\nexport { Curve } from './extras/core/Curve.js';\nexport { DataUtils } from './extras/DataUtils.js';\nexport { ImageUtils } from './extras/ImageUtils.js';\nexport { ShapeUtils } from './extras/ShapeUtils.js';\nexport { PMREMGenerator } from './extras/PMREMGenerator.js';\nexport { WebGLUtils } from './renderers/webgl/WebGLUtils.js';\nexport * from './constants.js';\nexport * from './Three.Legacy.js';\n\nif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'register', { detail: {\n\t\trevision: REVISION,\n\t} } ) );\n\n}\n\nif ( typeof window !== 'undefined' ) {\n\n\tif ( window.__THREE__ ) {\n\n\t\tconsole.warn( 'WARNING: Multiple instances of Three.js being imported.' );\n\n\t} else {\n\n\t\twindow.__THREE__ = REVISION;\n\n\t}\n\n}\n", "/* eslint-disable */\nimport {\n  BufferAttribute,\n  BufferGeometry,\n  Float32BufferAttribute,\n  InstancedBufferAttribute,\n  InterleavedBuffer,\n  InterleavedBufferAttribute,\n  TriangleFanDrawMode,\n  TriangleStripDrawMode,\n  TrianglesDrawMode,\n  Vector3,\n} from 'three';\n\nfunction computeMikkTSpaceTangents(geometry, MikkTSpace, negateSign = true) {\n  if (!MikkTSpace || !MikkTSpace.isReady) {\n    throw new Error('BufferGeometryUtils: Initialized MikkTSpace library required.');\n  }\n\n  if (\n    !geometry.hasAttribute('position') ||\n    !geometry.hasAttribute('normal') ||\n    !geometry.hasAttribute('uv')\n  ) {\n    throw new Error(\n      'BufferGeometryUtils: Tangents require \"position\", \"normal\", and \"uv\" attributes.',\n    );\n  }\n\n  function getAttributeArray(attribute) {\n    if (attribute.normalized || attribute.isInterleavedBufferAttribute) {\n      const dstArray = new Float32Array(attribute.getCount() * attribute.itemSize);\n\n      for (let i = 0, j = 0; i < attribute.getCount(); i++) {\n        dstArray[j++] = attribute.getX(i);\n        dstArray[j++] = attribute.getY(i);\n\n        if (attribute.itemSize > 2) {\n          dstArray[j++] = attribute.getZ(i);\n        }\n      }\n\n      return dstArray;\n    }\n\n    if (attribute.array instanceof Float32Array) {\n      return attribute.array;\n    }\n\n    return new Float32Array(attribute.array);\n  }\n\n  // MikkTSpace algorithm requires non-indexed input.\n\n  const _geometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\n  // Compute vertex tangents.\n\n  const tangents = MikkTSpace.generateTangents(\n    getAttributeArray(_geometry.attributes.position),\n    getAttributeArray(_geometry.attributes.normal),\n    getAttributeArray(_geometry.attributes.uv),\n  );\n\n  // Texture coordinate convention of glTF differs from the apparent\n  // default of the MikkTSpace library; .w component must be flipped.\n\n  if (negateSign) {\n    for (let i = 3; i < tangents.length; i += 4) {\n      tangents[i] *= -1;\n    }\n  }\n\n  //\n\n  _geometry.setAttribute('tangent', new BufferAttribute(tangents, 4));\n\n  if (geometry !== _geometry) {\n    geometry.copy(_geometry);\n  }\n\n  return geometry;\n}\n\n/**\n * @param  {Array<BufferGeometry>} geometries\n * @param  {Boolean} useGroups\n * @return {BufferGeometry}\n */\nfunction mergeGeometries(geometries, useGroups = false) {\n  const isIndexed = geometries[0].index !== null;\n\n  const attributesUsed = new Set(Object.keys(geometries[0].attributes));\n  const morphAttributesUsed = new Set(Object.keys(geometries[0].morphAttributes));\n\n  const attributes = {};\n  const morphAttributes = {};\n\n  const morphTargetsRelative = geometries[0].morphTargetsRelative;\n\n  const mergedGeometry = new BufferGeometry();\n\n  let offset = 0;\n\n  for (let i = 0; i < geometries.length; ++i) {\n    const geometry = geometries[i];\n    let attributesCount = 0;\n\n    // ensure that all geometries are indexed, or none\n\n    if (isIndexed !== (geometry.index !== null)) {\n      console.error(\n        'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' +\n          i +\n          '. All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them.',\n      );\n      return null;\n    }\n\n    // gather attributes, exit early if they're different\n\n    for (const name in geometry.attributes) {\n      if (!attributesUsed.has(name)) {\n        console.error(\n          'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' +\n            i +\n            '. All geometries must have compatible attributes; make sure \"' +\n            name +\n            '\" attribute exists among all geometries, or in none of them.',\n        );\n        return null;\n      }\n\n      if (attributes[name] === undefined) attributes[name] = [];\n\n      attributes[name].push(geometry.attributes[name]);\n\n      attributesCount++;\n    }\n\n    // ensure geometries have the same number of attributes\n\n    if (attributesCount !== attributesUsed.size) {\n      console.error(\n        'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' +\n          i +\n          '. Make sure all geometries have the same number of attributes.',\n      );\n      return null;\n    }\n\n    // gather morph attributes, exit early if they're different\n\n    if (morphTargetsRelative !== geometry.morphTargetsRelative) {\n      console.error(\n        'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' +\n          i +\n          '. .morphTargetsRelative must be consistent throughout all geometries.',\n      );\n      return null;\n    }\n\n    for (const name in geometry.morphAttributes) {\n      if (!morphAttributesUsed.has(name)) {\n        console.error(\n          'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' +\n            i +\n            '.  .morphAttributes must be consistent throughout all geometries.',\n        );\n        return null;\n      }\n\n      if (morphAttributes[name] === undefined) morphAttributes[name] = [];\n\n      morphAttributes[name].push(geometry.morphAttributes[name]);\n    }\n\n    if (useGroups) {\n      let count;\n\n      if (isIndexed) {\n        count = geometry.index.count;\n      } else if (geometry.attributes.position !== undefined) {\n        count = geometry.attributes.position.count;\n      } else {\n        console.error(\n          'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' +\n            i +\n            '. The geometry must have either an index or a position attribute',\n        );\n        return null;\n      }\n\n      mergedGeometry.addGroup(offset, count, i);\n\n      offset += count;\n    }\n  }\n\n  // merge indices\n\n  if (isIndexed) {\n    let indexOffset = 0;\n    const mergedIndex = [];\n\n    for (let i = 0; i < geometries.length; ++i) {\n      const index = geometries[i].index;\n\n      for (let j = 0; j < index.count; ++j) {\n        mergedIndex.push(index.getX(j) + indexOffset);\n      }\n\n      indexOffset += geometries[i].attributes.position.count;\n    }\n\n    mergedGeometry.setIndex(mergedIndex);\n  }\n\n  // merge attributes\n\n  for (const name in attributes) {\n    const mergedAttribute = mergeAttributes(attributes[name]);\n\n    if (!mergedAttribute) {\n      console.error(\n        'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' +\n          name +\n          ' attribute.',\n      );\n      return null;\n    }\n\n    mergedGeometry.setAttribute(name, mergedAttribute);\n  }\n\n  // merge morph attributes\n\n  for (const name in morphAttributes) {\n    const numMorphTargets = morphAttributes[name][0].length;\n\n    if (numMorphTargets === 0) break;\n\n    mergedGeometry.morphAttributes = mergedGeometry.morphAttributes || {};\n    mergedGeometry.morphAttributes[name] = [];\n\n    for (let i = 0; i < numMorphTargets; ++i) {\n      const morphAttributesToMerge = [];\n\n      for (let j = 0; j < morphAttributes[name].length; ++j) {\n        morphAttributesToMerge.push(morphAttributes[name][j][i]);\n      }\n\n      const mergedMorphAttribute = mergeAttributes(morphAttributesToMerge);\n\n      if (!mergedMorphAttribute) {\n        console.error(\n          'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' +\n            name +\n            ' morphAttribute.',\n        );\n        return null;\n      }\n\n      mergedGeometry.morphAttributes[name].push(mergedMorphAttribute);\n    }\n  }\n\n  return mergedGeometry;\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {BufferAttribute}\n */\nfunction mergeAttributes(attributes) {\n  let TypedArray;\n  let itemSize;\n  let normalized;\n  let arrayLength = 0;\n\n  for (let i = 0; i < attributes.length; ++i) {\n    const attribute = attributes[i];\n\n    if (attribute.isInterleavedBufferAttribute) {\n      console.error(\n        'THREE.BufferGeometryUtils: .mergeAttributes() failed. InterleavedBufferAttributes are not supported.',\n      );\n      return null;\n    }\n\n    if (TypedArray === undefined) TypedArray = attribute.array.constructor;\n    if (TypedArray !== attribute.array.constructor) {\n      console.error(\n        'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes.',\n      );\n      return null;\n    }\n\n    if (itemSize === undefined) itemSize = attribute.itemSize;\n    if (itemSize !== attribute.itemSize) {\n      console.error(\n        'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes.',\n      );\n      return null;\n    }\n\n    if (normalized === undefined) normalized = attribute.normalized;\n    if (normalized !== attribute.normalized) {\n      console.error(\n        'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes.',\n      );\n      return null;\n    }\n\n    arrayLength += attribute.array.length;\n  }\n\n  const array = new TypedArray(arrayLength);\n  let offset = 0;\n\n  for (let i = 0; i < attributes.length; ++i) {\n    array.set(attributes[i].array, offset);\n\n    offset += attributes[i].array.length;\n  }\n\n  return new BufferAttribute(array, itemSize, normalized);\n}\n\n/**\n * @param {BufferAttribute}\n * @return {BufferAttribute}\n */\nexport function deepCloneAttribute(attribute) {\n  if (attribute.isInstancedInterleavedBufferAttribute || attribute.isInterleavedBufferAttribute) {\n    return deinterleaveAttribute(attribute);\n  }\n\n  if (attribute.isInstancedBufferAttribute) {\n    return new InstancedBufferAttribute().copy(attribute);\n  }\n\n  return new BufferAttribute().copy(attribute);\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {Array<InterleavedBufferAttribute>}\n */\nfunction interleaveAttributes(attributes) {\n  // Interleaves the provided attributes into an InterleavedBuffer and returns\n  // a set of InterleavedBufferAttributes for each attribute\n  let TypedArray;\n  let arrayLength = 0;\n  let stride = 0;\n\n  // calculate the length and type of the interleavedBuffer\n  for (let i = 0, l = attributes.length; i < l; ++i) {\n    const attribute = attributes[i];\n\n    if (TypedArray === undefined) TypedArray = attribute.array.constructor;\n    if (TypedArray !== attribute.array.constructor) {\n      console.error('AttributeBuffers of different types cannot be interleaved');\n      return null;\n    }\n\n    arrayLength += attribute.array.length;\n    stride += attribute.itemSize;\n  }\n\n  // Create the set of buffer attributes\n  const interleavedBuffer = new InterleavedBuffer(new TypedArray(arrayLength), stride);\n  let offset = 0;\n  const res = [];\n  const getters = ['getX', 'getY', 'getZ', 'getW'];\n  const setters = ['setX', 'setY', 'setZ', 'setW'];\n\n  for (let j = 0, l = attributes.length; j < l; j++) {\n    const attribute = attributes[j];\n    const itemSize = attribute.itemSize;\n    const count = attribute.count;\n    const iba = new InterleavedBufferAttribute(\n      interleavedBuffer,\n      itemSize,\n      offset,\n      attribute.normalized,\n    );\n    res.push(iba);\n\n    offset += itemSize;\n\n    // Move the data for each attribute into the new interleavedBuffer\n    // at the appropriate offset\n    for (let c = 0; c < count; c++) {\n      for (let k = 0; k < itemSize; k++) {\n        iba[setters[k]](c, attribute[getters[k]](c));\n      }\n    }\n  }\n\n  return res;\n}\n\n// returns a new, non-interleaved version of the provided attribute\nexport function deinterleaveAttribute(attribute) {\n  const cons = attribute.data.array.constructor;\n  const count = attribute.count;\n  const itemSize = attribute.itemSize;\n  const normalized = attribute.normalized;\n\n  const array = new cons(count * itemSize);\n  let newAttribute;\n  if (attribute.isInstancedInterleavedBufferAttribute) {\n    newAttribute = new InstancedBufferAttribute(\n      array,\n      itemSize,\n      normalized,\n      attribute.meshPerAttribute,\n    );\n  } else {\n    newAttribute = new BufferAttribute(array, itemSize, normalized);\n  }\n\n  for (let i = 0; i < count; i++) {\n    newAttribute.setX(i, attribute.getX(i));\n\n    if (itemSize >= 2) {\n      newAttribute.setY(i, attribute.getY(i));\n    }\n\n    if (itemSize >= 3) {\n      newAttribute.setZ(i, attribute.getZ(i));\n    }\n\n    if (itemSize >= 4) {\n      newAttribute.setW(i, attribute.getW(i));\n    }\n  }\n\n  return newAttribute;\n}\n\n// deinterleaves all attributes on the geometry\nexport function deinterleaveGeometry(geometry) {\n  const attributes = geometry.attributes;\n  const morphTargets = geometry.morphTargets;\n  const attrMap = new Map();\n\n  for (const key in attributes) {\n    const attr = attributes[key];\n    if (attr.isInterleavedBufferAttribute) {\n      if (!attrMap.has(attr)) {\n        attrMap.set(attr, deinterleaveAttribute(attr));\n      }\n\n      attributes[key] = attrMap.get(attr);\n    }\n  }\n\n  for (const key in morphTargets) {\n    const attr = morphTargets[key];\n    if (attr.isInterleavedBufferAttribute) {\n      if (!attrMap.has(attr)) {\n        attrMap.set(attr, deinterleaveAttribute(attr));\n      }\n\n      morphTargets[key] = attrMap.get(attr);\n    }\n  }\n}\n\n/**\n * @param {Array<BufferGeometry>} geometry\n * @return {number}\n */\nfunction estimateBytesUsed(geometry) {\n  // Return the estimated memory used by this geometry in bytes\n  // Calculate using itemSize, count, and BYTES_PER_ELEMENT to account\n  // for InterleavedBufferAttributes.\n  let mem = 0;\n  for (const name in geometry.attributes) {\n    const attr = geometry.getAttribute(name);\n    mem += attr.count * attr.itemSize * attr.array.BYTES_PER_ELEMENT;\n  }\n\n  const indices = geometry.getIndex();\n  mem += indices ? indices.count * indices.itemSize * indices.array.BYTES_PER_ELEMENT : 0;\n  return mem;\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} tolerance\n * @return {BufferGeometry}\n */\nfunction mergeVertices(geometry, tolerance = 1e-4) {\n  tolerance = Math.max(tolerance, Number.EPSILON);\n\n  // Generate an index buffer if the geometry doesn't have one, or optimize it\n  // if it's already available.\n  const hashToIndex = {};\n  const indices = geometry.getIndex();\n  const positions = geometry.getAttribute('position');\n  const vertexCount = indices ? indices.count : positions.count;\n\n  // next value for triangle indices\n  let nextIndex = 0;\n\n  // attributes and new attribute arrays\n  const attributeNames = Object.keys(geometry.attributes);\n  const tmpAttributes = {};\n  const tmpMorphAttributes = {};\n  const newIndices = [];\n  const getters = ['getX', 'getY', 'getZ', 'getW'];\n  const setters = ['setX', 'setY', 'setZ', 'setW'];\n\n  // Initialize the arrays, allocating space conservatively. Extra\n  // space will be trimmed in the last step.\n  for (let i = 0, l = attributeNames.length; i < l; i++) {\n    const name = attributeNames[i];\n    const attr = geometry.attributes[name];\n\n    tmpAttributes[name] = new BufferAttribute(\n      new attr.array.constructor(attr.count * attr.itemSize),\n      attr.itemSize,\n      attr.normalized,\n    );\n\n    const morphAttr = geometry.morphAttributes[name];\n    if (morphAttr) {\n      tmpMorphAttributes[name] = new BufferAttribute(\n        new morphAttr.array.constructor(morphAttr.count * morphAttr.itemSize),\n        morphAttr.itemSize,\n        morphAttr.normalized,\n      );\n    }\n  }\n\n  // convert the error tolerance to an amount of decimal places to truncate to\n  const decimalShift = Math.log10(1 / tolerance);\n  const shiftMultiplier = Math.pow(10, decimalShift);\n  for (let i = 0; i < vertexCount; i++) {\n    const index = indices ? indices.getX(i) : i;\n\n    // Generate a hash for the vertex attributes at the current index 'i'\n    let hash = '';\n    for (let j = 0, l = attributeNames.length; j < l; j++) {\n      const name = attributeNames[j];\n      const attribute = geometry.getAttribute(name);\n      const itemSize = attribute.itemSize;\n\n      for (let k = 0; k < itemSize; k++) {\n        // double tilde truncates the decimal value\n        hash += `${~~(attribute[getters[k]](index) * shiftMultiplier)},`;\n      }\n    }\n\n    // Add another reference to the vertex if it's already\n    // used by another index\n    if (hash in hashToIndex) {\n      newIndices.push(hashToIndex[hash]);\n    } else {\n      // copy data to the new index in the temporary attributes\n      for (let j = 0, l = attributeNames.length; j < l; j++) {\n        const name = attributeNames[j];\n        const attribute = geometry.getAttribute(name);\n        const morphAttr = geometry.morphAttributes[name];\n        const itemSize = attribute.itemSize;\n        const newarray = tmpAttributes[name];\n        const newMorphArrays = tmpMorphAttributes[name];\n\n        for (let k = 0; k < itemSize; k++) {\n          const getterFunc = getters[k];\n          const setterFunc = setters[k];\n          newarray[setterFunc](nextIndex, attribute[getterFunc](index));\n\n          if (morphAttr) {\n            for (let m = 0, ml = morphAttr.length; m < ml; m++) {\n              newMorphArrays[m][setterFunc](nextIndex, morphAttr[m][getterFunc](index));\n            }\n          }\n        }\n      }\n\n      hashToIndex[hash] = nextIndex;\n      newIndices.push(nextIndex);\n      nextIndex++;\n    }\n  }\n\n  // generate result BufferGeometry\n  const result = geometry.clone();\n  for (const name in geometry.attributes) {\n    const tmpAttribute = tmpAttributes[name];\n\n    result.setAttribute(\n      name,\n      new BufferAttribute(\n        tmpAttribute.array.slice(0, nextIndex * tmpAttribute.itemSize),\n        tmpAttribute.itemSize,\n        tmpAttribute.normalized,\n      ),\n    );\n\n    if (!(name in tmpMorphAttributes)) continue;\n\n    for (let j = 0; j < tmpMorphAttributes[name].length; j++) {\n      const tmpMorphAttribute = tmpMorphAttributes[name][j];\n\n      result.morphAttributes[name][j] = new BufferAttribute(\n        tmpMorphAttribute.array.slice(0, nextIndex * tmpMorphAttribute.itemSize),\n        tmpMorphAttribute.itemSize,\n        tmpMorphAttribute.normalized,\n      );\n    }\n  }\n\n  // indices\n\n  result.setIndex(newIndices);\n\n  return result;\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} drawMode\n * @return {BufferGeometry}\n */\nfunction toTrianglesDrawMode(geometry, drawMode) {\n  if (drawMode === TrianglesDrawMode) {\n    console.warn(\n      'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles.',\n    );\n    return geometry;\n  }\n\n  if (drawMode === TriangleFanDrawMode || drawMode === TriangleStripDrawMode) {\n    let index = geometry.getIndex();\n\n    // generate index if not present\n\n    if (index === null) {\n      const indices = [];\n\n      const position = geometry.getAttribute('position');\n\n      if (position !== undefined) {\n        for (let i = 0; i < position.count; i++) {\n          indices.push(i);\n        }\n\n        geometry.setIndex(indices);\n        index = geometry.getIndex();\n      } else {\n        console.error(\n          'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.',\n        );\n        return geometry;\n      }\n    }\n\n    //\n\n    const numberOfTriangles = index.count - 2;\n    const newIndices = [];\n\n    if (drawMode === TriangleFanDrawMode) {\n      // gl.TRIANGLE_FAN\n\n      for (let i = 1; i <= numberOfTriangles; i++) {\n        newIndices.push(index.getX(0));\n        newIndices.push(index.getX(i));\n        newIndices.push(index.getX(i + 1));\n      }\n    } else {\n      // gl.TRIANGLE_STRIP\n\n      for (let i = 0; i < numberOfTriangles; i++) {\n        if (i % 2 === 0) {\n          newIndices.push(index.getX(i));\n          newIndices.push(index.getX(i + 1));\n          newIndices.push(index.getX(i + 2));\n        } else {\n          newIndices.push(index.getX(i + 2));\n          newIndices.push(index.getX(i + 1));\n          newIndices.push(index.getX(i));\n        }\n      }\n    }\n\n    if (newIndices.length / 3 !== numberOfTriangles) {\n      console.error(\n        'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.',\n      );\n    }\n\n    // build final geometry\n\n    const newGeometry = geometry.clone();\n    newGeometry.setIndex(newIndices);\n    newGeometry.clearGroups();\n\n    return newGeometry;\n  } else {\n    console.error('THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:', drawMode);\n    return geometry;\n  }\n}\n\n/**\n * Calculates the morphed attributes of a morphed/skinned BufferGeometry.\n * Helpful for Raytracing or Decals.\n * @param {Mesh | Line | Points} object An instance of Mesh, Line or Points.\n * @return {Object} An Object with original position/normal attributes and morphed ones.\n */\nfunction computeMorphedAttributes(object) {\n  const _vA = new Vector3();\n  const _vB = new Vector3();\n  const _vC = new Vector3();\n\n  const _tempA = new Vector3();\n  const _tempB = new Vector3();\n  const _tempC = new Vector3();\n\n  const _morphA = new Vector3();\n  const _morphB = new Vector3();\n  const _morphC = new Vector3();\n\n  function _calculateMorphedAttributeData(\n    object,\n    attribute,\n    morphAttribute,\n    morphTargetsRelative,\n    a,\n    b,\n    c,\n    modifiedAttributeArray,\n  ) {\n    _vA.fromBufferAttribute(attribute, a);\n    _vB.fromBufferAttribute(attribute, b);\n    _vC.fromBufferAttribute(attribute, c);\n\n    const morphInfluences = object.morphTargetInfluences;\n\n    if (morphAttribute && morphInfluences) {\n      _morphA.set(0, 0, 0);\n      _morphB.set(0, 0, 0);\n      _morphC.set(0, 0, 0);\n\n      for (let i = 0, il = morphAttribute.length; i < il; i++) {\n        const influence = morphInfluences[i];\n        const morph = morphAttribute[i];\n\n        if (influence === 0) continue;\n\n        _tempA.fromBufferAttribute(morph, a);\n        _tempB.fromBufferAttribute(morph, b);\n        _tempC.fromBufferAttribute(morph, c);\n\n        if (morphTargetsRelative) {\n          _morphA.addScaledVector(_tempA, influence);\n          _morphB.addScaledVector(_tempB, influence);\n          _morphC.addScaledVector(_tempC, influence);\n        } else {\n          _morphA.addScaledVector(_tempA.sub(_vA), influence);\n          _morphB.addScaledVector(_tempB.sub(_vB), influence);\n          _morphC.addScaledVector(_tempC.sub(_vC), influence);\n        }\n      }\n\n      _vA.add(_morphA);\n      _vB.add(_morphB);\n      _vC.add(_morphC);\n    }\n\n    if (object.isSkinnedMesh) {\n      object.applyBoneTransform(a, _vA);\n      object.applyBoneTransform(b, _vB);\n      object.applyBoneTransform(c, _vC);\n    }\n\n    modifiedAttributeArray[a * 3 + 0] = _vA.x;\n    modifiedAttributeArray[a * 3 + 1] = _vA.y;\n    modifiedAttributeArray[a * 3 + 2] = _vA.z;\n    modifiedAttributeArray[b * 3 + 0] = _vB.x;\n    modifiedAttributeArray[b * 3 + 1] = _vB.y;\n    modifiedAttributeArray[b * 3 + 2] = _vB.z;\n    modifiedAttributeArray[c * 3 + 0] = _vC.x;\n    modifiedAttributeArray[c * 3 + 1] = _vC.y;\n    modifiedAttributeArray[c * 3 + 2] = _vC.z;\n  }\n\n  const geometry = object.geometry;\n  const material = object.material;\n\n  let a, b, c;\n  const index = geometry.index;\n  const positionAttribute = geometry.attributes.position;\n  const morphPosition = geometry.morphAttributes.position;\n  const morphTargetsRelative = geometry.morphTargetsRelative;\n  const normalAttribute = geometry.attributes.normal;\n  const morphNormal = geometry.morphAttributes.position;\n\n  const groups = geometry.groups;\n  const drawRange = geometry.drawRange;\n  let i, j, il, jl;\n  let group;\n  let start, end;\n\n  const modifiedPosition = new Float32Array(positionAttribute.count * positionAttribute.itemSize);\n  const modifiedNormal = new Float32Array(normalAttribute.count * normalAttribute.itemSize);\n\n  if (index !== null) {\n    // indexed buffer geometry\n\n    if (Array.isArray(material)) {\n      for (i = 0, il = groups.length; i < il; i++) {\n        group = groups[i];\n\n        start = Math.max(group.start, drawRange.start);\n        end = Math.min(group.start + group.count, drawRange.start + drawRange.count);\n\n        for (j = start, jl = end; j < jl; j += 3) {\n          a = index.getX(j);\n          b = index.getX(j + 1);\n          c = index.getX(j + 2);\n\n          _calculateMorphedAttributeData(\n            object,\n            positionAttribute,\n            morphPosition,\n            morphTargetsRelative,\n            a,\n            b,\n            c,\n            modifiedPosition,\n          );\n\n          _calculateMorphedAttributeData(\n            object,\n            normalAttribute,\n            morphNormal,\n            morphTargetsRelative,\n            a,\n            b,\n            c,\n            modifiedNormal,\n          );\n        }\n      }\n    } else {\n      start = Math.max(0, drawRange.start);\n      end = Math.min(index.count, drawRange.start + drawRange.count);\n\n      for (i = start, il = end; i < il; i += 3) {\n        a = index.getX(i);\n        b = index.getX(i + 1);\n        c = index.getX(i + 2);\n\n        _calculateMorphedAttributeData(\n          object,\n          positionAttribute,\n          morphPosition,\n          morphTargetsRelative,\n          a,\n          b,\n          c,\n          modifiedPosition,\n        );\n\n        _calculateMorphedAttributeData(\n          object,\n          normalAttribute,\n          morphNormal,\n          morphTargetsRelative,\n          a,\n          b,\n          c,\n          modifiedNormal,\n        );\n      }\n    }\n  } else {\n    // non-indexed buffer geometry\n\n    if (Array.isArray(material)) {\n      for (i = 0, il = groups.length; i < il; i++) {\n        group = groups[i];\n\n        start = Math.max(group.start, drawRange.start);\n        end = Math.min(group.start + group.count, drawRange.start + drawRange.count);\n\n        for (j = start, jl = end; j < jl; j += 3) {\n          a = j;\n          b = j + 1;\n          c = j + 2;\n\n          _calculateMorphedAttributeData(\n            object,\n            positionAttribute,\n            morphPosition,\n            morphTargetsRelative,\n            a,\n            b,\n            c,\n            modifiedPosition,\n          );\n\n          _calculateMorphedAttributeData(\n            object,\n            normalAttribute,\n            morphNormal,\n            morphTargetsRelative,\n            a,\n            b,\n            c,\n            modifiedNormal,\n          );\n        }\n      }\n    } else {\n      start = Math.max(0, drawRange.start);\n      end = Math.min(positionAttribute.count, drawRange.start + drawRange.count);\n\n      for (i = start, il = end; i < il; i += 3) {\n        a = i;\n        b = i + 1;\n        c = i + 2;\n\n        _calculateMorphedAttributeData(\n          object,\n          positionAttribute,\n          morphPosition,\n          morphTargetsRelative,\n          a,\n          b,\n          c,\n          modifiedPosition,\n        );\n\n        _calculateMorphedAttributeData(\n          object,\n          normalAttribute,\n          morphNormal,\n          morphTargetsRelative,\n          a,\n          b,\n          c,\n          modifiedNormal,\n        );\n      }\n    }\n  }\n\n  const morphedPositionAttribute = new Float32BufferAttribute(modifiedPosition, 3);\n  const morphedNormalAttribute = new Float32BufferAttribute(modifiedNormal, 3);\n\n  return {\n    positionAttribute: positionAttribute,\n    normalAttribute: normalAttribute,\n    morphedPositionAttribute: morphedPositionAttribute,\n    morphedNormalAttribute: morphedNormalAttribute,\n  };\n}\n\nfunction mergeGroups(geometry) {\n  if (geometry.groups.length === 0) {\n    console.warn(\n      'THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge.',\n    );\n    return geometry;\n  }\n\n  let groups = geometry.groups;\n\n  // sort groups by material index\n\n  groups = groups.sort((a, b) => {\n    if (a.materialIndex !== b.materialIndex) return a.materialIndex - b.materialIndex;\n\n    return a.start - b.start;\n  });\n\n  // create index for non-indexed geometries\n\n  if (geometry.getIndex() === null) {\n    const positionAttribute = geometry.getAttribute('position');\n    const indices = [];\n\n    for (let i = 0; i < positionAttribute.count; i += 3) {\n      indices.push(i, i + 1, i + 2);\n    }\n\n    geometry.setIndex(indices);\n  }\n\n  // sort index\n\n  const index = geometry.getIndex();\n\n  const newIndices = [];\n\n  for (let i = 0; i < groups.length; i++) {\n    const group = groups[i];\n\n    const groupStart = group.start;\n    const groupLength = groupStart + group.count;\n\n    for (let j = groupStart; j < groupLength; j++) {\n      newIndices.push(index.getX(j));\n    }\n  }\n\n  geometry.dispose(); // Required to force buffer recreation\n  geometry.setIndex(newIndices);\n\n  // update groups indices\n\n  let start = 0;\n\n  for (let i = 0; i < groups.length; i++) {\n    const group = groups[i];\n\n    group.start = start;\n    start += group.count;\n  }\n\n  // merge groups\n\n  let currentGroup = groups[0];\n\n  geometry.groups = [currentGroup];\n\n  for (let i = 1; i < groups.length; i++) {\n    const group = groups[i];\n\n    if (currentGroup.materialIndex === group.materialIndex) {\n      currentGroup.count += group.count;\n    } else {\n      currentGroup = group;\n      geometry.groups.push(currentGroup);\n    }\n  }\n\n  return geometry;\n}\n\n// Creates a new, non-indexed geometry with smooth normals everywhere except faces that meet at\n// an angle greater than the crease angle.\nfunction toCreasedNormals(geometry, creaseAngle = Math.PI / 3 /* 60 degrees */) {\n  const creaseDot = Math.cos(creaseAngle);\n  const hashMultiplier = (1 + 1e-10) * 1e2;\n\n  // reusable vertors\n  const verts = [new Vector3(), new Vector3(), new Vector3()];\n  const tempVec1 = new Vector3();\n  const tempVec2 = new Vector3();\n  const tempNorm = new Vector3();\n  const tempNorm2 = new Vector3();\n\n  // hashes a vector\n  function hashVertex(v) {\n    const x = ~~(v.x * hashMultiplier);\n    const y = ~~(v.y * hashMultiplier);\n    const z = ~~(v.z * hashMultiplier);\n    return `${x},${y},${z}`;\n  }\n\n  const resultGeometry = geometry.toNonIndexed();\n  const posAttr = resultGeometry.attributes.position;\n  const vertexMap = {};\n\n  // find all the normals shared by commonly located vertices\n  for (let i = 0, l = posAttr.count / 3; i < l; i++) {\n    const i3 = 3 * i;\n    const a = verts[0].fromBufferAttribute(posAttr, i3 + 0);\n    const b = verts[1].fromBufferAttribute(posAttr, i3 + 1);\n    const c = verts[2].fromBufferAttribute(posAttr, i3 + 2);\n\n    tempVec1.subVectors(c, b);\n    tempVec2.subVectors(a, b);\n\n    // add the normal to the map for all vertices\n    const normal = new Vector3().crossVectors(tempVec1, tempVec2).normalize();\n    for (let n = 0; n < 3; n++) {\n      const vert = verts[n];\n      const hash = hashVertex(vert);\n      if (!(hash in vertexMap)) {\n        vertexMap[hash] = [];\n      }\n\n      vertexMap[hash].push(normal);\n    }\n  }\n\n  // average normals from all vertices that share a common location if they are within the\n  // provided crease threshold\n  const normalArray = new Float32Array(posAttr.count * 3);\n  const normAttr = new BufferAttribute(normalArray, 3, false);\n  for (let i = 0, l = posAttr.count / 3; i < l; i++) {\n    // get the face normal for this vertex\n    const i3 = 3 * i;\n    const a = verts[0].fromBufferAttribute(posAttr, i3 + 0);\n    const b = verts[1].fromBufferAttribute(posAttr, i3 + 1);\n    const c = verts[2].fromBufferAttribute(posAttr, i3 + 2);\n\n    tempVec1.subVectors(c, b);\n    tempVec2.subVectors(a, b);\n\n    tempNorm.crossVectors(tempVec1, tempVec2).normalize();\n\n    // average all normals that meet the threshold and set the normal value\n    for (let n = 0; n < 3; n++) {\n      const vert = verts[n];\n      const hash = hashVertex(vert);\n      const otherNormals = vertexMap[hash];\n      tempNorm2.set(0, 0, 0);\n\n      for (let k = 0, lk = otherNormals.length; k < lk; k++) {\n        const otherNorm = otherNormals[k];\n        if (tempNorm.dot(otherNorm) > creaseDot) {\n          tempNorm2.add(otherNorm);\n        }\n      }\n\n      tempNorm2.normalize();\n      normAttr.setXYZ(i3 + n, tempNorm2.x, tempNorm2.y, tempNorm2.z);\n    }\n  }\n\n  resultGeometry.setAttribute('normal', normAttr);\n  return resultGeometry;\n}\n\nfunction mergeBufferGeometries(geometries, useGroups = false) {\n  console.warn(\n    'THREE.BufferGeometryUtils: mergeBufferGeometries() has been renamed to mergeGeometries().',\n  ); // @deprecated, r151\n  return mergeGeometries(geometries, useGroups);\n}\n\nfunction mergeBufferAttributes(attributes) {\n  console.warn(\n    'THREE.BufferGeometryUtils: mergeBufferAttributes() has been renamed to mergeAttributes().',\n  ); // @deprecated, r151\n  return mergeAttributes(attributes);\n}\n\nexport {\n  computeMikkTSpaceTangents,\n  mergeGeometries,\n  mergeBufferGeometries,\n  mergeAttributes,\n  mergeBufferAttributes,\n  interleaveAttributes,\n  estimateBytesUsed,\n  mergeVertices,\n  toTrianglesDrawMode,\n  computeMorphedAttributes,\n  mergeGroups,\n  toCreasedNormals,\n};\n", "/* eslint-disable */\nimport {\n  AnimationClip,\n  Bone,\n  Box3,\n  BufferAttribute,\n  BufferGeometry,\n  ClampToEdgeWrapping,\n  Color,\n  DirectionalLight,\n  DoubleSide,\n  FileLoader,\n  FrontSide,\n  Group,\n  ImageBitmapLoader,\n  InstancedMesh,\n  InterleavedBuffer,\n  InterleavedBufferAttribute,\n  Interpolant,\n  InterpolateDiscrete,\n  InterpolateLinear,\n  Line,\n  LineBasicMaterial,\n  LineLoop,\n  LineSegments,\n  LinearFilter,\n  LinearMipmapLinearFilter,\n  LinearMipmapNearestFilter,\n  Loader,\n  LoaderUtils,\n  Material,\n  MathUtils,\n  Matrix4,\n  Mesh,\n  MeshBasicMaterial,\n  MeshPhysicalMaterial,\n  MeshStandardMaterial,\n  MirroredRepeatWrapping,\n  NearestFilter,\n  NearestMipmapLinearFilter,\n  NearestMipmapNearestFilter,\n  NumberKeyframeTrack,\n  Object3D,\n  OrthographicCamera,\n  PerspectiveCamera,\n  PointLight,\n  Points,\n  PointsMaterial,\n  PropertyBinding,\n  Quaternion,\n  QuaternionKeyframeTrack,\n  RepeatWrapping,\n  Skeleton,\n  SkinnedMesh,\n  Sphere,\n  SpotLight,\n  Texture,\n  TextureLoader,\n  TriangleFanDrawMode,\n  TriangleStripDrawMode,\n  Vector2,\n  Vector3,\n  VectorKeyframeTrack,\n  sRGBEncoding,\n} from '../../node_modules/three/src/Three.js';\nimport { toTrianglesDrawMode } from './BufferGeometryUtils.js';\nclass GLTFLoader extends Loader {\n  constructor(manager) {\n    super(manager);\n\n    this.dracoLoader = null;\n    this.ktx2Loader = null;\n    this.meshoptDecoder = null;\n\n    this.pluginCallbacks = [];\n\n    this.register(function (parser) {\n      return new GLTFMaterialsClearcoatExtension(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFTextureBasisUExtension(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFTextureWebPExtension(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFTextureAVIFExtension(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFMaterialsSheenExtension(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFMaterialsTransmissionExtension(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFMaterialsVolumeExtension(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFMaterialsIorExtension(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFMaterialsEmissiveStrengthExtension(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFMaterialsSpecularExtension(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFMaterialsIridescenceExtension(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFLightsExtension(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFMeshoptCompression(parser);\n    });\n\n    this.register(function (parser) {\n      return new GLTFMeshGpuInstancing(parser);\n    });\n  }\n\n  load(url, onLoad, onProgress, onError) {\n    const scope = this;\n\n    let resourcePath;\n\n    if (this.resourcePath !== '') {\n      resourcePath = this.resourcePath;\n    } else if (this.path !== '') {\n      resourcePath = this.path;\n    } else {\n      resourcePath = LoaderUtils.extractUrlBase(url);\n    }\n\n    // Tells the LoadingManager to track an extra item, which resolves after\n    // the model is fully loaded. This means the count of items loaded will\n    // be incorrect, but ensures manager.onLoad() does not fire early.\n    this.manager.itemStart(url);\n\n    const _onError = function (e) {\n      if (onError) {\n        onError(e);\n      } else {\n        console.error(e);\n      }\n\n      scope.manager.itemError(url);\n      scope.manager.itemEnd(url);\n    };\n\n    const loader = new FileLoader(this.manager);\n\n    loader.setPath(this.path);\n    loader.setResponseType('arraybuffer');\n    loader.setRequestHeader(this.requestHeader);\n    loader.setWithCredentials(this.withCredentials);\n\n    loader.load(\n      url,\n      function (data) {\n        try {\n          scope.parse(\n            data,\n            resourcePath,\n            function (gltf) {\n              onLoad(gltf);\n\n              scope.manager.itemEnd(url);\n            },\n            _onError,\n          );\n        } catch (e) {\n          _onError(e);\n        }\n      },\n      onProgress,\n      _onError,\n    );\n  }\n\n  setDRACOLoader(dracoLoader) {\n    this.dracoLoader = dracoLoader;\n    return this;\n  }\n\n  setDDSLoader() {\n    throw new Error(\n      'THREE.GLTFLoader: \"MSFT_texture_dds\" no longer supported. Please update to \"KHR_texture_basisu\".',\n    );\n  }\n\n  setKTX2Loader(ktx2Loader) {\n    this.ktx2Loader = ktx2Loader;\n    return this;\n  }\n\n  setMeshoptDecoder(meshoptDecoder) {\n    this.meshoptDecoder = meshoptDecoder;\n    return this;\n  }\n\n  register(callback) {\n    if (this.pluginCallbacks.indexOf(callback) === -1) {\n      this.pluginCallbacks.push(callback);\n    }\n\n    return this;\n  }\n\n  unregister(callback) {\n    if (this.pluginCallbacks.indexOf(callback) !== -1) {\n      this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(callback), 1);\n    }\n\n    return this;\n  }\n\n  parse(data, path, onLoad, onError) {\n    let json;\n    const extensions = {};\n    const plugins = {};\n    const textDecoder = new TextDecoder();\n\n    if (typeof data === 'string') {\n      json = JSON.parse(data);\n    } else if (data instanceof ArrayBuffer) {\n      const magic = textDecoder.decode(new Uint8Array(data, 0, 4));\n\n      if (magic === BINARY_EXTENSION_HEADER_MAGIC) {\n        try {\n          extensions[EXTENSIONS.KHR_BINARY_GLTF] = new GLTFBinaryExtension(data);\n        } catch (error) {\n          if (onError) onError(error);\n          return;\n        }\n\n        json = JSON.parse(extensions[EXTENSIONS.KHR_BINARY_GLTF].content);\n      } else {\n        json = JSON.parse(textDecoder.decode(data));\n      }\n    } else {\n      json = data;\n    }\n\n    if (json.asset === undefined || json.asset.version[0] < 2) {\n      if (onError)\n        onError(\n          new Error('THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.'),\n        );\n      return;\n    }\n\n    const parser = new GLTFParser(json, {\n      path: path || this.resourcePath || '',\n      crossOrigin: this.crossOrigin,\n      requestHeader: this.requestHeader,\n      manager: this.manager,\n      ktx2Loader: this.ktx2Loader,\n      meshoptDecoder: this.meshoptDecoder,\n    });\n\n    parser.fileLoader.setRequestHeader(this.requestHeader);\n\n    for (let i = 0; i < this.pluginCallbacks.length; i++) {\n      const plugin = this.pluginCallbacks[i](parser);\n      plugins[plugin.name] = plugin;\n\n      // Workaround to avoid determining as unknown extension\n      // in addUnknownExtensionsToUserData().\n      // Remove this workaround if we move all the existing\n      // extension handlers to plugin system\n      extensions[plugin.name] = true;\n    }\n\n    if (json.extensionsUsed) {\n      for (let i = 0; i < json.extensionsUsed.length; ++i) {\n        const extensionName = json.extensionsUsed[i];\n        const extensionsRequired = json.extensionsRequired || [];\n\n        switch (extensionName) {\n          case EXTENSIONS.KHR_MATERIALS_UNLIT:\n            extensions[extensionName] = new GLTFMaterialsUnlitExtension();\n            break;\n\n          case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n            extensions[extensionName] = new GLTFDracoMeshCompressionExtension(\n              json,\n              this.dracoLoader,\n            );\n            break;\n\n          case EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n            extensions[extensionName] = new GLTFTextureTransformExtension();\n            break;\n\n          case EXTENSIONS.KHR_MESH_QUANTIZATION:\n            extensions[extensionName] = new GLTFMeshQuantizationExtension();\n            break;\n\n          default:\n            if (\n              extensionsRequired.indexOf(extensionName) >= 0 &&\n              plugins[extensionName] === undefined\n            ) {\n              console.warn('THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".');\n            }\n        }\n      }\n    }\n\n    parser.setExtensions(extensions);\n    parser.setPlugins(plugins);\n    parser.parse(onLoad, onError);\n  }\n\n  parseAsync(data, path) {\n    const scope = this;\n\n    return new Promise(function (resolve, reject) {\n      scope.parse(data, path, resolve, reject);\n    });\n  }\n}\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n  let objects = {};\n\n  return {\n    get: function (key) {\n      return objects[key];\n    },\n\n    add: function (key, object) {\n      objects[key] = object;\n    },\n\n    remove: function (key) {\n      delete objects[key];\n    },\n\n    removeAll: function () {\n      objects = {};\n    },\n  };\n}\n\n/*********************************/\n/********** EXTENSIONS ***********/\n/*********************************/\n\nconst EXTENSIONS = {\n  KHR_BINARY_GLTF: 'KHR_binary_glTF',\n  KHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n  KHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n  KHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n  KHR_MATERIALS_IOR: 'KHR_materials_ior',\n  KHR_MATERIALS_SHEEN: 'KHR_materials_sheen',\n  KHR_MATERIALS_SPECULAR: 'KHR_materials_specular',\n  KHR_MATERIALS_TRANSMISSION: 'KHR_materials_transmission',\n  KHR_MATERIALS_IRIDESCENCE: 'KHR_materials_iridescence',\n  KHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n  KHR_MATERIALS_VOLUME: 'KHR_materials_volume',\n  KHR_TEXTURE_BASISU: 'KHR_texture_basisu',\n  KHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n  KHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n  KHR_MATERIALS_EMISSIVE_STRENGTH: 'KHR_materials_emissive_strength',\n  EXT_TEXTURE_WEBP: 'EXT_texture_webp',\n  EXT_TEXTURE_AVIF: 'EXT_texture_avif',\n  EXT_MESHOPT_COMPRESSION: 'EXT_meshopt_compression',\n  EXT_MESH_GPU_INSTANCING: 'EXT_mesh_gpu_instancing',\n};\n\n/**\n * Punctual Lights Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n */\nclass GLTFLightsExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n    // Object3D instance caches\n    this.cache = { refs: {}, uses: {} };\n  }\n\n  _markDefs() {\n    const parser = this.parser;\n    const nodeDefs = this.parser.json.nodes || [];\n\n    for (let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex++) {\n      const nodeDef = nodeDefs[nodeIndex];\n\n      if (\n        nodeDef.extensions &&\n        nodeDef.extensions[this.name] &&\n        nodeDef.extensions[this.name].light !== undefined\n      ) {\n        parser._addNodeRef(this.cache, nodeDef.extensions[this.name].light);\n      }\n    }\n  }\n\n  _loadLight(lightIndex) {\n    const parser = this.parser;\n    const cacheKey = 'light:' + lightIndex;\n    let dependency = parser.cache.get(cacheKey);\n\n    if (dependency) return dependency;\n\n    const json = parser.json;\n    const extensions = (json.extensions && json.extensions[this.name]) || {};\n    const lightDefs = extensions.lights || [];\n    const lightDef = lightDefs[lightIndex];\n    let lightNode;\n\n    const color = new Color(0xffffff);\n\n    if (lightDef.color !== undefined) color.fromArray(lightDef.color);\n\n    const range = lightDef.range !== undefined ? lightDef.range : 0;\n\n    switch (lightDef.type) {\n      case 'directional':\n        lightNode = new DirectionalLight(color);\n        lightNode.target.position.set(0, 0, -1);\n        lightNode.add(lightNode.target);\n        break;\n\n      case 'point':\n        lightNode = new PointLight(color);\n        lightNode.distance = range;\n        break;\n\n      case 'spot':\n        lightNode = new SpotLight(color);\n        lightNode.distance = range;\n        // Handle spotlight properties.\n        lightDef.spot = lightDef.spot || {};\n        lightDef.spot.innerConeAngle =\n          lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n        lightDef.spot.outerConeAngle =\n          lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n        lightNode.angle = lightDef.spot.outerConeAngle;\n        lightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n        lightNode.target.position.set(0, 0, -1);\n        lightNode.add(lightNode.target);\n        break;\n\n      default:\n        throw new Error('THREE.GLTFLoader: Unexpected light type: ' + lightDef.type);\n    }\n\n    // Some lights (e.g. spot) default to a position other than the origin. Reset the position\n    // here, because node-level parsing will only override position if explicitly specified.\n    lightNode.position.set(0, 0, 0);\n\n    lightNode.decay = 2;\n\n    assignExtrasToUserData(lightNode, lightDef);\n\n    if (lightDef.intensity !== undefined) lightNode.intensity = lightDef.intensity;\n\n    lightNode.name = parser.createUniqueName(lightDef.name || 'light_' + lightIndex);\n\n    dependency = Promise.resolve(lightNode);\n\n    parser.cache.add(cacheKey, dependency);\n\n    return dependency;\n  }\n\n  getDependency(type, index) {\n    if (type !== 'light') return;\n\n    return this._loadLight(index);\n  }\n\n  createNodeAttachment(nodeIndex) {\n    const self = this;\n    const parser = this.parser;\n    const json = parser.json;\n    const nodeDef = json.nodes[nodeIndex];\n    const lightDef = (nodeDef.extensions && nodeDef.extensions[this.name]) || {};\n    const lightIndex = lightDef.light;\n\n    if (lightIndex === undefined) return null;\n\n    return this._loadLight(lightIndex).then(function (light) {\n      return parser._getNodeRef(self.cache, lightIndex, light);\n    });\n  }\n}\n\n/**\n * Unlit Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n */\nclass GLTFMaterialsUnlitExtension {\n  constructor() {\n    this.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n  }\n\n  getMaterialType() {\n    return MeshBasicMaterial;\n  }\n\n  extendParams(materialParams, materialDef, parser) {\n    const pending = [];\n\n    materialParams.color = new Color(1.0, 1.0, 1.0);\n    materialParams.opacity = 1.0;\n\n    const metallicRoughness = materialDef.pbrMetallicRoughness;\n\n    if (metallicRoughness) {\n      if (Array.isArray(metallicRoughness.baseColorFactor)) {\n        const array = metallicRoughness.baseColorFactor;\n\n        materialParams.color.fromArray(array);\n        materialParams.opacity = array[3];\n      }\n\n      if (metallicRoughness.baseColorTexture !== undefined) {\n        pending.push(\n          parser.assignTexture(\n            materialParams,\n            'map',\n            metallicRoughness.baseColorTexture,\n            sRGBEncoding,\n          ),\n        );\n      }\n    }\n\n    return Promise.all(pending);\n  }\n}\n\n/**\n * Materials Emissive Strength Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/blob/5768b3ce0ef32bc39cdf1bef10b948586635ead3/extensions/2.0/Khronos/KHR_materials_emissive_strength/README.md\n */\nclass GLTFMaterialsEmissiveStrengthExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH;\n  }\n\n  extendMaterialParams(materialIndex, materialParams) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return Promise.resolve();\n    }\n\n    const emissiveStrength = materialDef.extensions[this.name].emissiveStrength;\n\n    if (emissiveStrength !== undefined) {\n      materialParams.emissiveIntensity = emissiveStrength;\n    }\n\n    return Promise.resolve();\n  }\n}\n\n/**\n * Clearcoat Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n */\nclass GLTFMaterialsClearcoatExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n  }\n\n  getMaterialType(materialIndex) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) return null;\n\n    return MeshPhysicalMaterial;\n  }\n\n  extendMaterialParams(materialIndex, materialParams) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return Promise.resolve();\n    }\n\n    const pending = [];\n\n    const extension = materialDef.extensions[this.name];\n\n    if (extension.clearcoatFactor !== undefined) {\n      materialParams.clearcoat = extension.clearcoatFactor;\n    }\n\n    if (extension.clearcoatTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(materialParams, 'clearcoatMap', extension.clearcoatTexture),\n      );\n    }\n\n    if (extension.clearcoatRoughnessFactor !== undefined) {\n      materialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n    }\n\n    if (extension.clearcoatRoughnessTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(\n          materialParams,\n          'clearcoatRoughnessMap',\n          extension.clearcoatRoughnessTexture,\n        ),\n      );\n    }\n\n    if (extension.clearcoatNormalTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(\n          materialParams,\n          'clearcoatNormalMap',\n          extension.clearcoatNormalTexture,\n        ),\n      );\n\n      if (extension.clearcoatNormalTexture.scale !== undefined) {\n        const scale = extension.clearcoatNormalTexture.scale;\n\n        materialParams.clearcoatNormalScale = new Vector2(scale, scale);\n      }\n    }\n\n    return Promise.all(pending);\n  }\n}\n\n/**\n * Iridescence Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_iridescence\n */\nclass GLTFMaterialsIridescenceExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = EXTENSIONS.KHR_MATERIALS_IRIDESCENCE;\n  }\n\n  getMaterialType(materialIndex) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) return null;\n\n    return MeshPhysicalMaterial;\n  }\n\n  extendMaterialParams(materialIndex, materialParams) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return Promise.resolve();\n    }\n\n    const pending = [];\n\n    const extension = materialDef.extensions[this.name];\n\n    if (extension.iridescenceFactor !== undefined) {\n      materialParams.iridescence = extension.iridescenceFactor;\n    }\n\n    if (extension.iridescenceTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(materialParams, 'iridescenceMap', extension.iridescenceTexture),\n      );\n    }\n\n    if (extension.iridescenceIor !== undefined) {\n      materialParams.iridescenceIOR = extension.iridescenceIor;\n    }\n\n    if (materialParams.iridescenceThicknessRange === undefined) {\n      materialParams.iridescenceThicknessRange = [100, 400];\n    }\n\n    if (extension.iridescenceThicknessMinimum !== undefined) {\n      materialParams.iridescenceThicknessRange[0] = extension.iridescenceThicknessMinimum;\n    }\n\n    if (extension.iridescenceThicknessMaximum !== undefined) {\n      materialParams.iridescenceThicknessRange[1] = extension.iridescenceThicknessMaximum;\n    }\n\n    if (extension.iridescenceThicknessTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(\n          materialParams,\n          'iridescenceThicknessMap',\n          extension.iridescenceThicknessTexture,\n        ),\n      );\n    }\n\n    return Promise.all(pending);\n  }\n}\n\n/**\n * Sheen Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_sheen\n */\nclass GLTFMaterialsSheenExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = EXTENSIONS.KHR_MATERIALS_SHEEN;\n  }\n\n  getMaterialType(materialIndex) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) return null;\n\n    return MeshPhysicalMaterial;\n  }\n\n  extendMaterialParams(materialIndex, materialParams) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return Promise.resolve();\n    }\n\n    const pending = [];\n\n    materialParams.sheenColor = new Color(0, 0, 0);\n    materialParams.sheenRoughness = 0;\n    materialParams.sheen = 1;\n\n    const extension = materialDef.extensions[this.name];\n\n    if (extension.sheenColorFactor !== undefined) {\n      materialParams.sheenColor.fromArray(extension.sheenColorFactor);\n    }\n\n    if (extension.sheenRoughnessFactor !== undefined) {\n      materialParams.sheenRoughness = extension.sheenRoughnessFactor;\n    }\n\n    if (extension.sheenColorTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(\n          materialParams,\n          'sheenColorMap',\n          extension.sheenColorTexture,\n          sRGBEncoding,\n        ),\n      );\n    }\n\n    if (extension.sheenRoughnessTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(materialParams, 'sheenRoughnessMap', extension.sheenRoughnessTexture),\n      );\n    }\n\n    return Promise.all(pending);\n  }\n}\n\n/**\n * Transmission Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_transmission\n * Draft: https://github.com/KhronosGroup/glTF/pull/1698\n */\nclass GLTFMaterialsTransmissionExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = EXTENSIONS.KHR_MATERIALS_TRANSMISSION;\n  }\n\n  getMaterialType(materialIndex) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) return null;\n\n    return MeshPhysicalMaterial;\n  }\n\n  extendMaterialParams(materialIndex, materialParams) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return Promise.resolve();\n    }\n\n    const pending = [];\n\n    const extension = materialDef.extensions[this.name];\n\n    if (extension.transmissionFactor !== undefined) {\n      materialParams.transmission = extension.transmissionFactor;\n    }\n\n    if (extension.transmissionTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(materialParams, 'transmissionMap', extension.transmissionTexture),\n      );\n    }\n\n    return Promise.all(pending);\n  }\n}\n\n/**\n * Materials Volume Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_volume\n */\nclass GLTFMaterialsVolumeExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = EXTENSIONS.KHR_MATERIALS_VOLUME;\n  }\n\n  getMaterialType(materialIndex) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) return null;\n\n    return MeshPhysicalMaterial;\n  }\n\n  extendMaterialParams(materialIndex, materialParams) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return Promise.resolve();\n    }\n\n    const pending = [];\n\n    const extension = materialDef.extensions[this.name];\n\n    materialParams.thickness =\n      extension.thicknessFactor !== undefined ? extension.thicknessFactor : 0;\n\n    if (extension.thicknessTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(materialParams, 'thicknessMap', extension.thicknessTexture),\n      );\n    }\n\n    materialParams.attenuationDistance = extension.attenuationDistance || Infinity;\n\n    const colorArray = extension.attenuationColor || [1, 1, 1];\n    materialParams.attenuationColor = new Color(colorArray[0], colorArray[1], colorArray[2]);\n\n    return Promise.all(pending);\n  }\n}\n\n/**\n * Materials ior Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_ior\n */\nclass GLTFMaterialsIorExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = EXTENSIONS.KHR_MATERIALS_IOR;\n  }\n\n  getMaterialType(materialIndex) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) return null;\n\n    return MeshPhysicalMaterial;\n  }\n\n  extendMaterialParams(materialIndex, materialParams) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return Promise.resolve();\n    }\n\n    const extension = materialDef.extensions[this.name];\n\n    materialParams.ior = extension.ior !== undefined ? extension.ior : 1.5;\n\n    return Promise.resolve();\n  }\n}\n\n/**\n * Materials specular Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_specular\n */\nclass GLTFMaterialsSpecularExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = EXTENSIONS.KHR_MATERIALS_SPECULAR;\n  }\n\n  getMaterialType(materialIndex) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) return null;\n\n    return MeshPhysicalMaterial;\n  }\n\n  extendMaterialParams(materialIndex, materialParams) {\n    const parser = this.parser;\n    const materialDef = parser.json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return Promise.resolve();\n    }\n\n    const pending = [];\n\n    const extension = materialDef.extensions[this.name];\n\n    materialParams.specularIntensity =\n      extension.specularFactor !== undefined ? extension.specularFactor : 1.0;\n\n    if (extension.specularTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(materialParams, 'specularIntensityMap', extension.specularTexture),\n      );\n    }\n\n    const colorArray = extension.specularColorFactor || [1, 1, 1];\n    materialParams.specularColor = new Color(colorArray[0], colorArray[1], colorArray[2]);\n\n    if (extension.specularColorTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(\n          materialParams,\n          'specularColorMap',\n          extension.specularColorTexture,\n          sRGBEncoding,\n        ),\n      );\n    }\n\n    return Promise.all(pending);\n  }\n}\n\n/**\n * BasisU Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n */\nclass GLTFTextureBasisUExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = EXTENSIONS.KHR_TEXTURE_BASISU;\n  }\n\n  loadTexture(textureIndex) {\n    const parser = this.parser;\n    const json = parser.json;\n\n    const textureDef = json.textures[textureIndex];\n\n    if (!textureDef.extensions || !textureDef.extensions[this.name]) {\n      return null;\n    }\n\n    const extension = textureDef.extensions[this.name];\n    const loader = parser.options.ktx2Loader;\n\n    if (!loader) {\n      if (json.extensionsRequired && json.extensionsRequired.indexOf(this.name) >= 0) {\n        throw new Error(\n          'THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures',\n        );\n      } else {\n        // Assumes that the extension is optional and that a fallback texture is present\n        return null;\n      }\n    }\n\n    return parser.loadTextureImage(textureIndex, extension.source, loader);\n  }\n}\n\n/**\n * WebP Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_webp\n */\nclass GLTFTextureWebPExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = EXTENSIONS.EXT_TEXTURE_WEBP;\n    this.isSupported = null;\n  }\n\n  loadTexture(textureIndex) {\n    const name = this.name;\n    const parser = this.parser;\n    const json = parser.json;\n\n    const textureDef = json.textures[textureIndex];\n\n    if (!textureDef.extensions || !textureDef.extensions[name]) {\n      return null;\n    }\n\n    const extension = textureDef.extensions[name];\n    const source = json.images[extension.source];\n\n    let loader = parser.textureLoader;\n    if (source.uri) {\n      const handler = parser.options.manager.getHandler(source.uri);\n      if (handler !== null) loader = handler;\n    }\n\n    return this.detectSupport().then(function (isSupported) {\n      if (isSupported) return parser.loadTextureImage(textureIndex, extension.source, loader);\n\n      if (json.extensionsRequired && json.extensionsRequired.indexOf(name) >= 0) {\n        throw new Error('THREE.GLTFLoader: WebP required by asset but unsupported.');\n      }\n\n      // Fall back to PNG or JPEG.\n      return parser.loadTexture(textureIndex);\n    });\n  }\n\n  detectSupport() {\n    if (!this.isSupported) {\n      this.isSupported = new Promise(function (resolve) {\n        const image = new Image();\n\n        // Lossy test image. Support for lossy images doesn't guarantee support for all\n        // WebP images, unfortunately.\n        image.src =\n          'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';\n\n        image.onload = image.onerror = function () {\n          resolve(image.height === 1);\n        };\n      });\n    }\n\n    return this.isSupported;\n  }\n}\n\n/**\n * AVIF Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_avif\n */\nclass GLTFTextureAVIFExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = EXTENSIONS.EXT_TEXTURE_AVIF;\n    this.isSupported = null;\n  }\n\n  loadTexture(textureIndex) {\n    const name = this.name;\n    const parser = this.parser;\n    const json = parser.json;\n\n    const textureDef = json.textures[textureIndex];\n\n    if (!textureDef.extensions || !textureDef.extensions[name]) {\n      return null;\n    }\n\n    const extension = textureDef.extensions[name];\n    const source = json.images[extension.source];\n\n    let loader = parser.textureLoader;\n    if (source.uri) {\n      const handler = parser.options.manager.getHandler(source.uri);\n      if (handler !== null) loader = handler;\n    }\n\n    return this.detectSupport().then(function (isSupported) {\n      if (isSupported) return parser.loadTextureImage(textureIndex, extension.source, loader);\n\n      if (json.extensionsRequired && json.extensionsRequired.indexOf(name) >= 0) {\n        throw new Error('THREE.GLTFLoader: AVIF required by asset but unsupported.');\n      }\n\n      // Fall back to PNG or JPEG.\n      return parser.loadTexture(textureIndex);\n    });\n  }\n\n  detectSupport() {\n    if (!this.isSupported) {\n      this.isSupported = new Promise(function (resolve) {\n        const image = new Image();\n\n        // Lossy test image.\n        image.src =\n          'data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=';\n        image.onload = image.onerror = function () {\n          resolve(image.height === 1);\n        };\n      });\n    }\n\n    return this.isSupported;\n  }\n}\n\n/**\n * meshopt BufferView Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_meshopt_compression\n */\nclass GLTFMeshoptCompression {\n  constructor(parser) {\n    this.name = EXTENSIONS.EXT_MESHOPT_COMPRESSION;\n    this.parser = parser;\n  }\n\n  loadBufferView(index) {\n    const json = this.parser.json;\n    const bufferView = json.bufferViews[index];\n\n    if (bufferView.extensions && bufferView.extensions[this.name]) {\n      const extensionDef = bufferView.extensions[this.name];\n\n      const buffer = this.parser.getDependency('buffer', extensionDef.buffer);\n      const decoder = this.parser.options.meshoptDecoder;\n\n      if (!decoder || !decoder.supported) {\n        if (json.extensionsRequired && json.extensionsRequired.indexOf(this.name) >= 0) {\n          throw new Error(\n            'THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files',\n          );\n        } else {\n          // Assumes that the extension is optional and that fallback buffer data is present\n          return null;\n        }\n      }\n\n      return buffer.then(function (res) {\n        const byteOffset = extensionDef.byteOffset || 0;\n        const byteLength = extensionDef.byteLength || 0;\n\n        const count = extensionDef.count;\n        const stride = extensionDef.byteStride;\n\n        const source = new Uint8Array(res, byteOffset, byteLength);\n\n        if (decoder.decodeGltfBufferAsync) {\n          return decoder\n            .decodeGltfBufferAsync(count, stride, source, extensionDef.mode, extensionDef.filter)\n            .then(function (res) {\n              return res.buffer;\n            });\n        } else {\n          // Support for MeshoptDecoder 0.18 or earlier, without decodeGltfBufferAsync\n          return decoder.ready.then(function () {\n            const result = new ArrayBuffer(count * stride);\n            decoder.decodeGltfBuffer(\n              new Uint8Array(result),\n              count,\n              stride,\n              source,\n              extensionDef.mode,\n              extensionDef.filter,\n            );\n            return result;\n          });\n        }\n      });\n    } else {\n      return null;\n    }\n  }\n}\n\n/**\n * GPU Instancing Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_mesh_gpu_instancing\n *\n */\nclass GLTFMeshGpuInstancing {\n  constructor(parser) {\n    this.name = EXTENSIONS.EXT_MESH_GPU_INSTANCING;\n    this.parser = parser;\n  }\n\n  createNodeMesh(nodeIndex) {\n    const json = this.parser.json;\n    const nodeDef = json.nodes[nodeIndex];\n\n    if (!nodeDef.extensions || !nodeDef.extensions[this.name] || nodeDef.mesh === undefined) {\n      return null;\n    }\n\n    const meshDef = json.meshes[nodeDef.mesh];\n\n    // No Points or Lines + Instancing support yet\n\n    for (const primitive of meshDef.primitives) {\n      if (\n        primitive.mode !== WEBGL_CONSTANTS.TRIANGLES &&\n        primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_STRIP &&\n        primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_FAN &&\n        primitive.mode !== undefined\n      ) {\n        return null;\n      }\n    }\n\n    const extensionDef = nodeDef.extensions[this.name];\n    const attributesDef = extensionDef.attributes;\n\n    // @TODO: Can we support InstancedMesh + SkinnedMesh?\n\n    const pending = [];\n    const attributes = {};\n\n    for (const key in attributesDef) {\n      pending.push(\n        this.parser.getDependency('accessor', attributesDef[key]).then((accessor) => {\n          attributes[key] = accessor;\n          return attributes[key];\n        }),\n      );\n    }\n\n    if (pending.length < 1) {\n      return null;\n    }\n\n    pending.push(this.parser.createNodeMesh(nodeIndex));\n\n    return Promise.all(pending).then((results) => {\n      const nodeObject = results.pop();\n      const meshes = nodeObject.isGroup ? nodeObject.children : [nodeObject];\n      const count = results[0].count; // All attribute counts should be same\n      const instancedMeshes = [];\n\n      for (const mesh of meshes) {\n        // Temporal variables\n        const m = new Matrix4();\n        const p = new Vector3();\n        const q = new Quaternion();\n        const s = new Vector3(1, 1, 1);\n\n        const instancedMesh = new InstancedMesh(mesh.geometry, mesh.material, count);\n\n        for (let i = 0; i < count; i++) {\n          if (attributes.TRANSLATION) {\n            p.fromBufferAttribute(attributes.TRANSLATION, i);\n          }\n\n          if (attributes.ROTATION) {\n            q.fromBufferAttribute(attributes.ROTATION, i);\n          }\n\n          if (attributes.SCALE) {\n            s.fromBufferAttribute(attributes.SCALE, i);\n          }\n\n          instancedMesh.setMatrixAt(i, m.compose(p, q, s));\n        }\n\n        // Add instance attributes to the geometry, excluding TRS.\n        for (const attributeName in attributes) {\n          if (\n            attributeName !== 'TRANSLATION' &&\n            attributeName !== 'ROTATION' &&\n            attributeName !== 'SCALE'\n          ) {\n            mesh.geometry.setAttribute(attributeName, attributes[attributeName]);\n          }\n        }\n\n        // Just in case\n        Object3D.prototype.copy.call(instancedMesh, mesh);\n\n        this.parser.assignFinalMaterial(instancedMesh);\n\n        instancedMeshes.push(instancedMesh);\n      }\n\n      if (nodeObject.isGroup) {\n        nodeObject.clear();\n\n        nodeObject.add(...instancedMeshes);\n\n        return nodeObject;\n      }\n\n      return instancedMeshes[0];\n    });\n  }\n}\n\n/* BINARY EXTENSION */\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4e4f534a, BIN: 0x004e4942 };\n\nclass GLTFBinaryExtension {\n  constructor(data) {\n    this.name = EXTENSIONS.KHR_BINARY_GLTF;\n    this.content = null;\n    this.body = null;\n\n    const headerView = new DataView(data, 0, BINARY_EXTENSION_HEADER_LENGTH);\n    const textDecoder = new TextDecoder();\n\n    this.header = {\n      magic: textDecoder.decode(new Uint8Array(data.slice(0, 4))),\n      version: headerView.getUint32(4, true),\n      length: headerView.getUint32(8, true),\n    };\n\n    if (this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC) {\n      throw new Error('THREE.GLTFLoader: Unsupported glTF-Binary header.');\n    } else if (this.header.version < 2.0) {\n      throw new Error('THREE.GLTFLoader: Legacy binary file detected.');\n    }\n\n    const chunkContentsLength = this.header.length - BINARY_EXTENSION_HEADER_LENGTH;\n    const chunkView = new DataView(data, BINARY_EXTENSION_HEADER_LENGTH);\n    let chunkIndex = 0;\n\n    while (chunkIndex < chunkContentsLength) {\n      const chunkLength = chunkView.getUint32(chunkIndex, true);\n      chunkIndex += 4;\n\n      const chunkType = chunkView.getUint32(chunkIndex, true);\n      chunkIndex += 4;\n\n      if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON) {\n        const contentArray = new Uint8Array(\n          data,\n          BINARY_EXTENSION_HEADER_LENGTH + chunkIndex,\n          chunkLength,\n        );\n        this.content = textDecoder.decode(contentArray);\n      } else if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN) {\n        const byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n        this.body = data.slice(byteOffset, byteOffset + chunkLength);\n      }\n\n      // Clients must ignore chunks with unknown types.\n\n      chunkIndex += chunkLength;\n    }\n\n    if (this.content === null) {\n      throw new Error('THREE.GLTFLoader: JSON content not found.');\n    }\n  }\n}\n\n/**\n * DRACO Mesh Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n */\nclass GLTFDracoMeshCompressionExtension {\n  constructor(json, dracoLoader) {\n    if (!dracoLoader) {\n      throw new Error('THREE.GLTFLoader: No DRACOLoader instance provided.');\n    }\n\n    this.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n    this.json = json;\n    this.dracoLoader = dracoLoader;\n    this.dracoLoader.preload();\n  }\n\n  decodePrimitive(primitive, parser) {\n    const json = this.json;\n    const dracoLoader = this.dracoLoader;\n    const bufferViewIndex = primitive.extensions[this.name].bufferView;\n    const gltfAttributeMap = primitive.extensions[this.name].attributes;\n    const threeAttributeMap = {};\n    const attributeNormalizedMap = {};\n    const attributeTypeMap = {};\n\n    for (const attributeName in gltfAttributeMap) {\n      const threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase();\n\n      threeAttributeMap[threeAttributeName] = gltfAttributeMap[attributeName];\n    }\n\n    for (const attributeName in primitive.attributes) {\n      const threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase();\n\n      if (gltfAttributeMap[attributeName] !== undefined) {\n        const accessorDef = json.accessors[primitive.attributes[attributeName]];\n        const componentType = WEBGL_COMPONENT_TYPES[accessorDef.componentType];\n\n        attributeTypeMap[threeAttributeName] = componentType.name;\n        attributeNormalizedMap[threeAttributeName] = accessorDef.normalized === true;\n      }\n    }\n\n    return parser.getDependency('bufferView', bufferViewIndex).then(function (bufferView) {\n      return new Promise(function (resolve) {\n        dracoLoader.decodeDracoFile(\n          bufferView,\n          function (geometry) {\n            for (const attributeName in geometry.attributes) {\n              const attribute = geometry.attributes[attributeName];\n              const normalized = attributeNormalizedMap[attributeName];\n\n              if (normalized !== undefined) attribute.normalized = normalized;\n            }\n\n            resolve(geometry);\n          },\n          threeAttributeMap,\n          attributeTypeMap,\n        );\n      });\n    });\n  }\n}\n\n/**\n * Texture Transform Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n */\nclass GLTFTextureTransformExtension {\n  constructor() {\n    this.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n  }\n\n  extendTexture(texture, transform) {\n    if (transform.texCoord !== undefined) {\n      console.warn(\n        'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.',\n      );\n    }\n\n    if (\n      transform.offset === undefined &&\n      transform.rotation === undefined &&\n      transform.scale === undefined\n    ) {\n      // See https://github.com/mrdoob/three.js/issues/21819.\n      return texture;\n    }\n\n    texture = texture.clone();\n\n    if (transform.offset !== undefined) {\n      texture.offset.fromArray(transform.offset);\n    }\n\n    if (transform.rotation !== undefined) {\n      texture.rotation = transform.rotation;\n    }\n\n    if (transform.scale !== undefined) {\n      texture.repeat.fromArray(transform.scale);\n    }\n\n    texture.needsUpdate = true;\n\n    return texture;\n  }\n}\n\n/**\n * Mesh Quantization Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n */\nclass GLTFMeshQuantizationExtension {\n  constructor() {\n    this.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n  }\n}\n\n/*********************************/\n/********** INTERPOLATION ********/\n/*********************************/\n\n// Spline Interpolation\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\nclass GLTFCubicSplineInterpolant extends Interpolant {\n  constructor(parameterPositions, sampleValues, sampleSize, resultBuffer) {\n    super(parameterPositions, sampleValues, sampleSize, resultBuffer);\n  }\n\n  copySampleValue_(index) {\n    // Copies a sample value to the result buffer. See description of glTF\n    // CUBICSPLINE values layout in interpolate_() function below.\n\n    const result = this.resultBuffer,\n      values = this.sampleValues,\n      valueSize = this.valueSize,\n      offset = index * valueSize * 3 + valueSize;\n\n    for (let i = 0; i !== valueSize; i++) {\n      result[i] = values[offset + i];\n    }\n\n    return result;\n  }\n\n  interpolate_(i1, t0, t, t1) {\n    const result = this.resultBuffer;\n    const values = this.sampleValues;\n    const stride = this.valueSize;\n\n    const stride2 = stride * 2;\n    const stride3 = stride * 3;\n\n    const td = t1 - t0;\n\n    const p = (t - t0) / td;\n    const pp = p * p;\n    const ppp = pp * p;\n\n    const offset1 = i1 * stride3;\n    const offset0 = offset1 - stride3;\n\n    const s2 = -2 * ppp + 3 * pp;\n    const s3 = ppp - pp;\n    const s0 = 1 - s2;\n    const s1 = s3 - pp + p;\n\n    // Layout of keyframe output values for CUBICSPLINE animations:\n    //   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n    for (let i = 0; i !== stride; i++) {\n      const p0 = values[offset0 + i + stride]; // splineVertex_k\n      const m0 = values[offset0 + i + stride2] * td; // outTangent_k * (t_k+1 - t_k)\n      const p1 = values[offset1 + i + stride]; // splineVertex_k+1\n      const m1 = values[offset1 + i] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n      result[i] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n    }\n\n    return result;\n  }\n}\n\nconst _q = new Quaternion();\n\nclass GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant {\n  interpolate_(i1, t0, t, t1) {\n    const result = super.interpolate_(i1, t0, t, t1);\n\n    _q.fromArray(result).normalize().toArray(result);\n\n    return result;\n  }\n}\n\n/*********************************/\n/********** INTERNALS ************/\n/*********************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n  FLOAT: 5126,\n  //FLOAT_MAT2: 35674,\n  FLOAT_MAT3: 35675,\n  FLOAT_MAT4: 35676,\n  FLOAT_VEC2: 35664,\n  FLOAT_VEC3: 35665,\n  FLOAT_VEC4: 35666,\n  LINEAR: 9729,\n  REPEAT: 10497,\n  SAMPLER_2D: 35678,\n  POINTS: 0,\n  LINES: 1,\n  LINE_LOOP: 2,\n  LINE_STRIP: 3,\n  TRIANGLES: 4,\n  TRIANGLE_STRIP: 5,\n  TRIANGLE_FAN: 6,\n  UNSIGNED_BYTE: 5121,\n  UNSIGNED_SHORT: 5123,\n};\n\nconst WEBGL_COMPONENT_TYPES = {\n  5120: Int8Array,\n  5121: Uint8Array,\n  5122: Int16Array,\n  5123: Uint16Array,\n  5125: Uint32Array,\n  5126: Float32Array,\n};\n\nconst WEBGL_FILTERS = {\n  9728: NearestFilter,\n  9729: LinearFilter,\n  9984: NearestMipmapNearestFilter,\n  9985: LinearMipmapNearestFilter,\n  9986: NearestMipmapLinearFilter,\n  9987: LinearMipmapLinearFilter,\n};\n\nconst WEBGL_WRAPPINGS = {\n  33071: ClampToEdgeWrapping,\n  33648: MirroredRepeatWrapping,\n  10497: RepeatWrapping,\n};\n\nconst WEBGL_TYPE_SIZES = {\n  SCALAR: 1,\n  VEC2: 2,\n  VEC3: 3,\n  VEC4: 4,\n  MAT2: 4,\n  MAT3: 9,\n  MAT4: 16,\n};\n\nconst ATTRIBUTES = {\n  POSITION: 'position',\n  NORMAL: 'normal',\n  TANGENT: 'tangent',\n  TEXCOORD_0: 'uv',\n  TEXCOORD_1: 'uv2',\n  COLOR_0: 'color',\n  WEIGHTS_0: 'skinWeight',\n  JOINTS_0: 'skinIndex',\n};\n\nconst PATH_PROPERTIES = {\n  scale: 'scale',\n  translation: 'position',\n  rotation: 'quaternion',\n  weights: 'morphTargetInfluences',\n};\n\nconst INTERPOLATION = {\n  CUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n  // keyframe track will be initialized with a default interpolation type, then modified.\n  LINEAR: InterpolateLinear,\n  STEP: InterpolateDiscrete,\n};\n\nconst ALPHA_MODES = {\n  OPAQUE: 'OPAQUE',\n  MASK: 'MASK',\n  BLEND: 'BLEND',\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n */\nfunction createDefaultMaterial(cache) {\n  if (cache['DefaultMaterial'] === undefined) {\n    cache['DefaultMaterial'] = new MeshStandardMaterial({\n      color: 0xffffff,\n      emissive: 0x000000,\n      metalness: 1,\n      roughness: 1,\n      transparent: false,\n      depthTest: true,\n      side: FrontSide,\n    });\n  }\n\n  return cache['DefaultMaterial'];\n}\n\nfunction addUnknownExtensionsToUserData(knownExtensions, object, objectDef) {\n  // Add unknown glTF extensions to an object's userData.\n\n  for (const name in objectDef.extensions) {\n    if (knownExtensions[name] === undefined) {\n      object.userData.gltfExtensions = object.userData.gltfExtensions || {};\n      object.userData.gltfExtensions[name] = objectDef.extensions[name];\n    }\n  }\n}\n\n/**\n * @param {Object3D|Material|BufferGeometry} object\n * @param {GLTF.definition} gltfDef\n */\nfunction assignExtrasToUserData(object, gltfDef) {\n  if (gltfDef.extras !== undefined) {\n    if (typeof gltfDef.extras === 'object') {\n      Object.assign(object.userData, gltfDef.extras);\n    } else {\n      console.warn('THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras);\n    }\n  }\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n *\n * @param {BufferGeometry} geometry\n * @param {Array<GLTF.Target>} targets\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addMorphTargets(geometry, targets, parser) {\n  let hasMorphPosition = false;\n  let hasMorphNormal = false;\n  let hasMorphColor = false;\n\n  for (let i = 0, il = targets.length; i < il; i++) {\n    const target = targets[i];\n\n    if (target.POSITION !== undefined) hasMorphPosition = true;\n    if (target.NORMAL !== undefined) hasMorphNormal = true;\n    if (target.COLOR_0 !== undefined) hasMorphColor = true;\n\n    if (hasMorphPosition && hasMorphNormal && hasMorphColor) break;\n  }\n\n  if (!hasMorphPosition && !hasMorphNormal && !hasMorphColor) return Promise.resolve(geometry);\n\n  const pendingPositionAccessors = [];\n  const pendingNormalAccessors = [];\n  const pendingColorAccessors = [];\n\n  for (let i = 0, il = targets.length; i < il; i++) {\n    const target = targets[i];\n\n    if (hasMorphPosition) {\n      const pendingAccessor =\n        target.POSITION !== undefined\n          ? parser.getDependency('accessor', target.POSITION)\n          : geometry.attributes.position;\n\n      pendingPositionAccessors.push(pendingAccessor);\n    }\n\n    if (hasMorphNormal) {\n      const pendingAccessor =\n        target.NORMAL !== undefined\n          ? parser.getDependency('accessor', target.NORMAL)\n          : geometry.attributes.normal;\n\n      pendingNormalAccessors.push(pendingAccessor);\n    }\n\n    if (hasMorphColor) {\n      const pendingAccessor =\n        target.COLOR_0 !== undefined\n          ? parser.getDependency('accessor', target.COLOR_0)\n          : geometry.attributes.color;\n\n      pendingColorAccessors.push(pendingAccessor);\n    }\n  }\n\n  return Promise.all([\n    Promise.all(pendingPositionAccessors),\n    Promise.all(pendingNormalAccessors),\n    Promise.all(pendingColorAccessors),\n  ]).then(function (accessors) {\n    const morphPositions = accessors[0];\n    const morphNormals = accessors[1];\n    const morphColors = accessors[2];\n\n    if (hasMorphPosition) geometry.morphAttributes.position = morphPositions;\n    if (hasMorphNormal) geometry.morphAttributes.normal = morphNormals;\n    if (hasMorphColor) geometry.morphAttributes.color = morphColors;\n    geometry.morphTargetsRelative = true;\n\n    return geometry;\n  });\n}\n\n/**\n * @param {Mesh} mesh\n * @param {GLTF.Mesh} meshDef\n */\nfunction updateMorphTargets(mesh, meshDef) {\n  mesh.updateMorphTargets();\n\n  if (meshDef.weights !== undefined) {\n    for (let i = 0, il = meshDef.weights.length; i < il; i++) {\n      mesh.morphTargetInfluences[i] = meshDef.weights[i];\n    }\n  }\n\n  // .extras has user-defined data, so check that .extras.targetNames is an array.\n  if (meshDef.extras && Array.isArray(meshDef.extras.targetNames)) {\n    const targetNames = meshDef.extras.targetNames;\n\n    if (mesh.morphTargetInfluences.length === targetNames.length) {\n      mesh.morphTargetDictionary = {};\n\n      for (let i = 0, il = targetNames.length; i < il; i++) {\n        mesh.morphTargetDictionary[targetNames[i]] = i;\n      }\n    } else {\n      console.warn('THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.');\n    }\n  }\n}\n\nfunction createPrimitiveKey(primitiveDef) {\n  const dracoExtension =\n    primitiveDef.extensions && primitiveDef.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];\n  let geometryKey;\n\n  if (dracoExtension) {\n    geometryKey =\n      'draco:' +\n      dracoExtension.bufferView +\n      ':' +\n      dracoExtension.indices +\n      ':' +\n      createAttributesKey(dracoExtension.attributes);\n  } else {\n    geometryKey =\n      primitiveDef.indices +\n      ':' +\n      createAttributesKey(primitiveDef.attributes) +\n      ':' +\n      primitiveDef.mode;\n  }\n\n  return geometryKey;\n}\n\nfunction createAttributesKey(attributes) {\n  let attributesKey = '';\n\n  const keys = Object.keys(attributes).sort();\n\n  for (let i = 0, il = keys.length; i < il; i++) {\n    attributesKey += keys[i] + ':' + attributes[keys[i]] + ';';\n  }\n\n  return attributesKey;\n}\n\nfunction getNormalizedComponentScale(constructor) {\n  // Reference:\n  // https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization#encoding-quantized-data\n\n  switch (constructor) {\n    case Int8Array:\n      return 1 / 127;\n\n    case Uint8Array:\n      return 1 / 255;\n\n    case Int16Array:\n      return 1 / 32767;\n\n    case Uint16Array:\n      return 1 / 65535;\n\n    default:\n      throw new Error('THREE.GLTFLoader: Unsupported normalized accessor component type.');\n  }\n}\n\nfunction getImageURIMimeType(uri) {\n  if (uri.search(/\\.jpe?g($|\\?)/i) > 0 || uri.search(/^data\\:image\\/jpeg/) === 0)\n    return 'image/jpeg';\n  if (uri.search(/\\.webp($|\\?)/i) > 0 || uri.search(/^data\\:image\\/webp/) === 0)\n    return 'image/webp';\n\n  return 'image/png';\n}\n\nconst _identityMatrix = new Matrix4();\n\n/* GLTF PARSER */\n\nclass GLTFParser {\n  constructor(json = {}, options = {}) {\n    this.json = json;\n    this.extensions = {};\n    this.plugins = {};\n    this.options = options;\n\n    // loader object cache\n    this.cache = new GLTFRegistry();\n\n    // associations between Three.js objects and glTF elements\n    this.associations = new Map();\n\n    // BufferGeometry caching\n    this.primitiveCache = {};\n\n    // Node cache\n    this.nodeCache = {};\n\n    // Object3D instance caches\n    this.meshCache = { refs: {}, uses: {} };\n    this.cameraCache = { refs: {}, uses: {} };\n    this.lightCache = { refs: {}, uses: {} };\n\n    this.sourceCache = {};\n    this.textureCache = {};\n\n    // Track node names, to ensure no duplicates\n    this.nodeNamesUsed = {};\n\n    // Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n    // expensive work of uploading a texture to the GPU off the main thread.\n\n    let isSafari = false;\n    let isFirefox = false;\n    let firefoxVersion = -1;\n\n    if (typeof navigator !== 'undefined') {\n      isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent) === true;\n      isFirefox = navigator.userAgent.indexOf('Firefox') > -1;\n      firefoxVersion = isFirefox ? navigator.userAgent.match(/Firefox\\/([0-9]+)\\./)[1] : -1;\n    }\n\n    if (\n      typeof createImageBitmap === 'undefined' ||\n      isSafari ||\n      (isFirefox && firefoxVersion < 98)\n    ) {\n      this.textureLoader = new TextureLoader(this.options.manager);\n    } else {\n      this.textureLoader = new ImageBitmapLoader(this.options.manager);\n    }\n\n    this.textureLoader.setCrossOrigin(this.options.crossOrigin);\n    this.textureLoader.setRequestHeader(this.options.requestHeader);\n\n    this.fileLoader = new FileLoader(this.options.manager);\n    this.fileLoader.setResponseType('arraybuffer');\n\n    if (this.options.crossOrigin === 'use-credentials') {\n      this.fileLoader.setWithCredentials(true);\n    }\n  }\n\n  setExtensions(extensions) {\n    this.extensions = extensions;\n  }\n\n  setPlugins(plugins) {\n    this.plugins = plugins;\n  }\n\n  parse(onLoad, onError) {\n    const parser = this;\n    const json = this.json;\n    const extensions = this.extensions;\n\n    // Clear the loader cache\n    this.cache.removeAll();\n    this.nodeCache = {};\n\n    // Mark the special nodes/meshes in json for efficient parse\n    this._invokeAll(function (ext) {\n      return ext._markDefs && ext._markDefs();\n    });\n\n    Promise.all(\n      this._invokeAll(function (ext) {\n        return ext.beforeRoot && ext.beforeRoot();\n      }),\n    )\n      .then(function () {\n        return Promise.all([\n          parser.getDependencies('scene'),\n          parser.getDependencies('animation'),\n          parser.getDependencies('camera'),\n        ]);\n      })\n      .then(function (dependencies) {\n        const result = {\n          scene: dependencies[0][json.scene || 0],\n          scenes: dependencies[0],\n          animations: dependencies[1],\n          cameras: dependencies[2],\n          asset: json.asset,\n          parser: parser,\n          userData: {},\n        };\n\n        addUnknownExtensionsToUserData(extensions, result, json);\n\n        assignExtrasToUserData(result, json);\n\n        Promise.all(\n          parser._invokeAll(function (ext) {\n            return ext.afterRoot && ext.afterRoot(result);\n          }),\n        ).then(function () {\n          onLoad(result);\n        });\n      })\n      .catch(onError);\n  }\n\n  /**\n   * Marks the special nodes/meshes in json for efficient parse.\n   */\n  _markDefs() {\n    const nodeDefs = this.json.nodes || [];\n    const skinDefs = this.json.skins || [];\n    const meshDefs = this.json.meshes || [];\n\n    // Nothing in the node definition indicates whether it is a Bone or an\n    // Object3D. Use the skins' joint references to mark bones.\n    for (let skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex++) {\n      const joints = skinDefs[skinIndex].joints;\n\n      for (let i = 0, il = joints.length; i < il; i++) {\n        nodeDefs[joints[i]].isBone = true;\n      }\n    }\n\n    // Iterate over all nodes, marking references to shared resources,\n    // as well as skeleton joints.\n    for (let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex++) {\n      const nodeDef = nodeDefs[nodeIndex];\n\n      if (nodeDef.mesh !== undefined) {\n        this._addNodeRef(this.meshCache, nodeDef.mesh);\n\n        // Nothing in the mesh definition indicates whether it is\n        // a SkinnedMesh or Mesh. Use the node's mesh reference\n        // to mark SkinnedMesh if node has skin.\n        if (nodeDef.skin !== undefined) {\n          meshDefs[nodeDef.mesh].isSkinnedMesh = true;\n        }\n      }\n\n      if (nodeDef.camera !== undefined) {\n        this._addNodeRef(this.cameraCache, nodeDef.camera);\n      }\n    }\n  }\n\n  /**\n   * Counts references to shared node / Object3D resources. These resources\n   * can be reused, or \"instantiated\", at multiple nodes in the scene\n   * hierarchy. Mesh, Camera, and Light instances are instantiated and must\n   * be marked. Non-scenegraph resources (like Materials, Geometries, and\n   * Textures) can be reused directly and are not marked here.\n   *\n   * Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n   */\n  _addNodeRef(cache, index) {\n    if (index === undefined) return;\n\n    if (cache.refs[index] === undefined) {\n      cache.refs[index] = cache.uses[index] = 0;\n    }\n\n    cache.refs[index]++;\n  }\n\n  /** Returns a reference to a shared resource, cloning it if necessary. */\n  _getNodeRef(cache, index, object) {\n    if (cache.refs[index] <= 1) return object;\n\n    const ref = object.clone();\n\n    // Propagates mappings to the cloned object, prevents mappings on the\n    // original object from being lost.\n    const updateMappings = (original, clone) => {\n      const mappings = this.associations.get(original);\n      if (mappings != null) {\n        this.associations.set(clone, mappings);\n      }\n\n      for (const [i, child] of original.children.entries()) {\n        updateMappings(child, clone.children[i]);\n      }\n    };\n\n    updateMappings(object, ref);\n\n    ref.name += '_instance_' + cache.uses[index]++;\n\n    return ref;\n  }\n\n  _invokeOne(func) {\n    const extensions = Object.values(this.plugins);\n    extensions.push(this);\n\n    for (let i = 0; i < extensions.length; i++) {\n      const result = func(extensions[i]);\n\n      if (result) return result;\n    }\n\n    return null;\n  }\n\n  _invokeAll(func) {\n    const extensions = Object.values(this.plugins);\n    extensions.unshift(this);\n\n    const pending = [];\n\n    for (let i = 0; i < extensions.length; i++) {\n      const result = func(extensions[i]);\n\n      if (result) pending.push(result);\n    }\n\n    return pending;\n  }\n\n  /**\n   * Requests the specified dependency asynchronously, with caching.\n   * @param {string} type\n   * @param {number} index\n   * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n   */\n  getDependency(type, index) {\n    const cacheKey = type + ':' + index;\n    let dependency = this.cache.get(cacheKey);\n\n    if (!dependency) {\n      switch (type) {\n        case 'scene':\n          dependency = this.loadScene(index);\n          break;\n\n        case 'node':\n          dependency = this._invokeOne(function (ext) {\n            return ext.loadNode && ext.loadNode(index);\n          });\n          break;\n\n        case 'mesh':\n          dependency = this._invokeOne(function (ext) {\n            return ext.loadMesh && ext.loadMesh(index);\n          });\n          break;\n\n        case 'accessor':\n          dependency = this.loadAccessor(index);\n          break;\n\n        case 'bufferView':\n          dependency = this._invokeOne(function (ext) {\n            return ext.loadBufferView && ext.loadBufferView(index);\n          });\n          break;\n\n        case 'buffer':\n          dependency = this.loadBuffer(index);\n          break;\n\n        case 'material':\n          dependency = this._invokeOne(function (ext) {\n            return ext.loadMaterial && ext.loadMaterial(index);\n          });\n          break;\n\n        case 'texture':\n          dependency = this._invokeOne(function (ext) {\n            return ext.loadTexture && ext.loadTexture(index);\n          });\n          break;\n\n        case 'skin':\n          dependency = this.loadSkin(index);\n          break;\n\n        case 'animation':\n          dependency = this._invokeOne(function (ext) {\n            return ext.loadAnimation && ext.loadAnimation(index);\n          });\n          break;\n\n        case 'camera':\n          dependency = this.loadCamera(index);\n          break;\n\n        default:\n          dependency = this._invokeOne(function (ext) {\n            return ext != this && ext.getDependency && ext.getDependency(type, index);\n          });\n\n          if (!dependency) {\n            throw new Error('Unknown type: ' + type);\n          }\n\n          break;\n      }\n\n      this.cache.add(cacheKey, dependency);\n    }\n\n    return dependency;\n  }\n\n  /**\n   * Requests all dependencies of the specified type asynchronously, with caching.\n   * @param {string} type\n   * @return {Promise<Array<Object>>}\n   */\n  getDependencies(type) {\n    let dependencies = this.cache.get(type);\n\n    if (!dependencies) {\n      const parser = this;\n      const defs = this.json[type + (type === 'mesh' ? 'es' : 's')] || [];\n\n      dependencies = Promise.all(\n        defs.map(function (def, index) {\n          return parser.getDependency(type, index);\n        }),\n      );\n\n      this.cache.add(type, dependencies);\n    }\n\n    return dependencies;\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n   * @param {number} bufferIndex\n   * @return {Promise<ArrayBuffer>}\n   */\n  loadBuffer(bufferIndex) {\n    const bufferDef = this.json.buffers[bufferIndex];\n    const loader = this.fileLoader;\n\n    if (bufferDef.type && bufferDef.type !== 'arraybuffer') {\n      throw new Error('THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.');\n    }\n\n    // If present, GLB container is required to be the first buffer.\n    if (bufferDef.uri === undefined && bufferIndex === 0) {\n      return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);\n    }\n\n    const options = this.options;\n\n    return new Promise(function (resolve, reject) {\n      loader.load(\n        LoaderUtils.resolveURL(bufferDef.uri, options.path),\n        resolve,\n        undefined,\n        function () {\n          reject(new Error('THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".'));\n        },\n      );\n    });\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n   * @param {number} bufferViewIndex\n   * @return {Promise<ArrayBuffer>}\n   */\n  loadBufferView(bufferViewIndex) {\n    const bufferViewDef = this.json.bufferViews[bufferViewIndex];\n\n    return this.getDependency('buffer', bufferViewDef.buffer).then(function (buffer) {\n      const byteLength = bufferViewDef.byteLength || 0;\n      const byteOffset = bufferViewDef.byteOffset || 0;\n      return buffer.slice(byteOffset, byteOffset + byteLength);\n    });\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n   * @param {number} accessorIndex\n   * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n   */\n  loadAccessor(accessorIndex) {\n    const parser = this;\n    const json = this.json;\n\n    const accessorDef = this.json.accessors[accessorIndex];\n\n    if (accessorDef.bufferView === undefined && accessorDef.sparse === undefined) {\n      const itemSize = WEBGL_TYPE_SIZES[accessorDef.type];\n      const TypedArray = WEBGL_COMPONENT_TYPES[accessorDef.componentType];\n      const normalized = accessorDef.normalized === true;\n\n      const array = new TypedArray(accessorDef.count * itemSize);\n      return Promise.resolve(new BufferAttribute(array, itemSize, normalized));\n    }\n\n    const pendingBufferViews = [];\n\n    if (accessorDef.bufferView !== undefined) {\n      pendingBufferViews.push(this.getDependency('bufferView', accessorDef.bufferView));\n    } else {\n      pendingBufferViews.push(null);\n    }\n\n    if (accessorDef.sparse !== undefined) {\n      pendingBufferViews.push(\n        this.getDependency('bufferView', accessorDef.sparse.indices.bufferView),\n      );\n      pendingBufferViews.push(\n        this.getDependency('bufferView', accessorDef.sparse.values.bufferView),\n      );\n    }\n\n    return Promise.all(pendingBufferViews).then(function (bufferViews) {\n      const bufferView = bufferViews[0];\n\n      const itemSize = WEBGL_TYPE_SIZES[accessorDef.type];\n      const TypedArray = WEBGL_COMPONENT_TYPES[accessorDef.componentType];\n\n      // For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n      const elementBytes = TypedArray.BYTES_PER_ELEMENT;\n      const itemBytes = elementBytes * itemSize;\n      const byteOffset = accessorDef.byteOffset || 0;\n      const byteStride =\n        accessorDef.bufferView !== undefined\n          ? json.bufferViews[accessorDef.bufferView].byteStride\n          : undefined;\n      const normalized = accessorDef.normalized === true;\n      let array, bufferAttribute;\n\n      // The buffer is not interleaved if the stride is the item size in bytes.\n      if (byteStride && byteStride !== itemBytes) {\n        // Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n        // This makes sure that IBA.count reflects accessor.count properly\n        const ibSlice = Math.floor(byteOffset / byteStride);\n        const ibCacheKey =\n          'InterleavedBuffer:' +\n          accessorDef.bufferView +\n          ':' +\n          accessorDef.componentType +\n          ':' +\n          ibSlice +\n          ':' +\n          accessorDef.count;\n        let ib = parser.cache.get(ibCacheKey);\n\n        if (!ib) {\n          array = new TypedArray(\n            bufferView,\n            ibSlice * byteStride,\n            (accessorDef.count * byteStride) / elementBytes,\n          );\n\n          // Integer parameters to IB/IBA are in array elements, not bytes.\n          ib = new InterleavedBuffer(array, byteStride / elementBytes);\n\n          parser.cache.add(ibCacheKey, ib);\n        }\n\n        bufferAttribute = new InterleavedBufferAttribute(\n          ib,\n          itemSize,\n          (byteOffset % byteStride) / elementBytes,\n          normalized,\n        );\n      } else {\n        if (bufferView === null) {\n          array = new TypedArray(accessorDef.count * itemSize);\n        } else {\n          array = new TypedArray(bufferView, byteOffset, accessorDef.count * itemSize);\n        }\n\n        bufferAttribute = new BufferAttribute(array, itemSize, normalized);\n      }\n\n      // https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n      if (accessorDef.sparse !== undefined) {\n        const itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n        const TypedArrayIndices = WEBGL_COMPONENT_TYPES[accessorDef.sparse.indices.componentType];\n\n        const byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n        const byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n        const sparseIndices = new TypedArrayIndices(\n          bufferViews[1],\n          byteOffsetIndices,\n          accessorDef.sparse.count * itemSizeIndices,\n        );\n        const sparseValues = new TypedArray(\n          bufferViews[2],\n          byteOffsetValues,\n          accessorDef.sparse.count * itemSize,\n        );\n\n        if (bufferView !== null) {\n          // Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n          bufferAttribute = new BufferAttribute(\n            bufferAttribute.array.slice(),\n            bufferAttribute.itemSize,\n            bufferAttribute.normalized,\n          );\n        }\n\n        for (let i = 0, il = sparseIndices.length; i < il; i++) {\n          const index = sparseIndices[i];\n\n          bufferAttribute.setX(index, sparseValues[i * itemSize]);\n          if (itemSize >= 2) bufferAttribute.setY(index, sparseValues[i * itemSize + 1]);\n          if (itemSize >= 3) bufferAttribute.setZ(index, sparseValues[i * itemSize + 2]);\n          if (itemSize >= 4) bufferAttribute.setW(index, sparseValues[i * itemSize + 3]);\n          if (itemSize >= 5)\n            throw new Error('THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.');\n        }\n      }\n\n      return bufferAttribute;\n    });\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n   * @param {number} textureIndex\n   * @return {Promise<THREE.Texture|null>}\n   */\n  loadTexture(textureIndex) {\n    const json = this.json;\n    const options = this.options;\n    const textureDef = json.textures[textureIndex];\n    const sourceIndex = textureDef.source;\n    const sourceDef = json.images[sourceIndex];\n\n    let loader = this.textureLoader;\n\n    if (sourceDef.uri) {\n      const handler = options.manager.getHandler(sourceDef.uri);\n      if (handler !== null) loader = handler;\n    }\n\n    return this.loadTextureImage(textureIndex, sourceIndex, loader);\n  }\n\n  loadTextureImage(textureIndex, sourceIndex, loader) {\n    const parser = this;\n    const json = this.json;\n\n    const textureDef = json.textures[textureIndex];\n    const sourceDef = json.images[sourceIndex];\n\n    const cacheKey = (sourceDef.uri || sourceDef.bufferView) + ':' + textureDef.sampler;\n\n    if (this.textureCache[cacheKey]) {\n      // See https://github.com/mrdoob/three.js/issues/21559.\n      return this.textureCache[cacheKey];\n    }\n\n    const promise = this.loadImageSource(sourceIndex, loader)\n      .then(function (texture) {\n        texture.flipY = false;\n\n        texture.name = textureDef.name || sourceDef.name || '';\n\n        if (\n          texture.name === '' &&\n          typeof sourceDef.uri === 'string' &&\n          sourceDef.uri.startsWith('data:image/') === false\n        ) {\n          texture.name = sourceDef.uri;\n        }\n\n        const samplers = json.samplers || {};\n        const sampler = samplers[textureDef.sampler] || {};\n\n        texture.magFilter = WEBGL_FILTERS[sampler.magFilter] || LinearFilter;\n        texture.minFilter = WEBGL_FILTERS[sampler.minFilter] || LinearMipmapLinearFilter;\n        texture.wrapS = WEBGL_WRAPPINGS[sampler.wrapS] || RepeatWrapping;\n        texture.wrapT = WEBGL_WRAPPINGS[sampler.wrapT] || RepeatWrapping;\n\n        parser.associations.set(texture, { textures: textureIndex });\n\n        return texture;\n      })\n      .catch(function () {\n        return null;\n      });\n\n    this.textureCache[cacheKey] = promise;\n\n    return promise;\n  }\n\n  loadImageSource(sourceIndex, loader) {\n    const parser = this;\n    const json = this.json;\n    const options = this.options;\n\n    if (this.sourceCache[sourceIndex] !== undefined) {\n      return this.sourceCache[sourceIndex].then((texture) => texture.clone());\n    }\n\n    const sourceDef = json.images[sourceIndex];\n\n    const URL = self.URL || self.webkitURL;\n\n    let sourceURI = sourceDef.uri || '';\n    let isObjectURL = false;\n\n    if (sourceDef.bufferView !== undefined) {\n      // Load binary image data from bufferView, if provided.\n\n      sourceURI = parser\n        .getDependency('bufferView', sourceDef.bufferView)\n        .then(function (bufferView) {\n          isObjectURL = true;\n          const blob = new Blob([bufferView], { type: sourceDef.mimeType });\n          sourceURI = URL.createObjectURL(blob);\n          return sourceURI;\n        });\n    } else if (sourceDef.uri === undefined) {\n      throw new Error('THREE.GLTFLoader: Image ' + sourceIndex + ' is missing URI and bufferView');\n    }\n\n    const promise = Promise.resolve(sourceURI)\n      .then(function (sourceURI) {\n        return new Promise(function (resolve, reject) {\n          let onLoad = resolve;\n\n          if (loader.isImageBitmapLoader === true) {\n            onLoad = function (imageBitmap) {\n              const texture = new Texture(imageBitmap);\n              texture.needsUpdate = true;\n\n              resolve(texture);\n            };\n          }\n\n          loader.load(LoaderUtils.resolveURL(sourceURI, options.path), onLoad, undefined, reject);\n        });\n      })\n      .then(function (texture) {\n        // Clean up resources and configure Texture.\n\n        if (isObjectURL === true) {\n          URL.revokeObjectURL(sourceURI);\n        }\n\n        texture.userData.mimeType = sourceDef.mimeType || getImageURIMimeType(sourceDef.uri);\n\n        return texture;\n      })\n      .catch(function (error) {\n        console.error(\"THREE.GLTFLoader: Couldn't load texture\", sourceURI);\n        throw error;\n      });\n\n    this.sourceCache[sourceIndex] = promise;\n    return promise;\n  }\n\n  /**\n   * Asynchronously assigns a texture to the given material parameters.\n   * @param {Object} materialParams\n   * @param {string} mapName\n   * @param {Object} mapDef\n   * @return {Promise<Texture>}\n   */\n  assignTexture(materialParams, mapName, mapDef, encoding) {\n    const parser = this;\n\n    return this.getDependency('texture', mapDef.index).then(function (texture) {\n      if (!texture) return null;\n\n      // Materials sample aoMap from UV set 1 and other maps from UV set 0 - this can't be configured\n      // However, we will copy UV set 0 to UV set 1 on demand for aoMap\n      if (\n        mapDef.texCoord !== undefined &&\n        mapDef.texCoord != 0 &&\n        !(mapName === 'aoMap' && mapDef.texCoord == 1)\n      ) {\n        console.warn(\n          'THREE.GLTFLoader: Custom UV set ' +\n            mapDef.texCoord +\n            ' for texture ' +\n            mapName +\n            ' not yet supported.',\n        );\n      }\n\n      if (parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]) {\n        const transform =\n          mapDef.extensions !== undefined\n            ? mapDef.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]\n            : undefined;\n\n        if (transform) {\n          const gltfReference = parser.associations.get(texture);\n          texture = parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(\n            texture,\n            transform,\n          );\n          parser.associations.set(texture, gltfReference);\n        }\n      }\n\n      if (encoding !== undefined) {\n        texture.encoding = encoding;\n      }\n\n      materialParams[mapName] = texture;\n\n      return texture;\n    });\n  }\n\n  /**\n   * Assigns final material to a Mesh, Line, or Points instance. The instance\n   * already has a material (generated from the glTF material options alone)\n   * but reuse of the same glTF material may require multiple threejs materials\n   * to accommodate different primitive types, defines, etc. New materials will\n   * be created if necessary, and reused from a cache.\n   * @param  {Object3D} mesh Mesh, Line, or Points instance.\n   */\n  assignFinalMaterial(mesh) {\n    const geometry = mesh.geometry;\n    let material = mesh.material;\n\n    const useDerivativeTangents = geometry.attributes.tangent === undefined;\n    const useVertexColors = geometry.attributes.color !== undefined;\n    const useFlatShading = geometry.attributes.normal === undefined;\n\n    if (mesh.isPoints) {\n      const cacheKey = 'PointsMaterial:' + material.uuid;\n\n      let pointsMaterial = this.cache.get(cacheKey);\n\n      if (!pointsMaterial) {\n        pointsMaterial = new PointsMaterial();\n        Material.prototype.copy.call(pointsMaterial, material);\n        pointsMaterial.color.copy(material.color);\n        pointsMaterial.map = material.map;\n        pointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n        this.cache.add(cacheKey, pointsMaterial);\n      }\n\n      material = pointsMaterial;\n    } else if (mesh.isLine) {\n      const cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n      let lineMaterial = this.cache.get(cacheKey);\n\n      if (!lineMaterial) {\n        lineMaterial = new LineBasicMaterial();\n        Material.prototype.copy.call(lineMaterial, material);\n        lineMaterial.color.copy(material.color);\n\n        this.cache.add(cacheKey, lineMaterial);\n      }\n\n      material = lineMaterial;\n    }\n\n    // Clone the material if it will be modified\n    if (useDerivativeTangents || useVertexColors || useFlatShading) {\n      let cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n      if (useDerivativeTangents) cacheKey += 'derivative-tangents:';\n      if (useVertexColors) cacheKey += 'vertex-colors:';\n      if (useFlatShading) cacheKey += 'flat-shading:';\n\n      let cachedMaterial = this.cache.get(cacheKey);\n\n      if (!cachedMaterial) {\n        cachedMaterial = material.clone();\n\n        if (useVertexColors) cachedMaterial.vertexColors = true;\n        if (useFlatShading) cachedMaterial.flatShading = true;\n\n        if (useDerivativeTangents) {\n          // https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n          if (cachedMaterial.normalScale) cachedMaterial.normalScale.y *= -1;\n          if (cachedMaterial.clearcoatNormalScale) cachedMaterial.clearcoatNormalScale.y *= -1;\n        }\n\n        this.cache.add(cacheKey, cachedMaterial);\n\n        this.associations.set(cachedMaterial, this.associations.get(material));\n      }\n\n      material = cachedMaterial;\n    }\n\n    // workarounds for mesh and geometry\n\n    if (\n      material.aoMap &&\n      geometry.attributes.uv2 === undefined &&\n      geometry.attributes.uv !== undefined\n    ) {\n      geometry.setAttribute('uv2', geometry.attributes.uv);\n    }\n\n    mesh.material = material;\n  }\n\n  getMaterialType(/* materialIndex */) {\n    return MeshStandardMaterial;\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n   * @param {number} materialIndex\n   * @return {Promise<Material>}\n   */\n  loadMaterial(materialIndex) {\n    const parser = this;\n    const json = this.json;\n    const extensions = this.extensions;\n    const materialDef = json.materials[materialIndex];\n\n    let materialType;\n    const materialParams = {};\n    const materialExtensions = materialDef.extensions || {};\n\n    const pending = [];\n\n    if (materialExtensions[EXTENSIONS.KHR_MATERIALS_UNLIT]) {\n      const kmuExtension = extensions[EXTENSIONS.KHR_MATERIALS_UNLIT];\n      materialType = kmuExtension.getMaterialType();\n      pending.push(kmuExtension.extendParams(materialParams, materialDef, parser));\n    } else {\n      // Specification:\n      // https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n      const metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n      materialParams.color = new Color(1.0, 1.0, 1.0);\n      materialParams.opacity = 1.0;\n\n      if (Array.isArray(metallicRoughness.baseColorFactor)) {\n        const array = metallicRoughness.baseColorFactor;\n\n        materialParams.color.fromArray(array);\n        materialParams.opacity = array[3];\n      }\n\n      if (metallicRoughness.baseColorTexture !== undefined) {\n        pending.push(\n          parser.assignTexture(\n            materialParams,\n            'map',\n            metallicRoughness.baseColorTexture,\n            sRGBEncoding,\n          ),\n        );\n      }\n\n      materialParams.metalness =\n        metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n      materialParams.roughness =\n        metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n      if (metallicRoughness.metallicRoughnessTexture !== undefined) {\n        pending.push(\n          parser.assignTexture(\n            materialParams,\n            'metalnessMap',\n            metallicRoughness.metallicRoughnessTexture,\n          ),\n        );\n        pending.push(\n          parser.assignTexture(\n            materialParams,\n            'roughnessMap',\n            metallicRoughness.metallicRoughnessTexture,\n          ),\n        );\n      }\n\n      materialType = this._invokeOne(function (ext) {\n        return ext.getMaterialType && ext.getMaterialType(materialIndex);\n      });\n\n      pending.push(\n        Promise.all(\n          this._invokeAll(function (ext) {\n            return (\n              ext.extendMaterialParams && ext.extendMaterialParams(materialIndex, materialParams)\n            );\n          }),\n        ),\n      );\n    }\n\n    if (materialDef.doubleSided === true) {\n      materialParams.side = DoubleSide;\n    }\n\n    const alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n    if (alphaMode === ALPHA_MODES.BLEND) {\n      materialParams.transparent = true;\n\n      // See: https://github.com/mrdoob/three.js/issues/17706\n      materialParams.depthWrite = false;\n    } else {\n      materialParams.transparent = false;\n\n      if (alphaMode === ALPHA_MODES.MASK) {\n        materialParams.alphaTest =\n          materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n      }\n    }\n\n    if (materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial) {\n      pending.push(parser.assignTexture(materialParams, 'normalMap', materialDef.normalTexture));\n\n      materialParams.normalScale = new Vector2(1, 1);\n\n      if (materialDef.normalTexture.scale !== undefined) {\n        const scale = materialDef.normalTexture.scale;\n\n        materialParams.normalScale.set(scale, scale);\n      }\n    }\n\n    if (materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial) {\n      pending.push(parser.assignTexture(materialParams, 'aoMap', materialDef.occlusionTexture));\n\n      if (materialDef.occlusionTexture.strength !== undefined) {\n        materialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n      }\n    }\n\n    if (materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial) {\n      materialParams.emissive = new Color().fromArray(materialDef.emissiveFactor);\n    }\n\n    if (materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial) {\n      pending.push(\n        parser.assignTexture(\n          materialParams,\n          'emissiveMap',\n          materialDef.emissiveTexture,\n          sRGBEncoding,\n        ),\n      );\n    }\n\n    return Promise.all(pending).then(function () {\n      const material = new materialType(materialParams);\n\n      if (materialDef.name) material.name = materialDef.name;\n\n      assignExtrasToUserData(material, materialDef);\n\n      parser.associations.set(material, { materials: materialIndex });\n\n      if (materialDef.extensions) addUnknownExtensionsToUserData(extensions, material, materialDef);\n\n      return material;\n    });\n  }\n\n  /** When Object3D instances are targeted by animation, they need unique names. */\n  createUniqueName(originalName) {\n    const sanitizedName = PropertyBinding.sanitizeNodeName(originalName || '');\n\n    let name = sanitizedName;\n\n    for (let i = 1; this.nodeNamesUsed[name]; ++i) {\n      name = sanitizedName + '_' + i;\n    }\n\n    this.nodeNamesUsed[name] = true;\n\n    return name;\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n   *\n   * Creates BufferGeometries from primitives.\n   *\n   * @param {Array<GLTF.Primitive>} primitives\n   * @return {Promise<Array<BufferGeometry>>}\n   */\n  loadGeometries(primitives) {\n    const parser = this;\n    const extensions = this.extensions;\n    const cache = this.primitiveCache;\n\n    function createDracoPrimitive(primitive) {\n      return extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]\n        .decodePrimitive(primitive, parser)\n        .then(function (geometry) {\n          return addPrimitiveAttributes(geometry, primitive, parser);\n        });\n    }\n\n    const pending = [];\n\n    for (let i = 0, il = primitives.length; i < il; i++) {\n      const primitive = primitives[i];\n      const cacheKey = createPrimitiveKey(primitive);\n\n      // See if we've already created this geometry\n      const cached = cache[cacheKey];\n\n      if (cached) {\n        // Use the cached geometry if it exists\n        pending.push(cached.promise);\n      } else {\n        let geometryPromise;\n\n        if (primitive.extensions && primitive.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]) {\n          // Use DRACO geometry if available\n          geometryPromise = createDracoPrimitive(primitive);\n        } else {\n          // Otherwise create a new geometry\n          geometryPromise = addPrimitiveAttributes(new BufferGeometry(), primitive, parser);\n        }\n\n        // Cache this geometry\n        cache[cacheKey] = { primitive: primitive, promise: geometryPromise };\n\n        pending.push(geometryPromise);\n      }\n    }\n\n    return Promise.all(pending);\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n   * @param {number} meshIndex\n   * @return {Promise<Group|Mesh|SkinnedMesh>}\n   */\n  loadMesh(meshIndex) {\n    const parser = this;\n    const json = this.json;\n    const extensions = this.extensions;\n\n    const meshDef = json.meshes[meshIndex];\n    const primitives = meshDef.primitives;\n\n    const pending = [];\n\n    for (let i = 0, il = primitives.length; i < il; i++) {\n      const material =\n        primitives[i].material === undefined\n          ? createDefaultMaterial(this.cache)\n          : this.getDependency('material', primitives[i].material);\n\n      pending.push(material);\n    }\n\n    pending.push(parser.loadGeometries(primitives));\n\n    return Promise.all(pending).then(function (results) {\n      const materials = results.slice(0, results.length - 1);\n      const geometries = results[results.length - 1];\n\n      const meshes = [];\n\n      for (let i = 0, il = geometries.length; i < il; i++) {\n        const geometry = geometries[i];\n        const primitive = primitives[i];\n\n        // 1. create Mesh\n\n        let mesh;\n\n        const material = materials[i];\n\n        if (\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n          primitive.mode === undefined\n        ) {\n          // .isSkinnedMesh isn't in glTF spec. See ._markDefs()\n          mesh =\n            meshDef.isSkinnedMesh === true\n              ? new SkinnedMesh(geometry, material)\n              : new Mesh(geometry, material);\n\n          if (mesh.isSkinnedMesh === true) {\n            // normalize skin weights to fix malformed assets (see #15319)\n            mesh.normalizeSkinWeights();\n          }\n\n          if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP) {\n            mesh.geometry = toTrianglesDrawMode(mesh.geometry, TriangleStripDrawMode);\n          } else if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN) {\n            mesh.geometry = toTrianglesDrawMode(mesh.geometry, TriangleFanDrawMode);\n          }\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINES) {\n          mesh = new LineSegments(geometry, material);\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINE_STRIP) {\n          mesh = new Line(geometry, material);\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINE_LOOP) {\n          mesh = new LineLoop(geometry, material);\n        } else if (primitive.mode === WEBGL_CONSTANTS.POINTS) {\n          mesh = new Points(geometry, material);\n        } else {\n          throw new Error('THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode);\n        }\n\n        if (Object.keys(mesh.geometry.morphAttributes).length > 0) {\n          updateMorphTargets(mesh, meshDef);\n        }\n\n        mesh.name = parser.createUniqueName(meshDef.name || 'mesh_' + meshIndex);\n\n        assignExtrasToUserData(mesh, meshDef);\n\n        if (primitive.extensions) addUnknownExtensionsToUserData(extensions, mesh, primitive);\n\n        parser.assignFinalMaterial(mesh);\n\n        meshes.push(mesh);\n      }\n\n      for (let i = 0, il = meshes.length; i < il; i++) {\n        parser.associations.set(meshes[i], {\n          meshes: meshIndex,\n          primitives: i,\n        });\n      }\n\n      if (meshes.length === 1) {\n        return meshes[0];\n      }\n\n      const group = new Group();\n\n      parser.associations.set(group, { meshes: meshIndex });\n\n      for (let i = 0, il = meshes.length; i < il; i++) {\n        group.add(meshes[i]);\n      }\n\n      return group;\n    });\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n   * @param {number} cameraIndex\n   * @return {Promise<THREE.Camera>}\n   */\n  loadCamera(cameraIndex) {\n    let camera;\n    const cameraDef = this.json.cameras[cameraIndex];\n    const params = cameraDef[cameraDef.type];\n\n    if (!params) {\n      console.warn('THREE.GLTFLoader: Missing camera parameters.');\n      return;\n    }\n\n    if (cameraDef.type === 'perspective') {\n      camera = new PerspectiveCamera(\n        MathUtils.radToDeg(params.yfov),\n        params.aspectRatio || 1,\n        params.znear || 1,\n        params.zfar || 2e6,\n      );\n    } else if (cameraDef.type === 'orthographic') {\n      camera = new OrthographicCamera(\n        -params.xmag,\n        params.xmag,\n        params.ymag,\n        -params.ymag,\n        params.znear,\n        params.zfar,\n      );\n    }\n\n    if (cameraDef.name) camera.name = this.createUniqueName(cameraDef.name);\n\n    assignExtrasToUserData(camera, cameraDef);\n\n    return Promise.resolve(camera);\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n   * @param {number} skinIndex\n   * @return {Promise<Skeleton>}\n   */\n  loadSkin(skinIndex) {\n    const skinDef = this.json.skins[skinIndex];\n\n    const pending = [];\n\n    for (let i = 0, il = skinDef.joints.length; i < il; i++) {\n      pending.push(this._loadNodeShallow(skinDef.joints[i]));\n    }\n\n    if (skinDef.inverseBindMatrices !== undefined) {\n      pending.push(this.getDependency('accessor', skinDef.inverseBindMatrices));\n    } else {\n      pending.push(null);\n    }\n\n    return Promise.all(pending).then(function (results) {\n      const inverseBindMatrices = results.pop();\n      const jointNodes = results;\n\n      // Note that bones (joint nodes) may or may not be in the\n      // scene graph at this time.\n\n      const bones = [];\n      const boneInverses = [];\n\n      for (let i = 0, il = jointNodes.length; i < il; i++) {\n        const jointNode = jointNodes[i];\n\n        if (jointNode) {\n          bones.push(jointNode);\n\n          const mat = new Matrix4();\n\n          if (inverseBindMatrices !== null) {\n            mat.fromArray(inverseBindMatrices.array, i * 16);\n          }\n\n          boneInverses.push(mat);\n        } else {\n          console.warn('THREE.GLTFLoader: Joint \"%s\" could not be found.', skinDef.joints[i]);\n        }\n      }\n\n      return new Skeleton(bones, boneInverses);\n    });\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n   * @param {number} animationIndex\n   * @return {Promise<AnimationClip>}\n   */\n  loadAnimation(animationIndex) {\n    const json = this.json;\n\n    const animationDef = json.animations[animationIndex];\n\n    const pendingNodes = [];\n    const pendingInputAccessors = [];\n    const pendingOutputAccessors = [];\n    const pendingSamplers = [];\n    const pendingTargets = [];\n\n    for (let i = 0, il = animationDef.channels.length; i < il; i++) {\n      const channel = animationDef.channels[i];\n      const sampler = animationDef.samplers[channel.sampler];\n      const target = channel.target;\n      const name = target.node;\n      const input =\n        animationDef.parameters !== undefined\n          ? animationDef.parameters[sampler.input]\n          : sampler.input;\n      const output =\n        animationDef.parameters !== undefined\n          ? animationDef.parameters[sampler.output]\n          : sampler.output;\n\n      pendingNodes.push(this.getDependency('node', name));\n      pendingInputAccessors.push(this.getDependency('accessor', input));\n      pendingOutputAccessors.push(this.getDependency('accessor', output));\n      pendingSamplers.push(sampler);\n      pendingTargets.push(target);\n    }\n\n    return Promise.all([\n      Promise.all(pendingNodes),\n      Promise.all(pendingInputAccessors),\n      Promise.all(pendingOutputAccessors),\n      Promise.all(pendingSamplers),\n      Promise.all(pendingTargets),\n    ]).then(function (dependencies) {\n      const nodes = dependencies[0];\n      const inputAccessors = dependencies[1];\n      const outputAccessors = dependencies[2];\n      const samplers = dependencies[3];\n      const targets = dependencies[4];\n\n      const tracks = [];\n\n      for (let i = 0, il = nodes.length; i < il; i++) {\n        const node = nodes[i];\n        const inputAccessor = inputAccessors[i];\n        const outputAccessor = outputAccessors[i];\n        const sampler = samplers[i];\n        const target = targets[i];\n\n        if (node === undefined) continue;\n\n        node.updateMatrix();\n\n        let TypedKeyframeTrack;\n\n        switch (PATH_PROPERTIES[target.path]) {\n          case PATH_PROPERTIES.weights:\n            TypedKeyframeTrack = NumberKeyframeTrack;\n            break;\n\n          case PATH_PROPERTIES.rotation:\n            TypedKeyframeTrack = QuaternionKeyframeTrack;\n            break;\n\n          case PATH_PROPERTIES.position:\n          case PATH_PROPERTIES.scale:\n          default:\n            TypedKeyframeTrack = VectorKeyframeTrack;\n            break;\n        }\n\n        const targetName = node.name ? node.name : node.uuid;\n\n        const interpolation =\n          sampler.interpolation !== undefined\n            ? INTERPOLATION[sampler.interpolation]\n            : InterpolateLinear;\n\n        const targetNames = [];\n\n        if (PATH_PROPERTIES[target.path] === PATH_PROPERTIES.weights) {\n          node.traverse(function (object) {\n            if (object.morphTargetInfluences) {\n              targetNames.push(object.name ? object.name : object.uuid);\n            }\n          });\n        } else {\n          targetNames.push(targetName);\n        }\n\n        let outputArray = outputAccessor.array;\n\n        if (outputAccessor.normalized) {\n          const scale = getNormalizedComponentScale(outputArray.constructor);\n          const scaled = new Float32Array(outputArray.length);\n\n          for (let j = 0, jl = outputArray.length; j < jl; j++) {\n            scaled[j] = outputArray[j] * scale;\n          }\n\n          outputArray = scaled;\n        }\n\n        for (let j = 0, jl = targetNames.length; j < jl; j++) {\n          const track = new TypedKeyframeTrack(\n            targetNames[j] + '.' + PATH_PROPERTIES[target.path],\n            inputAccessor.array,\n            outputArray,\n            interpolation,\n          );\n\n          // Override interpolation with custom factory method.\n          if (sampler.interpolation === 'CUBICSPLINE') {\n            track.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline(result) {\n              // A CUBICSPLINE keyframe in glTF has three output values for each input value,\n              // representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n              // must be divided by three to get the interpolant's sampleSize argument.\n\n              const interpolantType =\n                this instanceof QuaternionKeyframeTrack\n                  ? GLTFCubicSplineQuaternionInterpolant\n                  : GLTFCubicSplineInterpolant;\n\n              return new interpolantType(this.times, this.values, this.getValueSize() / 3, result);\n            };\n\n            // Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n            track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n          }\n\n          tracks.push(track);\n        }\n      }\n\n      const name = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n      return new AnimationClip(name, undefined, tracks);\n    });\n  }\n\n  createNodeMesh(nodeIndex) {\n    const json = this.json;\n    const parser = this;\n    const nodeDef = json.nodes[nodeIndex];\n\n    if (nodeDef.mesh === undefined) return null;\n\n    return parser.getDependency('mesh', nodeDef.mesh).then(function (mesh) {\n      const node = parser._getNodeRef(parser.meshCache, nodeDef.mesh, mesh);\n\n      // if weights are provided on the node, override weights on the mesh.\n      if (nodeDef.weights !== undefined) {\n        node.traverse(function (o) {\n          if (!o.isMesh) return;\n\n          for (let i = 0, il = nodeDef.weights.length; i < il; i++) {\n            o.morphTargetInfluences[i] = nodeDef.weights[i];\n          }\n        });\n      }\n\n      return node;\n    });\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n   * @param {number} nodeIndex\n   * @return {Promise<Object3D>}\n   */\n  loadNode(nodeIndex) {\n    const json = this.json;\n    const parser = this;\n\n    const nodeDef = json.nodes[nodeIndex];\n\n    const nodePending = parser._loadNodeShallow(nodeIndex);\n\n    const childPending = [];\n    const childrenDef = nodeDef.children || [];\n\n    for (let i = 0, il = childrenDef.length; i < il; i++) {\n      childPending.push(parser.getDependency('node', childrenDef[i]));\n    }\n\n    const skeletonPending =\n      nodeDef.skin === undefined\n        ? Promise.resolve(null)\n        : parser.getDependency('skin', nodeDef.skin);\n\n    return Promise.all([nodePending, Promise.all(childPending), skeletonPending]).then(function (\n      results,\n    ) {\n      const node = results[0];\n      const children = results[1];\n      const skeleton = results[2];\n\n      if (skeleton !== null) {\n        // This full traverse should be fine because\n        // child glTF nodes have not been added to this node yet.\n        node.traverse(function (mesh) {\n          if (!mesh.isSkinnedMesh) return;\n\n          mesh.bind(skeleton, _identityMatrix);\n        });\n      }\n\n      for (let i = 0, il = children.length; i < il; i++) {\n        node.add(children[i]);\n      }\n\n      return node;\n    });\n  }\n\n  // ._loadNodeShallow() parses a single node.\n  // skin and child nodes are created and added in .loadNode() (no '_' prefix).\n  _loadNodeShallow(nodeIndex) {\n    const json = this.json;\n    const extensions = this.extensions;\n    const parser = this;\n\n    // This method is called from .loadNode() and .loadSkin().\n    // Cache a node to avoid duplication.\n\n    if (this.nodeCache[nodeIndex] !== undefined) {\n      return this.nodeCache[nodeIndex];\n    }\n\n    const nodeDef = json.nodes[nodeIndex];\n\n    // reserve node's name before its dependencies, so the root has the intended name.\n    const nodeName = nodeDef.name ? parser.createUniqueName(nodeDef.name) : '';\n\n    const pending = [];\n\n    const meshPromise = parser._invokeOne(function (ext) {\n      return ext.createNodeMesh && ext.createNodeMesh(nodeIndex);\n    });\n\n    if (meshPromise) {\n      pending.push(meshPromise);\n    }\n\n    if (nodeDef.camera !== undefined) {\n      pending.push(\n        parser.getDependency('camera', nodeDef.camera).then(function (camera) {\n          return parser._getNodeRef(parser.cameraCache, nodeDef.camera, camera);\n        }),\n      );\n    }\n\n    parser\n      ._invokeAll(function (ext) {\n        return ext.createNodeAttachment && ext.createNodeAttachment(nodeIndex);\n      })\n      .forEach(function (promise) {\n        pending.push(promise);\n      });\n\n    this.nodeCache[nodeIndex] = Promise.all(pending).then(function (objects) {\n      let node;\n\n      // .isBone isn't in glTF spec. See ._markDefs\n      if (nodeDef.isBone === true) {\n        node = new Bone();\n      } else if (objects.length > 1) {\n        node = new Group();\n      } else if (objects.length === 1) {\n        node = objects[0];\n      } else {\n        node = new Object3D();\n      }\n\n      if (node !== objects[0]) {\n        for (let i = 0, il = objects.length; i < il; i++) {\n          node.add(objects[i]);\n        }\n      }\n\n      if (nodeDef.name) {\n        node.userData.name = nodeDef.name;\n        node.name = nodeName;\n      }\n\n      assignExtrasToUserData(node, nodeDef);\n\n      if (nodeDef.extensions) addUnknownExtensionsToUserData(extensions, node, nodeDef);\n\n      if (nodeDef.matrix !== undefined) {\n        const matrix = new Matrix4();\n        matrix.fromArray(nodeDef.matrix);\n        node.applyMatrix4(matrix);\n      } else {\n        if (nodeDef.translation !== undefined) {\n          node.position.fromArray(nodeDef.translation);\n        }\n\n        if (nodeDef.rotation !== undefined) {\n          node.quaternion.fromArray(nodeDef.rotation);\n        }\n\n        if (nodeDef.scale !== undefined) {\n          node.scale.fromArray(nodeDef.scale);\n        }\n      }\n\n      if (!parser.associations.has(node)) {\n        parser.associations.set(node, {});\n      }\n\n      parser.associations.get(node).nodes = nodeIndex;\n\n      return node;\n    });\n\n    return this.nodeCache[nodeIndex];\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n   * @param {number} sceneIndex\n   * @return {Promise<Group>}\n   */\n  loadScene(sceneIndex) {\n    const extensions = this.extensions;\n    const sceneDef = this.json.scenes[sceneIndex];\n    const parser = this;\n\n    // Loader returns Group, not Scene.\n    // See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n    const scene = new Group();\n    if (sceneDef.name) scene.name = parser.createUniqueName(sceneDef.name);\n\n    assignExtrasToUserData(scene, sceneDef);\n\n    if (sceneDef.extensions) addUnknownExtensionsToUserData(extensions, scene, sceneDef);\n\n    const nodeIds = sceneDef.nodes || [];\n\n    const pending = [];\n\n    for (let i = 0, il = nodeIds.length; i < il; i++) {\n      pending.push(parser.getDependency('node', nodeIds[i]));\n    }\n\n    return Promise.all(pending).then(function (nodes) {\n      for (let i = 0, il = nodes.length; i < il; i++) {\n        scene.add(nodes[i]);\n      }\n\n      // Removes dangling associations, associations that reference a node that\n      // didn't make it into the scene.\n      const reduceAssociations = (node) => {\n        const reducedAssociations = new Map();\n\n        for (const [key, value] of parser.associations) {\n          if (key instanceof Material || key instanceof Texture) {\n            reducedAssociations.set(key, value);\n          }\n        }\n\n        node.traverse((node) => {\n          const mappings = parser.associations.get(node);\n\n          if (mappings != null) {\n            reducedAssociations.set(node, mappings);\n          }\n        });\n\n        return reducedAssociations;\n      };\n\n      parser.associations = reduceAssociations(scene);\n\n      return scene;\n    });\n  }\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n */\nfunction computeBounds(geometry, primitiveDef, parser) {\n  const attributes = primitiveDef.attributes;\n\n  const box = new Box3();\n\n  if (attributes.POSITION !== undefined) {\n    const accessor = parser.json.accessors[attributes.POSITION];\n\n    const min = accessor.min;\n    const max = accessor.max;\n\n    // glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n    if (min !== undefined && max !== undefined) {\n      box.set(new Vector3(min[0], min[1], min[2]), new Vector3(max[0], max[1], max[2]));\n\n      if (accessor.normalized) {\n        const boxScale = getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[accessor.componentType]);\n        box.min.multiplyScalar(boxScale);\n        box.max.multiplyScalar(boxScale);\n      }\n    } else {\n      console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');\n\n      return;\n    }\n  } else {\n    return;\n  }\n\n  const targets = primitiveDef.targets;\n\n  if (targets !== undefined) {\n    const maxDisplacement = new Vector3();\n    const vector = new Vector3();\n\n    for (let i = 0, il = targets.length; i < il; i++) {\n      const target = targets[i];\n\n      if (target.POSITION !== undefined) {\n        const accessor = parser.json.accessors[target.POSITION];\n        const min = accessor.min;\n        const max = accessor.max;\n\n        // glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n        if (min !== undefined && max !== undefined) {\n          // we need to get max of absolute components because target weight is [-1,1]\n          vector.setX(Math.max(Math.abs(min[0]), Math.abs(max[0])));\n          vector.setY(Math.max(Math.abs(min[1]), Math.abs(max[1])));\n          vector.setZ(Math.max(Math.abs(min[2]), Math.abs(max[2])));\n\n          if (accessor.normalized) {\n            const boxScale = getNormalizedComponentScale(\n              WEBGL_COMPONENT_TYPES[accessor.componentType],\n            );\n            vector.multiplyScalar(boxScale);\n          }\n\n          // Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n          // to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n          // are used to implement key-frame animations and as such only two are active at a time - this results in very large\n          // boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n          maxDisplacement.max(vector);\n        } else {\n          console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');\n        }\n      }\n    }\n\n    // As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n    box.expandByVector(maxDisplacement);\n  }\n\n  geometry.boundingBox = box;\n\n  const sphere = new Sphere();\n\n  box.getCenter(sphere.center);\n  sphere.radius = box.min.distanceTo(box.max) / 2;\n\n  geometry.boundingSphere = sphere;\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addPrimitiveAttributes(geometry, primitiveDef, parser) {\n  const attributes = primitiveDef.attributes;\n\n  const pending = [];\n\n  function assignAttributeAccessor(accessorIndex, attributeName) {\n    return parser.getDependency('accessor', accessorIndex).then(function (accessor) {\n      geometry.setAttribute(attributeName, accessor);\n    });\n  }\n\n  for (const gltfAttributeName in attributes) {\n    const threeAttributeName = ATTRIBUTES[gltfAttributeName] || gltfAttributeName.toLowerCase();\n\n    // Skip attributes already provided by e.g. Draco extension.\n    if (threeAttributeName in geometry.attributes) continue;\n\n    pending.push(assignAttributeAccessor(attributes[gltfAttributeName], threeAttributeName));\n  }\n\n  if (primitiveDef.indices !== undefined && !geometry.index) {\n    const accessor = parser\n      .getDependency('accessor', primitiveDef.indices)\n      .then(function (accessor) {\n        geometry.setIndex(accessor);\n      });\n\n    pending.push(accessor);\n  }\n\n  assignExtrasToUserData(geometry, primitiveDef);\n\n  computeBounds(geometry, primitiveDef, parser);\n\n  return Promise.all(pending).then(function () {\n    return primitiveDef.targets !== undefined\n      ? addMorphTargets(geometry, primitiveDef.targets, parser)\n      : geometry;\n  });\n}\n\nexport { GLTFLoader };\n", "/* eslint-disable */\nimport {\n  Color,\n  DoubleSide,\n  Matrix4,\n  MeshBasicMaterial,\n} from '../../node_modules/three/src/Three.js';\n\n/**\n * https://github.com/gkjohnson/collada-exporter-js\n *\n * Usage:\n *  const exporter = new ColladaExporter();\n *\n *  const data = exporter.parse(mesh);\n *\n * Format Definition:\n *  https://www.khronos.org/collada/\n */\n\nclass ColladaExporter {\n  parse(object, onDone, options = {}) {\n    options = Object.assign(\n      {\n        version: '1.4.1',\n        author: null,\n        textureDirectory: '',\n        upAxis: 'Y_UP',\n        unitName: null,\n        unitMeter: null,\n      },\n      options,\n    );\n\n    if (options.upAxis.match(/^[XYZ]_UP$/) === null) {\n      console.error('ColladaExporter: Invalid upAxis: valid values are X_UP, Y_UP or Z_UP.');\n      return null;\n    }\n\n    if (options.unitName !== null && options.unitMeter === null) {\n      console.error('ColladaExporter: unitMeter needs to be specified if unitName is specified.');\n      return null;\n    }\n\n    if (options.unitMeter !== null && options.unitName === null) {\n      console.error('ColladaExporter: unitName needs to be specified if unitMeter is specified.');\n      return null;\n    }\n\n    if (options.textureDirectory !== '') {\n      options.textureDirectory = `${options.textureDirectory}/`\n        .replace(/\\\\/g, '/')\n        .replace(/\\/+/g, '/');\n    }\n\n    const version = options.version;\n\n    if (version !== '1.4.1' && version !== '1.5.0') {\n      console.warn(\n        `ColladaExporter : Version ${version} not supported for export. Only 1.4.1 and 1.5.0.`,\n      );\n      return null;\n    }\n\n    // Convert the urdf xml into a well-formatted, indented format\n    function format(urdf) {\n      const IS_END_TAG = /^<\\//;\n      const IS_SELF_CLOSING = /(\\?>$)|(\\/>$)/;\n      const HAS_TEXT = /<[^>]+>[^<]*<\\/[^<]+>/;\n\n      const pad = (ch, num) => (num > 0 ? ch + pad(ch, num - 1) : '');\n\n      let tagnum = 0;\n\n      return urdf\n        .match(/(<[^>]+>[^<]+<\\/[^<]+>)|(<[^>]+>)/g)\n        .map((tag) => {\n          if (!HAS_TEXT.test(tag) && !IS_SELF_CLOSING.test(tag) && IS_END_TAG.test(tag)) {\n            tagnum--;\n          }\n\n          const res = `${pad('  ', tagnum)}${tag}`;\n\n          if (!HAS_TEXT.test(tag) && !IS_SELF_CLOSING.test(tag) && !IS_END_TAG.test(tag)) {\n            tagnum++;\n          }\n\n          return res;\n        })\n        .join('\\n');\n    }\n\n    // Convert an image into a png format for saving\n    function base64ToBuffer(str) {\n      const b = atob(str);\n      const buf = new Uint8Array(b.length);\n\n      for (let i = 0, l = buf.length; i < l; i++) {\n        buf[i] = b.charCodeAt(i);\n      }\n\n      return buf;\n    }\n\n    let canvas, ctx;\n\n    function imageToData(image, ext) {\n      canvas = canvas || document.createElement('canvas');\n      ctx = ctx || canvas.getContext('2d');\n\n      canvas.width = image.width;\n      canvas.height = image.height;\n\n      ctx.drawImage(image, 0, 0);\n\n      // Get the base64 encoded data\n      const base64data = canvas\n        .toDataURL(`image/${ext}`, 1)\n        .replace(/^data:image\\/(png|jpg);base64,/, '');\n\n      // Convert to a uint8 array\n      return base64ToBuffer(base64data);\n    }\n\n    // gets the attribute array. Generate a new array if the attribute is interleaved\n    const getFuncs = ['getX', 'getY', 'getZ', 'getW'];\n    const tempColor = new Color();\n\n    function attrBufferToArray(attr, isColor = false) {\n      if (isColor) {\n        // convert the colors to srgb before export\n        // colors are always written as floats\n        const arr = new Float32Array(attr.count * 3);\n        for (let i = 0, l = attr.count; i < l; i++) {\n          tempColor.fromBufferAttribute(attr, i).convertLinearToSRGB();\n\n          arr[3 * i + 0] = tempColor.r;\n          arr[3 * i + 1] = tempColor.g;\n          arr[3 * i + 2] = tempColor.b;\n        }\n\n        return arr;\n      } else if (attr.isInterleavedBufferAttribute) {\n        // use the typed array constructor to save on memory\n        const arr = new attr.array.constructor(attr.count * attr.itemSize);\n        const size = attr.itemSize;\n\n        for (let i = 0, l = attr.count; i < l; i++) {\n          for (let j = 0; j < size; j++) {\n            arr[i * size + j] = attr[getFuncs[j]](i);\n          }\n        }\n\n        return arr;\n      } else {\n        return attr.array;\n      }\n    }\n\n    // Returns an array of the same type starting at the `st` index,\n    // and `ct` length\n    function subArray(arr, st, ct) {\n      if (Array.isArray(arr)) return arr.slice(st, st + ct);\n      else return new arr.constructor(arr.buffer, st * arr.BYTES_PER_ELEMENT, ct);\n    }\n\n    // Returns the string for a geometry's attribute\n    function getAttribute(attr, name, params, type, isColor = false) {\n      const array = attrBufferToArray(attr, isColor);\n      const res =\n        `<source id=\"${name}\">` +\n        `<float_array id=\"${name}-array\" count=\"${array.length}\">` +\n        array.join(' ') +\n        '</float_array>' +\n        '<technique_common>' +\n        `<accessor source=\"#${name}-array\" count=\"${Math.floor(\n          array.length / attr.itemSize,\n        )}\" stride=\"${attr.itemSize}\">` +\n        params.map((n) => `<param name=\"${n}\" type=\"${type}\" />`).join('') +\n        '</accessor>' +\n        '</technique_common>' +\n        '</source>';\n\n      return res;\n    }\n\n    // Returns the string for a node's transform information\n    let transMat;\n    function getTransform(o) {\n      // ensure the object's matrix is up to date\n      // before saving the transform\n      o.updateMatrix();\n\n      transMat = transMat || new Matrix4();\n      transMat.copy(o.matrix);\n      transMat.transpose();\n      return `<matrix>${transMat.toArray().join(' ')}</matrix>`;\n    }\n\n    // Process the given piece of geometry into the geometry library\n    // Returns the mesh id\n    function processGeometry(g) {\n      let info = geometryInfo.get(g);\n\n      if (!info) {\n        // convert the geometry to bufferGeometry if it isn't already\n        const bufferGeometry = g;\n\n        if (bufferGeometry.isBufferGeometry !== true) {\n          throw new Error('THREE.ColladaExporter: Geometry is not of type THREE.BufferGeometry.');\n        }\n\n        const meshid = `Mesh${libraryGeometries.length + 1}`;\n\n        const indexCount = bufferGeometry.index\n          ? bufferGeometry.index.count * bufferGeometry.index.itemSize\n          : bufferGeometry.attributes.position.count;\n\n        const groups =\n          bufferGeometry.groups != null && bufferGeometry.groups.length !== 0\n            ? bufferGeometry.groups\n            : [{ start: 0, count: indexCount, materialIndex: 0 }];\n\n        const gname = g.name ? ` name=\"${g.name}\"` : '';\n        let gnode = `<geometry id=\"${meshid}\"${gname}><mesh>`;\n\n        // define the geometry node and the vertices for the geometry\n        const posName = `${meshid}-position`;\n        const vertName = `${meshid}-vertices`;\n        gnode += getAttribute(\n          bufferGeometry.attributes.position,\n          posName,\n          ['X', 'Y', 'Z'],\n          'float',\n        );\n        gnode += `<vertices id=\"${vertName}\"><input semantic=\"POSITION\" source=\"#${posName}\" /></vertices>`;\n\n        // NOTE: We're not optimizing the attribute arrays here, so they're all the same length and\n        // can therefore share the same triangle indices. However, MeshLab seems to have trouble opening\n        // models with attributes that share an offset.\n        // MeshLab Bug#424: https://sourceforge.net/p/meshlab/bugs/424/\n\n        // serialize normals\n        let triangleInputs = `<input semantic=\"VERTEX\" source=\"#${vertName}\" offset=\"0\" />`;\n        if ('normal' in bufferGeometry.attributes) {\n          const normName = `${meshid}-normal`;\n          gnode += getAttribute(\n            bufferGeometry.attributes.normal,\n            normName,\n            ['X', 'Y', 'Z'],\n            'float',\n          );\n          triangleInputs += `<input semantic=\"NORMAL\" source=\"#${normName}\" offset=\"0\" />`;\n        }\n\n        // serialize uvs\n        if ('uv' in bufferGeometry.attributes) {\n          const uvName = `${meshid}-texcoord`;\n          gnode += getAttribute(bufferGeometry.attributes.uv, uvName, ['S', 'T'], 'float');\n          triangleInputs += `<input semantic=\"TEXCOORD\" source=\"#${uvName}\" offset=\"0\" set=\"0\" />`;\n        }\n\n        // serialize lightmap uvs\n        if ('uv2' in bufferGeometry.attributes) {\n          const uvName = `${meshid}-texcoord2`;\n          gnode += getAttribute(bufferGeometry.attributes.uv2, uvName, ['S', 'T'], 'float');\n          triangleInputs += `<input semantic=\"TEXCOORD\" source=\"#${uvName}\" offset=\"0\" set=\"1\" />`;\n        }\n\n        // serialize colors\n        if ('color' in bufferGeometry.attributes) {\n          // colors are always written as floats\n          const colName = `${meshid}-color`;\n          gnode += getAttribute(\n            bufferGeometry.attributes.color,\n            colName,\n            ['R', 'G', 'B'],\n            'float',\n            true,\n          );\n          triangleInputs += `<input semantic=\"COLOR\" source=\"#${colName}\" offset=\"0\" />`;\n        }\n\n        let indexArray = null;\n        if (bufferGeometry.index) {\n          indexArray = attrBufferToArray(bufferGeometry.index);\n        } else {\n          indexArray = new Array(indexCount);\n          for (let i = 0, l = indexArray.length; i < l; i++) indexArray[i] = i;\n        }\n\n        for (let i = 0, l = groups.length; i < l; i++) {\n          const group = groups[i];\n          const subarr = subArray(indexArray, group.start, group.count);\n          const polycount = subarr.length / 3;\n          gnode += `<triangles material=\"MESH_MATERIAL_${group.materialIndex}\" count=\"${polycount}\">`;\n          gnode += triangleInputs;\n\n          gnode += `<p>${subarr.join(' ')}</p>`;\n          gnode += '</triangles>';\n        }\n\n        gnode += '</mesh></geometry>';\n\n        libraryGeometries.push(gnode);\n\n        info = { meshid: meshid, bufferGeometry: bufferGeometry };\n        geometryInfo.set(g, info);\n      }\n\n      return info;\n    }\n\n    // Process the given texture into the image library\n    // Returns the image library\n    function processTexture(tex) {\n      let texid = imageMap.get(tex);\n      if (texid == null) {\n        texid = `image-${libraryImages.length + 1}`;\n\n        const ext = 'png';\n        const name = tex.name || texid;\n        let imageNode = `<image id=\"${texid}\" name=\"${name}\">`;\n\n        if (version === '1.5.0') {\n          imageNode += `<init_from><ref>${options.textureDirectory}${name}.${ext}</ref></init_from>`;\n        } else {\n          // version image node 1.4.1\n          imageNode += `<init_from>${options.textureDirectory}${name}.${ext}</init_from>`;\n        }\n\n        imageNode += '</image>';\n\n        libraryImages.push(imageNode);\n        imageMap.set(tex, texid);\n        textures.push({\n          directory: options.textureDirectory,\n          name,\n          ext,\n          data: imageToData(tex.image, ext),\n          original: tex,\n        });\n      }\n\n      return texid;\n    }\n\n    // Process the given material into the material and effect libraries\n    // Returns the material id\n    function processMaterial(m) {\n      let matid = materialMap.get(m);\n\n      if (matid == null) {\n        matid = `Mat${libraryEffects.length + 1}`;\n\n        let type = 'phong';\n\n        if (m.isMeshLambertMaterial === true) {\n          type = 'lambert';\n        } else if (m.isMeshBasicMaterial === true) {\n          type = 'constant';\n\n          if (m.map !== null) {\n            // The Collada spec does not support diffuse texture maps with the\n            // constant shader type.\n            // mrdoob/three.js#15469\n            console.warn('ColladaExporter: Texture maps not supported with MeshBasicMaterial.');\n          }\n        }\n\n        const emissive = m.emissive ? m.emissive : new Color(0, 0, 0);\n        const diffuse = m.color ? m.color : new Color(0, 0, 0);\n        const specular = m.specular ? m.specular : new Color(1, 1, 1);\n        const shininess = m.shininess || 0;\n        const reflectivity = m.reflectivity || 0;\n\n        emissive.convertLinearToSRGB();\n        specular.convertLinearToSRGB();\n        diffuse.convertLinearToSRGB();\n\n        // Do not export and alpha map for the reasons mentioned in issue (#13792)\n        // in three.js alpha maps are black and white, but collada expects the alpha\n        // channel to specify the transparency\n        let transparencyNode = '';\n        if (m.transparent === true) {\n          transparencyNode +=\n            '<transparent>' +\n            (m.map ? '<texture texture=\"diffuse-sampler\"></texture>' : '<float>1</float>') +\n            '</transparent>';\n\n          if (m.opacity < 1) {\n            transparencyNode += `<transparency><float>${m.opacity}</float></transparency>`;\n          }\n        }\n\n        const techniqueNode =\n          `<technique sid=\"common\"><${type}>` +\n          '<emission>' +\n          (m.emissiveMap\n            ? '<texture texture=\"emissive-sampler\" texcoord=\"TEXCOORD\" />'\n            : `<color sid=\"emission\">${emissive.r} ${emissive.g} ${emissive.b} 1</color>`) +\n          '</emission>' +\n          (type !== 'constant'\n            ? '<diffuse>' +\n              (m.map\n                ? '<texture texture=\"diffuse-sampler\" texcoord=\"TEXCOORD\" />'\n                : `<color sid=\"diffuse\">${diffuse.r} ${diffuse.g} ${diffuse.b} 1</color>`) +\n              '</diffuse>'\n            : '') +\n          (type !== 'constant'\n            ? '<bump>' +\n              (m.normalMap ? '<texture texture=\"bump-sampler\" texcoord=\"TEXCOORD\" />' : '') +\n              '</bump>'\n            : '') +\n          (type === 'phong'\n            ? `<specular><color sid=\"specular\">${specular.r} ${specular.g} ${specular.b} 1</color></specular>` +\n              '<shininess>' +\n              (m.specularMap\n                ? '<texture texture=\"specular-sampler\" texcoord=\"TEXCOORD\" />'\n                : `<float sid=\"shininess\">${shininess}</float>`) +\n              '</shininess>'\n            : '') +\n          `<reflective><color>${diffuse.r} ${diffuse.g} ${diffuse.b} 1</color></reflective>` +\n          `<reflectivity><float>${reflectivity}</float></reflectivity>` +\n          transparencyNode +\n          `</${type}></technique>`;\n\n        const effectnode =\n          `<effect id=\"${matid}-effect\">` +\n          '<profile_COMMON>' +\n          (m.map\n            ? '<newparam sid=\"diffuse-surface\"><surface type=\"2D\">' +\n              `<init_from>${processTexture(m.map)}</init_from>` +\n              '</surface></newparam>' +\n              '<newparam sid=\"diffuse-sampler\"><sampler2D><source>diffuse-surface</source></sampler2D></newparam>'\n            : '') +\n          (m.specularMap\n            ? '<newparam sid=\"specular-surface\"><surface type=\"2D\">' +\n              `<init_from>${processTexture(m.specularMap)}</init_from>` +\n              '</surface></newparam>' +\n              '<newparam sid=\"specular-sampler\"><sampler2D><source>specular-surface</source></sampler2D></newparam>'\n            : '') +\n          (m.emissiveMap\n            ? '<newparam sid=\"emissive-surface\"><surface type=\"2D\">' +\n              `<init_from>${processTexture(m.emissiveMap)}</init_from>` +\n              '</surface></newparam>' +\n              '<newparam sid=\"emissive-sampler\"><sampler2D><source>emissive-surface</source></sampler2D></newparam>'\n            : '') +\n          (m.normalMap\n            ? '<newparam sid=\"bump-surface\"><surface type=\"2D\">' +\n              `<init_from>${processTexture(m.normalMap)}</init_from>` +\n              '</surface></newparam>' +\n              '<newparam sid=\"bump-sampler\"><sampler2D><source>bump-surface</source></sampler2D></newparam>'\n            : '') +\n          techniqueNode +\n          (m.side === DoubleSide\n            ? '<extra><technique profile=\"THREEJS\"><double_sided sid=\"double_sided\" type=\"int\">1</double_sided></technique></extra>'\n            : '') +\n          '</profile_COMMON>' +\n          '</effect>';\n\n        const materialName = m.name ? ` name=\"${m.name}\"` : '';\n        const materialNode = `<material id=\"${matid}\"${materialName}><instance_effect url=\"#${matid}-effect\" /></material>`;\n\n        libraryMaterials.push(materialNode);\n        libraryEffects.push(effectnode);\n        materialMap.set(m, matid);\n      }\n\n      return matid;\n    }\n\n    // Recursively process the object into a scene\n    function processObject(o) {\n      let node = `<node name=\"${o.name}\">`;\n\n      node += getTransform(o);\n\n      if (o.isMesh === true && o.geometry !== null) {\n        // function returns the id associated with the mesh and a \"BufferGeometry\" version\n        // of the geometry in case it's not a geometry.\n        const geomInfo = processGeometry(o.geometry);\n        const meshid = geomInfo.meshid;\n        const geometry = geomInfo.bufferGeometry;\n\n        // ids of the materials to bind to the geometry\n        let matids = null;\n        let matidsArray;\n\n        // get a list of materials to bind to the sub groups of the geometry.\n        // If the amount of subgroups is greater than the materials, than reuse\n        // the materials.\n        const mat = o.material || new MeshBasicMaterial();\n        const materials = Array.isArray(mat) ? mat : [mat];\n\n        if (geometry.groups.length > materials.length) {\n          matidsArray = new Array(geometry.groups.length);\n        } else {\n          matidsArray = new Array(materials.length);\n        }\n\n        matids = matidsArray.fill().map((v, i) => processMaterial(materials[i % materials.length]));\n\n        node +=\n          `<instance_geometry url=\"#${meshid}\">` +\n          (matids.length > 0\n            ? '<bind_material><technique_common>' +\n              matids\n                .map(\n                  (id, i) =>\n                    `<instance_material symbol=\"MESH_MATERIAL_${i}\" target=\"#${id}\" >` +\n                    '<bind_vertex_input semantic=\"TEXCOORD\" input_semantic=\"TEXCOORD\" input_set=\"0\" />' +\n                    '</instance_material>',\n                )\n                .join('') +\n              '</technique_common></bind_material>'\n            : '') +\n          '</instance_geometry>';\n      }\n\n      o.children.forEach((c) => (node += processObject(c)));\n\n      node += '</node>';\n\n      return node;\n    }\n\n    const geometryInfo = new WeakMap();\n    const materialMap = new WeakMap();\n    const imageMap = new WeakMap();\n    const textures = [];\n\n    const libraryImages = [];\n    const libraryGeometries = [];\n    const libraryEffects = [];\n    const libraryMaterials = [];\n    const libraryVisualScenes = processObject(object);\n\n    const specLink =\n      version === '1.4.1'\n        ? 'http://www.collada.org/2005/11/COLLADASchema'\n        : 'https://www.khronos.org/collada/';\n    let dae =\n      '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>' +\n      `<COLLADA xmlns=\"${specLink}\" version=\"${version}\">` +\n      '<asset>' +\n      ('<contributor>' +\n        '<authoring_tool>three.js Collada Exporter</authoring_tool>' +\n        (options.author !== null ? `<author>${options.author}</author>` : '') +\n        '</contributor>' +\n        `<created>${new Date().toISOString()}</created>` +\n        `<modified>${new Date().toISOString()}</modified>` +\n        (options.unitName !== null\n          ? `<unit name=\"${options.unitName}\" meter=\"${options.unitMeter}\" />`\n          : '') +\n        `<up_axis>${options.upAxis}</up_axis>`) +\n      '</asset>';\n\n    dae += `<library_images>${libraryImages.join('')}</library_images>`;\n\n    dae += `<library_effects>${libraryEffects.join('')}</library_effects>`;\n\n    dae += `<library_materials>${libraryMaterials.join('')}</library_materials>`;\n\n    dae += `<library_geometries>${libraryGeometries.join('')}</library_geometries>`;\n\n    dae += `<library_visual_scenes><visual_scene id=\"Scene\" name=\"scene\">${libraryVisualScenes}</visual_scene></library_visual_scenes>`;\n\n    dae += '<scene><instance_visual_scene url=\"#Scene\"/></scene>';\n\n    dae += '</COLLADA>';\n\n    const res = {\n      data: format(dae),\n      textures,\n    };\n\n    if (typeof onDone === 'function') {\n      requestAnimationFrame(() => onDone(res));\n    }\n\n    return res;\n  }\n}\n\nexport { ColladaExporter };\n", "/**\n * @author Tim Knip / http://www.floorplanner.com/ / tim at floorplanner.com\n * @author Tony Parisi / http://www.tonyparisi.com/\n */\n/* eslint-disable */\nexport const ColladaLoader = function () {\n  var COLLADA = null;\n  var scene = null;\n  var visualScene;\n  var kinematicsModel;\n\n  var readyCallbackFunc = null;\n\n  var sources = {};\n  var images = {};\n  var animations = {};\n  var controllers = {};\n  var geometries = {};\n  var materials = {};\n  var effects = {};\n  var cameras = {};\n  var lights = {};\n\n  var animData;\n  var kinematics;\n  var visualScenes;\n  var kinematicsModels;\n  var baseUrl;\n  var morphs;\n  var skins;\n  var loader;\n\n  var flip_uv = true;\n  var preferredShading = THREE.SmoothShading;\n\n  var options = {\n    // Force Geometry to always be centered at the local origin of the\n    // containing Mesh.\n    centerGeometry: false,\n\n    // Axis conversion is done for geometries, animations, and controllers.\n    // If we ever pull cameras or lights out of the COLLADA file, they'll\n    // need extra work.\n    convertUpAxis: false,\n\n    subdivideFaces: true,\n\n    upAxis: 'Y',\n\n    // For reflective or refractive materials we'll use this cubemap\n    defaultEnvMap: null,\n  };\n\n  var colladaUnit = 1.0;\n  var colladaUp = 'Y';\n  var upConversion = null;\n\n  function load(url, readyCallback, progressCallback, failCallback) {\n    readyCallbackFunc = readyCallback;\n    var xmlParser = new DOMParser();\n    var responseXML = xmlParser.parseFromString(url, 'application/xml');\n    parse(responseXML, undefined, url);\n  }\n\n  function parse(doc, callBack, url) {\n    COLLADA = doc;\n    callBack = callBack || readyCallbackFunc;\n\n    if (url !== undefined) {\n      var parts = url.split('/');\n      parts.pop();\n      baseUrl = (parts.length < 1 ? '.' : parts.join('/')) + '/';\n    }\n\n    parseAsset();\n    setUpConversion();\n    images = parseLib('library_images image', _Image, 'image');\n    materials = parseLib('library_materials material', Material, 'material');\n    effects = parseLib('library_effects effect', Effect, 'effect');\n    geometries = parseLib('library_geometries geometry', Geometry, 'geometry');\n    cameras = parseLib('library_cameras camera', Camera, 'camera');\n    lights = parseLib('library_lights light', Light, 'light');\n    controllers = parseLib('library_controllers controller', Controller, 'controller');\n    animations = parseLib('library_animations animation', Animation, 'animation');\n    visualScenes = parseLib('library_visual_scenes visual_scene', VisualScene, 'visual_scene');\n    kinematicsModels = parseLib(\n      'library_kinematics_models kinematics_model',\n      KinematicsModel,\n      'kinematics_model',\n    );\n\n    morphs = [];\n    skins = [];\n\n    visualScene = parseScene();\n    scene = new THREE.Group();\n\n    for (var i = 0; i < visualScene.nodes.length; i++) {\n      scene.add(createSceneGraph(visualScene.nodes[i]));\n    }\n\n    // unit conversion\n    scene.scale.multiplyScalar(colladaUnit);\n\n    createAnimations();\n\n    kinematicsModel = parseKinematicsModel();\n    createKinematics();\n\n    var result = {\n      scene: scene,\n      morphs: morphs,\n      skins: skins,\n      animations: animData,\n      kinematics: kinematics,\n      dae: {\n        images: images,\n        materials: materials,\n        cameras: cameras,\n        lights: lights,\n        effects: effects,\n        geometries: geometries,\n        controllers: controllers,\n        animations: animations,\n        visualScenes: visualScenes,\n        visualScene: visualScene,\n        scene: visualScene,\n        kinematicsModels: kinematicsModels,\n        kinematicsModel: kinematicsModel,\n      },\n    };\n\n    if (callBack) {\n      callBack(result);\n    }\n\n    return result;\n  }\n\n  function setPreferredShading(shading) {\n    preferredShading = shading;\n  }\n\n  function parseAsset() {\n    var elements = COLLADA.querySelectorAll('asset');\n\n    var element = elements[0];\n\n    if (element && element.childNodes) {\n      for (var i = 0; i < element.childNodes.length; i++) {\n        var child = element.childNodes[i];\n\n        switch (child.nodeName) {\n          case 'unit':\n            var meter = child.getAttribute('meter');\n\n            if (meter) {\n              colladaUnit = parseFloat(meter);\n            }\n\n            break;\n\n          case 'up_axis':\n            colladaUp = child.textContent.charAt(0);\n            break;\n        }\n      }\n    }\n  }\n\n  function parseLib(q, classSpec, prefix) {\n    var elements = COLLADA.querySelectorAll(q);\n\n    var lib = {};\n\n    var i = 0;\n\n    var elementsLength = elements.length;\n\n    for (var j = 0; j < elementsLength; j++) {\n      var element = elements[j];\n      var daeElement = new classSpec().parse(element);\n\n      if (!daeElement.id || daeElement.id.length === 0) daeElement.id = prefix + i++;\n      lib[daeElement.id] = daeElement;\n    }\n\n    return lib;\n  }\n\n  function parseScene() {\n    var sceneElement = COLLADA.querySelectorAll('scene instance_visual_scene')[0];\n\n    if (sceneElement) {\n      var url = sceneElement.getAttribute('url').replace(/^#/, '');\n      return visualScenes[url.length > 0 ? url : 'visual_scene0'];\n    } else {\n      return null;\n    }\n  }\n\n  function parseKinematicsModel() {\n    var kinematicsModelElement = COLLADA.querySelectorAll('instance_kinematics_model')[0];\n\n    if (kinematicsModelElement) {\n      var url = kinematicsModelElement.getAttribute('url').replace(/^#/, '');\n      return kinematicsModels[url.length > 0 ? url : 'kinematics_model0'];\n    } else {\n      return null;\n    }\n  }\n\n  function createAnimations() {\n    animData = [];\n\n    // fill in the keys\n    recurseHierarchy(scene);\n  }\n\n  function recurseHierarchy(node) {\n    var n = visualScene.getChildById(node.colladaId, true),\n      newData = null;\n\n    if (n && n.keys) {\n      newData = {\n        fps: 60,\n        hierarchy: [\n          {\n            node: n,\n            keys: n.keys,\n            sids: n.sids,\n          },\n        ],\n        node: node,\n        name: 'animation_' + node.name,\n        length: 0,\n      };\n\n      animData.push(newData);\n\n      for (var i = 0, il = n.keys.length; i < il; i++) {\n        newData.length = Math.max(newData.length, n.keys[i].time);\n      }\n    } else {\n      newData = {\n        hierarchy: [\n          {\n            keys: [],\n            sids: [],\n          },\n        ],\n      };\n    }\n\n    for (var i = 0, il = node.children.length; i < il; i++) {\n      var d = recurseHierarchy(node.children[i]);\n\n      for (var j = 0, jl = d.hierarchy.length; j < jl; j++) {\n        newData.hierarchy.push({\n          keys: [],\n          sids: [],\n        });\n      }\n    }\n\n    return newData;\n  }\n\n  function calcAnimationBounds() {\n    var start = 1000000;\n    var end = -start;\n    var frames = 0;\n    var ID;\n    for (var id in animations) {\n      var animation = animations[id];\n      ID = ID || animation.id;\n      for (var i = 0; i < animation.sampler.length; i++) {\n        var sampler = animation.sampler[i];\n\n        sampler.create();\n\n        start = Math.min(start, sampler.startTime);\n        end = Math.max(end, sampler.endTime);\n        frames = Math.max(frames, sampler.input.length);\n      }\n    }\n\n    return { start: start, end: end, frames: frames, ID: ID };\n  }\n\n  function createMorph(geometry, ctrl) {\n    var morphCtrl = ctrl instanceof InstanceController ? controllers[ctrl.url] : ctrl;\n\n    if (!morphCtrl || !morphCtrl.morph) {\n      console.log('could not find morph controller!');\n      return;\n    }\n\n    var morph = morphCtrl.morph;\n\n    for (var i = 0; i < morph.targets.length; i++) {\n      var target_id = morph.targets[i];\n      var daeGeometry = geometries[target_id];\n\n      if (\n        !daeGeometry.mesh ||\n        !daeGeometry.mesh.primitives ||\n        !daeGeometry.mesh.primitives.length\n      ) {\n        continue;\n      }\n\n      var target = daeGeometry.mesh.primitives[0].geometry;\n\n      if (target.vertices.length === geometry.vertices.length) {\n        geometry.morphTargets.push({ name: 'target_1', vertices: target.vertices });\n      }\n    }\n\n    geometry.morphTargets.push({ name: 'target_Z', vertices: geometry.vertices });\n  }\n\n  function createSkin(geometry, ctrl, applyBindShape) {\n    var skinCtrl = controllers[ctrl.url];\n\n    if (!skinCtrl || !skinCtrl.skin) {\n      console.log('could not find skin controller!');\n      return;\n    }\n\n    if (!ctrl.skeleton || !ctrl.skeleton.length) {\n      console.log('could not find the skeleton for the skin!');\n      return;\n    }\n\n    var skin = skinCtrl.skin;\n    var skeleton = visualScene.getChildById(ctrl.skeleton[0]);\n    var hierarchy = [];\n\n    applyBindShape = applyBindShape !== undefined ? applyBindShape : true;\n\n    var bones = [];\n    geometry.skinWeights = [];\n    geometry.skinIndices = [];\n\n    //createBones( geometry.bones, skin, hierarchy, skeleton, null, -1 );\n    //createWeights( skin, geometry.bones, geometry.skinIndices, geometry.skinWeights );\n\n    /*\n\t\tgeometry.animation = {\n\t\t\tname: 'take_001',\n\t\t\tfps: 30,\n\t\t\tlength: 2,\n\t\t\tJIT: true,\n\t\t\thierarchy: hierarchy\n\t\t};\n\t\t*/\n\n    if (applyBindShape) {\n      for (var i = 0; i < geometry.vertices.length; i++) {\n        geometry.vertices[i].applyMatrix4(skin.bindShapeMatrix);\n      }\n    }\n  }\n\n  function setupSkeleton(node, bones, frame, parent) {\n    node.world = node.world || new THREE.Matrix4();\n    node.localworld = node.localworld || new THREE.Matrix4();\n    node.world.copy(node.matrix);\n    node.localworld.copy(node.matrix);\n\n    if (node.channels && node.channels.length) {\n      var channel = node.channels[0];\n      var m = channel.sampler.output[frame];\n\n      if (m instanceof THREE.Matrix4) {\n        node.world.copy(m);\n        node.localworld.copy(m);\n        if (frame === 0) node.matrix.copy(m);\n      }\n    }\n\n    if (parent) {\n      node.world.multiplyMatrices(parent, node.world);\n    }\n\n    bones.push(node);\n\n    for (var i = 0; i < node.nodes.length; i++) {\n      setupSkeleton(node.nodes[i], bones, frame, node.world);\n    }\n  }\n\n  function setupSkinningMatrices(bones, skin) {\n    // FIXME: this is dumb...\n\n    for (var i = 0; i < bones.length; i++) {\n      var bone = bones[i];\n      var found = -1;\n\n      if (bone.type != 'JOINT') continue;\n\n      for (var j = 0; j < skin.joints.length; j++) {\n        if (bone.sid === skin.joints[j]) {\n          found = j;\n          break;\n        }\n      }\n\n      if (found >= 0) {\n        var inv = skin.invBindMatrices[found];\n\n        bone.invBindMatrix = inv;\n        bone.skinningMatrix = new THREE.Matrix4();\n        bone.skinningMatrix.multiplyMatrices(bone.world, inv); // (IBMi * JMi)\n        bone.animatrix = new THREE.Matrix4();\n\n        bone.animatrix.copy(bone.localworld);\n        bone.weights = [];\n\n        for (var j = 0; j < skin.weights.length; j++) {\n          for (var k = 0; k < skin.weights[j].length; k++) {\n            var w = skin.weights[j][k];\n\n            if (w.joint === found) {\n              bone.weights.push(w);\n            }\n          }\n        }\n      } else {\n        console.warn(\"ColladaLoader: Could not find joint '\" + bone.sid + \"'.\");\n\n        bone.skinningMatrix = new THREE.Matrix4();\n        bone.weights = [];\n      }\n    }\n  }\n\n  //Walk the Collada tree and flatten the bones into a list, extract the position, quat and scale from the matrix\n  function flattenSkeleton(skeleton) {\n    var list = [];\n    var walk = function (parentid, node, list) {\n      var bone = {};\n      bone.name = node.sid;\n      bone.parent = parentid;\n      bone.matrix = node.matrix;\n      var data = [new THREE.Vector3(), new THREE.Quaternion(), new THREE.Vector3()];\n      bone.matrix.decompose(data[0], data[1], data[2]);\n\n      bone.pos = [data[0].x, data[0].y, data[0].z];\n\n      bone.scl = [data[2].x, data[2].y, data[2].z];\n      bone.rotq = [data[1].x, data[1].y, data[1].z, data[1].w];\n      list.push(bone);\n\n      for (var i in node.nodes) {\n        walk(node.sid, node.nodes[i], list);\n      }\n    };\n\n    walk(-1, skeleton, list);\n    return list;\n  }\n\n  //Move the vertices into the pose that is proper for the start of the animation\n  function skinToBindPose(geometry, skeleton, skinController) {\n    var bones = [];\n    setupSkeleton(skeleton, bones, -1);\n    setupSkinningMatrices(bones, skinController.skin);\n    v = new THREE.Vector3();\n    var skinned = [];\n\n    for (var i = 0; i < geometry.vertices.length; i++) {\n      skinned.push(new THREE.Vector3());\n    }\n\n    for (i = 0; i < bones.length; i++) {\n      if (bones[i].type != 'JOINT') continue;\n\n      for (j = 0; j < bones[i].weights.length; j++) {\n        w = bones[i].weights[j];\n        vidx = w.index;\n        weight = w.weight;\n\n        o = geometry.vertices[vidx];\n        s = skinned[vidx];\n\n        v.x = o.x;\n        v.y = o.y;\n        v.z = o.z;\n\n        v.applyMatrix4(bones[i].skinningMatrix);\n\n        s.x += v.x * weight;\n        s.y += v.y * weight;\n        s.z += v.z * weight;\n      }\n    }\n\n    for (var i = 0; i < geometry.vertices.length; i++) {\n      geometry.vertices[i] = skinned[i];\n    }\n  }\n\n  function applySkin(geometry, instanceCtrl, frame) {\n    var skinController = controllers[instanceCtrl.url];\n\n    frame = frame !== undefined ? frame : 40;\n\n    if (!skinController || !skinController.skin) {\n      console.log('ColladaLoader: Could not find skin controller.');\n      return;\n    }\n\n    if (!instanceCtrl.skeleton || !instanceCtrl.skeleton.length) {\n      console.log('ColladaLoader: Could not find the skeleton for the skin. ');\n      return;\n    }\n\n    var animationBounds = calcAnimationBounds();\n    var skeleton =\n      visualScene.getChildById(instanceCtrl.skeleton[0], true) ||\n      visualScene.getChildBySid(instanceCtrl.skeleton[0], true);\n\n    //flatten the skeleton into a list of bones\n    var bonelist = flattenSkeleton(skeleton);\n    var joints = skinController.skin.joints;\n\n    //sort that list so that the order reflects the order in the joint list\n    var sortedbones = [];\n    for (var i = 0; i < joints.length; i++) {\n      for (var j = 0; j < bonelist.length; j++) {\n        if (bonelist[j].name === joints[i]) {\n          sortedbones[i] = bonelist[j];\n        }\n      }\n    }\n\n    //hook up the parents by index instead of name\n    for (var i = 0; i < sortedbones.length; i++) {\n      for (var j = 0; j < sortedbones.length; j++) {\n        if (sortedbones[i].parent === sortedbones[j].name) {\n          sortedbones[i].parent = j;\n        }\n      }\n    }\n\n    var i, j, w, vidx, weight;\n    var v = new THREE.Vector3(),\n      o,\n      s;\n\n    // move vertices to bind shape\n    for (i = 0; i < geometry.vertices.length; i++) {\n      geometry.vertices[i].applyMatrix4(skinController.skin.bindShapeMatrix);\n    }\n\n    var skinIndices = [];\n    var skinWeights = [];\n    var weights = skinController.skin.weights;\n\n    // hook up the skin weights\n    // TODO - this might be a good place to choose greatest 4 weights\n    for (var i = 0; i < weights.length; i++) {\n      var indicies = new THREE.Vector4(\n        weights[i][0] ? weights[i][0].joint : 0,\n        weights[i][1] ? weights[i][1].joint : 0,\n        weights[i][2] ? weights[i][2].joint : 0,\n        weights[i][3] ? weights[i][3].joint : 0,\n      );\n      var weight = new THREE.Vector4(\n        weights[i][0] ? weights[i][0].weight : 0,\n        weights[i][1] ? weights[i][1].weight : 0,\n        weights[i][2] ? weights[i][2].weight : 0,\n        weights[i][3] ? weights[i][3].weight : 0,\n      );\n\n      skinIndices.push(indicies);\n      skinWeights.push(weight);\n    }\n\n    geometry.skinIndices = skinIndices;\n    geometry.skinWeights = skinWeights;\n    geometry.bones = sortedbones;\n    // process animation, or simply pose the rig if no animation\n\n    //create an animation for the animated bones\n    //NOTE: this has no effect when using morphtargets\n    var animationdata = {\n      name: animationBounds.ID,\n      fps: 30,\n      length: animationBounds.frames / 30,\n      hierarchy: [],\n    };\n\n    for (var j = 0; j < sortedbones.length; j++) {\n      animationdata.hierarchy.push({\n        parent: sortedbones[j].parent,\n        name: sortedbones[j].name,\n        keys: [],\n      });\n    }\n\n    console.log('ColladaLoader:', animationBounds.ID + ' has ' + sortedbones.length + ' bones.');\n\n    skinToBindPose(geometry, skeleton, skinController);\n\n    for (frame = 0; frame < animationBounds.frames; frame++) {\n      var bones = [];\n      var skinned = [];\n      // process the frame and setup the rig with a fresh\n      // transform, possibly from the bone's animation channel(s)\n\n      setupSkeleton(skeleton, bones, frame);\n      setupSkinningMatrices(bones, skinController.skin);\n\n      for (var i = 0; i < bones.length; i++) {\n        for (var j = 0; j < animationdata.hierarchy.length; j++) {\n          if (animationdata.hierarchy[j].name === bones[i].sid) {\n            var key = {};\n            key.time = frame / 30;\n            key.matrix = bones[i].animatrix;\n\n            if (frame === 0) bones[i].matrix = key.matrix;\n\n            var data = [new THREE.Vector3(), new THREE.Quaternion(), new THREE.Vector3()];\n            key.matrix.decompose(data[0], data[1], data[2]);\n\n            key.pos = [data[0].x, data[0].y, data[0].z];\n\n            key.scl = [data[2].x, data[2].y, data[2].z];\n            key.rot = data[1];\n\n            animationdata.hierarchy[j].keys.push(key);\n          }\n        }\n      }\n\n      geometry.animation = animationdata;\n    }\n  }\n\n  function createKinematics() {\n    if (kinematicsModel && kinematicsModel.joints.length === 0) {\n      kinematics = undefined;\n      return;\n    }\n\n    var jointMap = {};\n\n    var _addToMap = function (jointIndex, parentVisualElement) {\n      var parentVisualElementId = parentVisualElement.getAttribute('id');\n      var colladaNode = visualScene.getChildById(parentVisualElementId, true);\n      var joint = kinematicsModel.joints[jointIndex];\n\n      scene.traverse(function (node) {\n        if (node.colladaId == parentVisualElementId) {\n          jointMap[jointIndex] = {\n            node: node,\n            transforms: colladaNode.transforms,\n            joint: joint,\n            position: joint.zeroPosition,\n          };\n        }\n      });\n    };\n\n    kinematics = {\n      joints: kinematicsModel && kinematicsModel.joints,\n\n      getJointValue: function (jointIndex) {\n        var jointData = jointMap[jointIndex];\n\n        if (jointData) {\n          return jointData.position;\n        } else {\n          console.log('getJointValue: joint ' + jointIndex + \" doesn't exist\");\n        }\n      },\n\n      setJointValue: function (jointIndex, value) {\n        var jointData = jointMap[jointIndex];\n\n        if (jointData) {\n          var joint = jointData.joint;\n\n          if (value > joint.limits.max || value < joint.limits.min) {\n            console.log(\n              'setJointValue: joint ' +\n                jointIndex +\n                ' value ' +\n                value +\n                ' outside of limits (min: ' +\n                joint.limits.min +\n                ', max: ' +\n                joint.limits.max +\n                ')',\n            );\n          } else if (joint.static) {\n            console.log('setJointValue: joint ' + jointIndex + ' is static');\n          } else {\n            var threejsNode = jointData.node;\n            var axis = joint.axis;\n            var transforms = jointData.transforms;\n\n            var matrix = new THREE.Matrix4();\n\n            for (i = 0; i < transforms.length; i++) {\n              var transform = transforms[i];\n\n              // kinda ghetto joint detection\n              if (transform.sid && transform.sid.indexOf('joint' + jointIndex) !== -1) {\n                // apply actual joint value here\n                switch (joint.type) {\n                  case 'revolute':\n                    matrix.multiply(m1.makeRotationAxis(axis, THREE.Math.degToRad(value)));\n                    break;\n\n                  case 'prismatic':\n                    matrix.multiply(\n                      m1.makeTranslation(axis.x * value, axis.y * value, axis.z * value),\n                    );\n                    break;\n\n                  default:\n                    console.warn('setJointValue: unknown joint type: ' + joint.type);\n                    break;\n                }\n              } else {\n                var m1 = new THREE.Matrix4();\n\n                switch (transform.type) {\n                  case 'matrix':\n                    matrix.multiply(transform.obj);\n\n                    break;\n\n                  case 'translate':\n                    matrix.multiply(\n                      m1.makeTranslation(transform.obj.x, transform.obj.y, transform.obj.z),\n                    );\n\n                    break;\n\n                  case 'rotate':\n                    matrix.multiply(m1.makeRotationAxis(transform.obj, transform.angle));\n\n                    break;\n                }\n              }\n            }\n\n            // apply the matrix to the threejs node\n            var elementsFloat32Arr = matrix.elements;\n            var elements = Array.prototype.slice.call(elementsFloat32Arr);\n\n            var elementsRowMajor = [\n              elements[0],\n              elements[4],\n              elements[8],\n              elements[12],\n              elements[1],\n              elements[5],\n              elements[9],\n              elements[13],\n              elements[2],\n              elements[6],\n              elements[10],\n              elements[14],\n              elements[3],\n              elements[7],\n              elements[11],\n              elements[15],\n            ];\n\n            threejsNode.matrix.set.apply(threejsNode.matrix, elementsRowMajor);\n            threejsNode.matrix.decompose(\n              threejsNode.position,\n              threejsNode.quaternion,\n              threejsNode.scale,\n            );\n          }\n        } else {\n          console.log('setJointValue: joint ' + jointIndex + \" doesn't exist\");\n        }\n      },\n    };\n\n    var element = COLLADA.querySelector('scene instance_kinematics_scene');\n\n    if (element) {\n      for (var i = 0; i < element.childNodes.length; i++) {\n        var child = element.childNodes[i];\n\n        if (child.nodeType != 1) continue;\n\n        switch (child.nodeName) {\n          case 'bind_joint_axis':\n            var visualTarget = child.getAttribute('target').split('/').pop();\n            var axis = child.querySelector('axis param').textContent;\n            var jointIndex = parseInt(axis.split('joint').pop().split('.')[0]);\n            var visualTargetElement = COLLADA.querySelector('[sid=\"' + visualTarget + '\"]');\n\n            if (visualTargetElement) {\n              var parentVisualElement = visualTargetElement.parentElement;\n              _addToMap(jointIndex, parentVisualElement);\n            }\n\n            break;\n\n          default:\n            break;\n        }\n      }\n    }\n  }\n\n  function createSceneGraph(node, parent) {\n    var obj = new THREE.Object3D();\n    var skinned = false;\n    var skinController;\n    var morphController;\n    var i, j;\n\n    // FIXME: controllers\n\n    for (i = 0; i < node.controllers.length; i++) {\n      var controller = controllers[node.controllers[i].url];\n\n      switch (controller.type) {\n        case 'skin':\n          if (geometries[controller.skin.source]) {\n            var inst_geom = new InstanceGeometry();\n\n            inst_geom.url = controller.skin.source;\n            inst_geom.instance_material = node.controllers[i].instance_material;\n\n            node.geometries.push(inst_geom);\n            skinned = true;\n            skinController = node.controllers[i];\n          } else if (controllers[controller.skin.source]) {\n            // urgh: controller can be chained\n            // handle the most basic case...\n\n            var second = controllers[controller.skin.source];\n            morphController = second;\n            //\tskinController = node.controllers[i];\n\n            if (second.morph && geometries[second.morph.source]) {\n              var inst_geom = new InstanceGeometry();\n\n              inst_geom.url = second.morph.source;\n              inst_geom.instance_material = node.controllers[i].instance_material;\n\n              node.geometries.push(inst_geom);\n            }\n          }\n\n          break;\n\n        case 'morph':\n          if (geometries[controller.morph.source]) {\n            var inst_geom = new InstanceGeometry();\n\n            inst_geom.url = controller.morph.source;\n            inst_geom.instance_material = node.controllers[i].instance_material;\n\n            node.geometries.push(inst_geom);\n            morphController = node.controllers[i];\n          }\n\n          console.log('ColladaLoader: Morph-controller partially supported.');\n\n        default:\n          break;\n      }\n    }\n\n    // geometries\n\n    var double_sided_materials = {};\n\n    for (i = 0; i < node.geometries.length; i++) {\n      var instance_geometry = node.geometries[i];\n      var instance_materials = instance_geometry.instance_material;\n      var geometry = geometries[instance_geometry.url];\n      var used_materials = {};\n      var used_materials_array = [];\n      var num_materials = 0;\n      var first_material;\n\n      if (geometry) {\n        if (!geometry.mesh || !geometry.mesh.primitives) continue;\n\n        if (obj.name.length === 0) {\n          obj.name = geometry.id;\n        }\n\n        // collect used fx for this geometry-instance\n\n        if (instance_materials) {\n          for (j = 0; j < instance_materials.length; j++) {\n            var instance_material = instance_materials[j];\n            var mat = materials[instance_material.target];\n            var effect_id = mat.instance_effect.url;\n            var shader = effects[effect_id].shader;\n            var material3js = shader.material;\n\n            if (geometry.doubleSided) {\n              if (!(instance_material.symbol in double_sided_materials)) {\n                var _copied_material = material3js.clone();\n                _copied_material.side = THREE.DoubleSide;\n                double_sided_materials[instance_material.symbol] = _copied_material;\n              }\n\n              material3js = double_sided_materials[instance_material.symbol];\n            }\n\n            material3js.opacity = !material3js.opacity ? 1 : material3js.opacity;\n            used_materials[instance_material.symbol] = num_materials;\n            used_materials_array.push(material3js);\n            first_material = material3js;\n            first_material.name = mat.name === null || mat.name === '' ? mat.id : mat.name;\n            num_materials++;\n          }\n        }\n\n        var mesh;\n        var material =\n          first_material ||\n          new THREE.MeshLambertMaterial({\n            color: 0xdddddd,\n            side: geometry.doubleSided ? THREE.DoubleSide : THREE.FrontSide,\n          });\n        var geom = geometry.mesh.geometry3js;\n\n        if (num_materials > 1) {\n          material = new THREE.MeshFaceMaterial(used_materials_array);\n\n          for (j = 0; j < geom.faces.length; j++) {\n            var face = geom.faces[j];\n            face.materialIndex = used_materials[face.daeMaterial];\n          }\n        }\n\n        if (skinController !== undefined) {\n          applySkin(geom, skinController);\n\n          if (geom.morphTargets.length > 0) {\n            material.morphTargets = true;\n            material.skinning = false;\n          } else {\n            material.morphTargets = false;\n            material.skinning = true;\n          }\n\n          mesh = new THREE.SkinnedMesh(geom, material, false);\n\n          //mesh.skeleton = skinController.skeleton;\n          //mesh.skinController = controllers[ skinController.url ];\n          //mesh.skinInstanceController = skinController;\n          mesh.name = 'skin_' + skins.length;\n\n          //mesh.animationHandle.setKey(0);\n          skins.push(mesh);\n        } else if (morphController !== undefined) {\n          createMorph(geom, morphController);\n\n          material.morphTargets = true;\n\n          mesh = new THREE.Mesh(geom, material);\n          mesh.name = 'morph_' + morphs.length;\n\n          morphs.push(mesh);\n        } else {\n          if (geom.isLineStrip === true) {\n            mesh = new THREE.Line(geom);\n          } else {\n            mesh = new THREE.Mesh(geom, material);\n          }\n        }\n\n        obj.add(mesh);\n      }\n    }\n\n    for (i = 0; i < node.cameras.length; i++) {\n      var instance_camera = node.cameras[i];\n      var cparams = cameras[instance_camera.url];\n\n      var cam = new THREE.PerspectiveCamera(\n        cparams.yfov,\n        parseFloat(cparams.aspect_ratio),\n        parseFloat(cparams.znear),\n        parseFloat(cparams.zfar),\n      );\n\n      obj.add(cam);\n    }\n\n    for (i = 0; i < node.lights.length; i++) {\n      var light = null;\n      var instance_light = node.lights[i];\n      var lparams = lights[instance_light.url];\n\n      if (lparams && lparams.technique) {\n        var color = lparams.color.getHex();\n        var intensity = lparams.intensity;\n        var distance = lparams.distance;\n        var angle = lparams.falloff_angle;\n        var exponent; // Intentionally undefined, don't know what this is yet\n\n        switch (lparams.technique) {\n          case 'directional':\n            light = new THREE.DirectionalLight(color, intensity, distance);\n            light.position.set(0, 0, 1);\n            break;\n\n          case 'point':\n            light = new THREE.PointLight(color, intensity, distance);\n            break;\n\n          case 'spot':\n            light = new THREE.SpotLight(color, intensity, distance, angle, exponent);\n            light.position.set(0, 0, 1);\n            break;\n\n          case 'ambient':\n            light = new THREE.AmbientLight(color);\n            break;\n        }\n      }\n\n      if (light) {\n        obj.add(light);\n      }\n    }\n\n    obj.name = node.name || node.id || '';\n    obj.colladaId = node.id || '';\n    obj.layer = node.layer || '';\n    obj.matrix = node.matrix;\n    obj.matrix.decompose(obj.position, obj.quaternion, obj.scale);\n\n    if (options.centerGeometry && obj.geometry) {\n      var delta = obj.geometry.center();\n      delta.multiply(obj.scale);\n      delta.applyQuaternion(obj.quaternion);\n\n      obj.position.sub(delta);\n    }\n\n    for (i = 0; i < node.nodes.length; i++) {\n      obj.add(createSceneGraph(node.nodes[i], node));\n    }\n\n    return obj;\n  }\n\n  function getJointId(skin, id) {\n    for (var i = 0; i < skin.joints.length; i++) {\n      if (skin.joints[i] === id) {\n        return i;\n      }\n    }\n  }\n\n  function getLibraryNode(id) {\n    var nodes = COLLADA.querySelectorAll('library_nodes node');\n\n    for (var i = 0; i < nodes.length; i++) {\n      var attObj = nodes[i].attributes.getNamedItem('id');\n\n      if (attObj && attObj.value === id) {\n        return nodes[i];\n      }\n    }\n\n    return undefined;\n  }\n\n  function getChannelsForNode(node) {\n    var channels = [];\n    var startTime = 1000000;\n    var endTime = -1000000;\n\n    for (var id in animations) {\n      var animation = animations[id];\n\n      for (var i = 0; i < animation.channel.length; i++) {\n        var channel = animation.channel[i];\n        var sampler = animation.sampler[i];\n        var id = channel.target.split('/')[0];\n\n        if (id == node.id) {\n          sampler.create();\n          channel.sampler = sampler;\n          startTime = Math.min(startTime, sampler.startTime);\n          endTime = Math.max(endTime, sampler.endTime);\n          channels.push(channel);\n        }\n      }\n    }\n\n    if (channels.length) {\n      node.startTime = startTime;\n      node.endTime = endTime;\n    }\n\n    return channels;\n  }\n\n  function calcFrameDuration(node) {\n    var minT = 10000000;\n\n    for (var i = 0; i < node.channels.length; i++) {\n      var sampler = node.channels[i].sampler;\n\n      for (var j = 0; j < sampler.input.length - 1; j++) {\n        var t0 = sampler.input[j];\n        var t1 = sampler.input[j + 1];\n        minT = Math.min(minT, t1 - t0);\n      }\n    }\n\n    return minT;\n  }\n\n  function calcMatrixAt(node, t) {\n    var animated = {};\n\n    var i, j;\n\n    for (i = 0; i < node.channels.length; i++) {\n      var channel = node.channels[i];\n      animated[channel.sid] = channel;\n    }\n\n    var matrix = new THREE.Matrix4();\n\n    for (i = 0; i < node.transforms.length; i++) {\n      var transform = node.transforms[i];\n      var channel = animated[transform.sid];\n\n      if (channel !== undefined) {\n        var sampler = channel.sampler;\n        var value;\n\n        for (j = 0; j < sampler.input.length - 1; j++) {\n          if (sampler.input[j + 1] > t) {\n            value = sampler.output[j];\n            //console.log(value.flatten)\n            break;\n          }\n        }\n\n        if (value !== undefined) {\n          if (value instanceof THREE.Matrix4) {\n            matrix.multiplyMatrices(matrix, value);\n          } else {\n            // FIXME: handle other types\n\n            matrix.multiplyMatrices(matrix, transform.matrix);\n          }\n        } else {\n          matrix.multiplyMatrices(matrix, transform.matrix);\n        }\n      } else {\n        matrix.multiplyMatrices(matrix, transform.matrix);\n      }\n    }\n\n    return matrix;\n  }\n\n  function bakeAnimations(node) {\n    if (node.channels && node.channels.length) {\n      var keys = [],\n        sids = [];\n\n      for (var i = 0, il = node.channels.length; i < il; i++) {\n        var channel = node.channels[i],\n          fullSid = channel.fullSid,\n          sampler = channel.sampler,\n          input = sampler.input,\n          transform = node.getTransformBySid(channel.sid),\n          member;\n\n        if (channel.arrIndices) {\n          member = [];\n\n          for (var j = 0, jl = channel.arrIndices.length; j < jl; j++) {\n            member[j] = getConvertedIndex(channel.arrIndices[j]);\n          }\n        } else {\n          member = getConvertedMember(channel.member);\n        }\n\n        if (transform) {\n          if (sids.indexOf(fullSid) === -1) {\n            sids.push(fullSid);\n          }\n\n          for (var j = 0, jl = input.length; j < jl; j++) {\n            var time = input[j],\n              data = sampler.getData(transform.type, j, member),\n              key = findKey(keys, time);\n\n            if (!key) {\n              key = new Key(time);\n              var timeNdx = findTimeNdx(keys, time);\n              keys.splice(timeNdx === -1 ? keys.length : timeNdx, 0, key);\n            }\n\n            key.addTarget(fullSid, transform, member, data);\n          }\n        } else {\n          console.log('Could not find transform \"' + channel.sid + '\" in node ' + node.id);\n        }\n      }\n\n      // post process\n      for (var i = 0; i < sids.length; i++) {\n        var sid = sids[i];\n\n        for (var j = 0; j < keys.length; j++) {\n          var key = keys[j];\n\n          if (!key.hasTarget(sid)) {\n            interpolateKeys(keys, key, j, sid);\n          }\n        }\n      }\n\n      node.keys = keys;\n      node.sids = sids;\n    }\n  }\n\n  function findKey(keys, time) {\n    var retVal = null;\n\n    for (var i = 0, il = keys.length; i < il && retVal === null; i++) {\n      var key = keys[i];\n\n      if (key.time === time) {\n        retVal = key;\n      } else if (key.time > time) {\n        break;\n      }\n    }\n\n    return retVal;\n  }\n\n  function findTimeNdx(keys, time) {\n    var ndx = -1;\n\n    for (var i = 0, il = keys.length; i < il && ndx === -1; i++) {\n      var key = keys[i];\n\n      if (key.time >= time) {\n        ndx = i;\n      }\n    }\n\n    return ndx;\n  }\n\n  function interpolateKeys(keys, key, ndx, fullSid) {\n    var prevKey = getPrevKeyWith(keys, fullSid, ndx ? ndx - 1 : 0),\n      nextKey = getNextKeyWith(keys, fullSid, ndx + 1);\n\n    if (prevKey && nextKey) {\n      var scale = (key.time - prevKey.time) / (nextKey.time - prevKey.time),\n        prevTarget = prevKey.getTarget(fullSid),\n        nextData = nextKey.getTarget(fullSid).data,\n        prevData = prevTarget.data,\n        data;\n\n      if (prevTarget.type === 'matrix') {\n        data = prevData;\n      } else if (prevData.length) {\n        data = [];\n\n        for (var i = 0; i < prevData.length; ++i) {\n          data[i] = prevData[i] + (nextData[i] - prevData[i]) * scale;\n        }\n      } else {\n        data = prevData + (nextData - prevData) * scale;\n      }\n\n      key.addTarget(fullSid, prevTarget.transform, prevTarget.member, data);\n    }\n  }\n\n  // Get next key with given sid\n\n  function getNextKeyWith(keys, fullSid, ndx) {\n    for (; ndx < keys.length; ndx++) {\n      var key = keys[ndx];\n\n      if (key.hasTarget(fullSid)) {\n        return key;\n      }\n    }\n\n    return null;\n  }\n\n  // Get previous key with given sid\n\n  function getPrevKeyWith(keys, fullSid, ndx) {\n    ndx = ndx >= 0 ? ndx : ndx + keys.length;\n\n    for (; ndx >= 0; ndx--) {\n      var key = keys[ndx];\n\n      if (key.hasTarget(fullSid)) {\n        return key;\n      }\n    }\n\n    return null;\n  }\n\n  function _Image() {\n    this.id = '';\n    this.init_from = '';\n  }\n\n  _Image.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n\n      if (child.nodeName === 'init_from') {\n        this.init_from = child.textContent;\n      }\n    }\n\n    return this;\n  };\n\n  function Controller() {\n    this.id = '';\n    this.name = '';\n    this.type = '';\n    this.skin = null;\n    this.morph = null;\n  }\n\n  Controller.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n    this.name = element.getAttribute('name');\n    this.type = 'none';\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n\n      switch (child.nodeName) {\n        case 'skin':\n          this.skin = new Skin().parse(child);\n          this.type = child.nodeName;\n          break;\n\n        case 'morph':\n          this.morph = new Morph().parse(child);\n          this.type = child.nodeName;\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function Morph() {\n    this.method = null;\n    this.source = null;\n    this.targets = null;\n    this.weights = null;\n  }\n\n  Morph.prototype.parse = function (element) {\n    var sources = {};\n    var inputs = [];\n    var i;\n\n    this.method = element.getAttribute('method');\n    this.source = element.getAttribute('source').replace(/^#/, '');\n\n    for (i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'source':\n          var source = new Source().parse(child);\n          sources[source.id] = source;\n          break;\n\n        case 'targets':\n          inputs = this.parseInputs(child);\n          break;\n\n        default:\n          console.log(child.nodeName);\n          break;\n      }\n    }\n\n    for (i = 0; i < inputs.length; i++) {\n      var input = inputs[i];\n      var source = sources[input.source];\n\n      switch (input.semantic) {\n        case 'MORPH_TARGET':\n          this.targets = source.read();\n          break;\n\n        case 'MORPH_WEIGHT':\n          this.weights = source.read();\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  Morph.prototype.parseInputs = function (element) {\n    var inputs = [];\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'input':\n          inputs.push(new Input().parse(child));\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return inputs;\n  };\n\n  function Skin() {\n    this.source = '';\n    this.bindShapeMatrix = null;\n    this.invBindMatrices = [];\n    this.joints = [];\n    this.weights = [];\n  }\n\n  Skin.prototype.parse = function (element) {\n    var sources = {};\n    var joints, weights;\n\n    this.source = element.getAttribute('source').replace(/^#/, '');\n    this.invBindMatrices = [];\n    this.joints = [];\n    this.weights = [];\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'bind_shape_matrix':\n          var f = _floats(child.textContent);\n          this.bindShapeMatrix = getConvertedMat4(f);\n          break;\n\n        case 'source':\n          var src = new Source().parse(child);\n          sources[src.id] = src;\n          break;\n\n        case 'joints':\n          joints = child;\n          break;\n\n        case 'vertex_weights':\n          weights = child;\n          break;\n\n        default:\n          console.log(child.nodeName);\n          break;\n      }\n    }\n\n    this.parseJoints(joints, sources);\n    this.parseWeights(weights, sources);\n\n    return this;\n  };\n\n  Skin.prototype.parseJoints = function (element, sources) {\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'input':\n          var input = new Input().parse(child);\n          var source = sources[input.source];\n\n          if (input.semantic === 'JOINT') {\n            this.joints = source.read();\n          } else if (input.semantic === 'INV_BIND_MATRIX') {\n            this.invBindMatrices = source.read();\n          }\n\n          break;\n\n        default:\n          break;\n      }\n    }\n  };\n\n  Skin.prototype.parseWeights = function (element, sources) {\n    var v,\n      vcount,\n      inputs = [];\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'input':\n          inputs.push(new Input().parse(child));\n          break;\n\n        case 'v':\n          v = _ints(child.textContent);\n          break;\n\n        case 'vcount':\n          vcount = _ints(child.textContent);\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    var index = 0;\n\n    for (var i = 0; i < vcount.length; i++) {\n      var numBones = vcount[i];\n      var vertex_weights = [];\n\n      for (var j = 0; j < numBones; j++) {\n        var influence = {};\n\n        for (var k = 0; k < inputs.length; k++) {\n          var input = inputs[k];\n          var value = v[index + input.offset];\n\n          switch (input.semantic) {\n            case 'JOINT':\n              influence.joint = value; //this.joints[value];\n              break;\n\n            case 'WEIGHT':\n              influence.weight = sources[input.source].data[value];\n              break;\n\n            default:\n              break;\n          }\n        }\n\n        vertex_weights.push(influence);\n        index += inputs.length;\n      }\n\n      for (var j = 0; j < vertex_weights.length; j++) {\n        vertex_weights[j].index = i;\n      }\n\n      this.weights.push(vertex_weights);\n    }\n  };\n\n  function VisualScene() {\n    this.id = '';\n    this.name = '';\n    this.nodes = [];\n    this.scene = new THREE.Group();\n  }\n\n  VisualScene.prototype.getChildById = function (id, recursive) {\n    for (var i = 0; i < this.nodes.length; i++) {\n      var node = this.nodes[i].getChildById(id, recursive);\n\n      if (node) {\n        return node;\n      }\n    }\n\n    return null;\n  };\n\n  VisualScene.prototype.getChildBySid = function (sid, recursive) {\n    for (var i = 0; i < this.nodes.length; i++) {\n      var node = this.nodes[i].getChildBySid(sid, recursive);\n\n      if (node) {\n        return node;\n      }\n    }\n\n    return null;\n  };\n\n  VisualScene.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n    this.name = element.getAttribute('name');\n    this.nodes = [];\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'node':\n          this.nodes.push(new Node().parse(child));\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function Node() {\n    this.id = '';\n    this.name = '';\n    this.sid = '';\n    this.nodes = [];\n    this.controllers = [];\n    this.transforms = [];\n    this.geometries = [];\n    this.channels = [];\n    this.matrix = new THREE.Matrix4();\n  }\n\n  Node.prototype.getChannelForTransform = function (transformSid) {\n    for (var i = 0; i < this.channels.length; i++) {\n      var channel = this.channels[i];\n      var parts = channel.target.split('/');\n      var id = parts.shift();\n      var sid = parts.shift();\n      var dotSyntax = sid.indexOf('.') >= 0;\n      var arrSyntax = sid.indexOf('(') >= 0;\n      var arrIndices;\n      var member;\n\n      if (dotSyntax) {\n        parts = sid.split('.');\n        sid = parts.shift();\n        member = parts.shift();\n      } else if (arrSyntax) {\n        arrIndices = sid.split('(');\n        sid = arrIndices.shift();\n\n        for (var j = 0; j < arrIndices.length; j++) {\n          arrIndices[j] = parseInt(arrIndices[j].replace(/\\)/, ''));\n        }\n      }\n\n      if (sid === transformSid) {\n        channel.info = {\n          sid: sid,\n          dotSyntax: dotSyntax,\n          arrSyntax: arrSyntax,\n          arrIndices: arrIndices,\n        };\n        return channel;\n      }\n    }\n\n    return null;\n  };\n\n  Node.prototype.getChildById = function (id, recursive) {\n    if (this.id === id) {\n      return this;\n    }\n\n    if (recursive) {\n      for (var i = 0; i < this.nodes.length; i++) {\n        var n = this.nodes[i].getChildById(id, recursive);\n\n        if (n) {\n          return n;\n        }\n      }\n    }\n\n    return null;\n  };\n\n  Node.prototype.getChildBySid = function (sid, recursive) {\n    if (this.sid === sid) {\n      return this;\n    }\n\n    if (recursive) {\n      for (var i = 0; i < this.nodes.length; i++) {\n        var n = this.nodes[i].getChildBySid(sid, recursive);\n\n        if (n) {\n          return n;\n        }\n      }\n    }\n\n    return null;\n  };\n\n  Node.prototype.getTransformBySid = function (sid) {\n    for (var i = 0; i < this.transforms.length; i++) {\n      if (this.transforms[i].sid === sid) return this.transforms[i];\n    }\n\n    return null;\n  };\n\n  Node.prototype.parse = function (element) {\n    var url;\n\n    this.id = element.getAttribute('id');\n    this.sid = element.getAttribute('sid');\n    this.name = element.getAttribute('name');\n    this.type = element.getAttribute('type');\n    this.layer = element.getAttribute('layer');\n\n    this.type = this.type === 'JOINT' ? this.type : 'NODE';\n\n    this.nodes = [];\n    this.transforms = [];\n    this.geometries = [];\n    this.cameras = [];\n    this.lights = [];\n    this.controllers = [];\n    this.matrix = new THREE.Matrix4();\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'node':\n          this.nodes.push(new Node().parse(child));\n          break;\n\n        case 'instance_camera':\n          this.cameras.push(new InstanceCamera().parse(child));\n          break;\n\n        case 'instance_controller':\n          this.controllers.push(new InstanceController().parse(child));\n          break;\n\n        case 'instance_geometry':\n          this.geometries.push(new InstanceGeometry().parse(child));\n          break;\n\n        case 'instance_light':\n          this.lights.push(new InstanceLight().parse(child));\n          break;\n\n        case 'instance_node':\n          url = child.getAttribute('url').replace(/^#/, '');\n          var iNode = getLibraryNode(url);\n\n          if (iNode) {\n            this.nodes.push(new Node().parse(iNode));\n          }\n\n          break;\n\n        case 'rotate':\n        case 'translate':\n        case 'scale':\n        case 'matrix':\n        case 'lookat':\n        case 'skew':\n          this.transforms.push(new Transform().parse(child));\n          break;\n\n        case 'extra':\n          break;\n\n        default:\n          console.log(child.nodeName);\n          break;\n      }\n    }\n\n    this.channels = getChannelsForNode(this);\n    bakeAnimations(this);\n\n    this.updateMatrix();\n\n    return this;\n  };\n\n  Node.prototype.updateMatrix = function () {\n    this.matrix.identity();\n\n    for (var i = 0; i < this.transforms.length; i++) {\n      this.transforms[i].apply(this.matrix);\n    }\n  };\n\n  function Transform() {\n    this.sid = '';\n    this.type = '';\n    this.data = [];\n    this.obj = null;\n  }\n\n  Transform.prototype.parse = function (element) {\n    this.sid = element.getAttribute('sid');\n    this.type = element.nodeName;\n    this.data = _floats(element.textContent);\n    this.convert();\n\n    return this;\n  };\n\n  Transform.prototype.convert = function () {\n    switch (this.type) {\n      case 'matrix':\n        this.obj = getConvertedMat4(this.data);\n        break;\n\n      case 'rotate':\n        this.angle = THREE.Math.degToRad(this.data[3]);\n\n      case 'translate':\n        fixCoords(this.data, -1);\n        this.obj = new THREE.Vector3(this.data[0], this.data[1], this.data[2]);\n        break;\n\n      case 'scale':\n        fixCoords(this.data, 1);\n        this.obj = new THREE.Vector3(this.data[0], this.data[1], this.data[2]);\n        break;\n\n      default:\n        console.log('Can not convert Transform of type ' + this.type);\n        break;\n    }\n  };\n\n  Transform.prototype.apply = (function () {\n    var m1 = new THREE.Matrix4();\n\n    return function (matrix) {\n      switch (this.type) {\n        case 'matrix':\n          matrix.multiply(this.obj);\n\n          break;\n\n        case 'translate':\n          matrix.multiply(m1.makeTranslation(this.obj.x, this.obj.y, this.obj.z));\n\n          break;\n\n        case 'rotate':\n          matrix.multiply(m1.makeRotationAxis(this.obj, this.angle));\n\n          break;\n\n        case 'scale':\n          matrix.scale(this.obj);\n\n          break;\n      }\n    };\n  })();\n\n  Transform.prototype.update = function (data, member) {\n    var members = ['X', 'Y', 'Z', 'ANGLE'];\n\n    switch (this.type) {\n      case 'matrix':\n        if (!member) {\n          this.obj.copy(data);\n        } else if (member.length === 1) {\n          switch (member[0]) {\n            case 0:\n              this.obj.n11 = data[0];\n              this.obj.n21 = data[1];\n              this.obj.n31 = data[2];\n              this.obj.n41 = data[3];\n\n              break;\n\n            case 1:\n              this.obj.n12 = data[0];\n              this.obj.n22 = data[1];\n              this.obj.n32 = data[2];\n              this.obj.n42 = data[3];\n\n              break;\n\n            case 2:\n              this.obj.n13 = data[0];\n              this.obj.n23 = data[1];\n              this.obj.n33 = data[2];\n              this.obj.n43 = data[3];\n\n              break;\n\n            case 3:\n              this.obj.n14 = data[0];\n              this.obj.n24 = data[1];\n              this.obj.n34 = data[2];\n              this.obj.n44 = data[3];\n\n              break;\n          }\n        } else if (member.length === 2) {\n          var propName = 'n' + (member[0] + 1) + (member[1] + 1);\n          this.obj[propName] = data;\n        } else {\n          console.log('Incorrect addressing of matrix in transform.');\n        }\n\n        break;\n\n      case 'translate':\n      case 'scale':\n        if (Object.prototype.toString.call(member) === '[object Array]') {\n          member = members[member[0]];\n        }\n\n        switch (member) {\n          case 'X':\n            this.obj.x = data;\n            break;\n\n          case 'Y':\n            this.obj.y = data;\n            break;\n\n          case 'Z':\n            this.obj.z = data;\n            break;\n\n          default:\n            this.obj.x = data[0];\n            this.obj.y = data[1];\n            this.obj.z = data[2];\n            break;\n        }\n\n        break;\n\n      case 'rotate':\n        if (Object.prototype.toString.call(member) === '[object Array]') {\n          member = members[member[0]];\n        }\n\n        switch (member) {\n          case 'X':\n            this.obj.x = data;\n            break;\n\n          case 'Y':\n            this.obj.y = data;\n            break;\n\n          case 'Z':\n            this.obj.z = data;\n            break;\n\n          case 'ANGLE':\n            this.angle = THREE.Math.degToRad(data);\n            break;\n\n          default:\n            this.obj.x = data[0];\n            this.obj.y = data[1];\n            this.obj.z = data[2];\n            this.angle = THREE.Math.degToRad(data[3]);\n            break;\n        }\n        break;\n    }\n  };\n\n  function InstanceController() {\n    this.url = '';\n    this.skeleton = [];\n    this.instance_material = [];\n  }\n\n  InstanceController.prototype.parse = function (element) {\n    this.url = element.getAttribute('url').replace(/^#/, '');\n    this.skeleton = [];\n    this.instance_material = [];\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType !== 1) continue;\n\n      switch (child.nodeName) {\n        case 'skeleton':\n          this.skeleton.push(child.textContent.replace(/^#/, ''));\n          break;\n\n        case 'bind_material':\n          var instances = child.querySelectorAll('instance_material');\n\n          for (var j = 0; j < instances.length; j++) {\n            var instance = instances[j];\n            this.instance_material.push(new InstanceMaterial().parse(instance));\n          }\n\n          break;\n\n        case 'extra':\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function InstanceMaterial() {\n    this.symbol = '';\n    this.target = '';\n  }\n\n  InstanceMaterial.prototype.parse = function (element) {\n    this.symbol = element.getAttribute('symbol');\n    this.target = element.getAttribute('target').replace(/^#/, '');\n    return this;\n  };\n\n  function InstanceGeometry() {\n    this.url = '';\n    this.instance_material = [];\n  }\n\n  InstanceGeometry.prototype.parse = function (element) {\n    this.url = element.getAttribute('url').replace(/^#/, '');\n    this.instance_material = [];\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      if (child.nodeName === 'bind_material') {\n        var instances = child.querySelectorAll('instance_material');\n\n        for (var j = 0; j < instances.length; j++) {\n          var instance = instances[j];\n          this.instance_material.push(new InstanceMaterial().parse(instance));\n        }\n\n        break;\n      }\n    }\n\n    return this;\n  };\n\n  function Geometry() {\n    this.id = '';\n    this.mesh = null;\n  }\n\n  Geometry.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n\n    extractDoubleSided(this, element);\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n\n      switch (child.nodeName) {\n        case 'mesh':\n          this.mesh = new Mesh(this).parse(child);\n          break;\n\n        case 'extra':\n          // console.log( child );\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function Mesh(geometry) {\n    this.geometry = geometry.id;\n    this.primitives = [];\n    this.vertices = null;\n    this.geometry3js = null;\n  }\n\n  Mesh.prototype.parse = function (element) {\n    this.primitives = [];\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n\n      switch (child.nodeName) {\n        case 'source':\n          _source(child);\n          break;\n\n        case 'vertices':\n          this.vertices = new Vertices().parse(child);\n          break;\n\n        case 'linestrips':\n          this.primitives.push(new LineStrips().parse(child));\n          break;\n\n        case 'triangles':\n          this.primitives.push(new Triangles().parse(child));\n          break;\n\n        case 'polygons':\n          this.primitives.push(new Polygons().parse(child));\n          break;\n\n        case 'polylist':\n          this.primitives.push(new Polylist().parse(child));\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    this.geometry3js = new THREE.Geometry();\n\n    if (this.vertices === null) {\n      // TODO (mrdoob): Study case when this is null (carrier.dae)\n\n      return this;\n    }\n\n    var vertexData = sources[this.vertices.input['POSITION'].source].data;\n\n    for (var i = 0; i < vertexData.length; i += 3) {\n      this.geometry3js.vertices.push(getConvertedVec3(vertexData, i).clone());\n    }\n\n    for (var i = 0; i < this.primitives.length; i++) {\n      var primitive = this.primitives[i];\n      primitive.setVertices(this.vertices);\n      this.handlePrimitive(primitive, this.geometry3js);\n    }\n\n    if (this.geometry3js.calcNormals) {\n      this.geometry3js.computeVertexNormals();\n      delete this.geometry3js.calcNormals;\n    }\n\n    return this;\n  };\n\n  Mesh.prototype.handlePrimitive = function (primitive, geom) {\n    if (primitive instanceof LineStrips) {\n      // TODO: Handle indices. Maybe easier with BufferGeometry?\n\n      geom.isLineStrip = true;\n      return;\n    }\n\n    var j,\n      k,\n      pList = primitive.p,\n      inputs = primitive.inputs;\n    var input, index, idx32;\n    var source, numParams;\n    var vcIndex = 0,\n      vcount = 3,\n      maxOffset = 0;\n    var texture_sets = [];\n\n    for (j = 0; j < inputs.length; j++) {\n      input = inputs[j];\n\n      var offset = input.offset + 1;\n      maxOffset = maxOffset < offset ? offset : maxOffset;\n\n      switch (input.semantic) {\n        case 'TEXCOORD':\n          texture_sets.push(input.set);\n          break;\n      }\n    }\n\n    for (var pCount = 0; pCount < pList.length; ++pCount) {\n      var p = pList[pCount],\n        i = 0;\n\n      while (i < p.length) {\n        var vs = [];\n        var ns = [];\n        var ts = null;\n        var cs = [];\n\n        if (primitive.vcount) {\n          vcount = primitive.vcount.length ? primitive.vcount[vcIndex++] : primitive.vcount;\n        } else {\n          vcount = p.length / maxOffset;\n        }\n\n        for (j = 0; j < vcount; j++) {\n          for (k = 0; k < inputs.length; k++) {\n            input = inputs[k];\n            source = sources[input.source];\n\n            index = p[i + j * maxOffset + input.offset];\n            numParams = source.accessor.params.length;\n            idx32 = index * numParams;\n\n            switch (input.semantic) {\n              case 'VERTEX':\n                vs.push(index);\n\n                break;\n\n              case 'NORMAL':\n                ns.push(getConvertedVec3(source.data, idx32));\n\n                break;\n\n              case 'TEXCOORD':\n                ts = ts || {};\n                if (ts[input.set] === undefined) ts[input.set] = [];\n                // invert the V\n                ts[input.set].push(new THREE.Vector2(source.data[idx32], source.data[idx32 + 1]));\n\n                break;\n\n              case 'COLOR':\n                cs.push(\n                  new THREE.Color().setRGB(\n                    source.data[idx32],\n                    source.data[idx32 + 1],\n                    source.data[idx32 + 2],\n                  ),\n                );\n\n                break;\n\n              default:\n                break;\n            }\n          }\n        }\n\n        if (ns.length === 0) {\n          // check the vertices inputs\n          input = this.vertices.input.NORMAL;\n\n          if (input) {\n            source = sources[input.source];\n            numParams = source.accessor.params.length;\n\n            for (var ndx = 0, len = vs.length; ndx < len; ndx++) {\n              ns.push(getConvertedVec3(source.data, vs[ndx] * numParams));\n            }\n          } else {\n            geom.calcNormals = true;\n          }\n        }\n\n        if (!ts) {\n          ts = {};\n          // check the vertices inputs\n          input = this.vertices.input.TEXCOORD;\n\n          if (input) {\n            texture_sets.push(input.set);\n            source = sources[input.source];\n            numParams = source.accessor.params.length;\n\n            for (var ndx = 0, len = vs.length; ndx < len; ndx++) {\n              idx32 = vs[ndx] * numParams;\n              if (ts[input.set] === undefined) ts[input.set] = [];\n              // invert the V\n              ts[input.set].push(\n                new THREE.Vector2(source.data[idx32], 1.0 - source.data[idx32 + 1]),\n              );\n            }\n          }\n        }\n\n        if (cs.length === 0) {\n          // check the vertices inputs\n          input = this.vertices.input.COLOR;\n\n          if (input) {\n            source = sources[input.source];\n            numParams = source.accessor.params.length;\n\n            for (var ndx = 0, len = vs.length; ndx < len; ndx++) {\n              idx32 = vs[ndx] * numParams;\n              cs.push(\n                new THREE.Color().setRGB(\n                  source.data[idx32],\n                  source.data[idx32 + 1],\n                  source.data[idx32 + 2],\n                ),\n              );\n            }\n          }\n        }\n\n        var face = null,\n          faces = [],\n          uv,\n          uvArr;\n\n        if (vcount === 3) {\n          faces.push(new THREE.Face3(vs[0], vs[1], vs[2], ns, cs.length ? cs : new THREE.Color()));\n        } else if (vcount === 4) {\n          faces.push(\n            new THREE.Face3(\n              vs[0],\n              vs[1],\n              vs[3],\n              [ns[0].clone(), ns[1].clone(), ns[3].clone()],\n              cs.length ? [cs[0], cs[1], cs[3]] : new THREE.Color(),\n            ),\n          );\n\n          faces.push(\n            new THREE.Face3(\n              vs[1],\n              vs[2],\n              vs[3],\n              [ns[1].clone(), ns[2].clone(), ns[3].clone()],\n              cs.length ? [cs[1], cs[2], cs[3]] : new THREE.Color(),\n            ),\n          );\n        } else if (vcount > 4 && options.subdivideFaces) {\n          var clr = cs.length ? cs : new THREE.Color(),\n            vec1,\n            vec2,\n            vec3,\n            v1,\n            v2,\n            norm;\n\n          // subdivide into multiple Face3s\n\n          for (k = 1; k < vcount - 1; ) {\n            faces.push(\n              new THREE.Face3(\n                vs[0],\n                vs[k],\n                vs[k + 1],\n                [ns[0].clone(), ns[k++].clone(), ns[k].clone()],\n                clr,\n              ),\n            );\n          }\n        }\n\n        if (faces.length) {\n          for (var ndx = 0, len = faces.length; ndx < len; ndx++) {\n            face = faces[ndx];\n            face.daeMaterial = primitive.material;\n            geom.faces.push(face);\n\n            for (k = 0; k < texture_sets.length; k++) {\n              uv = ts[texture_sets[k]];\n\n              if (vcount > 4) {\n                // Grab the right UVs for the vertices in this face\n                uvArr = [uv[0], uv[ndx + 1], uv[ndx + 2]];\n              } else if (vcount === 4) {\n                if (ndx === 0) {\n                  uvArr = [uv[0], uv[1], uv[3]];\n                } else {\n                  uvArr = [uv[1].clone(), uv[2], uv[3].clone()];\n                }\n              } else {\n                uvArr = [uv[0], uv[1], uv[2]];\n              }\n\n              if (geom.faceVertexUvs[k] === undefined) {\n                geom.faceVertexUvs[k] = [];\n              }\n\n              geom.faceVertexUvs[k].push(uvArr);\n            }\n          }\n        } else {\n          console.log('dropped face with vcount ' + vcount + ' for geometry with id: ' + geom.id);\n        }\n\n        i += maxOffset * vcount;\n      }\n    }\n  };\n\n  function Polygons() {\n    this.material = '';\n    this.count = 0;\n    this.inputs = [];\n    this.vcount = null;\n    this.p = [];\n    this.geometry = new THREE.Geometry();\n  }\n\n  Polygons.prototype.setVertices = function (vertices) {\n    for (var i = 0; i < this.inputs.length; i++) {\n      if (this.inputs[i].source === vertices.id) {\n        this.inputs[i].source = vertices.input['POSITION'].source;\n      }\n    }\n  };\n\n  Polygons.prototype.parse = function (element) {\n    this.material = element.getAttribute('material');\n    this.count = _attr_as_int(element, 'count', 0);\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n\n      switch (child.nodeName) {\n        case 'input':\n          this.inputs.push(new Input().parse(element.childNodes[i]));\n          break;\n\n        case 'vcount':\n          this.vcount = _ints(child.textContent);\n          break;\n\n        case 'p':\n          this.p.push(_ints(child.textContent));\n          break;\n\n        case 'ph':\n          console.warn('polygon holes not yet supported!');\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function Polylist() {\n    Polygons.call(this);\n\n    this.vcount = [];\n  }\n\n  Polylist.prototype = Object.create(Polygons.prototype);\n  Polylist.prototype.constructor = Polylist;\n\n  function LineStrips() {\n    Polygons.call(this);\n\n    this.vcount = 1;\n  }\n\n  LineStrips.prototype = Object.create(Polygons.prototype);\n  LineStrips.prototype.constructor = LineStrips;\n\n  function Triangles() {\n    Polygons.call(this);\n\n    this.vcount = 3;\n  }\n\n  Triangles.prototype = Object.create(Polygons.prototype);\n  Triangles.prototype.constructor = Triangles;\n\n  function Accessor() {\n    this.source = '';\n    this.count = 0;\n    this.stride = 0;\n    this.params = [];\n  }\n\n  Accessor.prototype.parse = function (element) {\n    this.params = [];\n    this.source = element.getAttribute('source');\n    this.count = _attr_as_int(element, 'count', 0);\n    this.stride = _attr_as_int(element, 'stride', 0);\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n\n      if (child.nodeName === 'param') {\n        var param = {};\n        param['name'] = child.getAttribute('name');\n        param['type'] = child.getAttribute('type');\n        this.params.push(param);\n      }\n    }\n\n    return this;\n  };\n\n  function Vertices() {\n    this.input = {};\n  }\n\n  Vertices.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      if (element.childNodes[i].nodeName === 'input') {\n        var input = new Input().parse(element.childNodes[i]);\n        this.input[input.semantic] = input;\n      }\n    }\n\n    return this;\n  };\n\n  function Input() {\n    this.semantic = '';\n    this.offset = 0;\n    this.source = '';\n    this.set = 0;\n  }\n\n  Input.prototype.parse = function (element) {\n    this.semantic = element.getAttribute('semantic');\n    this.source = element.getAttribute('source').replace(/^#/, '');\n    this.set = _attr_as_int(element, 'set', -1);\n    this.offset = _attr_as_int(element, 'offset', 0);\n\n    if (this.semantic === 'TEXCOORD' && this.set < 0) {\n      this.set = 0;\n    }\n\n    return this;\n  };\n\n  function Source(id) {\n    this.id = id;\n    this.type = null;\n  }\n\n  Source.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n\n      switch (child.nodeName) {\n        case 'bool_array':\n          this.data = _bools(child.textContent);\n          this.type = child.nodeName;\n          break;\n\n        case 'float_array':\n          this.data = _floats(child.textContent);\n          this.type = child.nodeName;\n          break;\n\n        case 'int_array':\n          this.data = _ints(child.textContent);\n          this.type = child.nodeName;\n          break;\n\n        case 'IDREF_array':\n        case 'Name_array':\n          this.data = _strings(child.textContent);\n          this.type = child.nodeName;\n          break;\n\n        case 'technique_common':\n          for (var j = 0; j < child.childNodes.length; j++) {\n            if (child.childNodes[j].nodeName === 'accessor') {\n              this.accessor = new Accessor().parse(child.childNodes[j]);\n              break;\n            }\n          }\n          break;\n\n        default:\n          // console.log(child.nodeName);\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  Source.prototype.read = function () {\n    var result = [];\n\n    //for (var i = 0; i < this.accessor.params.length; i++) {\n\n    var param = this.accessor.params[0];\n\n    //console.log(param.name + \" \" + param.type);\n\n    switch (param.type) {\n      case 'IDREF':\n      case 'Name':\n      case 'name':\n      case 'float':\n        return this.data;\n\n      case 'float4x4':\n        for (var j = 0; j < this.data.length; j += 16) {\n          var s = this.data.slice(j, j + 16);\n          var m = getConvertedMat4(s);\n          result.push(m);\n        }\n\n        break;\n\n      default:\n        console.log('ColladaLoader: Source: Read dont know how to read ' + param.type + '.');\n        break;\n    }\n\n    //}\n\n    return result;\n  };\n\n  function Material() {\n    this.id = '';\n    this.name = '';\n    this.instance_effect = null;\n  }\n\n  Material.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n    this.name = element.getAttribute('name');\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      if (element.childNodes[i].nodeName === 'instance_effect') {\n        this.instance_effect = new InstanceEffect().parse(element.childNodes[i]);\n        break;\n      }\n    }\n\n    return this;\n  };\n\n  function ColorOrTexture() {\n    this.color = new THREE.Color();\n    this.color.setRGB(Math.random(), Math.random(), Math.random());\n    this.color.a = 1.0;\n\n    this.texture = null;\n    this.texcoord = null;\n    this.texOpts = null;\n  }\n\n  ColorOrTexture.prototype.isColor = function () {\n    return this.texture === null;\n  };\n\n  ColorOrTexture.prototype.isTexture = function () {\n    return this.texture != null;\n  };\n\n  ColorOrTexture.prototype.parse = function (element) {\n    if (element.nodeName === 'transparent') {\n      this.opaque = element.getAttribute('opaque');\n    }\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'color':\n          var rgba = _floats(child.textContent);\n          this.color = new THREE.Color();\n          this.color.setRGB(rgba[0], rgba[1], rgba[2]);\n          this.color.a = rgba[3];\n          break;\n\n        case 'texture':\n          this.texture = child.getAttribute('texture');\n          this.texcoord = child.getAttribute('texcoord');\n          // Defaults from:\n          // https://collada.org/mediawiki/index.php/Maya_texture_placement_MAYA_extension\n          this.texOpts = {\n            offsetU: 0,\n            offsetV: 0,\n            repeatU: 1,\n            repeatV: 1,\n            wrapU: 1,\n            wrapV: 1,\n          };\n          this.parseTexture(child);\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  ColorOrTexture.prototype.parseTexture = function (element) {\n    if (!element.childNodes) return this;\n\n    // This should be supported by Maya, 3dsMax, and MotionBuilder\n\n    if (element.childNodes[1] && element.childNodes[1].nodeName === 'extra') {\n      element = element.childNodes[1];\n\n      if (element.childNodes[1] && element.childNodes[1].nodeName === 'technique') {\n        element = element.childNodes[1];\n      }\n    }\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n\n      switch (child.nodeName) {\n        case 'offsetU':\n        case 'offsetV':\n        case 'repeatU':\n        case 'repeatV':\n          this.texOpts[child.nodeName] = parseFloat(child.textContent);\n\n          break;\n\n        case 'wrapU':\n        case 'wrapV':\n          // some dae have a value of true which becomes NaN via parseInt\n\n          if (child.textContent.toUpperCase() === 'TRUE') {\n            this.texOpts[child.nodeName] = 1;\n          } else {\n            this.texOpts[child.nodeName] = parseInt(child.textContent);\n          }\n          break;\n\n        default:\n          this.texOpts[child.nodeName] = child.textContent;\n\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function Shader(type, effect) {\n    this.type = type;\n    this.effect = effect;\n    this.material = null;\n  }\n\n  Shader.prototype.parse = function (element) {\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'emission':\n        case 'diffuse':\n        case 'specular':\n        case 'transparent':\n          this[child.nodeName] = new ColorOrTexture().parse(child);\n          break;\n\n        case 'bump':\n          // If 'bumptype' is 'heightfield', create a 'bump' property\n          // Else if 'bumptype' is 'normalmap', create a 'normal' property\n          // (Default to 'bump')\n          var bumpType = child.getAttribute('bumptype');\n          if (bumpType) {\n            if (bumpType.toLowerCase() === 'heightfield') {\n              this['bump'] = new ColorOrTexture().parse(child);\n            } else if (bumpType.toLowerCase() === 'normalmap') {\n              this['normal'] = new ColorOrTexture().parse(child);\n            } else {\n              console.error(\n                \"Shader.prototype.parse: Invalid value for attribute 'bumptype' (\" +\n                  bumpType +\n                  \") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'\",\n              );\n              this['bump'] = new ColorOrTexture().parse(child);\n            }\n          } else {\n            console.warn(\n              \"Shader.prototype.parse: Attribute 'bumptype' missing from bump node - defaulting to 'HEIGHTFIELD'\",\n            );\n            this['bump'] = new ColorOrTexture().parse(child);\n          }\n\n          break;\n\n        case 'shininess':\n        case 'reflectivity':\n        case 'index_of_refraction':\n        case 'transparency':\n          var f = child.querySelectorAll('float');\n\n          if (f.length > 0) this[child.nodeName] = parseFloat(f[0].textContent);\n\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    this.create();\n    return this;\n  };\n\n  Shader.prototype.create = function () {\n    var props = {};\n\n    var transparent = false;\n\n    if (this['transparency'] !== undefined && this['transparent'] !== undefined) {\n      // convert transparent color RBG to average value\n      var transparentColor = this['transparent'];\n      var transparencyLevel =\n        ((this.transparent.color.r + this.transparent.color.g + this.transparent.color.b) / 3) *\n        this.transparency;\n\n      if (transparencyLevel > 0) {\n        transparent = true;\n        props['transparent'] = true;\n        props['opacity'] = 1 - transparencyLevel;\n      }\n    }\n\n    var keys = {\n      diffuse: 'map',\n      ambient: 'lightMap',\n      specular: 'specularMap',\n      emission: 'emissionMap',\n      bump: 'bumpMap',\n      normal: 'normalMap',\n    };\n\n    for (var prop in this) {\n      switch (prop) {\n        case 'ambient':\n        case 'emission':\n        case 'diffuse':\n        case 'specular':\n        case 'bump':\n        case 'normal':\n          var cot = this[prop];\n\n          if (cot instanceof ColorOrTexture) {\n            if (cot.isTexture()) {\n              var samplerId = cot.texture;\n              var surfaceId = this.effect.sampler[samplerId];\n\n              if (surfaceId !== undefined && surfaceId.source !== undefined) {\n                var surface = this.effect.surface[surfaceId.source];\n\n                if (surface !== undefined) {\n                  var image = images[surface.init_from];\n\n                  if (image) {\n                    var url = baseUrl + image.init_from;\n\n                    var texture;\n                    var loader = THREE.Loader.Handlers.get(url);\n\n                    if (loader !== null) {\n                      texture = loader.load(url);\n                    } else {\n                      texture = new THREE.Texture();\n\n                      loadTextureImage(texture, url);\n                    }\n\n                    texture.wrapS = cot.texOpts.wrapU\n                      ? THREE.RepeatWrapping\n                      : THREE.ClampToEdgeWrapping;\n                    texture.wrapT = cot.texOpts.wrapV\n                      ? THREE.RepeatWrapping\n                      : THREE.ClampToEdgeWrapping;\n                    texture.offset.x = cot.texOpts.offsetU;\n                    texture.offset.y = cot.texOpts.offsetV;\n                    texture.repeat.x = cot.texOpts.repeatU;\n                    texture.repeat.y = cot.texOpts.repeatV;\n                    props[keys[prop]] = texture;\n\n                    // Texture with baked lighting?\n                    if (prop === 'emission') props['emissive'] = 0xffffff;\n                  }\n                }\n              }\n            } else if (prop === 'diffuse' || !transparent) {\n              if (prop === 'emission') {\n                props['emissive'] = cot.color.getHex();\n              } else {\n                props[prop] = cot.color.getHex();\n              }\n            }\n          }\n\n          break;\n\n        case 'shininess':\n          props[prop] = this[prop];\n          break;\n\n        case 'reflectivity':\n          props[prop] = this[prop];\n          if (props[prop] > 0.0) props['envMap'] = options.defaultEnvMap;\n          props['combine'] = THREE.MixOperation; //mix regular shading with reflective component\n          break;\n\n        case 'index_of_refraction':\n          props['refractionRatio'] = this[prop]; //TODO: \"index_of_refraction\" becomes \"refractionRatio\" in shader, but I'm not sure if the two are actually comparable\n          if (this[prop] !== 1.0) props['envMap'] = options.defaultEnvMap;\n          break;\n\n        case 'transparency':\n          // gets figured out up top\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    props['shading'] = preferredShading;\n    props['side'] = this.effect.doubleSided ? THREE.DoubleSide : THREE.FrontSide;\n\n    switch (this.type) {\n      case 'constant':\n        if (props.emissive != undefined) props.color = props.emissive;\n        this.material = new THREE.MeshBasicMaterial(props);\n        break;\n\n      case 'phong':\n      case 'blinn':\n        if (props.diffuse != undefined) props.color = props.diffuse;\n        this.material = new THREE.MeshPhongMaterial(props);\n        break;\n\n      case 'lambert':\n      default:\n        if (props.diffuse != undefined) props.color = props.diffuse;\n        this.material = new THREE.MeshLambertMaterial(props);\n        break;\n    }\n\n    return this.material;\n  };\n\n  function Surface(effect) {\n    this.effect = effect;\n    this.init_from = null;\n    this.format = null;\n  }\n\n  Surface.prototype.parse = function (element) {\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'init_from':\n          this.init_from = child.textContent;\n          break;\n\n        case 'format':\n          this.format = child.textContent;\n          break;\n\n        default:\n          console.log('unhandled Surface prop: ' + child.nodeName);\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function Sampler2D(effect) {\n    this.effect = effect;\n    this.source = null;\n    this.wrap_s = null;\n    this.wrap_t = null;\n    this.minfilter = null;\n    this.magfilter = null;\n    this.mipfilter = null;\n  }\n\n  Sampler2D.prototype.parse = function (element) {\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'source':\n          this.source = child.textContent;\n          break;\n\n        case 'minfilter':\n          this.minfilter = child.textContent;\n          break;\n\n        case 'magfilter':\n          this.magfilter = child.textContent;\n          break;\n\n        case 'mipfilter':\n          this.mipfilter = child.textContent;\n          break;\n\n        case 'wrap_s':\n          this.wrap_s = child.textContent;\n          break;\n\n        case 'wrap_t':\n          this.wrap_t = child.textContent;\n          break;\n\n        default:\n          console.log('unhandled Sampler2D prop: ' + child.nodeName);\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function Effect() {\n    this.id = '';\n    this.name = '';\n    this.shader = null;\n    this.surface = {};\n    this.sampler = {};\n  }\n\n  Effect.prototype.create = function () {\n    if (this.shader === null) {\n      return null;\n    }\n  };\n\n  Effect.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n    this.name = element.getAttribute('name');\n\n    extractDoubleSided(this, element);\n\n    this.shader = null;\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'profile_COMMON':\n          this.parseTechnique(this.parseProfileCOMMON(child));\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  Effect.prototype.parseNewparam = function (element) {\n    var sid = element.getAttribute('sid');\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'surface':\n          this.surface[sid] = new Surface(this).parse(child);\n          break;\n\n        case 'sampler2D':\n          this.sampler[sid] = new Sampler2D(this).parse(child);\n          break;\n\n        case 'extra':\n          break;\n\n        default:\n          console.log(child.nodeName);\n          break;\n      }\n    }\n  };\n\n  Effect.prototype.parseProfileCOMMON = function (element) {\n    var technique;\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'profile_COMMON':\n          this.parseProfileCOMMON(child);\n          break;\n\n        case 'technique':\n          technique = child;\n          break;\n\n        case 'newparam':\n          this.parseNewparam(child);\n          break;\n\n        case 'image':\n          var _image = new _Image().parse(child);\n          images[_image.id] = _image;\n          break;\n\n        case 'extra':\n          break;\n\n        default:\n          console.log(child.nodeName);\n          break;\n      }\n    }\n\n    return technique;\n  };\n\n  Effect.prototype.parseTechnique = function (element) {\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'constant':\n        case 'lambert':\n        case 'blinn':\n        case 'phong':\n          this.shader = new Shader(child.nodeName, this).parse(child);\n          break;\n        case 'extra':\n          this.parseExtra(child);\n          break;\n        default:\n          break;\n      }\n    }\n  };\n\n  Effect.prototype.parseExtra = function (element) {\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'technique':\n          this.parseExtraTechnique(child);\n          break;\n        default:\n          break;\n      }\n    }\n  };\n\n  Effect.prototype.parseExtraTechnique = function (element) {\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'bump':\n          this.shader.parse(element);\n          break;\n        default:\n          break;\n      }\n    }\n  };\n\n  function InstanceEffect() {\n    this.url = '';\n  }\n\n  InstanceEffect.prototype.parse = function (element) {\n    this.url = element.getAttribute('url').replace(/^#/, '');\n    return this;\n  };\n\n  function Animation() {\n    this.id = '';\n    this.name = '';\n    this.source = {};\n    this.sampler = [];\n    this.channel = [];\n  }\n\n  Animation.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n    this.name = element.getAttribute('name');\n    this.source = {};\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'animation':\n          var anim = new Animation().parse(child);\n\n          for (var src in anim.source) {\n            this.source[src] = anim.source[src];\n          }\n\n          for (var j = 0; j < anim.channel.length; j++) {\n            this.channel.push(anim.channel[j]);\n            this.sampler.push(anim.sampler[j]);\n          }\n\n          break;\n\n        case 'source':\n          var src = new Source().parse(child);\n          this.source[src.id] = src;\n          break;\n\n        case 'sampler':\n          this.sampler.push(new Sampler(this).parse(child));\n          break;\n\n        case 'channel':\n          this.channel.push(new Channel(this).parse(child));\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function Channel(animation) {\n    this.animation = animation;\n    this.source = '';\n    this.target = '';\n    this.fullSid = null;\n    this.sid = null;\n    this.dotSyntax = null;\n    this.arrSyntax = null;\n    this.arrIndices = null;\n    this.member = null;\n  }\n\n  Channel.prototype.parse = function (element) {\n    this.source = element.getAttribute('source').replace(/^#/, '');\n    this.target = element.getAttribute('target');\n\n    var parts = this.target.split('/');\n\n    var id = parts.shift();\n    var sid = parts.shift();\n\n    var dotSyntax = sid.indexOf('.') >= 0;\n    var arrSyntax = sid.indexOf('(') >= 0;\n\n    if (dotSyntax) {\n      parts = sid.split('.');\n      this.sid = parts.shift();\n      this.member = parts.shift();\n    } else if (arrSyntax) {\n      var arrIndices = sid.split('(');\n      this.sid = arrIndices.shift();\n\n      for (var j = 0; j < arrIndices.length; j++) {\n        arrIndices[j] = parseInt(arrIndices[j].replace(/\\)/, ''));\n      }\n\n      this.arrIndices = arrIndices;\n    } else {\n      this.sid = sid;\n    }\n\n    this.fullSid = sid;\n    this.dotSyntax = dotSyntax;\n    this.arrSyntax = arrSyntax;\n\n    return this;\n  };\n\n  function Sampler(animation) {\n    this.id = '';\n    this.animation = animation;\n    this.inputs = [];\n    this.input = null;\n    this.output = null;\n    this.strideOut = null;\n    this.interpolation = null;\n    this.startTime = null;\n    this.endTime = null;\n    this.duration = 0;\n  }\n\n  Sampler.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n    this.inputs = [];\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'input':\n          this.inputs.push(new Input().parse(child));\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  Sampler.prototype.create = function () {\n    for (var i = 0; i < this.inputs.length; i++) {\n      var input = this.inputs[i];\n      var source = this.animation.source[input.source];\n\n      switch (input.semantic) {\n        case 'INPUT':\n          this.input = source.read();\n          break;\n\n        case 'OUTPUT':\n          this.output = source.read();\n          this.strideOut = source.accessor.stride;\n          break;\n\n        case 'INTERPOLATION':\n          this.interpolation = source.read();\n          break;\n\n        case 'IN_TANGENT':\n          break;\n\n        case 'OUT_TANGENT':\n          break;\n\n        default:\n          console.log(input.semantic);\n          break;\n      }\n    }\n\n    this.startTime = 0;\n    this.endTime = 0;\n    this.duration = 0;\n\n    if (this.input.length) {\n      this.startTime = 100000000;\n      this.endTime = -100000000;\n\n      for (var i = 0; i < this.input.length; i++) {\n        this.startTime = Math.min(this.startTime, this.input[i]);\n        this.endTime = Math.max(this.endTime, this.input[i]);\n      }\n\n      this.duration = this.endTime - this.startTime;\n    }\n  };\n\n  Sampler.prototype.getData = function (type, ndx, member) {\n    var data;\n\n    if (type === 'matrix' && this.strideOut === 16) {\n      data = this.output[ndx];\n    } else if (this.strideOut > 1) {\n      data = [];\n      ndx *= this.strideOut;\n\n      for (var i = 0; i < this.strideOut; ++i) {\n        data[i] = this.output[ndx + i];\n      }\n\n      if (this.strideOut === 3) {\n        switch (type) {\n          case 'rotate':\n          case 'translate':\n            fixCoords(data, -1);\n            break;\n\n          case 'scale':\n            fixCoords(data, 1);\n            break;\n        }\n      } else if (this.strideOut === 4 && type === 'matrix') {\n        fixCoords(data, -1);\n      }\n    } else {\n      data = this.output[ndx];\n\n      if (member && type === 'translate') {\n        data = getConvertedTranslation(member, data);\n      }\n    }\n\n    return data;\n  };\n\n  function Key(time) {\n    this.targets = [];\n    this.time = time;\n  }\n\n  Key.prototype.addTarget = function (fullSid, transform, member, data) {\n    this.targets.push({\n      sid: fullSid,\n      member: member,\n      transform: transform,\n      data: data,\n    });\n  };\n\n  Key.prototype.apply = function (opt_sid) {\n    for (var i = 0; i < this.targets.length; ++i) {\n      var target = this.targets[i];\n\n      if (!opt_sid || target.sid === opt_sid) {\n        target.transform.update(target.data, target.member);\n      }\n    }\n  };\n\n  Key.prototype.getTarget = function (fullSid) {\n    for (var i = 0; i < this.targets.length; ++i) {\n      if (this.targets[i].sid === fullSid) {\n        return this.targets[i];\n      }\n    }\n\n    return null;\n  };\n\n  Key.prototype.hasTarget = function (fullSid) {\n    for (var i = 0; i < this.targets.length; ++i) {\n      if (this.targets[i].sid === fullSid) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  // TODO: Currently only doing linear interpolation. Should support full COLLADA spec.\n  Key.prototype.interpolate = function (nextKey, time) {\n    for (var i = 0, l = this.targets.length; i < l; i++) {\n      var target = this.targets[i],\n        nextTarget = nextKey.getTarget(target.sid),\n        data;\n\n      if (target.transform.type !== 'matrix' && nextTarget) {\n        var scale = (time - this.time) / (nextKey.time - this.time),\n          nextData = nextTarget.data,\n          prevData = target.data;\n\n        if (scale < 0) scale = 0;\n        if (scale > 1) scale = 1;\n\n        if (prevData.length) {\n          data = [];\n\n          for (var j = 0; j < prevData.length; ++j) {\n            data[j] = prevData[j] + (nextData[j] - prevData[j]) * scale;\n          }\n        } else {\n          data = prevData + (nextData - prevData) * scale;\n        }\n      } else {\n        data = target.data;\n      }\n\n      target.transform.update(data, target.member);\n    }\n  };\n\n  // Camera\n  function Camera() {\n    this.id = '';\n    this.name = '';\n    this.technique = '';\n  }\n\n  Camera.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n    this.name = element.getAttribute('name');\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'optics':\n          this.parseOptics(child);\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  Camera.prototype.parseOptics = function (element) {\n    for (var i = 0; i < element.childNodes.length; i++) {\n      if (element.childNodes[i].nodeName === 'technique_common') {\n        var technique = element.childNodes[i];\n\n        for (var j = 0; j < technique.childNodes.length; j++) {\n          this.technique = technique.childNodes[j].nodeName;\n\n          if (this.technique === 'perspective') {\n            var perspective = technique.childNodes[j];\n\n            for (var k = 0; k < perspective.childNodes.length; k++) {\n              var param = perspective.childNodes[k];\n\n              switch (param.nodeName) {\n                case 'yfov':\n                  this.yfov = param.textContent;\n                  break;\n                case 'xfov':\n                  this.xfov = param.textContent;\n                  break;\n                case 'znear':\n                  this.znear = param.textContent;\n                  break;\n                case 'zfar':\n                  this.zfar = param.textContent;\n                  break;\n                case 'aspect_ratio':\n                  this.aspect_ratio = param.textContent;\n                  break;\n              }\n            }\n          } else if (this.technique === 'orthographic') {\n            var orthographic = technique.childNodes[j];\n\n            for (var k = 0; k < orthographic.childNodes.length; k++) {\n              var param = orthographic.childNodes[k];\n\n              switch (param.nodeName) {\n                case 'xmag':\n                  this.xmag = param.textContent;\n                  break;\n                case 'ymag':\n                  this.ymag = param.textContent;\n                  break;\n                case 'znear':\n                  this.znear = param.textContent;\n                  break;\n                case 'zfar':\n                  this.zfar = param.textContent;\n                  break;\n                case 'aspect_ratio':\n                  this.aspect_ratio = param.textContent;\n                  break;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return this;\n  };\n\n  function InstanceCamera() {\n    this.url = '';\n  }\n\n  InstanceCamera.prototype.parse = function (element) {\n    this.url = element.getAttribute('url').replace(/^#/, '');\n\n    return this;\n  };\n\n  // Light\n\n  function Light() {\n    this.id = '';\n    this.name = '';\n    this.technique = '';\n  }\n\n  Light.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n    this.name = element.getAttribute('name');\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'technique_common':\n          this.parseCommon(child);\n          break;\n\n        case 'technique':\n          this.parseTechnique(child);\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  Light.prototype.parseCommon = function (element) {\n    for (var i = 0; i < element.childNodes.length; i++) {\n      switch (element.childNodes[i].nodeName) {\n        case 'directional':\n        case 'point':\n        case 'spot':\n        case 'ambient':\n          this.technique = element.childNodes[i].nodeName;\n\n          var light = element.childNodes[i];\n\n          for (var j = 0; j < light.childNodes.length; j++) {\n            var child = light.childNodes[j];\n\n            switch (child.nodeName) {\n              case 'color':\n                var rgba = _floats(child.textContent);\n                this.color = new THREE.Color(0);\n                this.color.setRGB(rgba[0], rgba[1], rgba[2]);\n                this.color.a = rgba[3];\n                break;\n\n              case 'falloff_angle':\n                this.falloff_angle = parseFloat(child.textContent);\n                break;\n\n              case 'quadratic_attenuation':\n                var f = parseFloat(child.textContent);\n                this.distance = f ? Math.sqrt(1 / f) : 0;\n            }\n          }\n      }\n    }\n\n    return this;\n  };\n\n  Light.prototype.parseTechnique = function (element) {\n    this.profile = element.getAttribute('profile');\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n\n      switch (child.nodeName) {\n        case 'intensity':\n          this.intensity = parseFloat(child.textContent);\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function InstanceLight() {\n    this.url = '';\n  }\n\n  InstanceLight.prototype.parse = function (element) {\n    this.url = element.getAttribute('url').replace(/^#/, '');\n\n    return this;\n  };\n\n  function KinematicsModel() {\n    this.id = '';\n    this.name = '';\n    this.joints = [];\n    this.links = [];\n  }\n\n  KinematicsModel.prototype.parse = function (element) {\n    this.id = element.getAttribute('id');\n    this.name = element.getAttribute('name');\n    this.joints = [];\n    this.links = [];\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'technique_common':\n          this.parseCommon(child);\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  KinematicsModel.prototype.parseCommon = function (element) {\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (element.childNodes[i].nodeName) {\n        case 'joint':\n          this.joints.push(new Joint().parse(child));\n          break;\n\n        case 'link':\n          this.links.push(new Link().parse(child));\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function Joint() {\n    this.sid = '';\n    this.name = '';\n    this.axis = new THREE.Vector3();\n    this.limits = {\n      min: 0,\n      max: 0,\n    };\n    this.type = '';\n    this.static = false;\n    this.zeroPosition = 0.0;\n    this.middlePosition = 0.0;\n  }\n\n  Joint.prototype.parse = function (element) {\n    this.sid = element.getAttribute('sid');\n    this.name = element.getAttribute('name');\n    this.axis = new THREE.Vector3();\n    this.limits = {\n      min: 0,\n      max: 0,\n    };\n    this.type = '';\n    this.static = false;\n    this.zeroPosition = 0.0;\n    this.middlePosition = 0.0;\n\n    var axisElement = element.querySelector('axis');\n    var _axis = _floats(axisElement.textContent);\n    this.axis = getConvertedVec3(_axis, 0);\n\n    var min = element.querySelector('limits min')\n      ? parseFloat(element.querySelector('limits min').textContent)\n      : -360;\n    var max = element.querySelector('limits max')\n      ? parseFloat(element.querySelector('limits max').textContent)\n      : 360;\n\n    this.limits = {\n      min: min,\n      max: max,\n    };\n\n    var jointTypes = ['prismatic', 'revolute'];\n    for (var i = 0; i < jointTypes.length; i++) {\n      var type = jointTypes[i];\n\n      var jointElement = element.querySelector(type);\n\n      if (jointElement) {\n        this.type = type;\n      }\n    }\n\n    // if the min is equal to or somehow greater than the max, consider the joint static\n    if (this.limits.min >= this.limits.max) {\n      this.static = true;\n    }\n\n    this.middlePosition = (this.limits.min + this.limits.max) / 2.0;\n    return this;\n  };\n\n  function Link() {\n    this.sid = '';\n    this.name = '';\n    this.transforms = [];\n    this.attachments = [];\n  }\n\n  Link.prototype.parse = function (element) {\n    this.sid = element.getAttribute('sid');\n    this.name = element.getAttribute('name');\n    this.transforms = [];\n    this.attachments = [];\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'attachment_full':\n          this.attachments.push(new Attachment().parse(child));\n          break;\n\n        case 'rotate':\n        case 'translate':\n        case 'matrix':\n          this.transforms.push(new Transform().parse(child));\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function Attachment() {\n    this.joint = '';\n    this.transforms = [];\n    this.links = [];\n  }\n\n  Attachment.prototype.parse = function (element) {\n    this.joint = element.getAttribute('joint').split('/').pop();\n    this.links = [];\n\n    for (var i = 0; i < element.childNodes.length; i++) {\n      var child = element.childNodes[i];\n      if (child.nodeType != 1) continue;\n\n      switch (child.nodeName) {\n        case 'link':\n          this.links.push(new Link().parse(child));\n          break;\n\n        case 'rotate':\n        case 'translate':\n        case 'matrix':\n          this.transforms.push(new Transform().parse(child));\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return this;\n  };\n\n  function _source(element) {\n    var id = element.getAttribute('id');\n\n    if (sources[id] != undefined) {\n      return sources[id];\n    }\n\n    sources[id] = new Source(id).parse(element);\n    return sources[id];\n  }\n\n  function _nsResolver(nsPrefix) {\n    if (nsPrefix === 'dae') {\n      return 'http://www.collada.org/2005/11/COLLADASchema';\n    }\n\n    return null;\n  }\n\n  function _bools(str) {\n    var raw = _strings(str);\n    var data = [];\n\n    for (var i = 0, l = raw.length; i < l; i++) {\n      data.push(raw[i] === 'true' || raw[i] === '1' ? true : false);\n    }\n\n    return data;\n  }\n\n  function _floats(str) {\n    var raw = _strings(str);\n    var data = [];\n\n    for (var i = 0, l = raw.length; i < l; i++) {\n      data.push(parseFloat(raw[i]));\n    }\n\n    return data;\n  }\n\n  function _ints(str) {\n    var raw = _strings(str);\n    var data = [];\n\n    for (var i = 0, l = raw.length; i < l; i++) {\n      data.push(parseInt(raw[i], 10));\n    }\n\n    return data;\n  }\n\n  function _strings(str) {\n    return str.length > 0 ? _trimString(str).split(/\\s+/) : [];\n  }\n\n  function _trimString(str) {\n    return str.replace(/^\\s+/, '').replace(/\\s+$/, '');\n  }\n\n  function _attr_as_float(element, name, defaultValue) {\n    if (element.hasAttribute(name)) {\n      return parseFloat(element.getAttribute(name));\n    } else {\n      return defaultValue;\n    }\n  }\n\n  function _attr_as_int(element, name, defaultValue) {\n    if (element.hasAttribute(name)) {\n      return parseInt(element.getAttribute(name), 10);\n    } else {\n      return defaultValue;\n    }\n  }\n\n  function _attr_as_string(element, name, defaultValue) {\n    if (element.hasAttribute(name)) {\n      return element.getAttribute(name);\n    } else {\n      return defaultValue;\n    }\n  }\n\n  function _format_float(f, num) {\n    if (f === undefined) {\n      var s = '0.';\n\n      while (s.length < num + 2) {\n        s += '0';\n      }\n\n      return s;\n    }\n\n    num = num || 2;\n\n    var parts = f.toString().split('.');\n    parts[1] = parts.length > 1 ? parts[1].substr(0, num) : '0';\n\n    while (parts[1].length < num) {\n      parts[1] += '0';\n    }\n\n    return parts.join('.');\n  }\n\n  function loadTextureImage(texture, url) {\n    loader = new THREE.ImageLoader();\n\n    loader.load(url, function (image) {\n      texture.image = image;\n      texture.needsUpdate = true;\n    });\n  }\n\n  function extractDoubleSided(obj, element) {\n    obj.doubleSided = false;\n\n    var node = element.querySelectorAll('extra double_sided')[0];\n\n    if (node) {\n      if (node && parseInt(node.textContent, 10) === 1) {\n        obj.doubleSided = true;\n      }\n    }\n  }\n\n  // Up axis conversion\n\n  function setUpConversion() {\n    if (options.convertUpAxis !== true || colladaUp === options.upAxis) {\n      upConversion = null;\n    } else {\n      switch (colladaUp) {\n        case 'X':\n          upConversion = options.upAxis === 'Y' ? 'XtoY' : 'XtoZ';\n          break;\n\n        case 'Y':\n          upConversion = options.upAxis === 'X' ? 'YtoX' : 'YtoZ';\n          break;\n\n        case 'Z':\n          upConversion = options.upAxis === 'X' ? 'ZtoX' : 'ZtoY';\n          break;\n      }\n    }\n  }\n\n  function fixCoords(data, sign) {\n    if (options.convertUpAxis !== true || colladaUp === options.upAxis) {\n      return;\n    }\n\n    switch (upConversion) {\n      case 'XtoY':\n        var tmp = data[0];\n        data[0] = sign * data[1];\n        data[1] = tmp;\n        break;\n\n      case 'XtoZ':\n        var tmp = data[2];\n        data[2] = data[1];\n        data[1] = data[0];\n        data[0] = tmp;\n        break;\n\n      case 'YtoX':\n        var tmp = data[0];\n        data[0] = data[1];\n        data[1] = sign * tmp;\n        break;\n\n      case 'YtoZ':\n        var tmp = data[1];\n        data[1] = sign * data[2];\n        data[2] = tmp;\n        break;\n\n      case 'ZtoX':\n        var tmp = data[0];\n        data[0] = data[1];\n        data[1] = data[2];\n        data[2] = tmp;\n        break;\n\n      case 'ZtoY':\n        var tmp = data[1];\n        data[1] = data[2];\n        data[2] = sign * tmp;\n        break;\n    }\n  }\n\n  function getConvertedTranslation(axis, data) {\n    if (options.convertUpAxis !== true || colladaUp === options.upAxis) {\n      return data;\n    }\n\n    switch (axis) {\n      case 'X':\n        data = upConversion === 'XtoY' ? data * -1 : data;\n        break;\n      case 'Y':\n        data = upConversion === 'YtoZ' || upConversion === 'YtoX' ? data * -1 : data;\n        break;\n      case 'Z':\n        data = upConversion === 'ZtoY' ? data * -1 : data;\n        break;\n      default:\n        break;\n    }\n\n    return data;\n  }\n\n  function getConvertedVec3(data, offset) {\n    var arr = [data[offset], data[offset + 1], data[offset + 2]];\n    fixCoords(arr, -1);\n    return new THREE.Vector3(arr[0], arr[1], arr[2]);\n  }\n\n  function getConvertedMat4(data) {\n    if (options.convertUpAxis) {\n      // First fix rotation and scale\n\n      // Columns first\n      var arr = [data[0], data[4], data[8]];\n      fixCoords(arr, -1);\n      data[0] = arr[0];\n      data[4] = arr[1];\n      data[8] = arr[2];\n      arr = [data[1], data[5], data[9]];\n      fixCoords(arr, -1);\n      data[1] = arr[0];\n      data[5] = arr[1];\n      data[9] = arr[2];\n      arr = [data[2], data[6], data[10]];\n      fixCoords(arr, -1);\n      data[2] = arr[0];\n      data[6] = arr[1];\n      data[10] = arr[2];\n      // Rows second\n      arr = [data[0], data[1], data[2]];\n      fixCoords(arr, -1);\n      data[0] = arr[0];\n      data[1] = arr[1];\n      data[2] = arr[2];\n      arr = [data[4], data[5], data[6]];\n      fixCoords(arr, -1);\n      data[4] = arr[0];\n      data[5] = arr[1];\n      data[6] = arr[2];\n      arr = [data[8], data[9], data[10]];\n      fixCoords(arr, -1);\n      data[8] = arr[0];\n      data[9] = arr[1];\n      data[10] = arr[2];\n\n      // Now fix translation\n      arr = [data[3], data[7], data[11]];\n      fixCoords(arr, -1);\n      data[3] = arr[0];\n      data[7] = arr[1];\n      data[11] = arr[2];\n    }\n\n    return new THREE.Matrix4().set(\n      data[0],\n      data[1],\n      data[2],\n      data[3],\n      data[4],\n      data[5],\n      data[6],\n      data[7],\n      data[8],\n      data[9],\n      data[10],\n      data[11],\n      data[12],\n      data[13],\n      data[14],\n      data[15],\n    );\n  }\n\n  function getConvertedIndex(index) {\n    if (index > -1 && index < 3) {\n      var members = ['X', 'Y', 'Z'],\n        indices = { X: 0, Y: 1, Z: 2 };\n\n      index = getConvertedMember(members[index]);\n      index = indices[index];\n    }\n\n    return index;\n  }\n\n  function getConvertedMember(member) {\n    if (options.convertUpAxis) {\n      switch (member) {\n        case 'X':\n          switch (upConversion) {\n            case 'XtoY':\n            case 'XtoZ':\n            case 'YtoX':\n              member = 'Y';\n              break;\n\n            case 'ZtoX':\n              member = 'Z';\n              break;\n          }\n\n          break;\n\n        case 'Y':\n          switch (upConversion) {\n            case 'XtoY':\n            case 'YtoX':\n            case 'ZtoX':\n              member = 'X';\n              break;\n\n            case 'XtoZ':\n            case 'YtoZ':\n            case 'ZtoY':\n              member = 'Z';\n              break;\n          }\n\n          break;\n\n        case 'Z':\n          switch (upConversion) {\n            case 'XtoZ':\n              member = 'X';\n              break;\n\n            case 'YtoZ':\n            case 'ZtoX':\n            case 'ZtoY':\n              member = 'Y';\n              break;\n          }\n\n          break;\n      }\n    }\n\n    return member;\n  }\n\n  return {\n    load: load,\n    parse: parse,\n    setPreferredShading: setPreferredShading,\n    applySkin: applySkin,\n    geometries: geometries,\n    options: options,\n  };\n};\n", "/* eslint-disable */\n\nimport { ColladaExporter } from './ColladaExporter.js';\nimport { ColladaLoader } from './ColladaLoader.js';\n\n// this translated a modern gltf loaded object (three r123) to a collada that can be loaded into three r71\nexport const TranslateModel = (THREE, model, scale, height) => {\n  return new Promise((resolve, reject) => {\n    const avatarPivot = new THREE.Object3D();\n\n    const avatarModel = new THREE.Group();\n\n    const onDone = (result) => {\n      const buffColor = result.textures[0].data;\n\n      const colorTexture = new THREE.Texture();\n\n      const imageColorBlob = new Blob([buffColor], { type: 'image/png' });\n      // set textures into buffers\n      createImageBitmap(imageColorBlob).then(function (imageBitmap) {\n        colorTexture.image = imageBitmap;\n        colorTexture.needsUpdate = true;\n      });\n      const colladaLoader = new ColladaLoader();\n      // then load collada (two meshes, one is helmet and the other is head)\n      colladaLoader.load(result.data, (colladaLoaded) => {\n        const mesh1 = colladaLoaded.scene.children[0].children[0]?.children[1]?.children[0];\n        if (mesh1) {\n          mesh1.rotation.set(0, 3.14, 0);\n          const mat1 = mesh1.material;\n          mat1.map = colorTexture;\n        }\n\n        const mesh2 = colladaLoaded.scene.children[0].children[0]?.children[2]?.children[0];\n        if (mesh2) {\n          mesh2.rotation.set(0, 3.14, 0);\n          const mat2 = mesh2.material;\n\n          if (!mat2) return;\n\n          mat2.map = colorTexture;\n          mat2.transparent = true;\n        }\n\n        avatarModel.add(colladaLoaded.scene);\n        avatarModel.scale.set(scale, scale, scale);\n        avatarModel.position.set(0, height, 0);\n        avatarPivot.add(avatarModel);\n        resolve(avatarPivot);\n      });\n    };\n    // translate from gltf to collada\n    const exporter = new ColladaExporter();\n    exporter.parse(model, onDone, {\n      upAxis: 'Y_UP',\n      unitName: 'meter',\n      unitMeter: 1,\n    });\n  });\n};\n\nexport const disposeAvatar = (avatar) => {\n  if (avatar) {\n    avatar.children.forEach((obj) => {\n      if (obj.geometry) {\n        obj.geometry.dispose();\n      }\n      if (obj.material) {\n        obj.material.dispose();\n      }\n    });\n  }\n};\n", "import { Shape } from 'three';\n\nimport { Slot } from '../types';\n\nexport class AvatarName {\n  constructor(name: string, slot: Slot, height: number, viewer: any) {\n    this.name = name;\n    this.viewer = viewer;\n    if (slot) {\n      this.backgroundColor = slot.color;\n      this.textColor = slot.textColor;\n    } else {\n      const firstColor = '#878291';\n      // eslint-disable-next-line prefer-destructuring\n      this.textColor = '#fff';\n      this.backgroundColor = firstColor;\n    }\n    this.height = height;\n    this.slot = slot;\n  }\n\n  public mesh: THREE.Mesh;\n  private readonly name: string;\n  private readonly backgroundColor: string;\n  private readonly textColor: string;\n\n  private readonly height: number;\n  public slot: Slot;\n  private viewer: any;\n\n  private renderFrame: number;\n  private curQuaternion: THREE.Quaternion;\n\n  public load = async () => {\n    return new Promise((resolve) => {\n      const script = document.createElement('script');\n      // @ts-ignore\n      window._typeface_js = { faces: THREE.FontUtils.faces, loadFace: THREE.FontUtils.loadFace };\n\n      script.setAttribute(\n        'src',\n        'https://production.storage.superviz.com/static/fonts/OpenSans.js',\n      );\n\n      script.onload = async () => {\n        const mesh = await this.createTextGeometry(this.name, this.textColor);\n        mesh.position.set(0, this.height, 0);\n        this.mesh = mesh;\n        this.renderFrame = requestAnimationFrame(this.render.bind(this));\n        resolve(mesh);\n      };\n      document.body.appendChild(script);\n    });\n  };\n\n  private createTextGeometry = async (text: string, color: string) => {\n    // @ts-ignore\n    const geometry = new THREE.TextGeometry(text, {\n      font: 'open sans',\n      size: 0.08,\n      height: 0,\n      curveSegments: 3,\n    });\n\n    geometry.computeBoundingBox();\n    const material = new THREE.MeshBasicMaterial({ color });\n    const mesh = new THREE.Mesh(geometry, material);\n    mesh.geometry.center();\n\n    this.createBackground(mesh, this.backgroundColor);\n    return mesh;\n  };\n\n  private createBackground = async (mesh: THREE.Mesh, color: string) => {\n    const boundingBox = new THREE.Box3().setFromObject(mesh);\n    const size = new THREE.Vector3(0, 0, 0);\n    boundingBox.getSize(size);\n    const { x, y } = size;\n\n    // @ts-ignore\n    const marginX = 0.12;\n    const marginY = 0.06;\n    const xStart = -(x / 2 + marginX / 2);\n    const yStart = -(y / 2 + marginY / 2) - 0.002; // 0.01 to center text\n    const width = x + marginX;\n    const height = y + marginY;\n    const radius = 0.078;\n\n    const shape = new Shape();\n    shape.moveTo(xStart, yStart + radius);\n    shape.lineTo(xStart, yStart + height - radius);\n    shape.quadraticCurveTo(xStart, yStart + height, xStart + radius, yStart + height);\n    shape.lineTo(xStart + width - radius, yStart + height);\n    shape.quadraticCurveTo(\n      xStart + width,\n      yStart + height,\n      xStart + width,\n      yStart + height - radius,\n    );\n    shape.lineTo(xStart + width, yStart + radius);\n    shape.quadraticCurveTo(xStart + width, yStart, xStart + width - radius, yStart);\n    shape.lineTo(xStart + radius, yStart);\n    shape.quadraticCurveTo(xStart, yStart, xStart, yStart + radius);\n    // @ts-ignore\n    const geometry = new THREE.ShapeGeometry(shape);\n\n    const material = new THREE.MeshBasicMaterial({ color, side: THREE.DoubleSide });\n    const plane = new THREE.Mesh(geometry, material);\n    mesh.add(plane);\n    plane.position.set(0, 0, -0.01);\n  };\n\n  private render() {\n    this.renderFrame = requestAnimationFrame(this.render.bind(this));\n    if (this.viewer && this.mesh) {\n      const camera = this.viewer.getCamera();\n\n      // @ts-ignore\n      this.curQuaternion = this.mesh.parent.quaternion\n        .clone()\n        // @ts-ignore\n        .invert()\n        .multiply(camera.quaternion.clone());\n\n      this.mesh.setRotationFromQuaternion(this.curQuaternion);\n    }\n  }\n\n  public destroy() {\n    cancelAnimationFrame(this.renderFrame);\n  }\n}\n", "import {\n  // new THREE (r139)\n  Clock,\n  Vector3,\n} from 'three';\n\n// eslint-disable-next-line import/extensions\nimport { Avatar } from './Avatar';\nimport { Slot } from '../types';\n\nexport class Laser {\n  constructor(viewer: Autodesk.Viewing.GuiViewer3D, slot: Slot, laserOrigin: Vector3) {\n    this.viewer = viewer;\n    this.laserOrigin = laserOrigin;\n    this.clock = new Clock();\n    this.clock.start();\n    this.isDestroyed = false;\n\n    this.lerpAnimationFrame = requestAnimationFrame(this.animate.bind(this));\n    this.generateMaterial(slot);\n  }\n\n  private clock: Clock;\n  private lerpAnimationFrame: number;\n  private viewer: Autodesk.Viewing.GuiViewer3D;\n  private isDestroyed: boolean;\n\n  private position: THREE.Vector3 = new THREE.Vector3(0, 0, 0);\n  private quaternion: THREE.Quaternion = new THREE.Quaternion(0, 0, 0, 0);\n  private mousePosition: THREE.Vector3 = new THREE.Vector3(0, 0, 0);\n  private lerpedMousePosition = new THREE.Vector3(0, 0, 0);\n\n  private slot: Slot = null;\n  private laserOrigin: Vector3;\n\n  public mesh: THREE.Mesh;\n\n  private avatar: Avatar;\n\n  private material: THREE.Material = new THREE.MeshBasicMaterial();\n\n  public destroy() {\n    this.isDestroyed = true;\n    cancelAnimationFrame(this.lerpAnimationFrame);\n    if (this.mesh) {\n      this.viewer.overlays.removeMesh(this.mesh, 'avatars-scene');\n      this.mesh.geometry.dispose();\n      this.mesh = null;\n    }\n  }\n\n  public setAvatar(avatar: Avatar) {\n    if (!avatar) return;\n\n    this.avatar = avatar;\n  }\n\n  public setMousePosition(position: THREE.Vector3) {\n    if (!position) return;\n\n    this.mousePosition.set(position.x, position.y, position.z);\n  }\n\n  public setColorIndex(slot: Slot) {\n    if (slot !== this.slot && slot !== undefined) {\n      this.generateMaterial(slot);\n      this.slot = slot;\n    }\n  }\n\n  private animate() {\n    // this should run slower than 60fps, run this at 20fps so CPU is not cooked\n    const fps: number = 20;\n    const delta = this.clock.getDelta();\n    setTimeout(() => {\n      if (this.isDestroyed) {\n        return;\n      }\n      this.lerpAnimationFrame = requestAnimationFrame(this.animate.bind(this));\n    }, 1000 / fps);\n    if (!this.avatar) {\n      return;\n    }\n    if (this.mesh) {\n      this.mesh.geometry.dispose();\n      this.viewer.overlays.removeMesh(this.mesh, 'avatars-scene');\n    }\n    this.position = this.avatar.model.position;\n    this.quaternion = this.avatar.model.quaternion;\n\n    if (!this.position || !this.mousePosition || !this.quaternion || !this.material) {\n      return;\n    }\n    const startPosition = new THREE.Vector3(this.position.x, this.position.y, this.position.z);\n    const v1 = new THREE.Vector3(\n      this.laserOrigin.x,\n      this.laserOrigin.y,\n      this.laserOrigin.z,\n    ).applyQuaternion(\n      new THREE.Quaternion(\n        this.quaternion.x,\n        this.quaternion.y,\n        this.quaternion.z,\n        this.quaternion.w,\n      ),\n    );\n    startPosition.add(v1.multiplyScalar(1));\n\n    const speed = 1000;\n    this.lerpedMousePosition.lerp(this.mousePosition, (delta / 1000) * speed);\n    // @ts-ignore\n    const curve = new THREE.LineCurve3(\n      startPosition,\n      new THREE.Vector3(\n        this.lerpedMousePosition.x,\n        this.lerpedMousePosition.y,\n        this.lerpedMousePosition.z,\n      ),\n    );\n    const thickness: number = 0.005;\n    // @ts-ignore\n    const tube = new THREE.TubeGeometry(curve, 3, thickness, 4, false);\n\n    this.mesh = new THREE.Mesh(tube, this.material);\n    if (this.viewer.overlays.hasScene('avatars-scene')) {\n      this.viewer.overlays.addMesh(this.mesh, 'avatars-scene');\n    }\n  }\n\n  private createTextureCanvas() {\n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d');\n    canvas.width = 1;\n    canvas.height = 64;\n    // set gradient\n    const gradient = context.createLinearGradient(0, 0, canvas.width, canvas.height);\n    gradient.addColorStop(0, 'rgba(  0,  0,  0,0.2)');\n    gradient.addColorStop(0.1, 'rgba(160,160,160,0.5)');\n    gradient.addColorStop(0.5, 'rgba(255,255,255,0.8)');\n    gradient.addColorStop(0.9, 'rgba(160,160,160,0.5)');\n    gradient.addColorStop(1.0, 'rgba(  0,  0,  0,0.2)');\n    // fill the rectangle\n    context.fillStyle = gradient;\n    context.fillRect(0, 0, canvas.width, canvas.height);\n    // return the just built canvas\n    return canvas;\n  }\n\n  private generateMaterial(slot: Slot) {\n    const color = slot?.color ?? '#878291';\n    const canvas = this.createTextureCanvas();\n    const texture = new THREE.Texture(canvas);\n    texture.needsUpdate = true;\n    this.material = new THREE.MeshBasicMaterial({\n      map: texture,\n      blending: THREE.AdditiveBlending,\n      color,\n      side: THREE.DoubleSide,\n      depthWrite: false,\n      transparent: false,\n    });\n  }\n}\n", "import { Clock } from 'three';\n\nimport { Slot } from '../types';\n\nconst distanceBetween = (v1, v2) => {\n  const dx = v1.x - v2.x;\n  const dy = v1.y - v2.y;\n  const dz = v1.z - v2.z;\n  return Math.sqrt(dx * dx + dy * dy + dz * dz);\n};\nexport class Mouse {\n  constructor(viewer, userId) {\n    this.clock = new Clock();\n    this.viewer = viewer;\n    this.userId = userId;\n    this.renderFrame = requestAnimationFrame(this.render.bind(this));\n    this.renderDivWrapper();\n  }\n\n  private clock: Clock;\n  private destPos = new THREE.Vector3(0, 0, 0); // synced\n  private curScreenPos = new THREE.Vector2(0, 0);\n  public slot: Slot = null;\n  private userId: any;\n  private renderFrame: number;\n  private viewer: any;\n  private mousesWrapper: HTMLDivElement;\n\n  public async load(name: string, slot: Slot): Promise<THREE.Object3D> {\n    if (!name || slot === undefined) return;\n\n    return new Promise(() => {\n      const svg = `https://production.cdn.superviz.com/static/mouse-pointers/${slot.colorName}.svg`;\n\n      const mouseEl = document.createElement('div');\n      mouseEl.setAttribute('id', `mouse_${this.userId}`);\n      mouseEl.setAttribute('style', `background-image:url('${svg}')`);\n      mouseEl.style.position = 'absolute';\n      mouseEl.style.zIndex = '3';\n      mouseEl.style.width = '15px';\n      mouseEl.style.height = '15px';\n      mouseEl.style.pointerEvents = 'none';\n      mouseEl.style.transition = 'all 75ms ease';\n      mouseEl.style.top = '-100px';\n      mouseEl.style.left = '-100px';\n\n      this.mousesWrapper.appendChild(mouseEl);\n\n      const nameEl = document.createElement('div');\n\n      if (!name.trim().length) return;\n\n      const color = slot?.color ?? '#878291';\n      nameEl.setAttribute('style', `background-color:${color}`);\n      nameEl.style.borderRadius = '30px';\n      nameEl.style.fontSize = '14px';\n      nameEl.style.fontWeight = '700';\n      nameEl.style.zIndex = '3';\n      nameEl.style.fontWeight = '600';\n      nameEl.style.fontFamily = 'Open Sans';\n      nameEl.style.width = 'fit-content';\n      nameEl.style.whiteSpace = 'nowrap';\n\n      nameEl.innerHTML += name;\n      nameEl.style.marginLeft = '12px';\n      nameEl.style.marginTop = '9px';\n      nameEl.style.pointerEvents = 'none';\n\n      nameEl.style.color = slot?.textColor ?? '#fff';\n      nameEl.style.padding = '2px 8px 2px 8px';\n\n      mouseEl.appendChild(nameEl);\n    });\n  }\n\n  public update = (destPos: THREE.Vector3, slot: Slot) => {\n    if (slot !== undefined) {\n      this.slot = slot;\n    }\n\n    if (!destPos || (destPos.x === 0 && destPos.y === 0 && destPos.z === 0)) return;\n\n    this.destPos.x = destPos.x;\n    this.destPos.y = destPos.y;\n    this.destPos.z = destPos.z;\n  };\n\n  public destroy() {\n    cancelAnimationFrame(this.renderFrame);\n    const mouseEl = document.getElementById(`mouse_${this.userId}`);\n    mouseEl.remove();\n  }\n\n  private async render() {\n    this.renderDivWrapper();\n    this.renderFrame = requestAnimationFrame(this.render.bind(this));\n    if (this.destPos.x === 0 && this.destPos.y === 0) {\n      return;\n    }\n\n    const delta = this.clock.getDelta();\n    const speed = 2000;\n    const screenPos = this.viewer.worldToClient(this.destPos);\n    let opacity = 1;\n    // check occlusion\n    const localPoint3D = this.viewer.utilities.getHitPoint(\n      screenPos.x / this.mousesWrapper.clientWidth,\n      screenPos.y / this.mousesWrapper.clientHeight,\n    );\n    if (localPoint3D) {\n      const localPosition = this.viewer.navigation.getPosition();\n      const distanceLocally = distanceBetween(localPoint3D, localPosition);\n      const distanceOriginal = distanceBetween(this.destPos, localPosition);\n\n      if (Math.abs(distanceOriginal - distanceLocally) > 1) {\n        opacity = 0.2;\n      }\n    }\n\n    if (screenPos) {\n      this.curScreenPos.lerp(screenPos, (delta / 100) * speed);\n\n      const top = this.curScreenPos.y;\n      const left = this.curScreenPos.x;\n\n      if (top === 0 && left === 0) {\n        opacity = 0;\n      }\n\n      const mouseEl = document.getElementById(`mouse_${this.userId}`);\n\n      if (mouseEl) {\n        mouseEl.style.top = `${top}px`;\n        mouseEl.style.left = `${left}px`;\n        mouseEl.style.opacity = `${opacity}`;\n      } else {\n        console.warn('no mouse element');\n      }\n    }\n  }\n\n  private renderDivWrapper(): void {\n    const canvasRect = this.viewer.canvas.getBoundingClientRect();\n    let wrapper = document.getElementById('superviz-autodesk-mouse-wrapper') as HTMLDivElement;\n\n    if (!wrapper) {\n      wrapper = document.createElement('div');\n      wrapper.id = 'superviz-autodesk-mouse-wrapper';\n    }\n\n    wrapper.style.position = 'absolute';\n    wrapper.style.top = `${this.viewer.canvas.offsetTop}px`;\n    wrapper.style.left = `${this.viewer.canvas.offsetLeft}px`;\n    wrapper.style.width = `${canvasRect.width}px`;\n    wrapper.style.height = `${canvasRect.height}px`;\n    wrapper.style.pointerEvents = 'none';\n    wrapper.style.overflow = 'hidden';\n\n    if (this.viewer.canvas.parentElement.style.position === 'static') {\n      this.viewer.canvas.parentElement.style.position = 'relative';\n    }\n\n    if (!document.getElementById('superviz-autodesk-mouse-wrapper')) {\n      this.viewer.canvas.parentElement.appendChild(wrapper);\n    }\n\n    this.mousesWrapper = wrapper;\n  }\n}\n", "// eslint-disable-next-line max-classes-per-file\nimport type {\n  Annotation,\n  PinAdapter,\n  PinCoordinates,\n  Observer as ObserverType,\n} from '@superviz/sdk';\nimport { Vector3 } from 'three';\n\nimport { Logger } from '../common/utils/logger';\nimport { Observer } from '../common/utils/observer';\n\nimport { HorizontalSide, Sides, SimpleParticipant, ParticipantByGroupApi } from './types';\n\nlet self: AutodeskPin;\n\ntype AnnotationPositionInfo = {\n  position: PinCoordinates;\n  camera: Vector3;\n};\n\nexport class AutodeskPin implements PinAdapter {\n  private logger: Logger;\n  private isPinsVisible: boolean = true;\n  private isActive: boolean;\n  private annotations: Annotation[];\n  private pins: Map<string, HTMLElement>;\n  private viewer: Autodesk.Viewing.GuiViewer3D;\n  private showcaseSides: Sides;\n  private selectedPin: HTMLElement | null;\n  private divWrapper: HTMLElement;\n  private mouseElement: HTMLElement;\n  private temporaryPinCoordinates: PinCoordinates;\n  private pinHeight: number;\n  public onPinFixedObserver: ObserverType;\n  private commentsSide: HorizontalSide = 'left';\n  private localParticipant: SimpleParticipant = {};\n  private participants: ParticipantByGroupApi[];\n  private renderFrame: number;\n  private isDragging: boolean = false;\n  private hasLayerSelected: boolean = false;\n\n  constructor(viewer: Autodesk.Viewing.GuiViewer3D) {\n    self = this;\n    this.viewer = viewer;\n    this.logger = new Logger('@superviz/sdk/comments-component/autodesk-adapter');\n    this.isActive = false;\n    this.pins = new Map();\n    this.pinHeight = 32;\n\n    this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraMove);\n    this.viewer.addEventListener(\n      Autodesk.Viewing.AGGREGATE_SELECTION_CHANGED_EVENT,\n      this.onAggregateSelectionChanged,\n    );\n\n    document.body.addEventListener('select-annotation', this.annotationSelected);\n    document.body.addEventListener('toggle-annotation-sidebar', this.onToggleAnnotationSidebar);\n    document.body.style.position = 'relative';\n\n    this.onPinFixedObserver = new Observer() as unknown as ObserverType;\n    this.annotations = [];\n    this.renderAnnotationsPins();\n    this.showcaseSides = this.viewer.canvas.getBoundingClientRect();\n    this.renderDivWrapper();\n    this.renderFrame = requestAnimationFrame(this.animate);\n  }\n\n  /**\n   * @function destroy\n   * @description destroys the canvas pin adapter.\n   * @returns {void}\n   * */\n  public destroy(): void {\n    this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraMove);\n    this.viewer.removeEventListener(\n      Autodesk.Viewing.AGGREGATE_SELECTION_CHANGED_EVENT,\n      this.onAggregateSelectionChanged,\n    );\n    document.body.removeEventListener('select-annotation', this.annotationSelected);\n    document.body.removeEventListener('toggle-annotation-sidebar', this.onToggleAnnotationSidebar);\n    this.removeAnnotationsPins();\n    this.removeListeners();\n    cancelAnimationFrame(this.renderFrame);\n    this.mouseElement = null;\n  }\n\n  /**\n   * @function setActive\n   * @param {boolean} isOpen - Whether the canvas pin adapter is active or not.\n   * @returns {void}\n   */\n  public setActive(isOpen: boolean): void {\n    this.isActive = isOpen;\n\n    if (this.isActive) {\n      this.addListeners();\n      return;\n    }\n\n    this.removeListeners();\n  }\n\n  public setPinsVisibility(isVisible: boolean): void {\n    this.isPinsVisible = isVisible;\n\n    if (this.isPinsVisible) {\n      this.renderAnnotationsPins();\n      return;\n    }\n\n    this.removeAnnotationsPins();\n  }\n\n  /**\n   * @function animate\n   * @description animates the canvas pin adapter.\n   * @returns {void}\n   */\n  private animate = () => {\n    this.positionWrapper();\n    this.renderFrame = requestAnimationFrame(this.animate);\n  };\n\n  /**\n   * @function positionWrapper\n   * @description reposition the div wrapper to adapt to the canvas current position.\n   * @returns {void}\n   */\n  private positionWrapper() {\n    const canvasRect = this.viewer.canvas.getBoundingClientRect();\n    this.divWrapper.style.position = 'fixed';\n    this.divWrapper.style.top = `${canvasRect.top}px`;\n    this.divWrapper.style.left = `${canvasRect.left}px`;\n    this.divWrapper.style.width = `${canvasRect.width}px`;\n    this.divWrapper.style.height = `${canvasRect.height}px`;\n  }\n\n  /**\n   * @function updateAnnotations\n   * @description updates the annotations of the canvas.\n   * @param {Annotation[]} annotations - New annotation to be added to the canvas.\n   * @returns {void}\n   */\n  public updateAnnotations(annotations: Annotation[]): void {\n    this.logger.log('updateAnnotations', annotations);\n\n    this.annotations = annotations;\n\n    if (!this.isActive && !this.isPinsVisible) return;\n\n    this.removeAnnotationsPins();\n    this.renderAnnotationsPins();\n  }\n\n  /**\n   * @function removeAnnotationPin\n   * @description Removes an annotation pin from the canvas.\n   * @param {string} uuid - The uuid of the annotation to be removed.\n   * @returns {void}\n   * */\n  public removeAnnotationPin(uuid: string): void {\n    const pinElement = this.pins.get(uuid);\n\n    if (!pinElement) return;\n\n    pinElement.remove();\n    this.pins.delete(uuid);\n    this.annotations = this.annotations.filter((annotation) => annotation.uuid !== uuid);\n  }\n\n  /**\n   * @function createTemporaryPin\n   * @description\n          creates a temporary pin with the id\n          temporary-pin to mark where the annotation is being created\n   * @param {PinCoordinates} coordinates  - The coordinates of the pin to be created.\n   */\n  public createTemporaryPin(coordinates: PinCoordinates): void {\n    let temporaryPin = document.getElementById('superviz-temporary-pin');\n    this.temporaryPinCoordinates = coordinates;\n\n    if (!temporaryPin) {\n      temporaryPin = document.createElement('superviz-comments-annotation-pin');\n      temporaryPin.id = 'superviz-temporary-pin';\n      const add = 'add';\n      temporaryPin.setAttribute('type', add);\n      temporaryPin.setAttribute('showInput', '');\n      temporaryPin.setAttribute('containerSides', JSON.stringify(this.showcaseSides));\n      temporaryPin.setAttribute('commentsSide', this.commentsSide);\n      temporaryPin.setAttribute('localAvatar', this.localParticipant.avatar ?? '');\n      temporaryPin.setAttribute('participantsList', JSON.stringify(this.participants));\n      temporaryPin.setAttribute('localName', this.localParticipant.name ?? '');\n      temporaryPin.setAttribute('position', JSON.stringify(this.temporaryPinCoordinates));\n      temporaryPin.setAttribute('annotation', JSON.stringify({}));\n      temporaryPin.setAttributeNode(document.createAttribute('active'));\n      temporaryPin.style.pointerEvents = 'auto';\n    }\n\n    const posScreen = this.position3DToScreen(coordinates, 0, this.pinHeight);\n\n    const screenCoordinates = {\n      x: posScreen.left,\n      y: posScreen.top,\n      type: coordinates.type,\n    };\n\n    temporaryPin.setAttribute('position', JSON.stringify(screenCoordinates));\n\n    this.divWrapper.appendChild(temporaryPin);\n    this.pins.set('temporary-pin', temporaryPin);\n    this.renderAnnotationsPins();\n  }\n\n  /**\n   * @function setCommentsMetadata\n   * @description sets metadata about how the comments was initialized and the user avatar\n   * @param {string} side  - The side of the window where the comments are\n   * @param {string} avatar  - The avatar of the user\n   */\n  public setCommentsMetadata = (side: 'left' | 'right'): void => {\n    this.commentsSide = side;\n  };\n\n  /**\n   * @function addListeners\n   * @description adds event listeners to the canvas element.\n   * @returns {void}\n   */\n  private addListeners(): void {\n    this.viewer.canvas.addEventListener('mouseup', this.onMouseUp);\n    this.viewer.canvas.addEventListener('mousedown', this.onMouseDown);\n    this.viewer.canvas.addEventListener('mousemove', this.onMouseMove);\n    this.viewer.canvas.addEventListener('mouseout', this.onMouseLeave);\n    this.viewer.canvas.addEventListener('mouseenter', this.onMouseEnter);\n    document.body.addEventListener('keyup', this.resetPins);\n    document.body.addEventListener('click', this.hideTemporaryPin);\n  }\n\n  /**\n   * @function removeListeners\n   * @description removes event listeners from the canvas element.\n   * @returns {void}\n   * */\n  private removeListeners(): void {\n    this.viewer.canvas.removeEventListener('mouseup', this.onMouseUp);\n    this.viewer.canvas.removeEventListener('mousedown', this.onMouseDown);\n    this.viewer.canvas.removeEventListener('mousemove', this.onMouseMove);\n    this.viewer.canvas.removeEventListener('mouseout', this.onMouseLeave);\n    this.viewer.canvas.removeEventListener('mouseenter', this.onMouseEnter);\n    document.body.removeEventListener('keyup', this.resetPins);\n    document.body.removeEventListener('click', this.hideTemporaryPin);\n  }\n\n  private onAggregateSelectionChanged = (event): void => {\n    this.hasLayerSelected = !!event.selections.length;\n    this.renderAnnotationsPins();\n  };\n\n  private onCameraMove = (): void => {\n    if (!this.isActive && !this.isPinsVisible) return;\n\n    this.renderAnnotationsPins();\n  };\n\n  /**\n   * @function renderAnnotationsPins\n   * @description Renders the annotations on the canvas.\n   * @returns {void}\n   */\n  private async renderAnnotationsPins(): Promise<void> {\n    this.annotations.forEach(async (annotation) => {\n      const positionInfo = JSON.parse(annotation.position) as AnnotationPositionInfo;\n      const coordinates: PinCoordinates = positionInfo.position;\n\n      if (coordinates?.type !== 'autodesk' || annotation.resolved) {\n        return;\n      }\n\n      if (!this.pins.has(annotation.uuid)) {\n        this.createPin(annotation, coordinates);\n        return;\n      }\n      const posScreen = this.position3DToScreen(coordinates, 0, this.pinHeight);\n\n      const visible = await this.checkIsVisible(posScreen, coordinates);\n      const pin = this.pins.get(annotation.uuid);\n      if (visible) {\n        pin.setAttribute('style', 'opacity: 1');\n\n        this.pins\n          .get(annotation.uuid)\n          .setAttribute('position', JSON.stringify({ x: posScreen.left, y: posScreen.top }));\n      } else {\n        pin.setAttribute('style', 'opacity: 0');\n      }\n    });\n\n    if (this.pins.get('temporary-pin')) {\n      const posScreen = this.position3DToScreen(this.temporaryPinCoordinates, 0, this.pinHeight);\n      const visible = await this.checkIsVisible(posScreen, this.temporaryPinCoordinates);\n      const temporaryPin = this.pins.get('temporary-pin');\n      if (visible) {\n        temporaryPin.setAttribute('style', 'opacity: 1');\n\n        temporaryPin.setAttribute(\n          'position',\n          JSON.stringify({ x: posScreen.left, y: posScreen.top }),\n        );\n      } else {\n        temporaryPin.setAttribute('style', 'opacity: 0');\n      }\n    }\n  }\n\n  /**\n   * @function createPin\n   * @description\n          creates a temporary the actual pin\n   * @param {Annotation} annotation  - The annotation saved in the database\n   * @param {PinCoordinates} coordinates  - The coordinates of the pin to be created.\n   */\n  private createPin(annotation: Annotation, coordinates: PinCoordinates) {\n    const posScreen = this.position3DToScreen(coordinates, 0, this.pinHeight);\n\n    const pinElement = document.createElement('superviz-comments-annotation-pin');\n    this.divWrapper.appendChild(pinElement);\n    pinElement.setAttribute('type', 'show');\n    pinElement.setAttribute('annotation', JSON.stringify(annotation));\n    pinElement.setAttribute('position', JSON.stringify({ x: posScreen.left, y: posScreen.top }));\n    pinElement.setAttribute('participantsList', JSON.stringify(this.participants));\n    pinElement.style.pointerEvents = 'auto';\n    this.pins.set(annotation.uuid, pinElement);\n  }\n\n  private onClickedPin(positionInfo: AnnotationPositionInfo): void {\n    const coordinates = positionInfo.position;\n    const camera = this.viewer.navigation.getCamera();\n    camera.updateMatrixWorld();\n    const originalCameraPosition: THREE.Vector3 = new Vector3(\n      positionInfo.camera.x,\n      positionInfo.camera.y,\n      positionInfo.camera.z,\n    );\n    const position = new THREE.Vector3(coordinates.x, coordinates.y, coordinates.z);\n    let destPosition;\n    if (position.distanceTo(originalCameraPosition) > 5) {\n      destPosition = originalCameraPosition.lerp(position, 0.6);\n    } else {\n      destPosition = originalCameraPosition;\n    }\n\n    this.onPinFixedObserver.publish({\n      x: positionInfo.position.x,\n      y: positionInfo.position.y,\n      z: positionInfo.position.z,\n      type: 'autodesk',\n    });\n\n    // @ts-ignore\n    this.viewer.utilities.setPivotPoint(position, false, false);\n    // @ts-ignore\n    this.viewer.utilities.transitionView(\n      destPosition,\n      position,\n      camera.fov,\n      camera.up,\n      camera.worldup,\n      true,\n      position,\n    );\n  }\n\n  private removeAnnotationsPins(): void {\n    this.pins.forEach((pinElement) => {\n      pinElement.remove();\n    });\n\n    this.pins.clear();\n  }\n\n  /** Callbacks  */\n\n  // when an annotation is selected, it will highlight the pin\n  private annotationSelected = ({ detail }: CustomEvent): void => {\n    const { uuid, haltGoToPin, newPin } = detail;\n    if (!uuid) return;\n\n    if (newPin) {\n      const pin = this.pins.get(uuid);\n      pin.setAttribute('newPin', '');\n    }\n\n    const annotation = JSON.parse(this.selectedPin?.getAttribute('annotation') ?? '{}');\n\n    this.resetPins();\n\n    if (annotation?.uuid === uuid) return;\n\n    document.body.dispatchEvent(new CustomEvent('close-temporary-annotation'));\n\n    const pinElement = this.pins.get(uuid);\n\n    if (!pinElement) return;\n\n    pinElement.setAttribute('active', '');\n    this.selectedPin = pinElement;\n\n    const { position } = this.annotations.find((ann) => ann.uuid === uuid);\n    if (position && !haltGoToPin) {\n      const info = JSON.parse(position) as AnnotationPositionInfo;\n      this.onClickedPin(info);\n    }\n  };\n\n  /**\n   * @function resetSelectedPin\n   * @description Unselects a pin by removing its 'active' attribute\n   * @returns {void}\n   * */\n  private resetSelectedPin(): void {\n    if (!this.selectedPin) return;\n    this.selectedPin.removeAttribute('active');\n    this.selectedPin = null;\n  }\n\n  /*\n   * @function hideTemporaryPin\n   * @description hides the temporary pin if click outside an observed element\n   * @param {MouseEvent} event the mouse event object\n   * @returns {void}\n   */\n  private hideTemporaryPin = (event: MouseEvent): void => {\n    const target = event.target as HTMLElement;\n\n    if (this.viewer.canvas.contains(target) || this.pins.get('temporary-pin')?.contains(target)) {\n      return;\n    }\n\n    this.removeAnnotationPin('temporary-pin');\n  };\n\n  /**\n   * @function participantsList\n   * @description - all participants of developer groupId\n   * @param participants - all participants list\n   */\n  public set participantsList(participants: ParticipantByGroupApi[]) {\n    this.participants = participants;\n  }\n\n  /**\n   * @function resetPins\n   * @description Unselects selected pin and removes temporary pin.\n   * @param {that} this - The canvas pin adapter instance.\n   * @param {KeyboardEvent} event - The keyboard event object.\n   * @returns {void}\n   * */\n  private resetPins = (event?: KeyboardEvent): void => {\n    if (event && event?.key !== 'Escape') return;\n\n    this.resetSelectedPin();\n    this.removeAnnotationPin('temporary-pin');\n    this.temporaryPinCoordinates = null;\n  };\n\n  /**\n   * @function renderDivWrapper\n   * @description Creates a div wrapper for the pins.\n   * */\n  private renderDivWrapper = (): void => {\n    const canvasRect = this.viewer.canvas.getBoundingClientRect();\n    let wrapper = this.divWrapper;\n\n    if (!wrapper) {\n      wrapper = document.createElement('div');\n      wrapper.id = 'superviz-autodesk-pins-wrapper';\n    }\n\n    wrapper.style.position = 'fixed';\n    wrapper.style.top = `${this.viewer.canvas.offsetTop}px`;\n    wrapper.style.left = `${this.viewer.canvas.offsetLeft}px`;\n    wrapper.style.width = `${canvasRect.width}px`;\n    wrapper.style.height = `${canvasRect.height}px`;\n    wrapper.style.pointerEvents = 'none';\n    wrapper.style.overflow = 'hidden';\n    wrapper.style.zIndex = '1';\n\n    if (!document.getElementById('superviz-autodesk-pins-wrapper')) {\n      document.body.appendChild(wrapper);\n    }\n\n    this.divWrapper = wrapper;\n  };\n\n  /**\n   * @function position3DToScreen\n   * @description translates a 3D coordinate to a 2D screen position\n   * @returns 2D screen coordinate\n   * */\n  private position3DToScreen(position3D: Vector3, offsetX, offsetY) {\n    const vector = this.viewer.worldToClient(position3D);\n    return {\n      top: vector.y - offsetY,\n      left: vector.x - offsetX,\n    };\n  }\n\n  /**\n   * @function checkIsVisible\n   * @description check if a pin is in the cameras view\n   * @returns boolean\n   * */\n  private async checkIsVisible(screenPos, originalPosition) {\n    let visible = true;\n\n    const hitTest = this.viewer.clientToWorld(\n      screenPos.left,\n      screenPos.top + this.pinHeight,\n      false,\n    );\n\n    if (hitTest) {\n      const hitPosition = hitTest.point;\n\n      const distanceLocally = this.distanceBetween(hitPosition, originalPosition);\n      const distance = Math.abs(distanceLocally);\n\n      const threshold = this.hasLayerSelected ? 8 : 3;\n\n      if (distance > threshold) {\n        visible = false;\n      }\n    }\n\n    return visible;\n  }\n\n  private distanceBetween = (v1, v2) => {\n    const dx = v1.x - v2.x;\n    const dy = v1.y - v2.y;\n    const dz = v1.z - v2.z;\n    return Math.sqrt(dx * dx + dy * dy + dz * dz);\n  };\n\n  /**\n   * @function createMouseElement\n   * @description Creates a new mouse element for the canvas pin adapter.\n   * @returns {HTMLElement} The newly created mouse element.\n   */\n  private createMouseElement(): HTMLElement {\n    const mouseElement = document.createElement('superviz-comments-annotation-pin');\n    mouseElement.setAttribute('type', 'add');\n    mouseElement.setAttribute('annotation', JSON.stringify({}));\n    mouseElement.setAttribute('position', JSON.stringify({ x: 0, y: 0 }));\n    document.body.appendChild(mouseElement);\n\n    this.viewer.canvas.style.cursor = 'none';\n\n    return mouseElement;\n  }\n\n  private onMouseUp = (event: MouseEvent): void => {\n    if (this.isDragging) return;\n\n    const hitTest = this.viewer.clientToWorld(event.offsetX, event.offsetY, false);\n    const mousePosition = hitTest.point;\n\n    if (mousePosition) {\n      const coordinates: PinCoordinates = {\n        x: mousePosition.x,\n        y: mousePosition.y,\n        z: mousePosition.z,\n        type: 'autodesk',\n      };\n\n      const camera = this.viewer.navigation.getCamera();\n      camera.updateMatrixWorld();\n      const origin: THREE.Vector3 = new Vector3(0, 0, 0);\n      camera.getWorldPosition(origin);\n      const positionInfo: AnnotationPositionInfo = {\n        position: coordinates,\n        camera: origin,\n      };\n\n      this.resetSelectedPin();\n      this.onPinFixedObserver.publish(positionInfo);\n      this.createTemporaryPin(coordinates);\n    }\n  };\n\n  /**\n   * @function onMouseDown\n   * @description handles the mouse down event on the canvas.\n   * @param event - The mouse event object.\n   * @returns {void}\n   */\n  private onMouseDown = (event: MouseEvent): void => {\n    this.isDragging = false;\n  };\n\n  /**\n   * @function onMouseMove\n   * @description handles the mouse move event on the canvas.\n   * @param event - The mouse event object.\n   * @returns {void}\n   */\n  private onMouseMove = (event: MouseEvent): void => {\n    this.isDragging = true;\n\n    const { x, y } = event;\n\n    if (!this.mouseElement) {\n      this.mouseElement = this.createMouseElement();\n    }\n    const adjustedY = y - this.pinHeight;\n    this.mouseElement.setAttribute('position', JSON.stringify({ x, y: adjustedY }));\n  };\n\n  /**\n   * @function onMouseLeave\n   * @description\n      Removes the mouse element and sets the canvas cursor\n      to default when the mouse leaves the canvas.\n   * @returns {void}\n   */\n  private onMouseLeave = (): void => {\n    if (this.mouseElement) {\n      this.mouseElement.remove();\n      this.mouseElement = null;\n    }\n\n    this.viewer.canvas.style.cursor = 'default';\n  };\n\n  /**\n   * @function onMouseEnter\n   * @description\n        Handles the mouse enter event for the canvas pin adapter.\n        If there is no mouse element, creates one.\n   * @returns {void}\n   */\n  private onMouseEnter = (): void => {\n    if (this.mouseElement) return;\n\n    this.mouseElement = this.createMouseElement();\n  };\n\n  private onToggleAnnotationSidebar = ({ detail }: CustomEvent): void => {\n    const { open } = detail;\n\n    if (open) return;\n\n    this.pins.forEach((pinElement) => {\n      pinElement.removeAttribute('active');\n    });\n\n    if (this.pins.has('temporary-pin')) {\n      this.removeAnnotationPin('temporary-pin');\n    }\n  };\n}\n", "import debug from 'debug';\n\nexport type Message = string | Error | number | Object;\n\nexport class Logger {\n  private debug: debug.Debugger;\n\n  constructor(scope: string) {\n    this.debug = debug(scope);\n  }\n\n  log(formatter: Message, ...args: Array<Message>) {\n    this.debug(formatter, ...args);\n  }\n}\n", "import throttle from 'lodash/throttle';\n\nimport { Logger } from './logger';\n\nexport type OberverOptions = {\n  throttleTime?: number;\n  logger?: Logger;\n};\n\nexport class Observer {\n  private logger: Logger;\n  private callbacks: Function[];\n  private throttle: number;\n\n  constructor(options: OberverOptions = {}) {\n    const { logger, throttleTime } = options;\n\n    this.logger = logger ?? new Logger('@superviz/sdk/observer-helper');\n    this.throttle = throttleTime;\n    this.callbacks = [];\n\n    if (this.throttle) {\n      this.publish = throttle(this.publish, this.throttle);\n    }\n  }\n\n  /**\n   * @function subscribe\n   * @description Subscribe to observer\n   * @param callback\n   * @returns {void}\n   */\n  public subscribe = (callback: Function): void => {\n    this.callbacks.push(callback);\n  };\n\n  /**\n   * @function unsubscribe\n   * @description Unsubscribe from observer\n   * @param callbackToRemove\n   * @returns {void}\n   */\n  public unsubscribe = (callbackToRemove: Function): void => {\n    this.callbacks = this.callbacks.filter((callback: Function) => callback !== callbackToRemove);\n  };\n\n  /**\n   * @function publish\n   * @description Publish event to all subscribers\n   * @param event\n   * @returns {void}\n   */\n  public publish = (...event: any[]): void => {\n    if (!this.callbacks) return;\n\n    this.callbacks.forEach((callback: Function) => {\n      this.callListener(callback, event).catch((error: Error) => {\n        this.logger.log(\n          'superviz-sdk:observer-helper:publish:error',\n          `\n            Failed to execute callback on publish value.\n            Callback: ${callback}\n            Event: ${JSON.stringify(event)}\n            Error: ${error}\n          `,\n        );\n      });\n    });\n  };\n\n  /**\n   * @function reset\n   * @description Reset observer\n   * @returns {void}\n   */\n  public reset = (): void => {\n    this.callbacks = [];\n  };\n\n  /**\n   * @function destroy\n   * @description Destroy observer\n   * @returns {void}\n   */\n  public destroy = (): void => {\n    delete this.logger;\n    delete this.callbacks;\n  };\n\n  /**\n   * @function callListener\n   * @description Call listener with params\n   * @param listener\n   * @param params\n   * @returns\n   */\n  private callListener = (listener: Function, params: any[]): Promise<unknown> => {\n    return new Promise((resolve, reject) => {\n      try {\n        const result = listener(...params);\n        resolve(result);\n      } catch (error) {\n        reject(error);\n      }\n    });\n  };\n}\n", "import debug from 'debug';\n\nexport type Message = string | Error | number | Object;\n\nexport class Logger {\n  private debug: debug.Debugger;\n\n  constructor(scope: string) {\n    this.debug = debug(scope);\n  }\n\n  log(formatter: Message, ...args: Array<Message>) {\n    this.debug(formatter, ...args);\n  }\n}\n"],
  "mappings": "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",
  "names": ["src_exports", "__export", "AutodeskPin", "Presence3D", "__toCommonJS", "import_lodash", "import_three", "import_three", "REVISION", "FrontSide", "BackSide", "DoubleSide", "FlatShading", "NormalBlending", "AddEquation", "SrcAlphaFactor", "OneMinusSrcAlphaFactor", "LessEqualDepth", "MultiplyOperation", "UVMapping", "RepeatWrapping", "ClampToEdgeWrapping", "MirroredRepeatWrapping", "NearestFilter", "NearestMipmapNearestFilter", "NearestMipmapLinearFilter", "LinearFilter", "LinearMipmapNearestFilter", "LinearMipmapLinearFilter", "UnsignedByteType", "FloatType", "RGBAFormat", "InterpolateDiscrete", "InterpolateLinear", "InterpolateSmooth", "ZeroCurvatureEnding", "ZeroSlopeEnding", "WrapAroundEnding", "NormalAnimationBlendMode", "AdditiveAnimationBlendMode", "TriangleStripDrawMode", "TriangleFanDrawMode", "LinearEncoding", "sRGBEncoding", "BasicDepthPacking", "TangentSpaceNormalMap", "SRGBColorSpace", "LinearSRGBColorSpace", "KeepStencilOp", "AlwaysStencilFunc", "StaticDrawUsage", "EventDispatcher", "type", "listener", "listeners", "listenerArray", "index", "event", "array", "i", "l", "MathUtils_exports", "__export", "DEG2RAD", "RAD2DEG", "ceilPowerOfTwo", "clamp", "damp", "degToRad", "denormalize", "euclideanModulo", "floorPowerOfTwo", "generateUUID", "inverseLerp", "isPowerOfTwo", "lerp", "mapLinear", "normalize", "pingpong", "radToDeg", "randFloat", "randFloatSpread", "randInt", "seededRandom", "setQuaternionFromProperEuler", "smootherstep", "smoothstep", "_lut", "i", "_seed", "d0", "d1", "d2", "d3", "value", "min", "max", "n", "m", "x", "a1", "a2", "b1", "b2", "y", "t", "lambda", "dt", "length", "low", "high", "range", "s", "degrees", "radians", "q", "a", "b", "c", "order", "cos", "sin", "c2", "s2", "c13", "s13", "c1_3", "s1_3", "c3_1", "s3_1", "array", "Vector2", "x", "y", "value", "scalar", "index", "v", "w", "s", "a", "b", "m", "e", "min", "max", "minVal", "maxVal", "length", "dx", "dy", "alpha", "v1", "v2", "array", "offset", "attribute", "center", "angle", "c", "Matrix3", "n11", "n12", "n13", "n21", "n22", "n23", "n31", "n32", "n33", "te", "m", "me", "xAxis", "yAxis", "zAxis", "a", "b", "ae", "be", "a11", "a12", "a13", "a21", "a22", "a23", "a31", "a32", "a33", "b11", "b12", "b13", "b21", "b22", "b23", "b31", "b32", "b33", "s", "c", "d", "e", "f", "g", "h", "i", "t11", "t12", "t13", "det", "detInv", "tmp", "matrix4", "r", "tx", "ty", "sx", "sy", "rotation", "cx", "cy", "theta", "matrix", "array", "offset", "arrayNeedsUint32", "array", "i", "createElementNS", "name", "SRGBToLinear", "c", "LinearToSRGB", "FN", "SRGBColorSpace", "LinearSRGBColorSpace", "ColorManagement", "colorSpace", "color", "sourceColorSpace", "targetColorSpace", "fn", "_colorKeywords", "_rgb", "_hslA", "_hslB", "hue2rgb", "p", "q", "t", "toComponents", "source", "target", "Color", "r", "g", "b", "value", "scalar", "hex", "colorSpace", "SRGBColorSpace", "ColorManagement", "LinearSRGBColorSpace", "h", "s", "l", "euclideanModulo", "clamp", "style", "handleAlpha", "string", "m", "color", "name", "components", "size", "SRGBToLinear", "LinearToSRGB", "max", "min", "hue", "saturation", "lightness", "delta", "color1", "color2", "alpha", "lerp", "c", "array", "offset", "attribute", "index", "_canvas", "ImageUtils", "image", "canvas", "createElementNS", "context", "imageData", "data", "i", "SRGBToLinear", "Source", "data", "generateUUID", "value", "meta", "isRootObject", "output", "url", "i", "l", "serializeImage", "image", "ImageUtils", "textureId", "Texture", "_Texture", "EventDispatcher", "image", "mapping", "wrapS", "ClampToEdgeWrapping", "wrapT", "magFilter", "LinearFilter", "minFilter", "LinearMipmapLinearFilter", "format", "RGBAFormat", "type", "UnsignedByteType", "anisotropy", "encoding", "LinearEncoding", "generateUUID", "Source", "Vector2", "Matrix3", "value", "source", "meta", "isRootObject", "output", "uv", "UVMapping", "RepeatWrapping", "MirroredRepeatWrapping", "Vector4", "x", "y", "z", "w", "value", "scalar", "index", "v", "s", "a", "b", "m", "e", "q", "angle", "te", "m11", "m12", "m13", "m21", "m22", "m23", "m31", "m32", "m33", "xx", "yy", "zz", "xy", "xz", "yz", "min", "max", "minVal", "maxVal", "length", "alpha", "v1", "v2", "array", "offset", "attribute", "Quaternion", "x", "y", "z", "w", "qa", "qb", "qm", "t", "dst", "dstOffset", "src0", "srcOffset0", "src1", "srcOffset1", "x0", "y0", "z0", "w0", "x1", "y1", "z1", "w1", "s", "cos", "dir", "sqrSin", "sin", "len", "tDir", "f", "value", "quaternion", "euler", "update", "order", "c1", "c2", "c3", "s1", "s2", "s3", "axis", "angle", "halfAngle", "m", "te", "m11", "m12", "m13", "m21", "m22", "m23", "m31", "m32", "m33", "trace", "vFrom", "vTo", "r", "q", "clamp", "step", "v", "l", "p", "a", "b", "qax", "qay", "qaz", "qaw", "qbx", "qby", "qbz", "qbw", "cosHalfTheta", "sqrSinHalfTheta", "sinHalfTheta", "halfTheta", "ratioA", "ratioB", "u1", "sqrt1u1", "sqrtu1", "u2", "u3", "array", "offset", "attribute", "index", "callback", "Vector3", "x", "y", "z", "scalar", "index", "value", "v", "w", "s", "a", "b", "euler", "_quaternion", "axis", "angle", "m", "e", "q", "qx", "qy", "qz", "qw", "ix", "iy", "iz", "iw", "camera", "min", "max", "minVal", "maxVal", "length", "alpha", "v1", "v2", "ax", "ay", "az", "bx", "by", "bz", "denominator", "planeNormal", "_vector", "normal", "theta", "clamp", "dx", "dy", "dz", "radius", "phi", "sinPhiRadius", "c", "sx", "sy", "sz", "array", "offset", "attribute", "u", "t", "f", "Quaternion", "Box3", "min", "Vector3", "max", "array", "minX", "minY", "minZ", "maxX", "maxY", "maxZ", "i", "l", "x", "y", "z", "attribute", "points", "il", "center", "size", "halfSize", "_vector", "object", "precise", "box", "target", "point", "vector", "scalar", "geometry", "position", "_box", "children", "sphere", "plane", "triangle", "_center", "_extents", "_v0", "_v1", "_v2", "_f0", "_f1", "_f2", "axes", "satForAxes", "_triangleNormal", "matrix", "_points", "offset", "_testAxis", "v0", "v1", "v2", "extents", "j", "r", "p0", "p1", "p2", "_box", "Box3", "_v1", "Vector3", "_toFarthestPoint", "_toPoint", "Sphere", "center", "radius", "points", "optionalCenter", "maxRadiusSq", "i", "il", "sphere", "point", "radiusSum", "box", "plane", "target", "deltaLengthSq", "matrix", "offset", "lengthSq", "length", "missingRadiusHalf", "_vector", "Vector3", "_segCenter", "_segDir", "_diff", "_edge1", "_edge2", "_normal", "Ray", "origin", "direction", "ray", "target", "v", "point", "directionDistance", "v0", "v1", "optionalPointOnRay", "optionalPointOnSegment", "segExtent", "a01", "b0", "b1", "c", "det", "s0", "s1", "sqrDist", "extDet", "invDet", "sphere", "tca", "d2", "radius2", "thc", "t0", "t1", "plane", "denominator", "t", "distToPoint", "box", "tmin", "tmax", "tymin", "tymax", "tzmin", "tzmax", "invdirx", "invdiry", "invdirz", "a", "b", "backfaceCulling", "DdN", "sign", "DdQxE2", "DdE1xQ", "QdN", "matrix4", "Matrix4", "_Matrix4", "n11", "n12", "n13", "n14", "n21", "n22", "n23", "n24", "n31", "n32", "n33", "n34", "n41", "n42", "n43", "n44", "te", "m", "me", "xAxis", "yAxis", "zAxis", "scaleX", "_v1", "scaleY", "scaleZ", "euler", "x", "y", "z", "b", "d", "e", "f", "ae", "af", "be", "bf", "ce", "cf", "de", "df", "ac", "ad", "bc", "bd", "q", "_zero", "_one", "eye", "target", "up", "_z", "_x", "_y", "n", "a", "a11", "a12", "a13", "a14", "a21", "a22", "a23", "a24", "a31", "a32", "a33", "a34", "a41", "a42", "a43", "a44", "b11", "b12", "b13", "b14", "b21", "b22", "b23", "b24", "b31", "b32", "b33", "b34", "b41", "b42", "b43", "b44", "s", "tmp", "t11", "t12", "t13", "t14", "det", "detInv", "v", "scaleXSq", "scaleYSq", "scaleZSq", "theta", "c", "axis", "angle", "t", "tx", "ty", "xy", "xz", "yx", "yz", "zx", "zy", "position", "quaternion", "scale", "w", "x2", "y2", "z2", "xx", "yy", "zz", "wx", "wy", "wz", "sx", "sy", "sz", "_m1", "invSX", "invSY", "invSZ", "left", "right", "top", "bottom", "near", "far", "h", "matrix", "i", "array", "offset", "Vector3", "_matrix", "Matrix4", "_quaternion", "Quaternion", "Euler", "_Euler", "x", "y", "z", "order", "value", "euler", "m", "update", "te", "m11", "m12", "m13", "m21", "m22", "m23", "m31", "m32", "m33", "clamp", "q", "v", "newOrder", "array", "offset", "callback", "Layers", "channel", "layers", "_object3DId", "_v1", "Vector3", "_q1", "Quaternion", "_m1", "Matrix4", "_target", "_position", "_scale", "_quaternion", "_xAxis", "_yAxis", "_zAxis", "_addedEvent", "_removedEvent", "Object3D", "_Object3D", "EventDispatcher", "generateUUID", "position", "rotation", "Euler", "quaternion", "scale", "onRotationChange", "onQuaternionChange", "Matrix3", "Layers", "matrix", "q", "axis", "angle", "euler", "m", "distance", "vector", "x", "y", "z", "parent", "object", "i", "index", "id", "name", "value", "l", "target", "callback", "children", "force", "updateParents", "updateChildren", "meta", "isRootObject", "output", "serialize", "library", "element", "parameters", "shapes", "shape", "uuids", "animation", "geometries", "extractFromCache", "materials", "textures", "images", "skeletons", "animations", "nodes", "cache", "values", "key", "data", "recursive", "source", "child", "_v0", "Vector3", "_v1", "_v2", "_v3", "_vab", "_vac", "_vbc", "_vap", "_vbp", "_vcp", "Triangle", "_Triangle", "a", "b", "c", "target", "targetLengthSq", "point", "dot00", "dot01", "dot02", "dot11", "dot12", "denom", "invDenom", "u", "v", "p1", "p2", "p3", "uv1", "uv2", "uv3", "direction", "points", "i0", "i1", "i2", "attribute", "triangle", "box", "p", "w", "d1", "d2", "d3", "d4", "vc", "d5", "d6", "vb", "va", "materialId", "Material", "EventDispatcher", "generateUUID", "NormalBlending", "FrontSide", "SrcAlphaFactor", "OneMinusSrcAlphaFactor", "AddEquation", "LessEqualDepth", "AlwaysStencilFunc", "KeepStencilOp", "value", "values", "key", "newValue", "FlatShading", "currentValue", "meta", "isRootObject", "data", "extractFromCache", "cache", "textures", "images", "source", "srcPlanes", "dstPlanes", "n", "i", "MeshBasicMaterial", "Material", "parameters", "Color", "MultiplyOperation", "source", "_vector", "Vector3", "_vector2", "Vector2", "BufferAttribute", "array", "itemSize", "normalized", "StaticDrawUsage", "value", "source", "index1", "attribute", "index2", "i", "l", "colors", "offset", "color", "Color", "vectors", "vector", "Vector4", "m", "index", "x", "y", "z", "w", "callback", "data", "Uint16BufferAttribute", "BufferAttribute", "array", "itemSize", "normalized", "Uint32BufferAttribute", "BufferAttribute", "array", "itemSize", "normalized", "Float16BufferAttribute", "Float32BufferAttribute", "_id", "_m1", "Matrix4", "_obj", "Object3D", "_offset", "Vector3", "_box", "Box3", "_boxMorphTargets", "_vector", "BufferGeometry", "_BufferGeometry", "EventDispatcher", "generateUUID", "index", "arrayNeedsUint32", "Uint32BufferAttribute", "Uint16BufferAttribute", "name", "attribute", "start", "count", "materialIndex", "matrix", "position", "normal", "normalMatrix", "Matrix3", "tangent", "q", "angle", "x", "y", "z", "vector", "points", "l", "point", "Float32BufferAttribute", "morphAttributesPosition", "il", "morphAttribute", "Sphere", "center", "i", "maxRadiusSq", "morphTargetsRelative", "j", "jl", "attributes", "indices", "positions", "normals", "uvs", "nVertices", "BufferAttribute", "tangents", "tan1", "tan2", "vA", "vB", "vC", "uvA", "Vector2", "uvB", "uvC", "sdir", "tdir", "handleTriangle", "a", "b", "c", "r", "groups", "group", "tmp", "tmp2", "n", "n2", "handleVertex", "v", "t", "w", "positionAttribute", "normalAttribute", "pA", "pB", "pC", "nA", "nB", "nC", "cb", "ab", "geometry", "offset", "key", "attributeArray1", "attribute2", "attributeArray2", "attributeOffset", "length", "convertBufferAttribute", "array", "itemSize", "normalized", "array2", "index2", "geometry2", "newAttribute", "morphAttributes", "morphArray", "data", "parameters", "hasMorphAttributes", "attributeArray", "boundingSphere", "source", "boundingBox", "_inverseMatrix", "Matrix4", "_ray", "Ray", "_sphere", "Sphere", "_vA", "Vector3", "_vB", "_vC", "_tempA", "_tempB", "_tempC", "_morphA", "_morphB", "_morphC", "_uvA", "Vector2", "_uvB", "_uvC", "_intersectionPoint", "_intersectionPointWorld", "Mesh", "Object3D", "geometry", "BufferGeometry", "material", "MeshBasicMaterial", "source", "morphAttributes", "keys", "morphAttribute", "m", "ml", "name", "morphTargets", "raycaster", "intersects", "matrixWorld", "intersection", "index", "position", "morphPosition", "morphTargetsRelative", "uv", "uv2", "groups", "drawRange", "i", "il", "group", "groupMaterial", "start", "end", "j", "jl", "a", "b", "c", "checkBufferGeometryIntersection", "checkIntersection", "object", "ray", "pA", "pB", "pC", "point", "intersect", "BackSide", "DoubleSide", "distance", "morphInfluences", "influence", "Triangle", "face", "cloneUniforms", "src", "dst", "u", "p", "property", "default_vertex_glsl_default", "default_fragment_glsl_default", "ShaderMaterial", "Material", "parameters", "default_vertex_glsl_default", "default_fragment_glsl_default", "source", "cloneUniforms", "meta", "data", "name", "value", "extensions", "key", "Camera", "Object3D", "Matrix4", "source", "recursive", "target", "force", "updateParents", "updateChildren", "PerspectiveCamera", "Camera", "fov", "aspect", "near", "far", "source", "recursive", "focalLength", "vExtentSlope", "RAD2DEG", "DEG2RAD", "fullWidth", "fullHeight", "x", "y", "width", "height", "top", "left", "view", "skew", "meta", "data", "_vector1", "Vector3", "_vector2", "_normalMatrix", "Matrix3", "Plane", "normal", "constant", "x", "y", "z", "w", "point", "a", "b", "c", "plane", "inverseNormalLength", "sphere", "target", "line", "direction", "denominator", "t", "startSign", "endSign", "box", "matrix", "optionalNormalMatrix", "normalMatrix", "referencePoint", "offset", "_sphere", "Sphere", "_vector", "Vector3", "Frustum", "p0", "Plane", "p1", "p2", "p3", "p4", "p5", "planes", "frustum", "m", "me", "me0", "me1", "me2", "me3", "me4", "me5", "me6", "me7", "me8", "me9", "me10", "me11", "me12", "me13", "me14", "me15", "object", "geometry", "sprite", "sphere", "center", "negRadius", "i", "box", "plane", "point", "OrthographicCamera", "Camera", "left", "right", "top", "bottom", "near", "far", "source", "recursive", "fullWidth", "fullHeight", "x", "y", "width", "height", "dx", "dy", "cx", "cy", "scaleW", "scaleH", "meta", "data", "MeshDepthMaterial", "Material", "parameters", "BasicDepthPacking", "source", "MeshDistanceMaterial", "Material", "parameters", "Vector3", "source", "Group", "Object3D", "InterleavedBuffer", "array", "stride", "StaticDrawUsage", "generateUUID", "value", "source", "index1", "attribute", "index2", "i", "l", "offset", "data", "ib", "callback", "_vector", "Vector3", "InterleavedBufferAttribute", "_InterleavedBufferAttribute", "interleavedBuffer", "itemSize", "offset", "normalized", "value", "m", "i", "l", "index", "x", "y", "z", "w", "data", "array", "j", "BufferAttribute", "SpriteMaterial", "Material", "parameters", "Color", "source", "_basePosition", "Vector3", "_skinIndex", "Vector4", "_skinWeight", "_vector", "_matrix", "Matrix4", "SkinnedMesh", "Mesh", "geometry", "material", "source", "skeleton", "bindMatrix", "vector", "skinWeight", "l", "scale", "force", "index", "target", "i", "weight", "boneIndex", "Bone", "Object3D", "DataTexture", "Texture", "data", "width", "height", "format", "type", "mapping", "wrapS", "wrapT", "magFilter", "NearestFilter", "minFilter", "anisotropy", "encoding", "_offsetMatrix", "Matrix4", "_identityMatrix", "Skeleton", "_Skeleton", "bones", "boneInverses", "generateUUID", "il", "i", "inverse", "bone", "boneMatrices", "boneTexture", "matrix", "size", "ceilPowerOfTwo", "DataTexture", "RGBAFormat", "FloatType", "name", "json", "l", "uuid", "Bone", "data", "boneInverse", "InstancedBufferAttribute", "BufferAttribute", "array", "itemSize", "normalized", "meshPerAttribute", "source", "data", "_instanceLocalMatrix", "Matrix4", "_instanceWorldMatrix", "_instanceIntersects", "_mesh", "Mesh", "InstancedMesh", "geometry", "material", "count", "InstancedBufferAttribute", "source", "index", "color", "matrix", "raycaster", "intersects", "matrixWorld", "raycastTimes", "instanceId", "i", "l", "intersect", "LineBasicMaterial", "Material", "parameters", "Color", "source", "_start", "Vector3", "_end", "_inverseMatrix", "Matrix4", "_ray", "Ray", "_sphere", "Sphere", "Line", "Object3D", "geometry", "BufferGeometry", "material", "LineBasicMaterial", "source", "positionAttribute", "lineDistances", "i", "l", "Float32BufferAttribute", "raycaster", "intersects", "matrixWorld", "threshold", "drawRange", "localThreshold", "localThresholdSq", "vStart", "vEnd", "interSegment", "interRay", "step", "index", "start", "end", "a", "b", "distance", "morphAttributes", "keys", "morphAttribute", "m", "ml", "name", "morphTargets", "_start", "Vector3", "_end", "LineSegments", "Line", "geometry", "material", "positionAttribute", "lineDistances", "i", "l", "Float32BufferAttribute", "LineLoop", "Line", "geometry", "material", "PointsMaterial", "Material", "parameters", "Color", "source", "_inverseMatrix", "Matrix4", "_ray", "Ray", "_sphere", "Sphere", "_position", "Vector3", "Points", "Object3D", "geometry", "BufferGeometry", "material", "PointsMaterial", "source", "raycaster", "intersects", "matrixWorld", "threshold", "drawRange", "localThreshold", "localThresholdSq", "index", "positionAttribute", "start", "end", "i", "il", "a", "testPoint", "l", "morphAttributes", "keys", "morphAttribute", "m", "ml", "name", "morphTargets", "point", "object", "rayPointDistanceSq", "intersectPoint", "distance", "ShadowMaterial", "Material", "parameters", "Color", "source", "RawShaderMaterial", "ShaderMaterial", "parameters", "MeshStandardMaterial", "Material", "parameters", "Color", "TangentSpaceNormalMap", "Vector2", "source", "MeshPhysicalMaterial", "MeshStandardMaterial", "parameters", "Vector2", "clamp", "reflectivity", "Color", "value", "source", "MeshPhongMaterial", "Material", "parameters", "Color", "TangentSpaceNormalMap", "Vector2", "MultiplyOperation", "source", "MeshToonMaterial", "Material", "parameters", "Color", "TangentSpaceNormalMap", "Vector2", "source", "MeshNormalMaterial", "Material", "parameters", "TangentSpaceNormalMap", "Vector2", "source", "MeshLambertMaterial", "Material", "parameters", "Color", "MultiplyOperation", "source", "MeshMatcapMaterial", "Material", "parameters", "Color", "TangentSpaceNormalMap", "Vector2", "source", "LineDashedMaterial", "LineBasicMaterial", "parameters", "source", "materialLib", "ShadowMaterial", "SpriteMaterial", "RawShaderMaterial", "ShaderMaterial", "PointsMaterial", "MeshPhysicalMaterial", "MeshStandardMaterial", "MeshPhongMaterial", "MeshToonMaterial", "MeshNormalMaterial", "MeshLambertMaterial", "MeshDepthMaterial", "MeshDistanceMaterial", "MeshBasicMaterial", "MeshMatcapMaterial", "LineDashedMaterial", "LineBasicMaterial", "Material", "type", "AnimationUtils", "array", "from", "to", "type", "forceClone", "object", "times", "compareTime", "i", "j", "n", "result", "values", "stride", "order", "nValues", "dstOffset", "srcOffset", "jsonKeys", "valuePropertyName", "key", "value", "sourceClip", "name", "startFrame", "endFrame", "fps", "clip", "tracks", "track", "valueSize", "frame", "k", "minStartTime", "targetClip", "referenceFrame", "referenceClip", "numTracks", "referenceTime", "referenceTrack", "referenceTrackType", "targetTrack", "referenceOffset", "referenceValueSize", "targetOffset", "targetValueSize", "lastIndex", "referenceValue", "startIndex", "endIndex", "interpolant", "Quaternion", "numTimes", "valueStart", "valueEnd", "AdditiveAnimationBlendMode", "Interpolant", "parameterPositions", "sampleValues", "sampleSize", "resultBuffer", "pp", "i1", "t1", "t0", "validate_interval", "seek", "right", "linear_scan", "forward_scan", "giveUpAt", "t1global", "mid", "index", "result", "values", "stride", "offset", "i", "CubicInterpolant", "Interpolant", "parameterPositions", "sampleValues", "sampleSize", "resultBuffer", "ZeroCurvatureEnding", "i1", "t0", "t1", "pp", "iPrev", "iNext", "tPrev", "tNext", "ZeroSlopeEnding", "WrapAroundEnding", "halfDt", "stride", "t", "result", "values", "o1", "o0", "oP", "oN", "wP", "wN", "p", "ppp", "sP", "s0", "s1", "sN", "i", "LinearInterpolant", "Interpolant", "parameterPositions", "sampleValues", "sampleSize", "resultBuffer", "i1", "t0", "t", "t1", "result", "values", "stride", "offset1", "offset0", "weight1", "weight0", "i", "DiscreteInterpolant", "Interpolant", "parameterPositions", "sampleValues", "sampleSize", "resultBuffer", "i1", "KeyframeTrack", "name", "times", "values", "interpolation", "AnimationUtils", "track", "trackType", "json", "result", "DiscreteInterpolant", "LinearInterpolant", "CubicInterpolant", "factoryMethod", "InterpolateDiscrete", "InterpolateLinear", "InterpolateSmooth", "message", "timeOffset", "n", "timeScale", "startTime", "endTime", "nKeys", "from", "to", "stride", "valid", "valueSize", "prevTime", "i", "currTime", "value", "smoothInterpolation", "lastIndex", "writeIndex", "keep", "time", "timeNext", "offset", "offsetP", "offsetN", "j", "readOffset", "writeOffset", "TypedKeyframeTrack", "BooleanKeyframeTrack", "KeyframeTrack", "InterpolateDiscrete", "ColorKeyframeTrack", "KeyframeTrack", "NumberKeyframeTrack", "KeyframeTrack", "QuaternionLinearInterpolant", "Interpolant", "parameterPositions", "sampleValues", "sampleSize", "resultBuffer", "i1", "t0", "t", "t1", "result", "values", "stride", "alpha", "offset", "end", "Quaternion", "QuaternionKeyframeTrack", "KeyframeTrack", "result", "QuaternionLinearInterpolant", "InterpolateLinear", "StringKeyframeTrack", "KeyframeTrack", "InterpolateDiscrete", "VectorKeyframeTrack", "KeyframeTrack", "AnimationClip", "name", "duration", "tracks", "blendMode", "NormalAnimationBlendMode", "generateUUID", "json", "jsonTracks", "frameTime", "i", "n", "parseKeyframeTrack", "clip", "clipTracks", "KeyframeTrack", "morphTargetSequence", "fps", "noLoop", "numMorphTargets", "times", "values", "order", "AnimationUtils", "NumberKeyframeTrack", "objectOrClipArray", "clipArray", "o", "morphTargets", "animationToMorphTargets", "pattern", "il", "morphTarget", "parts", "animationMorphTargets", "clips", "animation", "bones", "addNonemptyTrack", "trackType", "trackName", "animationKeys", "propertyName", "destTracks", "clipName", "hierarchyTracks", "h", "morphTargetNames", "k", "m", "morphTargetName", "animationKey", "boneName", "VectorKeyframeTrack", "QuaternionKeyframeTrack", "track", "valid", "getTrackTypeForValueTypeName", "typeName", "ColorKeyframeTrack", "BooleanKeyframeTrack", "StringKeyframeTrack", "Cache", "key", "file", "LoadingManager", "onLoad", "onProgress", "onError", "scope", "isLoading", "itemsLoaded", "itemsTotal", "urlModifier", "handlers", "url", "transform", "regex", "loader", "index", "file", "i", "l", "DefaultLoadingManager", "Loader", "manager", "DefaultLoadingManager", "url", "onProgress", "scope", "resolve", "reject", "crossOrigin", "value", "path", "resourcePath", "requestHeader", "loading", "FileLoader", "Loader", "manager", "url", "onLoad", "onProgress", "onError", "cached", "Cache", "req", "mimeType", "responseType", "response", "callbacks", "reader", "contentLength", "total", "lengthComputable", "loaded", "stream", "controller", "readData", "done", "value", "event", "i", "il", "callback", "text", "exec", "label", "decoder", "ab", "data", "err", "ImageLoader", "Loader", "manager", "url", "onLoad", "onProgress", "onError", "scope", "cached", "Cache", "image", "createElementNS", "onImageLoad", "removeEventListeners", "onImageError", "event", "TextureLoader", "Loader", "manager", "url", "onLoad", "onProgress", "onError", "texture", "Texture", "loader", "ImageLoader", "image", "Light", "Object3D", "color", "intensity", "Color", "source", "meta", "data", "_projScreenMatrix", "Matrix4", "_lightPositionWorld", "Vector3", "_lookTarget", "LightShadow", "camera", "Vector2", "Frustum", "Vector4", "light", "shadowCamera", "shadowMatrix", "viewportIndex", "source", "object", "SpotLightShadow", "LightShadow", "PerspectiveCamera", "light", "camera", "fov", "RAD2DEG", "aspect", "far", "source", "SpotLight", "Light", "color", "intensity", "distance", "angle", "penumbra", "decay", "Object3D", "SpotLightShadow", "power", "source", "_projScreenMatrix", "Matrix4", "_lightPositionWorld", "Vector3", "_lookTarget", "PointLightShadow", "LightShadow", "PerspectiveCamera", "Vector2", "Vector4", "light", "viewportIndex", "camera", "shadowMatrix", "far", "PointLight", "Light", "color", "intensity", "distance", "decay", "PointLightShadow", "power", "source", "DirectionalLightShadow", "LightShadow", "OrthographicCamera", "DirectionalLight", "Light", "color", "intensity", "Object3D", "DirectionalLightShadow", "source", "LoaderUtils", "array", "s", "il", "url", "index", "path", "ImageBitmapLoader", "Loader", "manager", "options", "url", "onLoad", "onProgress", "onError", "scope", "cached", "Cache", "fetchOptions", "res", "blob", "imageBitmap", "e", "_RESERVED_CHARS_RE", "_reservedRe", "_wordChar", "_wordCharOrDot", "_directoryRe", "_nodeRe", "_objectRe", "_propertyRe", "_trackRe", "_supportedObjectNames", "Composite", "targetGroup", "path", "optionalParsedPath", "parsedPath", "PropertyBinding", "array", "offset", "firstValidIndex", "binding", "bindings", "i", "n", "_PropertyBinding", "rootNode", "root", "name", "trackName", "matches", "results", "lastDot", "objectName", "nodeName", "bone", "searchNodeSubtree", "children", "childNode", "result", "subTreeNode", "buffer", "source", "dest", "targetArray", "sourceArray", "targetObject", "propertyName", "propertyIndex", "objectIndex", "nodeProperty", "versioning", "bindingType", "REVISION", "import_three", "toTrianglesDrawMode", "geometry", "drawMode", "index", "indices", "position", "i", "numberOfTriangles", "newIndices", "newGeometry", "GLTFLoader", "Loader", "manager", "parser", "GLTFMaterialsClearcoatExtension", "GLTFTextureBasisUExtension", "GLTFTextureWebPExtension", "GLTFTextureAVIFExtension", "GLTFMaterialsSheenExtension", "GLTFMaterialsTransmissionExtension", "GLTFMaterialsVolumeExtension", "GLTFMaterialsIorExtension", "GLTFMaterialsEmissiveStrengthExtension", "GLTFMaterialsSpecularExtension", "GLTFMaterialsIridescenceExtension", "GLTFLightsExtension", "GLTFMeshoptCompression", "GLTFMeshGpuInstancing", "url", "onLoad", "onProgress", "onError", "scope", "resourcePath", "LoaderUtils", "_onError", "e", "loader", "FileLoader", "data", "gltf", "dracoLoader", "ktx2Loader", "meshoptDecoder", "callback", "path", "json", "extensions", "plugins", "textDecoder", "BINARY_EXTENSION_HEADER_MAGIC", "EXTENSIONS", "GLTFBinaryExtension", "error", "GLTFParser", "i", "plugin", "extensionName", "extensionsRequired", "GLTFMaterialsUnlitExtension", "GLTFDracoMeshCompressionExtension", "GLTFTextureTransformExtension", "GLTFMeshQuantizationExtension", "resolve", "reject", "GLTFRegistry", "objects", "key", "object", "nodeDefs", "nodeIndex", "nodeLength", "nodeDef", "lightIndex", "cacheKey", "dependency", "lightDef", "lightNode", "color", "Color", "range", "DirectionalLight", "PointLight", "SpotLight", "assignExtrasToUserData", "type", "index", "self", "light", "MeshBasicMaterial", "materialParams", "materialDef", "pending", "metallicRoughness", "array", "sRGBEncoding", "materialIndex", "emissiveStrength", "MeshPhysicalMaterial", "extension", "scale", "Vector2", "colorArray", "textureIndex", "textureDef", "name", "source", "handler", "isSupported", "image", "bufferView", "extensionDef", "buffer", "decoder", "res", "byteOffset", "byteLength", "count", "stride", "result", "meshDef", "primitive", "WEBGL_CONSTANTS", "attributesDef", "attributes", "accessor", "results", "nodeObject", "meshes", "instancedMeshes", "mesh", "m", "Matrix4", "p", "Vector3", "q", "Quaternion", "s", "instancedMesh", "InstancedMesh", "attributeName", "Object3D", "BINARY_EXTENSION_HEADER_LENGTH", "BINARY_EXTENSION_CHUNK_TYPES", "headerView", "chunkContentsLength", "chunkView", "chunkIndex", "chunkLength", "chunkType", "contentArray", "bufferViewIndex", "gltfAttributeMap", "threeAttributeMap", "attributeNormalizedMap", "attributeTypeMap", "threeAttributeName", "ATTRIBUTES", "accessorDef", "componentType", "WEBGL_COMPONENT_TYPES", "geometry", "attribute", "normalized", "texture", "transform", "GLTFCubicSplineInterpolant", "Interpolant", "parameterPositions", "sampleValues", "sampleSize", "resultBuffer", "values", "valueSize", "offset", "i1", "t0", "t", "t1", "stride2", "stride3", "td", "pp", "ppp", "offset1", "offset0", "s2", "s3", "s0", "s1", "p0", "m0", "p1", "m1", "_q", "GLTFCubicSplineQuaternionInterpolant", "WEBGL_FILTERS", "NearestFilter", "LinearFilter", "NearestMipmapNearestFilter", "LinearMipmapNearestFilter", "NearestMipmapLinearFilter", "LinearMipmapLinearFilter", "WEBGL_WRAPPINGS", "ClampToEdgeWrapping", "MirroredRepeatWrapping", "RepeatWrapping", "WEBGL_TYPE_SIZES", "PATH_PROPERTIES", "INTERPOLATION", "InterpolateLinear", "InterpolateDiscrete", "ALPHA_MODES", "createDefaultMaterial", "cache", "MeshStandardMaterial", "FrontSide", "addUnknownExtensionsToUserData", "knownExtensions", "objectDef", "gltfDef", "addMorphTargets", "targets", "hasMorphPosition", "hasMorphNormal", "hasMorphColor", "il", "target", "pendingPositionAccessors", "pendingNormalAccessors", "pendingColorAccessors", "pendingAccessor", "accessors", "morphPositions", "morphNormals", "morphColors", "updateMorphTargets", "targetNames", "createPrimitiveKey", "primitiveDef", "dracoExtension", "geometryKey", "createAttributesKey", "attributesKey", "keys", "getNormalizedComponentScale", "constructor", "getImageURIMimeType", "uri", "_identityMatrix", "options", "isSafari", "isFirefox", "firefoxVersion", "TextureLoader", "ImageBitmapLoader", "ext", "dependencies", "skinDefs", "meshDefs", "skinIndex", "skinLength", "joints", "ref", "updateMappings", "original", "clone", "mappings", "child", "func", "defs", "def", "bufferIndex", "bufferDef", "bufferViewDef", "accessorIndex", "itemSize", "TypedArray", "BufferAttribute", "pendingBufferViews", "bufferViews", "elementBytes", "itemBytes", "byteStride", "bufferAttribute", "ibSlice", "ibCacheKey", "ib", "InterleavedBuffer", "InterleavedBufferAttribute", "itemSizeIndices", "TypedArrayIndices", "byteOffsetIndices", "byteOffsetValues", "sparseIndices", "sparseValues", "sourceIndex", "sourceDef", "promise", "sampler", "URL", "sourceURI", "isObjectURL", "blob", "imageBitmap", "Texture", "mapName", "mapDef", "encoding", "gltfReference", "material", "useDerivativeTangents", "useVertexColors", "useFlatShading", "pointsMaterial", "PointsMaterial", "Material", "lineMaterial", "LineBasicMaterial", "cachedMaterial", "materialType", "materialExtensions", "kmuExtension", "DoubleSide", "alphaMode", "originalName", "sanitizedName", "PropertyBinding", "primitives", "createDracoPrimitive", "addPrimitiveAttributes", "cached", "geometryPromise", "BufferGeometry", "meshIndex", "materials", "geometries", "SkinnedMesh", "Mesh", "toTrianglesDrawMode", "TriangleStripDrawMode", "TriangleFanDrawMode", "LineSegments", "Line", "LineLoop", "Points", "group", "Group", "cameraIndex", "camera", "cameraDef", "params", "PerspectiveCamera", "MathUtils_exports", "OrthographicCamera", "skinDef", "inverseBindMatrices", "jointNodes", "bones", "boneInverses", "jointNode", "mat", "Skeleton", "animationIndex", "animationDef", "pendingNodes", "pendingInputAccessors", "pendingOutputAccessors", "pendingSamplers", "pendingTargets", "channel", "input", "output", "nodes", "inputAccessors", "outputAccessors", "samplers", "tracks", "node", "inputAccessor", "outputAccessor", "TypedKeyframeTrack", "NumberKeyframeTrack", "QuaternionKeyframeTrack", "VectorKeyframeTrack", "targetName", "interpolation", "outputArray", "scaled", "j", "jl", "track", "interpolantType", "AnimationClip", "o", "nodePending", "childPending", "childrenDef", "skeletonPending", "children", "skeleton", "nodeName", "meshPromise", "Bone", "matrix", "sceneIndex", "sceneDef", "scene", "nodeIds", "reduceAssociations", "reducedAssociations", "value", "computeBounds", "box", "Box3", "min", "max", "boxScale", "maxDisplacement", "vector", "sphere", "Sphere", "assignAttributeAccessor", "gltfAttributeName", "ColladaExporter", "object", "onDone", "options", "version", "format", "urdf", "IS_END_TAG", "IS_SELF_CLOSING", "HAS_TEXT", "pad", "ch", "num", "tagnum", "tag", "res", "base64ToBuffer", "str", "b", "buf", "i", "l", "canvas", "ctx", "imageToData", "image", "ext", "base64data", "getFuncs", "tempColor", "Color", "attrBufferToArray", "attr", "isColor", "arr", "size", "j", "subArray", "st", "ct", "getAttribute", "name", "params", "type", "array", "n", "transMat", "getTransform", "o", "Matrix4", "processGeometry", "g", "info", "geometryInfo", "bufferGeometry", "meshid", "libraryGeometries", "indexCount", "groups", "gname", "gnode", "posName", "vertName", "triangleInputs", "normName", "uvName", "colName", "indexArray", "group", "subarr", "polycount", "processTexture", "tex", "texid", "imageMap", "libraryImages", "imageNode", "textures", "processMaterial", "m", "matid", "materialMap", "libraryEffects", "emissive", "diffuse", "specular", "shininess", "reflectivity", "transparencyNode", "techniqueNode", "effectnode", "DoubleSide", "materialName", "materialNode", "libraryMaterials", "processObject", "node", "geomInfo", "geometry", "matids", "matidsArray", "mat", "MeshBasicMaterial", "materials", "v", "id", "c", "libraryVisualScenes", "dae", "ColladaLoader", "COLLADA", "scene", "visualScene", "kinematicsModel", "readyCallbackFunc", "sources", "images", "animations", "controllers", "geometries", "materials", "effects", "cameras", "lights", "animData", "kinematics", "visualScenes", "kinematicsModels", "baseUrl", "morphs", "skins", "loader", "flip_uv", "preferredShading", "options", "colladaUnit", "colladaUp", "upConversion", "load", "url", "readyCallback", "progressCallback", "failCallback", "xmlParser", "responseXML", "parse", "doc", "callBack", "parts", "parseAsset", "setUpConversion", "parseLib", "_Image", "Material", "Effect", "Geometry", "Camera", "Light", "Controller", "Animation", "VisualScene", "KinematicsModel", "parseScene", "i", "createSceneGraph", "createAnimations", "parseKinematicsModel", "createKinematics", "result", "setPreferredShading", "shading", "elements", "element", "child", "meter", "q", "classSpec", "prefix", "lib", "elementsLength", "j", "daeElement", "sceneElement", "kinematicsModelElement", "recurseHierarchy", "node", "n", "newData", "il", "d", "jl", "calcAnimationBounds", "start", "end", "frames", "ID", "id", "animation", "sampler", "createMorph", "geometry", "ctrl", "morphCtrl", "InstanceController", "morph", "target_id", "daeGeometry", "target", "createSkin", "applyBindShape", "skinCtrl", "skin", "skeleton", "hierarchy", "bones", "setupSkeleton", "frame", "parent", "channel", "m", "setupSkinningMatrices", "bone", "found", "inv", "k", "w", "flattenSkeleton", "list", "walk", "parentid", "data", "skinToBindPose", "skinController", "skinned", "applySkin", "instanceCtrl", "animationBounds", "bonelist", "joints", "sortedbones", "vidx", "weight", "v", "o", "s", "skinIndices", "skinWeights", "weights", "indicies", "animationdata", "key", "jointMap", "_addToMap", "jointIndex", "parentVisualElement", "parentVisualElementId", "colladaNode", "joint", "jointData", "value", "threejsNode", "axis", "transforms", "matrix", "transform", "m1", "elementsFloat32Arr", "elementsRowMajor", "visualTarget", "visualTargetElement", "obj", "morphController", "controller", "inst_geom", "InstanceGeometry", "second", "double_sided_materials", "instance_geometry", "instance_materials", "used_materials", "used_materials_array", "num_materials", "first_material", "instance_material", "mat", "effect_id", "shader", "material3js", "_copied_material", "mesh", "material", "geom", "face", "instance_camera", "cparams", "cam", "light", "instance_light", "lparams", "color", "intensity", "distance", "angle", "exponent", "delta", "getJointId", "getLibraryNode", "nodes", "attObj", "getChannelsForNode", "channels", "startTime", "endTime", "calcFrameDuration", "minT", "t0", "t1", "calcMatrixAt", "t", "animated", "bakeAnimations", "keys", "sids", "fullSid", "input", "member", "getConvertedIndex", "getConvertedMember", "time", "findKey", "Key", "timeNdx", "findTimeNdx", "sid", "interpolateKeys", "retVal", "ndx", "prevKey", "getPrevKeyWith", "nextKey", "getNextKeyWith", "scale", "prevTarget", "nextData", "prevData", "Skin", "Morph", "inputs", "source", "Source", "Input", "f", "_floats", "getConvertedMat4", "src", "vcount", "_ints", "index", "numBones", "vertex_weights", "influence", "recursive", "Node", "transformSid", "dotSyntax", "arrSyntax", "arrIndices", "InstanceCamera", "InstanceLight", "iNode", "Transform", "fixCoords", "members", "propName", "instances", "instance", "InstanceMaterial", "extractDoubleSided", "Mesh", "_source", "Vertices", "LineStrips", "Triangles", "Polygons", "Polylist", "vertexData", "getConvertedVec3", "primitive", "pList", "idx32", "numParams", "vcIndex", "maxOffset", "texture_sets", "offset", "pCount", "p", "vs", "ns", "ts", "cs", "len", "faces", "uv", "uvArr", "clr", "vec1", "vec2", "vec3", "v1", "v2", "norm", "vertices", "_attr_as_int", "Accessor", "param", "_bools", "_strings", "InstanceEffect", "ColorOrTexture", "rgba", "Shader", "type", "effect", "bumpType", "props", "transparent", "transparentColor", "transparencyLevel", "prop", "cot", "samplerId", "surfaceId", "surface", "image", "texture", "loadTextureImage", "Surface", "Sampler2D", "technique", "_image", "anim", "Sampler", "Channel", "getConvertedTranslation", "opt_sid", "l", "nextTarget", "perspective", "orthographic", "Joint", "Link", "axisElement", "_axis", "min", "max", "jointTypes", "jointElement", "Attachment", "_nsResolver", "nsPrefix", "str", "raw", "_trimString", "_attr_as_float", "name", "defaultValue", "_attr_as_string", "_format_float", "num", "sign", "tmp", "arr", "indices", "TranslateModel", "THREE", "model", "scale", "height", "resolve", "reject", "avatarPivot", "avatarModel", "onDone", "result", "buffColor", "colorTexture", "imageColorBlob", "imageBitmap", "ColladaLoader", "colladaLoaded", "_a", "_b", "_c", "_d", "mesh1", "mat1", "mesh2", "mat2", "ColladaExporter", "Avatar", "url", "scale", "height", "loader", "GLTFLoader", "resolve", "reject", "gltf", "TranslateModel", "error", "position", "quaternion", "lerpSpeed", "curQuaternion", "import_three", "AvatarName", "name", "slot", "height", "viewer", "resolve", "script", "mesh", "text", "color", "geometry", "material", "boundingBox", "size", "x", "y", "marginX", "marginY", "xStart", "yStart", "width", "radius", "shape", "plane", "firstColor", "camera", "import_three", "Laser", "viewer", "slot", "laserOrigin", "avatar", "position", "delta", "startPosition", "v1", "curve", "thickness", "tube", "canvas", "context", "gradient", "color", "texture", "import_three", "distanceBetween", "v1", "v2", "dx", "dy", "dz", "Mouse", "viewer", "userId", "destPos", "slot", "name", "svg", "mouseEl", "nameEl", "color", "delta", "speed", "screenPos", "opacity", "localPoint3D", "localPosition", "distanceLocally", "distanceOriginal", "top", "left", "canvasRect", "wrapper", "import_three", "import_debug", "Logger", "scope", "debug", "formatter", "args", "import_throttle", "Observer", "options", "callback", "callbackToRemove", "event", "error", "listener", "params", "resolve", "reject", "result", "logger", "throttleTime", "Logger", "throttle", "self", "AutodeskPin", "viewer", "side", "event", "detail", "_a", "uuid", "haltGoToPin", "newPin", "annotation", "pinElement", "position", "ann", "info", "target", "canvasRect", "wrapper", "v1", "v2", "dx", "dy", "dz", "mousePosition", "coordinates", "camera", "origin", "positionInfo", "x", "y", "adjustedY", "open", "Logger", "Observer", "isOpen", "isVisible", "annotations", "temporaryPin", "posScreen", "screenCoordinates", "visible", "pin", "originalCameraPosition", "destPosition", "participants", "position3D", "offsetX", "offsetY", "vector", "screenPos", "originalPosition", "hitTest", "hitPosition", "distanceLocally", "distance", "threshold", "mouseElement", "import_debug", "Logger", "scope", "debug", "formatter", "args", "DEFAULT_AVATAR", "storeType", "Presence3D", "viewer", "options", "params", "message", "eventBus", "useStore", "ioc", "Presence3DManagerService", "localParticipant", "hasJoinedRoom", "hasJoined3D", "participants", "unsubscribe", "participant", "id", "name", "avatar", "avatarConfig", "type", "slot", "_a", "_b", "_c", "_d", "event", "participantToRemove", "participantOnlist", "position", "rotation", "participantToBeUpdated", "oldParticipant", "index", "u", "list", "isPrivate", "participantOn3D", "p", "participantId", "isTooClose", "closeAvatars", "remoteAvatar", "remoteLaser", "remoteMouse", "quaternion", "target", "mouse", "Logger", "model", "scale", "height", "url", "Avatar", "laserOrigin", "Laser", "avatarModel", "boundingBox", "size", "nameHeight", "AvatarName", "nameModel", "Mouse", "destPosition", "destTarget", "camera", "_e", "_f", "participantData", "similarX", "similarY", "similarZ", "AutodeskPin"]
}
